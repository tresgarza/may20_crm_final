/*! For license information please see main.8acf75ea.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},129:(e,t,n)=>{n.d(t,{C:()=>r});const r={APPLICATIONS:"applications",APPLICATION_HISTORY:"application_history",COMPANIES:"companies",CLIENTS:"users",USERS:"users",ADVISORS:"advisors",COMPANY_ADMINS:"company_admins",DOCUMENTS:"documents",COMMENTS:"comments",MESSAGES:"messages"}},153:(e,t,n)=>{var r=n(43),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:d,props:o,_owner:i.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,f(x,v.prototype),x.isPureReactComponent=!0;var _=Array.isArray,w=Object.prototype.hasOwnProperty,N={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var a,o={},s=null,i=null;if(null!=t)for(a in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(s=""+t.key),t)w.call(t,a)&&!E.hasOwnProperty(a)&&(o[a]=t[a]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];o.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===o[a]&&(o[a]=l[a]);return{$$typeof:n,type:e,key:s,ref:i,props:o,_owner:N.current}}function j(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function D(e,t,a,o,s){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===o?"."+C(l,0):o,_(s)?(a="",null!=e&&(a=e.replace(k,"$&/")+"/"),D(s,t,a,"",(function(e){return e}))):null!=s&&(j(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",_(e))for(var c=0;c<e.length;c++){var d=o+C(i=e[c],c);l+=D(i,t,a,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(i=e.next()).done;)l+=D(i=i.value,t,a,d=o+C(i,c++),s);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var r=[],a=0;return D(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},I={transition:null},R={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:I,ReactCurrentOwner:N};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!j(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=f({},e.props),o=e.key,s=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,i=N.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!E.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:n,type:e.type,key:o,ref:s,props:a,_owner:i}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=j,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},210:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(829)),o=r(n(736)),s=n(745);class i{constructor(e){let{headers:t={},schema:n,fetch:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new a.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new i(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:r=!1,get:a=!1,count:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new URL(`${this.url}/rpc/${e}`);let l;r||a?(t=r?"HEAD":"GET",Object.entries(n).filter((e=>{let[t,n]=e;return void 0!==n})).map((e=>{let[t,n]=e;return[t,Array.isArray(n)?`{${n.join(",")}}`:`${n}`]})).forEach((e=>{let[t,n]=e;i.searchParams.append(t,n)}))):(t="POST",l=n);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new o.default({method:t,url:i,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=i},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<o(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var i=2*(r+1)-1,l=e[i],c=i+1,d=e[c];if(0>o(l,n))c<a&&0>o(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[i]=n,r=i);else{if(!(c<a&&0>o(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function _(e){if(g=!1,x(e),!f)if(null!==r(c))f=!0,I(w);else{var t=r(d);null!==t&&R(_,t.startTime-e)}}function w(e,n){f=!1,g&&(g=!1,y(j),j=-1),m=!0;var o=p;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!D());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var i=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof i?h.callback=i:h===r(c)&&a(c),x(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&R(_,u.startTime-n),l=!1}return l}finally{h=null,p=o,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,E=!1,S=null,j=-1,k=5,C=-1;function D(){return!(t.unstable_now()-C<k)}function T(){if(null!==S){var e=t.unstable_now();C=e;var n=!0;try{n=S(!0,e)}finally{n?N():(E=!1,S=null)}}else E=!1}if("function"===typeof b)N=function(){b(T)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,P=A.port2;A.port1.onmessage=T,N=function(){P.postMessage(null)}}else N=function(){v(T,0)};function I(e){S=e,E||(E=!0,N())}function R(e,n){j=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,I(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:o,expirationTime:i=o+i,sortIndex:-1},o>s?(e.sortIndex=o,n(d,e),null===r(c)&&e===r(d)&&(g?(y(j),j=-1):g=!0,R(_,o-s))):(e.sortIndex=i,n(c,e),f||m||(f=!0,I(w))),e},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},286:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(630)),o=r(n(611));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=a.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,n,r;let a=null,s=null,i=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(s="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),o=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&o&&o.length>1&&(i=parseInt(o[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(s)&&(s.length>1?(a={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,i=null,l=406,c="Not Acceptable"):s=1===s.length?s[0]:null)}else{const t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(s=[],a=null,l=200,c="OK")}catch(d){404===e.status&&""===t?(l=204,c="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(r=null===a||void 0===a?void 0:a.details)||void 0===r?void 0:r.includes("0 rows"))&&(a=null,l=200,c="OK"),a&&this.shouldThrowOnError)throw new o.default(a)}return{error:a,data:s,count:i,status:l,statusText:c}}));return this.shouldThrowOnError||(n=n.catch((e=>{var t,n,r;return{error:{message:`${null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null===e||void 0===e?void 0:e.message}`,details:`${null!==(n=null===e||void 0===e?void 0:e.stack)&&void 0!==n?n:""}`,hint:"",code:`${null!==(r=null===e||void 0===e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),n.then(e,t)}returns(){return this}overrideTypes(){return this}}},287:(e,t,n)=>{n.d(t,{AS:()=>u,XX:()=>h,hx:()=>d,nj:()=>p,yH:()=>c});var r=n(509),a=n(129),o=n(599),s=n(703);const i=a.C.DOCUMENTS,l="client-documents",c=async e=>{const t=e||(0,r.X3)();try{const{data:e,error:n}=await t.storage.listBuckets();if(n)throw n;if(e.some((e=>e.name===l)))console.log(`Storage bucket '${l}' exists and is accessible`);else{console.log(`Storage bucket '${l}' does not exist, creating it...`);const{error:e}=await t.storage.createBucket(l,{public:!0,fileSizeLimit:10485760});if(e)throw e;console.log(`Storage bucket '${l}' created successfully.`)}}catch(n){throw console.error(`Error checking/creating storage bucket: ${n instanceof Error?n.message:"Unknown error"}`),n}},d=async e=>{const{data:t,error:n}=await r.ND.from(i).select("*").eq("application_id",e).order("created_at",{ascending:!1});if(n)throw console.error(`Error fetching documents for application ${e}:`,n),n;return t},u=async e=>{try{if(!await(0,o.LD)(i))return console.warn(`Documents table ${i} does not exist.`),[];const{data:t,error:n}=await r.ND.from(i).select("id, created_at, file_name, file_path, file_type, file_size, category, application_id, client_id, uploaded_by_user_id").eq("client_id",e).order("created_at",{ascending:!1});if(n)throw console.error(`Error fetching documents for client ${e}:`,n),n;return console.log(`Retrieved ${(null===t||void 0===t?void 0:t.length)||0} documents for client ${e}`),t||[]}catch(t){return console.error(`Error in getClientDocuments for client ${e}:`,t),[]}},h=async e=>{let{application_id:t,client_id:n,file:o,category:i,userId:d,documentName:u,contentType:h}=e;try{if(!t&&!n)throw new Error("Se requiere al menos un ID de aplicaci\xf3n o cliente");if(!o)throw new Error("No se proporcion\xf3 un archivo");await c();const e=h||o.type||"application/octet-stream",s=Math.random().toString(36).substring(2,15),p=`${n||t||"general"}/${s}.${o.name.split(".").pop()||""}`;console.log(`Subiendo archivo: ${o.name} (${e}) a ${p}`);const m=(0,r.X3)(),f=await m.storage.from(l).upload(p,o,{cacheControl:"3600",upsert:!0,contentType:e});if(f.error)throw console.error("Error subiendo archivo:",f.error),f.error;const g={file_name:u||o.name,file_path:p,file_type:e,file_size:o.size,category:i,uploaded_by_user_id:d,application_id:t,client_id:n},{data:v,error:y}=await r.ND.from(a.C.DOCUMENTS).insert(g).select().single();if(y)throw y;return v}catch(p){try{const e=(0,r.X3)(),a=`${n||t||"general"}/${o.name}`;await e.storage.from(l).remove([a])}catch(m){console.error("Error during cleanup after failed upload:",m)}if(p.message&&p.message.includes("policy"))throw(0,s.vV)(`Violaci\xf3n de pol\xedtica RLS al crear documento: ${p.message}`,"documentService.uploadDocument",{error:p}),(0,s.KR)(s.By.AUTHORIZATION,"No tienes permisos para crear documentos para este cliente o aplicaci\xf3n",{error:p.message});throw(0,s.vV)(`Error al crear documento en la base de datos: ${p.message}`,"documentService.uploadDocument",{error:p}),(0,s.KR)(s.By.DATABASE,"Error al crear documento en la base de datos",{error:p.message})}return{}},p=async e=>{try{console.log(`[getAllClientDocuments] Buscando documentos para cliente ${e}`);const t=(0,r.X3)();if(!await(0,o.LD)(i))return console.warn(`Documents table ${i} does not exist.`),[];const{data:n,error:s}=await t.from(i).select("*").eq("client_id",e);s&&console.error("[getAllClientDocuments] Error direct docs:",s);let l=[];const{data:c,error:d}=await t.from(a.C.APPLICATIONS).select("id").eq("client_id",e);if(d?console.error("[getAllClientDocuments] Error fetching apps by client_id:",d):c&&c.length>0&&l.push(...c.map((e=>e.id))),0===l.length){const{data:n,error:r}=await t.from("users").select("first_name, paternal_surname, maternal_surname").eq("id",e).single();if(r&&console.error("[getAllClientDocuments] Error fetching client name:",r),n){const e=[n.first_name,n.paternal_surname,n.maternal_surname].filter(Boolean).join(" ").trim();console.log(`[getAllClientDocuments] Buscando aplicaciones por nombre: "${e}"`);const{data:r,error:o}=await t.from(a.C.APPLICATIONS).select("id").ilike("client_name",`%${e}%`);o?console.error("[getAllClientDocuments] Error apps by name:",o):r&&r.length>0&&l.push(...r.map((e=>e.id)))}}let u=[];if(l.length>0){const{data:e,error:n}=await t.from(i).select("*").in("application_id",l);n?console.error("[getAllClientDocuments] Error fetching docs by applications:",n):u=e||[]}const h=[...n||[],...u].filter(((e,t,n)=>t===n.findIndex((t=>t.id===e.id))));return console.log(`[getAllClientDocuments] Total documentos retornados: ${h.length}`),h}catch(t){return console.error("[getAllClientDocuments] Error inesperado:",t),[]}}},296:(e,t,n)=>{n.d(t,{ND:()=>l,X3:()=>d});var r=n(799);const a="https://ydnygntfkrleiseuciwq.supabase.co",o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ydnygntfkrleiseuciwq.supabase.co",REACT_APP_SUPABASE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczOTk5MjQwNiwiZXhwIjoyMDU1NTY4NDA2fQ.TwhEGW9DK4DTQQRquT6Z9UW8T8UjLX-hp9uKdRjWAhs"}.REACT_APP_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk5OTI0MDYsImV4cCI6MjA1NTU2ODQwNn0.B-dH2Kptzz1oyM4ynno_GjlvjpxL-HbNKC_st4bgf0A",s={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ydnygntfkrleiseuciwq.supabase.co",REACT_APP_SUPABASE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczOTk5MjQwNiwiZXhwIjoyMDU1NTY4NDA2fQ.TwhEGW9DK4DTQQRquT6Z9UW8T8UjLX-hp9uKdRjWAhs"}.REACT_APP_SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczOTk5MjQwNiwiZXhwIjoyMDU1NTY4NDA2fQ.TwhEGW9DK4DTQQRquT6Z9UW8T8UjLX-hp9uKdRjWAhs",i=e=>({auth:{persistSession:!0},global:{headers:{Accept:"application/json","Content-Type":"application/json",apikey:e,Authorization:`Bearer ${e}`,Prefer:"return=representation"}}}),l=(0,r.UU)(a,o,i(o));let c=null;const d=()=>s?c||(c=(0,r.UU)(a,s,i(s)),c):(console.warn("Service role key not available, falling back to anon client"),l)},358:(e,t,n)=>{n.r(t),n.d(t,{checkClientExists:()=>_,checkClientExistsById:()=>N,createClient:()=>y,createMissingClient:()=>E,deleteClient:()=>x,getCanonicalClientId:()=>j,getClientApplications:()=>g,getClientById:()=>m,getClientCount:()=>w,getClientFromAnySource:()=>S,getClientWithSync:()=>k,getClients:()=>p,updateClient:()=>b,uploadClientDocuments:()=>v});var r=n(509),a=n(129),o=n(287),s=n(703);const i=async(e,t,n)=>{if(!n||0===n.length)return console.log("No documents to upload"),{successful:[],failed:[],allSuccessful:!0};console.log(`Attempting to upload ${n.length} documents for client ${e}`);const r=(e=>e&&0!==e.length?e.filter((e=>!!(e.file&&e.category&&e.name)||(console.error("Invalid document detected:",JSON.stringify({name:e.name||"undefined",category:e.category||"undefined",hasFile:!!e.file})),!1))):[])(n);if(0===r.length)return console.warn("No valid documents to upload after filtering"),{successful:[],failed:n.map((e=>({name:e.name||"Sin nombre",category:e.category||"Sin categor\xeda",error:"Documento inv\xe1lido: falta el archivo, nombre o categor\xeda"}))),allSuccessful:!1,warningMessage:"No se pudo subir ning\xfan documento porque todos estaban incompletos (faltan archivos, nombres o categor\xedas)."};const a=[],i=[];try{try{console.log('Checking if storage bucket "documents" exists...'),await o.yH(),console.log('Storage bucket "documents" exists and is accessible.')}catch(u){return console.warn("Bucket availability check failed, documents will not be uploaded:",u),l(r,u)}for(const n of r)try{const r=await c(n,e,t);r.success?(a.push(r.data),console.log(`Successfully uploaded document ${n.name} (${r.data.id})`)):i.push({name:n.name,category:n.category,error:r.error||"Error desconocido"})}catch(h){console.error(`Failed to upload document ${n.name}:`,h),i.push({name:n.name,category:n.category,error:h instanceof Error?h.message:"Error desconocido"})}return i.length>0&&(console.warn(`${i.length} documents failed to upload:`,i),console.log(`Successful uploads: ${a.length}/${r.length}`)),d(a,i,r.length)}catch(p){(0,s.vV)(p,"uploadClientDocuments");const e=(0,s.KI)(p,"document-upload");throw new Error(e.message)}},l=(e,t)=>{const n=e.map((e=>({name:e.name,category:e.category,error:"El almacenamiento de documentos no est\xe1 disponible temporalmente"})));let r="";return t instanceof Error&&(r=t.message,r.includes("404")||r.includes("not found")||r.includes("no existe")?r='El bucket "documents" no existe en Supabase Storage.':(r.includes("violates row-level security policy")||r.includes("Permission denied")||r.includes("Unauthorized"))&&(r='No tienes permisos para acceder al bucket "documents".')),{successful:[],failed:n,allSuccessful:!1,warningMessage:`Se actualiz\xf3 la informaci\xf3n del cliente, pero no se pudieron subir los documentos: ${r} El administrador debe verificar las pol\xedticas del bucket "documents" en Supabase Storage.`}},c=async(e,t,n)=>{console.log(`Attempting to upload document ${e.name} for client ${t}`);for(let a=1;a<=3;a++)try{return{success:!0,data:await o.XX({file:e.file,client_id:t,application_id:void 0,userId:n,documentName:e.name,category:e.category,description:e.description||void 0})}}catch(r){if(console.error(`Error uploading document ${e.name} (attempt ${a}/3):`,r),r instanceof Error&&(r.message.includes("violates row-level security policy")||r.message.includes("permission denied")||r.message.includes("Unauthorized")||r.message.includes("403")))return{success:!1,error:"Error de permisos: No se pueden subir documentos debido a restricciones de seguridad. Contacte al administrador para configurar las pol\xedticas RLS en Supabase."};if(3===a){let e="Error desconocido";return r instanceof Error&&(e=r.message),{success:!1,error:e}}const t=1e3*Math.pow(2,a-1);console.log(`Waiting ${t}ms before retrying upload for document ${e.name}`),await new Promise((e=>setTimeout(e,t))),console.log(`Retrying upload for document ${e.name} (attempt ${a+1}/3)`)}return{success:!1,error:"Error inesperado durante la carga del documento"}},d=(e,t,n)=>{let r=null;return t.length>0&&(r=t.length===n?t.some((e=>e.error&&(e.error.includes("permisos")||e.error.includes("seguridad")||e.error.includes("policy")||e.error.includes("RLS"))))?"Se guard\xf3 la informaci\xf3n del cliente, pero no se pudo subir ning\xfan documento debido a permisos insuficientes. Contacta al administrador para resolver el problema de pol\xedticas RLS en Supabase.":"Se guard\xf3 la informaci\xf3n del cliente, pero no se pudo subir ning\xfan documento. Por favor, intenta nuevamente m\xe1s tarde.":`Se guard\xf3 la informaci\xf3n del cliente y se subieron ${e.length} documentos, pero ${t.length} ${1===t.length?"documento fall\xf3":"documentos fallaron"} al subirse. Puedes intentar subir los documentos fallidos m\xe1s tarde.`),{successful:e,failed:t,allSuccessful:0===t.length,warningMessage:r}},u="users",h=e=>{if(!e)throw console.error("Error: userData is undefined in mapUserToClient"),new Error("No se pudo procesar la informaci\xf3n del cliente, los datos son inv\xe1lidos");const t=e.name||[e.first_name,e.paternal_surname,e.maternal_surname].filter(Boolean).join(" "),n={id:e.id,created_at:e.created_at,last_login:e.last_login,name:t,first_name:e.first_name,paternal_surname:e.paternal_surname,maternal_surname:e.maternal_surname,email:e.email,phone:e.phone,birth_date:e.birth_date,company_id:e.company_id,rfc:e.rfc,curp:e.curp,advisor_id:e.advisor_id,address:e.address,city:e.city,state:e.state,postal_code:e.postal_code,gender:e.gender,marital_status:e.marital_status,employment_type:e.employment_type,employment_years:e.employment_years,monthly_income:e.monthly_income,additional_income:e.additional_income,monthly_expenses:e.monthly_expenses,other_loan_balances:e.other_loan_balances,bank_name:e.bank_name,bank_clabe:e.bank_clabe,bank_account_number:e.bank_account_number,bank_account_type:e.bank_account_type,bank_account_origin:e.bank_account_origin,street_number_ext:e.street_number_ext,street_number_int:e.street_number_int,neighborhood:e.neighborhood,home_phone:e.home_phone,birth_state:e.birth_state,nationality:e.nationality,job_position:e.job_position,employer_name:e.employer_name,employer_phone:e.employer_phone,employer_address:e.employer_address,employer_activity:e.employer_activity,mortgage_payment:e.mortgage_payment,rent_payment:e.rent_payment,dependent_persons:e.dependent_persons,income_frequency:e.income_frequency,payment_method:e.payment_method,credit_purpose:e.credit_purpose,spouse_paternal_surname:e.spouse_paternal_surname,spouse_maternal_surname:e.spouse_maternal_surname,reference1_name:e.reference1_name,reference1_relationship:e.reference1_relationship,reference1_address:e.reference1_address,reference1_phone:e.reference1_phone,reference2_name:e.reference2_name,reference2_relationship:e.reference2_relationship,reference2_address:e.reference2_address,reference2_phone:e.reference2_phone};let r;const a=e.companies;var o;a&&(Array.isArray(a)?r=null===(o=a[0])||void 0===o?void 0:o.name:"object"===typeof a&&(r=null===a||void 0===a?void 0:a.name));return{...n,company_name:r}},p=async e=>{try{var t,n,a;const c=(0,r.X3)();console.log("[getClients] Starting client query with filters:",JSON.stringify(e));const d=await c.auth.getUser();if("COMPANY_ADMIN"===(null===d||void 0===d||null===(t=d.data)||void 0===t||null===(n=t.user)||void 0===n||null===(a=n.user_metadata)||void 0===a?void 0:a.role)){var o,i,l;const t=null===d||void 0===d||null===(o=d.data)||void 0===o||null===(i=o.user)||void 0===i||null===(l=i.user_metadata)||void 0===l?void 0:l.entityId;if(null===e||void 0===e||!e.company_id||e.company_id!==t)throw console.error("\ud83d\udea8 SECURITY VIOLATION: Company admin attempting to access data without proper company filter"),console.error("\ud83d\udea8 User entityId:",t),console.error("\ud83d\udea8 Requested company_id:",null===e||void 0===e?void 0:e.company_id),new Error("Acceso denegado: No tiene permisos para ver datos de otras empresas")}let p=c.from(u).select("\n        id, email, first_name, paternal_surname, maternal_surname, phone, \n        company_id, created_at, birth_date, rfc, curp, advisor_id, \n        address, city, state, postal_code, gender, marital_status, employment_type, \n        employment_years, monthly_income, additional_income, monthly_expenses, \n        other_loan_balances, bank_name, bank_clabe, bank_account_number, \n        bank_account_type, bank_account_origin, street_number_ext, street_number_int, \n        neighborhood, home_phone, birth_state, nationality, job_position, \n        employer_name, employer_phone, employer_address, employer_activity, \n        mortgage_payment, rent_payment, dependent_persons, income_frequency, \n        payment_method, credit_purpose, spouse_paternal_surname, spouse_maternal_surname, \n        reference1_name, reference1_relationship, reference1_address, reference1_phone, \n        reference2_name, reference2_relationship, reference2_address, reference2_phone, \n        last_login,\n        companies(name)\n      ",{count:"exact"});if(e){if(console.log("[getClients] Filter application details:"),console.log(`  - advisor_id filter: ${e.advisor_id||"not set"}`),console.log(`  - company_id filter: ${e.company_id||"not set"}`),console.log(`  - searchQuery filter: ${e.searchQuery||"not set"}`),e.advisor_id&&(console.log(`[getClients] Applying STRICT advisor filter: advisor_id=${e.advisor_id}`),p=p.eq("advisor_id",e.advisor_id)),e.company_id&&(console.log(`[getClients] Applying company filter: company_id=${e.company_id}`),p=p.eq("company_id",e.company_id)),e.dateFrom&&(p=p.gte("created_at",e.dateFrom)),e.dateTo&&(p=p.lte("created_at",e.dateTo)),e.searchQuery){const t=e.searchQuery.trim();console.log(`[getClients] Applying search query filter: "${t}"`);const n=[`first_name.ilike.%${t}%`,`paternal_surname.ilike.%${t}%`,`maternal_surname.ilike.%${t}%`,`email.ilike.%${t}%`,`phone.ilike.%${t}%`].join(",");console.log(`[getClients] Search condition: ${n}`),p=p.or(n)}if(void 0!==e.page&&e.pageSize){const t=e.page*e.pageSize,n=t+e.pageSize-1;console.log(`[getClients] Applying pagination: page ${e.page}, size ${e.pageSize}, range ${t}-${n}`),p=p.range(t,n)}}p=p.order("created_at",{ascending:!1}),console.log("[getClients] Executing final query");const{data:m,error:f,count:g}=await p;if(f)throw console.error("[getClients] Query error:",f),(0,s.vV)(f,"getClients",{filters:e}),(0,s.hS)(f);const v=m?m.map((e=>h(e))):[];return console.log(`[getClients] Query returned ${v.length} clients out of total ${g}`),{clients:v,totalCount:g||0}}catch(c){throw console.error("[getClients] Error in getClients:",c),(0,s.vV)(c,"getClients",{filters:e}),(0,s.hS)(c)}},m=async e=>{try{console.log(`[getClientById] Attempting to fetch client with ID: ${e}`);const t=(0,r.X3)(),{data:n,error:a}=await t.from(u).select("id, email, first_name, paternal_surname, maternal_surname, phone, company_id, created_at, birth_date, rfc, curp, advisor_id, address, city, state, postal_code, gender, marital_status, employment_type, employment_years, monthly_income, additional_income, monthly_expenses, other_loan_balances, bank_name, bank_clabe, bank_account_number, bank_account_type, bank_account_origin, street_number_ext, street_number_int, neighborhood, home_phone, birth_state, nationality, job_position, employer_name, employer_phone, employer_address, employer_activity, mortgage_payment, rent_payment, dependent_persons, income_frequency, payment_method, credit_purpose, spouse_paternal_surname, spouse_maternal_surname, reference1_name, reference1_relationship, reference1_address, reference1_phone, reference2_name, reference2_relationship, reference2_address, reference2_phone, last_login").eq("id",e).limit(1);if(a){console.log(`[getClientById] Error on first attempt: ${a.message}`),(0,s.vV)(a,"getClientById",{clientId:e}),console.log(`Trying fallback approach for client ${e}`);const{data:n,error:r}=await t.from(u).select("*").eq("id",e);if(r)throw console.log(`[getClientById] Fallback attempt also failed: ${r.message}`),(0,s.vV)(r,"getClientById fallback",{clientId:e}),(0,s.hS)(r);if(!n||0===n.length){console.log(`[getClientById] No data found for client ID: ${e}`);const t=(0,s.KR)(s.By.NOT_FOUND,`No se encontr\xf3 cliente con ID: ${e}`);throw(0,s.vV)(t,"getClientById",{clientId:e}),t}return console.log(`[getClientById] Found client via fallback method: ${e}`),h(n[0])}if(!n||Array.isArray(n)&&0===n.length){console.log(`[getClientById] No data returned on first attempt for client ID: ${e}`);const t=(0,s.KR)(s.By.NOT_FOUND,`No se encontr\xf3 cliente con ID: ${e}`);throw(0,s.vV)(t,"getClientById",{clientId:e}),t}const o=Array.isArray(n)?n[0]:n;return console.log(`[getClientById] Successfully found client with ID: ${e}`),h(o)}catch(t){throw console.error(`[getClientById] Unexpected error for client ID ${e}:`,t),(0,s.vV)(t,"getClientById",{clientId:e}),(0,s.hS)(t)}};function f(e){if(null===e||void 0===e)return"NULL";if("boolean"===typeof e)return e?"TRUE":"FALSE";if("number"===typeof e)return e.toString();return String(e).replace(/'/g,"''")}const g=async e=>{try{const t=await m(e).catch((t=>(console.error(`Error obteniendo cliente con ID ${e}:`,t),null))),n=(0,r.X3)();let o=n.from(a.C.APPLICATIONS).select("*").eq("client_id",e).order("created_at",{ascending:!1}),{data:s,error:i}=await o;if(i&&(console.error("[getClientApplications] Error fetching by client_id:",i),s=[]),(!s||0===s.length)&&null!==t&&void 0!==t&&t.name){const e=n.from(a.C.APPLICATIONS).select("*").ilike("client_name",`%${t.name}%`).order("created_at",{ascending:!1}),r=await e;!r.error&&r.data&&(s=r.data)}return s||[]}catch(t){return(0,s.vV)(t,"getClientApplications",{clientId:e}),[]}},v=async(e,t,n)=>{if(!e)throw console.error("Client ID is required for uploading documents"),new Error("El ID del cliente es requerido para subir documentos");if(!t||!Array.isArray(t)||0===t.length)throw console.error("No valid documents provided for upload"),new Error("No se proporcionaron documentos v\xe1lidos para subir");if(!n)throw console.error("User ID is required for uploading documents"),new Error("Se requiere el ID del usuario para subir documentos");try{const a=(0,r.X3)();await o.yH(a);const s=t.map((async t=>{try{if(!t.file||!t.name)throw console.error("Invalid document data",t),new Error("Datos de documento inv\xe1lidos: se requiere archivo y nombre");const r={file:t.file,category:t.category,documentName:t.name,description:t.description,userId:n,client_id:e,authClient:a};return await o.XX(r)}catch(r){if(r.message&&(r.message.includes("permission denied")||r.message.includes("not authorized")||r.message.includes("row level security")))throw console.error("Permission error when uploading document:",r),new Error("No tienes permiso para subir documentos para este cliente. Verifica tus permisos.");throw console.error(`Error uploading document for client ${e}:`,r),r}}));return await Promise.all(s)}catch(a){throw(0,s.vV)(a,"uploadClientDocuments",{clientId:e}),(0,s.hS)(a)}},y=async(e,t,n)=>{try{console.log("Creating client with sanitized data:",JSON.stringify({email:e.email,first_name:e.first_name||"",paternal_surname:e.paternal_surname||"",maternal_surname:e.maternal_surname||"",phone:e.phone,birth_date:e.birth_date&&""!==e.birth_date.trim()?e.birth_date:null,company_id:e.company_id||"70b2aa97-a5b6-4b5e-91db-be8acbd3701a",rfc:e.rfc||"",curp:e.curp||"",advisor_id:e.advisor_id||null}));const l=(0,r.X3)(),c=["first_name","paternal_surname","maternal_surname","email","phone","rfc","curp","birth_date","gender","marital_status","company_id","address","city","state","postal_code","advisor_id","employment_type","employment_years","monthly_income","additional_income","monthly_expenses","other_loan_balances","dependent_persons","bank_name","bank_clabe","bank_account_number","bank_account_type","bank_account_origin","spouse_paternal_surname","spouse_maternal_surname","birth_state","nationality","street_number_ext","street_number_int","neighborhood","home_phone","job_position","employer_name","employer_phone","employer_address","employer_activity","mortgage_payment","rent_payment","income_frequency","payment_method","credit_purpose","reference1_name","reference1_relationship","reference1_address","reference1_phone","reference2_name","reference2_relationship","reference2_address","reference2_phone"],d={};for(const t of c){const n=t;if(void 0!==e[n]){if("birth_date"===t&&""===e[n])continue;if("dependent_persons"===t&&"string"===typeof e[n]){const r=parseInt(e[n],10);isNaN(r)||(d[t]=r)}else d[t]=e[n]}}try{console.log("Inserting client with direct Supabase API");const{data:e,error:r}=await l.from(u).insert(d).select("id").single();if(r)console.error("Error inserting client with direct API:",r);else if(e&&e.id){console.log(`Client created successfully with ID: ${e.id}`);const r={...d,id:e.id,created_at:(new Date).toISOString()};if(t&&t.length>0&&n)try{console.log(`Uploading ${t.length} documents for client ${r.id}`),await v(r.id,t,n)}catch(a){return console.error("Error uploading documents:",a),{...r,warningMessage:`El cliente se cre\xf3 correctamente, pero hubo un problema al subir documentos: ${a instanceof Error?a.message:"Error desconocido"}`}}return r}}catch(o){console.error("Exception during client creation with direct API:",o)}console.log("Using fallback SQL approach for client creation");try{const e=Object.keys(d),r=Object.values(d);e.push("id");const o=r.map(((e,t)=>`$${t+1}`)).join(", "),s=`\n        INSERT INTO users (${e.join(", ")})\n        VALUES (${o}, gen_random_uuid())\n        RETURNING id;\n      `;console.log("Executing parameterized SQL insert");const{data:i,error:c}=await l.rpc("execute_sql",{sql:s,params:r});if(c)throw console.error("Error with parameterized SQL insert:",c),c;if(!i||!i.length||!i[0].id)throw new Error("No se pudo crear el cliente (SQL directo no retorn\xf3 id)");const p=i[0].id;console.log(`Client created with ID ${p} using SQL fallback`);const{data:m,error:f}=await l.from(u).select("*").eq("id",p).single();if(f)throw console.error("Error fetching newly created client:",f),f;const g=h(m);if(t&&t.length>0&&n&&g.id)try{console.log(`Uploading ${t.length} documents for new client ${g.id}`),await v(g.id,t,n)}catch(a){console.error("Error uploading documents during client creation:",a),g.warningMessage="Se cre\xf3 el cliente, pero hubo un problema al subir los documentos. Puede intentar agregarlos nuevamente m\xe1s tarde."}return g}catch(i){throw(0,s.vV)(i,"createClient - SQL fallback"),(0,s.hS)(i)}}catch(l){throw(0,s.vV)(l,"createClient",{clientData:e}),(0,s.hS)(l)}},b=async(e,t,n,a)=>{try{console.log(`Updating client with ID ${e}`),console.log("Update data:",t),console.log("Documents to upload:",(null===n||void 0===n?void 0:n.length)||0);const s=(0,r.X3)();void 0!==t.birth_date&&(""===t.birth_date||"string"===typeof t.birth_date&&""===t.birth_date.trim())&&(console.log("Converting empty birth_date to null"),t.birth_date=null);const d=["dependent_persons","spouse_paternal_surname","spouse_maternal_surname","birth_state","nationality","street_number_ext","street_number_int","neighborhood","home_phone","job_position","employer_name","employer_phone","employer_address","employer_activity","mortgage_payment","rent_payment","income_frequency","payment_method","credit_purpose","reference1_name","reference1_relationship","reference1_address","reference1_phone","reference2_name","reference2_relationship","reference2_address","reference2_phone"].filter((e=>void 0!==t[e]));d.length>0&&(console.log("Updating the following previously problematic fields:",d),d.forEach((e=>{const n=t[e];console.log(`  - ${e}: ${n} (${typeof n})`)}))),"dependent_persons"in t&&console.log(`FOCUS: dependent_persons is ${t.dependent_persons} (type: ${typeof t.dependent_persons})`);let u=!1,h=null;try{const{data:n,error:r}=await s.rpc("update_client",{p_id:e,p_updates:t});r?(console.error("Error updating client with RPC:",r),h=r):n?(u=!0,console.log(`Successfully updated client ${e} via RPC`)):console.warn(`The RPC update for client ${e} had no effect`)}catch(o){console.error("Exception during RPC update:",o),h=o}if(!u&&(h||d.length>0)){console.log("Attempting direct SQL update as fallback");try{const n=[];for(const[e,s]of Object.entries(t)){if(void 0===s)continue;let t;"dependent_persons"===e&&console.log(`Processing ${e}, value: ${s}, type: ${typeof s}`),null===s?t="NULL":"birth_date"!==e||""!==s&&s?"number"===typeof s?(t=s.toString(),"dependent_persons"===e&&console.log(`Numeric field ${e} with value ${s} converted to SQL: ${t}`)):t="boolean"===typeof s?s?"TRUE":"FALSE":`'${f(String(s))}'`:t="NULL",n.push(`${e} = ${t}`)}if(0===n.length)throw console.warn("No valid fields to update"),new Error("No hay campos v\xe1lidos para actualizar");const r=`\n          UPDATE users \n          SET ${n.join(", ")}, \n              updated_at = NOW()\n          WHERE id = '${e}'\n          RETURNING id;\n        `;console.log("Executing direct SQL update");const{data:a,error:o}=await s.rpc("execute_sql",{sql:r});if(o)throw console.error("Error with direct SQL update:",o),new Error(`Error al actualizar cliente (directo): ${o.message}`);u=!0,console.log("Direct SQL update successful")}catch(l){if(console.error("Failed with direct SQL update:",l),h){const e="object"===typeof h&&null!==h?h.message||JSON.stringify(h):String(h);throw new Error(`Error al actualizar cliente: ${e}`)}throw l}}if(!u)throw new Error("La actualizaci\xf3n no tuvo efecto. Es posible que no tenga permisos para actualizar este cliente o que no haya cambios para guardar.");if(n&&n.length>0&&a){console.log(`Processing ${n.length} documents for client ${e}`);try{const r=await i(e,a,n);if(console.log("Document upload result:",r),!r.allSuccessful&&r.warningMessage)return{...t,id:e,warningMessage:r.warningMessage}}catch(c){return console.error("Error uploading documents during client update:",c),{...t,id:e,warningMessage:`Se actualiz\xf3 la informaci\xf3n del cliente, pero hubo un problema al subir los documentos: ${c instanceof Error?c.message:"Error desconocido"}`}}}return{...t,id:e}}catch(o){throw(0,s.vV)(o,"updateClient",{clientId:e}),(0,s.hS)(o)}},x=async e=>{try{const t=(0,r.X3)(),{error:n,count:a}=await t.from(u).delete().eq("id",e);if(n){if((0,s.Dg)(n))throw(0,s.T_)("eliminar","cliente",e,n);throw(0,s.vV)(n,"deleteClient",{clientId:e}),(0,s.hS)(n)}if(0===a)throw console.warn(`Delete operation didn't affect any rows for client ${e}`),(0,s.h5)("delete","cliente",e);return!0}catch(t){throw(0,s.vV)(t,"deleteClient",{clientId:e}),(0,s.hS)(t)}},_=async(e,t)=>{try{let n=(0,r.X3)().from(u).select("id, email, rfc").eq("email",e);t&&(n=n.or(`rfc.eq.${t}`));const{data:a,error:o}=await n;if(o)throw(0,s.vV)(o,"checkClientExists",{email:e,rfc:t}),(0,s.hS)(o);return(null===a||void 0===a?void 0:a.length)>0}catch(n){throw(0,s.vV)(n,"checkClientExists",{email:e,rfc:t}),(0,s.hS)(n)}},w=async e=>{try{let t=(0,r.X3)().from(u).select("*",{count:"exact",head:!0});e&&(e.advisor_id&&(t=t.eq("advisor_id",e.advisor_id)),e.company_id&&(t=t.eq("company_id",e.company_id)),e.dateFrom&&(t=t.gte("created_at",e.dateFrom)),e.dateTo&&(t=t.lte("created_at",e.dateTo)));const{count:n,error:a}=await t;if(a)throw(0,s.vV)(a,"getClientCount",{filters:e}),(0,s.hS)(a);return n||0}catch(t){throw(0,s.vV)(t,"getClientCount",{filters:e}),(0,s.hS)(t)}},N=async e=>{if(!e||""===e.trim())return console.log("[checkClientExistsById] Received empty or null clientId"),!1;console.log(`[checkClientExistsById] Verifying if client with ID ${e} exists in the database...`);try{const{data:t,error:n,count:a}=await r.ND.from("users").select("*",{count:"exact",head:!0}).eq("id",e);if(n)console.error(`[checkClientExistsById] Error checking users table: ${n.message}`,n);else if(a&&a>0)return console.log(`[checkClientExistsById] Client ${e} found in users table`),!0;const{data:o,error:s,count:i}=await r.ND.from("clients").select("*",{count:"exact",head:!0}).eq("id",e);if(s)console.error(`[checkClientExistsById] Error checking clients table: ${s.message}`,s);else if(i&&i>0)return console.log(`[checkClientExistsById] Client ${e} found in clients table`),!0;return console.log(`[checkClientExistsById] Client with ID ${e} not found in any table`),!1}catch(t){return console.error("[checkClientExistsById] Unexpected error:",t),!1}},E=async(e,t)=>{try{console.log(`[createMissingClient] Attempting to create missing client record for ID: ${e}`);if("f04660f4-6aeb-46fb-aff3-6d0241925a4d"===e){console.log(`[createMissingClient] Special handling for known problematic ID: ${e}`);const t=`\n        DO $$\n        BEGIN\n          IF NOT EXISTS (SELECT 1 FROM users WHERE id = '${e}') THEN\n            INSERT INTO users (\n              id, first_name, paternal_surname, maternal_surname, email, phone, \n              company_id, is_sso_user, is_anonymous, created_at\n            ) VALUES (\n              '${e}', \n              'Jorge Alberto', \n              'Garza', \n              'Gonz\xe1lez', \n              'client_${e.substring(0,8)}@example.com', \n              '0000000000', \n              '70b2aa97-a5b6-4b5e-91db-be8acbd3701a',\n              false,\n              false,\n              NOW()\n            );\n          END IF;\n        END $$;\n      `;try{console.log("[createMissingClient] Executing direct SQL insert for problematic ID");const a=(0,r.X3)(),{error:o}=await a.rpc("execute_sql",{query_text:t});if(o)console.error(`[createMissingClient] Error in direct SQL for problematic ID: ${o.message}`);else{console.log("[createMissingClient] Direct SQL for problematic ID executed successfully");try{return await m(e)}catch(n){console.error("[createMissingClient] Still cannot fetch client after direct insertion:",n)}}}catch(a){console.error("[createMissingClient] Exception executing direct SQL:",a)}}if(await N(e))return console.log(`[createMissingClient] Client with ID ${e} already exists, no need to create stub`),m(e).catch((e=>(console.error(`[createMissingClient] Error fetching existing client: ${e}`),null)));let l="Unknown",c="Client",d="";if(t){const e=t.split(" ");e.length>=1&&(l=e[0]),e.length>=2&&(c=e[1]),e.length>=3&&(d=e.slice(2).join(" "))}const u=(0,r.X3)(),p=`\n      INSERT INTO users (\n        id, first_name, paternal_surname, maternal_surname, email, phone, \n        company_id, is_sso_user, is_anonymous, created_at\n      ) VALUES (\n        '${e}', \n        '${l.replace(/'/g,"''")}', \n        '${c.replace(/'/g,"''")}', \n        '${d.replace(/'/g,"''")}', \n        'client_${e.substring(0,8)}@example.com', \n        '0000000000', \n        '70b2aa97-a5b6-4b5e-91db-be8acbd3701a',\n        false,\n        false,\n        NOW()\n      ) ON CONFLICT (id) DO NOTHING\n      RETURNING id, first_name, paternal_surname, maternal_surname, email, phone;\n    `;console.log(`[createMissingClient] Executing insert query for missing client: ${e}`);try{const{data:t,error:n}=await u.rpc("execute_sql",{query_text:p});if(n)console.error(`[createMissingClient] Error creating client via SQL: ${n.message}`,n);else{if(t&&t.length>0)return console.log(`[createMissingClient] Successfully created stub client with ID: ${e} via SQL`),m(e).catch((e=>(console.error(`[createMissingClient] Error fetching newly created client: ${e}`),null)));console.log("[createMissingClient] SQL query executed but no rows returned, trying fallback method")}}catch(o){console.error(`[createMissingClient] Exception executing SQL: ${o}`)}console.log(`[createMissingClient] Trying fallback insert method for client: ${e}`);try{const{data:t,error:n}=await u.from("users").insert([{id:e,first_name:l,paternal_surname:c,maternal_surname:d,email:`client_${e.substring(0,8)}@example.com`,phone:"0000000000",company_id:"70b2aa97-a5b6-4b5e-91db-be8acbd3701a",is_sso_user:!1,is_anonymous:!1,created_at:(new Date).toISOString()}]).select("*");if(n)return console.error(`[createMissingClient] Error in fallback insert: ${n.message}`,n),null;if(t&&t.length>0)return console.log(`[createMissingClient] Successfully created client via fallback insert: ${t[0].id}`),h(t[0])}catch(s){console.error(`[createMissingClient] Exception in fallback insert: ${s}`)}try{return console.log(`[createMissingClient] Trying one last forced getClientById call for: ${e}`),await m(e)}catch(i){return console.error(`[createMissingClient] Final attempt failed: ${i}`),null}}catch(l){return console.error(`[createMissingClient] Error in createMissingClient: ${l}`),null}},S=async e=>{if(!e)return console.log("[getClientFromAnySource] No client ID provided"),null;console.log(`[getClientFromAnySource] Attempting to fetch client ${e} from any source`);try{try{console.log(`[getClientFromAnySource] Checking users_full_profiles view for client ${e}`);const{data:t,error:n}=await r.ND.from("users_full_profiles").select("*").eq("id",e).maybeSingle();if(n)console.log(`[getClientFromAnySource] Error or view not found: ${n.message}`);else if(t)return console.log("[getClientFromAnySource] Client found in users_full_profiles view"),h(t)}catch(t){console.log(`[getClientFromAnySource] Exception checking users_full_profiles: ${t}`)}try{console.log(`[getClientFromAnySource] Checking users table for client ${e}`);const{data:t,error:n}=await r.ND.from("users").select("*").eq("id",e).maybeSingle();if(n)console.log(`[getClientFromAnySource] Error checking users table: ${n.message}`);else if(t)return console.log("[getClientFromAnySource] Client found in users table"),h(t)}catch(n){console.log(`[getClientFromAnySource] Exception checking users table: ${n}`)}try{console.log(`[getClientFromAnySource] Checking clients table for client ${e}`);const{data:t,error:n}=await r.ND.from("clients").select("*").eq("id",e).maybeSingle();if(n)console.log(`[getClientFromAnySource] Error checking clients table: ${n.message}`);else if(t)return console.log("[getClientFromAnySource] Client found in clients table"),h(t)}catch(a){console.log(`[getClientFromAnySource] Exception checking clients table: ${a}`)}return console.log(`[getClientFromAnySource] Client ${e} not found in any source`),null}catch(o){return console.error(`[getClientFromAnySource] Error: ${o}`),null}},j=async e=>{if(!e)return null;console.log(`[getCanonicalClientId] Checking for canonical ID mapping for: ${e}`);try{const{data:t,error:n}=await r.ND.from("client_id_mappings").select("canonical_id").eq("client_id",e).maybeSingle();return n?(console.log(`[getCanonicalClientId] Error or table doesn't exist: ${n.message}`),e):null!==t&&void 0!==t&&t.canonical_id?(console.log(`[getCanonicalClientId] Found canonical mapping: ${e} -> ${t.canonical_id}`),t.canonical_id):e}catch(t){return console.error(`[getCanonicalClientId] Error: ${t}`),e}},k=async e=>{if(!e)return null;try{const t=await j(e)||e;let n=await S(t);return n||await E(t)}catch(t){return console.error(`[getClientWithSync] Error: ${t}`),null}}},374:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(286));class o extends a.default{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:a=r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=a?`${a}.order`:"order",s=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${void 0===n?"":n?".nullsfirst":".nullslast"}`),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="undefined"===typeof n?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t){let{foreignTable:n,referencedTable:r=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a="undefined"===typeof r?"offset":`${r}.offset`,o="undefined"===typeof r?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(o,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:a=!1,format:o="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var s;const i=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(s=this.headers.Accept)&&void 0!==s?s:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${l}"; options=${i};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=o},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},509:(e,t,n)=>{n.d(t,{ND:()=>r.ND,X3:()=>r.X3});var r=n(296)},579:(e,t,n)=>{e.exports=n(153)},599:(e,t,n)=>{n.d(t,{$n:()=>c,LD:()=>i,dg:()=>l,og:()=>u});var r=n(509),a=n(129);let o=!1,s=!1;const i=async e=>{try{try{const t="https://ydnygntfkrleiseuciwq.supabase.co",n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ydnygntfkrleiseuciwq.supabase.co",REACT_APP_SUPABASE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczOTk5MjQwNiwiZXhwIjoyMDU1NTY4NDA2fQ.TwhEGW9DK4DTQQRquT6Z9UW8T8UjLX-hp9uKdRjWAhs"}.REACT_APP_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk5OTI0MDYsImV4cCI6MjA1NTU2ODQwNn0.B-dH2Kptzz1oyM4ynno_GjlvjpxL-HbNKC_st4bgf0A";if((await fetch(`${t}/rest/v1/${e}?limit=0`,{method:"HEAD",headers:{apikey:n,Authorization:`Bearer ${n}`,Accept:"application/json"}})).ok)return console.log(`\u2705 Tabla ${e} existe (verificado via REST API)`),!0}catch(t){console.warn(`Error verificando tabla ${e} via REST:`,t)}try{const{error:t}=await r.ND.from(e).select("count",{count:"exact",head:!0});if(!t)return console.log(`\u2705 Tabla ${e} existe (verificado via count query)`),!0}catch(n){console.warn(`Error verificando tabla ${e} via count:`,n)}try{const{data:t,error:n}=await r.ND.rpc("check_table_exists",{_table_name:e});if(!n&&t)return console.log(`\u2705 Tabla ${e} existe (verificado via RPC)`),!0}catch(a){console.warn(`Error verificando tabla ${e} via RPC:`,a)}return"documents"===e?(console.log(`\u26a0\ufe0f Asumiendo que la tabla ${e} existe basado en verificaci\xf3n manual previa`),!0):(console.warn(`\u274c Tabla ${e} no existe o no se pudo verificar`),!1)}catch(o){return console.error(`Error general verificando si la tabla ${e} existe:`,o),"documents"===e&&(console.log(`\u26a0\ufe0f Error al verificar tabla ${e}, pero asumiendo que existe`),!0)}},l=async(e,t)=>{try{try{const{data:n,error:a}=await r.ND.rpc("check_column_exists",{_table_name:e,_column_name:t});if(a)throw a;return!!n}catch(n){console.warn("No se pudo usar RPC para verificar columna, usando m\xe9todo alternativo:",n);const{error:a}=await r.ND.from(e).select("id").limit(1).order(t,{ascending:!0});return!a||!a.message||!a.message.toLowerCase().includes(`column "${t}" does not exist`)&&!a.message.toLowerCase().includes(`column ${t} does not exist`)}}catch(a){return console.error(`Error verificando si la columna ${t} existe en la tabla ${e}:`,a),!1}},c=async(e,t)=>{try{if(await i(e))return console.log(`Tabla ${e} ya existe.`),!0;const n=`\n      CREATE TABLE IF NOT EXISTS public.${e} (\n        ${t}\n      );\n    `,r=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})}),a=await r.json();return a.error?(console.error(`Error creando tabla ${e}:`,a.error),!1):(console.log(`Tabla ${e} creada con \xe9xito.`),!0)}catch(n){return console.error(`Error en ensureTableExists para ${e}:`,n),!1}},d=async()=>{if(!o){console.info("Verificando estructura de la base de datos...");try{const e=await(async()=>{const e=Object.values(a.C),t=[];for(const r of e)try{const e=await i(r);t.push({name:r,exists:e})}catch(n){console.warn(`Error checking table ${r}:`,n),t.push({name:r,exists:!0})}return t})();console.group("Estado de tablas:"),e.forEach((e=>{e.exists?console.info(`\u2705 Tabla ${e.name}: OK`):console.warn(`\u274c Tabla ${e.name}: No existe o no se pudo verificar`)})),console.groupEnd();const t=e.filter((e=>!e.exists));t.length>0?console.warn(`Se encontraron ${t.length} tablas faltantes. La aplicaci\xf3n podr\xeda no funcionar correctamente.`):(console.info("Todas las tablas necesarias existen en la base de datos o se asumen existentes."),s=!0)}catch(e){console.error("Error general verificando estructura de base de datos:",e)}finally{o=!0}}},u=()=>{setTimeout((()=>{d().then((()=>console.log("Database structure check completed"))).catch((e=>{console.error("Error verificando estructura de base de datos:",e)}))}),3e3)}},611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=n},630:(e,t,n)=>{n.r(t),n.d(t,{Headers:()=>s,Request:()=>i,Response:()=>l,default:()=>o,fetch:()=>a});var r=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("unable to locate global object")}();const a=r.fetch,o=r.fetch.bind(r),s=r.Headers,i=r.Request,l=r.Response},703:(e,t,n)=>{n.d(t,{By:()=>r,Dg:()=>d,KI:()=>a,KR:()=>o,T_:()=>u,h5:()=>h,hS:()=>l,vV:()=>c});n(768);let r=function(e){return e.VALIDATION="VALIDATION",e.AUTHENTICATION="AUTHENTICATION",e.AUTHORIZATION="AUTHORIZATION",e.SERVER="SERVER",e.NETWORK="NETWORK",e.UPLOAD="UPLOAD",e.NOT_FOUND="NOT_FOUND",e.DATABASE="DATABASE",e.UNKNOWN="UNKNOWN",e}({});const a=(e,t)=>{let n={message:"Error desconocido",context:t};return e instanceof Error?n.message=e.message:"object"===typeof e&&null!==e&&(e.message&&(n.message=e.message),e.code&&(n.code=e.code,"23505"===e.code?n.message="Ya existe un registro con estos datos.":"42P01"===e.code&&(n.message="La tabla no existe en la base de datos.")),e.details&&(n.details=e.details)),n},o=(e,t,n,r)=>({type:e,message:t,details:n,originalError:r}),s=e=>e instanceof Error&&(e.message.includes("network")||e.message.includes("offline")||e.message.includes("failed to fetch")||e.message.includes("NetworkError")),i=e=>e instanceof Error&&(e.message.includes("500")||e.message.includes("server error")),l=e=>{if(e instanceof Error){if(e.message.includes("401")||e.message.includes("authentication"))return o(r.AUTHENTICATION,"Authentication failed. Please log in again.",{},e);if(e.message.includes("403")||e.message.includes("permission"))return o(r.AUTHORIZATION,"You do not have permission to perform this action.",{},e);if(e.message.includes("404")||e.message.includes("not found"))return o(r.NOT_FOUND,"The requested resource was not found.",{},e);if(s(e))return o(r.NETWORK,"A network error occurred. Please check your connection and try again.",{},e);if(i(e))return o(r.SERVER,"A server error occurred. Please try again later.",{},e)}return o(r.UNKNOWN,"An unexpected error occurred.",{},e)},c=(e,t,n)=>{if(console.error(`Error in ${t}:`,e),n&&console.error("Additional info:",n),e&&"object"===typeof e&&"type"in e){const t=e;console.error("Error type:",t.type),console.error("Error message:",t.message),t.details&&console.error("Error details:",t.details),t.originalError&&console.error("Original error:",t.originalError)}},d=e=>!(!e||!e.message)&&(e.message.includes("violates row-level security policy")||e.message.includes("permission denied")||e.message.includes("Unauthorized")||e.message.includes("403")),u=(e,t,n,a)=>{const s=o(r.AUTHORIZATION,`No tienes permisos para ${e} este ${t}. Esto puede deberse a pol\xedticas de seguridad RLS en Supabase.`,{originalError:(null===a||void 0===a?void 0:a.message)||"Unknown error"});return c(s,`${e}${t}.RLS_VIOLATION`,{[`${t}Id`]:n}),s},h=(e,t,n)=>{const a="update"===e?"actualizaci\xf3n":"delete"===e?"eliminaci\xf3n":e,s=o(r.DATABASE,`La ${a} no tuvo efecto en la base de datos. Esto puede deberse a permisos insuficientes.`,{[`${t}Id`]:n});return c(s,`${e}${t}.NO_EFFECT`,{[`${t}Id`]:n}),s}},730:(e,t,n)=>{var r=n(43),a=n(853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(i[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,r,a,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),k=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var I=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var O,L=Object.assign;function $(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var F=!1;function z(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),o=r.stack.split("\n"),s=a.length-1,i=o.length-1;1<=s&&0<=i&&a[s]!==o[i];)i--;for(;1<=s&&0<=i;s--,i--)if(a[s]!==o[i]){if(1!==s||1!==i)do{if(s--,0>--i||a[s]!==o[i]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=i);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?$(e):""}function B(e){switch(e.tag){case 5:return $(e.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case w:return"Portal";case S:return"Profiler";case E:return"StrictMode";case D:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case j:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function G(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){G(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function oe(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ne=null,Ee=null;function Se(e){if(e=ba(e)){if("function"!==typeof we)throw Error(o(280));var t=e.stateNode;t&&(t=_a(t),we(e.stateNode,e.type,t))}}function je(e){Ne?Ee?Ee.push(e):Ee=[e]:Ne=e}function ke(){if(Ne){var e=Ne,t=Ee;if(Ee=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ce(e,t){return e(t)}function De(){}var Te=!1;function Ae(e,t,n){if(Te)return e(t,n);Te=!0;try{return Ce(e,t,n)}finally{Te=!1,(null!==Ne||null!==Ee)&&(De(),ke())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=_a(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Ie=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Ie=!1}function Me(e,t,n,r,a,o,s,i,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Oe=!1,Le=null,$e=!1,Fe=null,ze={onError:function(e){Oe=!0,Le=e}};function Be(e,t,n,r,a,o,s,i,l){Oe=!1,Le=null,Me.apply(ze,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Ue(e)!==e)throw Error(o(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return Ve(a),e;if(s===r)return Ve(a),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=a,r=s;else{for(var i=!1,l=a.child;l;){if(l===n){i=!0,n=a,r=s;break}if(l===r){i=!0,r=a,n=s;break}l=l.sibling}if(!i){for(l=s.child;l;){if(l===n){i=!0,n=s,r=a;break}if(l===r){i=!0,r=s,n=a;break}l=l.sibling}if(!i)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ye=a.unstable_scheduleCallback,Je=a.unstable_cancelCallback,Qe=a.unstable_shouldYield,Ke=a.unstable_requestPaint,Ge=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/lt|0)|0},it=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var i=s&~a;0!==i?r=ut(i):0!==(o&=s)&&(r=ut(o))}else 0!==(s=n&~a)?r=ut(s):0!==o&&(r=ut(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(o=t&-t)||16===a&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,wt,Nt,Et,St,jt=!1,kt=[],Ct=null,Dt=null,Tt=null,At=new Map,Pt=new Map,It=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Dt=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Ot(e,t,n,r,a,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ya(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void St(e.priority,(function(){Nt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function $t(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Ft(e,t,n){$t(e)&&n.delete(t)}function zt(){jt=!1,null!==Ct&&$t(Ct)&&(Ct=null),null!==Dt&&$t(Dt)&&(Dt=null),null!==Tt&&$t(Tt)&&(Tt=null),At.forEach(Ft),Pt.forEach(Ft)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,jt||(jt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function Ut(e){function t(t){return Bt(t,e)}if(0<kt.length){Bt(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Bt(Ct,e),null!==Dt&&Bt(Dt,e),null!==Tt&&Bt(Tt,e),At.forEach(t),Pt.forEach(t),n=0;n<It.length;n++)(r=It[n]).blockedOn===e&&(r.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Lt(n),null===n.blockedOn&&It.shift()}var Wt=x.ReactCurrentBatchConfig,Vt=!0;function Ht(e,t,n,r){var a=bt,o=Wt.transition;Wt.transition=null;try{bt=1,Yt(e,t,n,r)}finally{bt=a,Wt.transition=o}}function qt(e,t,n,r){var a=bt,o=Wt.transition;Wt.transition=null;try{bt=4,Yt(e,t,n,r)}finally{bt=a,Wt.transition=o}}function Yt(e,t,n,r){if(Vt){var a=Qt(e,t,n,r);if(null===a)Vr(e,t,r,Jt,n),Mt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Ct=Ot(Ct,e,t,n,r,a),!0;case"dragenter":return Dt=Ot(Dt,e,t,n,r,a),!0;case"mouseover":return Tt=Ot(Tt,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return At.set(o,Ot(At.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,Pt.set(o,Ot(Pt.get(o)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==a;){var o=ba(a);if(null!==o&&_t(o),null===(o=Qt(e,t,n,r))&&Vr(e,t,r,Jt,n),o===a)break;a=o}null!==a&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Jt=null;function Qt(e,t,n,r){if(Jt=null,null!==(e=ya(e=_e(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Gt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,a="value"in Gt?Gt.value:Gt.textContent,o=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[o-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),un=L({},cn,{view:0,detail:0}),hn=an(un),pn=L({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),mn=an(pn),fn=an(L({},pn,{dataTransfer:0})),gn=an(L({},un,{relatedTarget:0})),vn=an(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(L({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Sn(){return En}var jn=L({},un,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=an(jn),Cn=an(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Dn=an(L({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Tn=an(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(An),In=[9,13,27,32],Rn=d&&"CompositionEvent"in window,Mn=null;d&&"documentMode"in document&&(Mn=document.documentMode);var On=d&&"TextEvent"in window&&!Mn,Ln=d&&(!Rn||Mn&&8<Mn&&11>=Mn),$n=String.fromCharCode(32),Fn=!1;function zn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Hn(e,t,n,r){je(r),0<(t=qr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Yn=null;function Jn(e){$r(e,0)}function Qn(e){if(Y(xa(e)))return e}function Kn(e,t){if("change"===e)return t}var Gn=!1;if(d){var Xn;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Gn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Yn=qn=null)}function nr(e){if("value"===e.propertyName&&Qn(Yn)){var t=[];Hn(t,Yn,e,_e(e)),Ae(Jn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Yn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Yn)}function or(e,t){if("click"===e)return Qn(t)}function sr(e,t){if("input"===e||"change"===e)return Qn(t)}var ir="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ir(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!u.call(t,a)||!ir(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,o=Math.min(r.start,a);r=void 0===r.end?o:Math.min(r.end,a),!e.extend&&o>r&&(a=r,r=o,o=a),a=dr(n,o);var s=dr(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=d&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==J(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=qr(vr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Nr={},Er={};function Sr(e){if(Nr[e])return Nr[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Nr[e]=n[t];return e}d&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var jr=Sr("animationend"),kr=Sr("animationiteration"),Cr=Sr("animationstart"),Dr=Sr("transitionend"),Tr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Tr.set(e,t),l(t,[e])}for(var Ir=0;Ir<Ar.length;Ir++){var Rr=Ar[Ir];Pr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Pr(jr,"onAnimationEnd"),Pr(kr,"onAnimationIteration"),Pr(Cr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Dr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,i,l,c){if(Be.apply(this,arguments),Oe){if(!Oe)throw Error(o(198));var d=Le;Oe=!1,Le=null,$e||($e=!0,Fe=d)}}(r,t,void 0,e),e.currentTarget=null}function $r(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var i=r[s],l=i.instance,c=i.currentTarget;if(i=i.listener,l!==o&&a.isPropagationStopped())break e;Lr(a,i,c),o=l}else for(s=0;s<r.length;s++){if(l=(i=r[s]).instance,c=i.currentTarget,i=i.listener,l!==o&&a.isPropagationStopped())break e;Lr(a,i,c),o=l}}}if($e)throw e=Fe,$e=!1,Fe=null,e}function Fr(e,t){var n=t[fa];void 0===n&&(n=t[fa]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Br]){e[Br]=!0,s.forEach((function(t){"selectionchange"!==t&&(Or.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,zr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Kt(t)){case 1:var a=Ht;break;case 4:a=qt;break;default:a=Yt}n=a.bind(null,t,n,e),a=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,a){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var i=r.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==i;){if(null===(s=ya(i)))return;if(5===(l=s.tag)||6===l){r=o=s;continue e}i=i.parentNode}}r=r.return}Ae((function(){var r=o,a=_e(n),s=[];e:{var i=Tr.get(e);if(void 0!==i){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=kn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Dn;break;case jr:case kr:case Cr:l=vn;break;case Dr:l=Tn;break;case"scroll":l=hn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==i?i+"Capture":null:i;d=[];for(var p,m=r;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Pe(m,h))&&d.push(Hr(m,f,p)))),u)break;m=m.return}0<d.length&&(i=new l(i,c,null,n,a),s.push({event:i,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[ma])&&(l||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(u=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=Cn,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?i:xa(l),p=null==c?i:xa(c),(i=new d(f,m+"leave",l,n,a)).target=u,i.relatedTarget=p,f=null,ya(a)===r&&((d=new d(h,m+"enter",c,n,a)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=Yr(p))m++;for(p=0,f=h;f;f=Yr(f))p++;for(;0<m-p;)d=Yr(d),m--;for(;0<p-m;)h=Yr(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Yr(d),h=Yr(h)}d=null}else d=null;null!==l&&Jr(s,i,l,d,!1),null!==c&&null!==u&&Jr(s,u,c,d,!0)}if("select"===(l=(i=r?xa(r):window).nodeName&&i.nodeName.toLowerCase())||"input"===l&&"file"===i.type)var g=Kn;else if(Vn(i))if(Gn)g=sr;else{g=ar;var v=rr}else(l=i.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(g=or);switch(g&&(g=g(e,r))?Hn(s,g,n,a):(v&&v(e,i,r),"focusout"===e&&(v=i._wrapperState)&&v.controlled&&"number"===i.type&&ee(i,"number",i.value)),v=r?xa(r):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(s,n,a);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":xr(s,n,a)}var y;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=en()):(Xt="value"in(Gt=a)?Gt.value:Gt.textContent,Un=!0)),0<(v=qr(r,b)).length&&(b=new xn(b,e,null,n,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=On?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Fn=!0,$n);case"textInput":return(e=t.data)===$n&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Rn&&zn(e,t)?(e=en(),Zt=Xt=Gt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=y))}$r(s,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,o=a.stateNode;5===a.tag&&null!==o&&(a=o,null!=(o=Pe(e,n))&&r.unshift(Hr(e,o,a)),null!=(o=Pe(e,t))&&r.push(Hr(e,o,a))),e=e.return}return r}function Yr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jr(e,t,n,r,a){for(var o=t._reactName,s=[];null!==n&&n!==r;){var i=n,l=i.alternate,c=i.stateNode;if(null!==l&&l===r)break;5===i.tag&&null!==c&&(i=c,a?null!=(l=Pe(n,o))&&s.unshift(Hr(n,l,i)):a||null!=(l=Pe(n,o))&&s.push(Hr(n,l,i))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qr=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function Gr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Kr,"")}function Xr(e,t,n){if(t=Gr(t),Gr(e)!==t&&n)throw Error(o(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,oa="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oa?function(e){return oa.resolve(null).then(e).catch(ia)}:ra;function ia(e){setTimeout((function(){throw e}))}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ut(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,pa="__reactProps$"+ua,ma="__reactContainer$"+ua,fa="__reactEvents$"+ua,ga="__reactListeners$"+ua,va="__reactHandles$"+ua;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ma]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=da(e);null!==e;){if(n=e[ha])return n;e=da(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[ma])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function _a(e){return e[pa]||null}var wa=[],Na=-1;function Ea(e){return{current:e}}function Sa(e){0>Na||(e.current=wa[Na],wa[Na]=null,Na--)}function ja(e,t){Na++,wa[Na]=e.current,e.current=t}var ka={},Ca=Ea(ka),Da=Ea(!1),Ta=ka;function Aa(e,t){var n=e.type.contextTypes;if(!n)return ka;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,o={};for(a in n)o[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Pa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ia(){Sa(Da),Sa(Ca)}function Ra(e,t,n){if(Ca.current!==ka)throw Error(o(168));ja(Ca,t),ja(Da,n)}function Ma(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(o(108,W(e)||"Unknown",a));return L({},n,r)}function Oa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ka,Ta=Ca.current,ja(Ca,e),ja(Da,Da.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Ma(e,t,Ta),r.__reactInternalMemoizedMergedChildContext=e,Sa(Da),Sa(Ca),ja(Ca,e)):Sa(Da),ja(Da,n)}var $a=null,Fa=!1,za=!1;function Ba(e){null===$a?$a=[e]:$a.push(e)}function Ua(){if(!za&&null!==$a){za=!0;var e=0,t=bt;try{var n=$a;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}$a=null,Fa=!1}catch(a){throw null!==$a&&($a=$a.slice(e+1)),Ye(Ze,Ua),a}finally{bt=t,za=!1}}return null}var Wa=[],Va=0,Ha=null,qa=0,Ya=[],Ja=0,Qa=null,Ka=1,Ga="";function Xa(e,t){Wa[Va++]=qa,Wa[Va++]=Ha,Ha=e,qa=t}function Za(e,t,n){Ya[Ja++]=Ka,Ya[Ja++]=Ga,Ya[Ja++]=Qa,Qa=e;var r=Ka;e=Ga;var a=32-st(r)-1;r&=~(1<<a),n+=1;var o=32-st(t)+a;if(30<o){var s=a-a%5;o=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Ka=1<<32-st(t)+a|n<<a|r,Ga=o+e}else Ka=1<<o|n<<a|r,Ga=e}function eo(e){null!==e.return&&(Xa(e,1),Za(e,1,0))}function to(e){for(;e===Ha;)Ha=Wa[--Va],Wa[Va]=null,qa=Wa[--Va],Wa[Va]=null;for(;e===Qa;)Qa=Ya[--Ja],Ya[Ja]=null,Ga=Ya[--Ja],Ya[Ja]=null,Ka=Ya[--Ja],Ya[Ja]=null}var no=null,ro=null,ao=!1,oo=null;function so(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function io(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qa?{id:Ka,overflow:Ga}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(ao){var t=ro;if(t){var n=t;if(!io(e,t)){if(lo(e))throw Error(o(418));t=ca(n.nextSibling);var r=no;t&&io(e,t)?so(r,n):(e.flags=-4097&e.flags|2,ao=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,ao=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!ao)return uo(e),ao=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw po(),Error(o(418));for(;t;)so(e,t),t=ca(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ca(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=ca(e.nextSibling)}function mo(){ro=no=null,ao=!1}function fo(e){null===oo?oo=[e]:oo.push(e)}var go=x.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function xo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=$c(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===N?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&bo(o)===t.type)?((r=a(t,n.props)).ref=vo(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=vo(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,r,o){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,o)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=$c(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case w:return(t=Fc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Oc(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===a?c(e,t,n,r):null;case w:return n.key===a?d(e,t,n,r):null;case P:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||M(n))return null!==a?null:u(e,t,n,r,null);yo(e,n)}return null}function m(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case P:return m(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||M(r))return u(t,e=e.get(n)||null,r,a,null);yo(t,r)}return null}function f(a,o,i,l){for(var c=null,d=null,u=o,f=o=0,g=null;null!==u&&f<i.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var v=p(a,u,i[f],l);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(a,u),o=s(v,o,f),null===d?c=v:d.sibling=v,d=v,u=g}if(f===i.length)return n(a,u),ao&&Xa(a,f),c;if(null===u){for(;f<i.length;f++)null!==(u=h(a,i[f],l))&&(o=s(u,o,f),null===d?c=u:d.sibling=u,d=u);return ao&&Xa(a,f),c}for(u=r(a,u);f<i.length;f++)null!==(g=m(u,a,f,i[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),o=s(g,o,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach((function(e){return t(a,e)})),ao&&Xa(a,f),c}function g(a,i,l,c){var d=M(l);if("function"!==typeof d)throw Error(o(150));if(null==(l=d.call(l)))throw Error(o(151));for(var u=d=null,f=i,g=i=0,v=null,y=l.next();null!==f&&!y.done;g++,y=l.next()){f.index>g?(v=f,f=null):v=f.sibling;var b=p(a,f,y.value,c);if(null===b){null===f&&(f=v);break}e&&f&&null===b.alternate&&t(a,f),i=s(b,i,g),null===u?d=b:u.sibling=b,u=b,f=v}if(y.done)return n(a,f),ao&&Xa(a,g),d;if(null===f){for(;!y.done;g++,y=l.next())null!==(y=h(a,y.value,c))&&(i=s(y,i,g),null===u?d=y:u.sibling=y,u=y);return ao&&Xa(a,g),d}for(f=r(a,f);!y.done;g++,y=l.next())null!==(y=m(f,a,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),i=s(y,i,g),null===u?d=y:u.sibling=y,u=y);return e&&f.forEach((function(e){return t(a,e)})),ao&&Xa(a,g),d}return function e(r,o,s,l){if("object"===typeof s&&null!==s&&s.type===N&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case _:e:{for(var c=s.key,d=o;null!==d;){if(d.key===c){if((c=s.type)===N){if(7===d.tag){n(r,d.sibling),(o=a(d,s.props.children)).return=r,r=o;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&bo(c)===d.type){n(r,d.sibling),(o=a(d,s.props)).ref=vo(r,d,s),o.return=r,r=o;break e}n(r,d);break}t(r,d),d=d.sibling}s.type===N?((o=Oc(s.props.children,r.mode,l,s.key)).return=r,r=o):((l=Mc(s.type,s.key,s.props,null,r.mode,l)).ref=vo(r,o,s),l.return=r,r=l)}return i(r);case w:e:{for(d=s.key;null!==o;){if(o.key===d){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(r,o.sibling),(o=a(o,s.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Fc(s,r.mode,l)).return=r,r=o}return i(r);case P:return e(r,o,(d=s._init)(s._payload),l)}if(te(s))return f(r,o,s,l);if(M(s))return g(r,o,s,l);yo(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(r,o.sibling),(o=a(o,s)).return=r,r=o):(n(r,o),(o=$c(s,r.mode,l)).return=r,r=o),i(r)):n(r,o)}}var _o=xo(!0),wo=xo(!1),No=Ea(null),Eo=null,So=null,jo=null;function ko(){jo=So=Eo=null}function Co(e){var t=No.current;Sa(No),e._currentValue=t}function Do(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function To(e,t){Eo=e,jo=So=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bi=!0),e.firstContext=null)}function Ao(e){var t=e._currentValue;if(jo!==e)if(e={context:e,memoizedValue:t,next:null},null===So){if(null===Eo)throw Error(o(308));So=e,Eo.dependencies={lanes:0,firstContext:e}}else So=So.next=e;return t}var Po=null;function Io(e){null===Po?Po=[e]:Po.push(e)}function Ro(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Io(t)):(n.next=a.next,a.next=n),t.interleaved=n,Mo(e,r)}function Mo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Oo=!1;function Lo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $o(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Mo(e,n)}return null===(a=r.interleaved)?(t.next=t,Io(r)):(t.next=a.next,a.next=t),r.interleaved=t,Mo(e,n)}function Bo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Uo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?a=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wo(e,t,n,r){var a=e.updateQueue;Oo=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var l=i,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var d=e.alternate;null!==d&&((i=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===i?d.firstBaseUpdate=c:i.next=c,d.lastBaseUpdate=l))}if(null!==o){var u=a.baseState;for(s=0,d=c=l=null,i=o;;){var h=i.lane,p=i.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var m=e,f=i;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=L({},u,h);break e;case 2:Oo=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[i]:h.push(i))}else p={eventTime:p,lane:h,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,s|=h;if(null===(i=i.next)){if(null===(i=a.shared.pending))break;i=(h=i).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===o&&(a.shared.lanes=0);Ol|=s,e.lanes=s,e.memoizedState=u}}function Vo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(o(191,a));a.call(r)}}}var Ho={},qo=Ea(Ho),Yo=Ea(Ho),Jo=Ea(Ho);function Qo(e){if(e===Ho)throw Error(o(174));return e}function Ko(e,t){switch(ja(Jo,t),ja(Yo,e),ja(qo,Ho),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sa(qo),ja(qo,t)}function Go(){Sa(qo),Sa(Yo),Sa(Jo)}function Xo(e){Qo(Jo.current);var t=Qo(qo.current),n=le(t,e.type);t!==n&&(ja(Yo,e),ja(qo,n))}function Zo(e){Yo.current===e&&(Sa(qo),Sa(Yo))}var es=Ea(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function rs(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var as=x.ReactCurrentDispatcher,os=x.ReactCurrentBatchConfig,ss=0,is=null,ls=null,cs=null,ds=!1,us=!1,hs=0,ps=0;function ms(){throw Error(o(321))}function fs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ir(e[n],t[n]))return!1;return!0}function gs(e,t,n,r,a,s){if(ss=s,is=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,as.current=null===e||null===e.memoizedState?Zs:ei,e=n(r,a),us){s=0;do{if(us=!1,hs=0,25<=s)throw Error(o(301));s+=1,cs=ls=null,t.updateQueue=null,as.current=ti,e=n(r,a)}while(us)}if(as.current=Xs,t=null!==ls&&null!==ls.next,ss=0,cs=ls=is=null,ds=!1,t)throw Error(o(300));return e}function vs(){var e=0!==hs;return hs=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?is.memoizedState=cs=e:cs=cs.next=e,cs}function bs(){if(null===ls){var e=is.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===cs?is.memoizedState:cs.next;if(null!==t)cs=t,ls=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?is.memoizedState=cs=e:cs=cs.next=e}return cs}function xs(e,t){return"function"===typeof t?t(e):t}function _s(e){var t=bs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=ls,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var i=a.next;a.next=s.next,s.next=i}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var l=i=null,c=null,d=s;do{var u=d.lane;if((ss&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,i=r):c=c.next=h,is.lanes|=u,Ol|=u}d=d.next}while(null!==d&&d!==s);null===c?i=r:c.next=l,ir(r,t.memoizedState)||(bi=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,is.lanes|=s,Ol|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ws(e){var t=bs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var i=a=a.next;do{s=e(s,i.action),i=i.next}while(i!==a);ir(s,t.memoizedState)||(bi=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ns(){}function Es(e,t){var n=is,r=bs(),a=t(),s=!ir(r.memoizedState,a);if(s&&(r.memoizedState=a,bi=!0),r=r.queue,Os(ks.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,As(9,js.bind(null,n,r,a,t),void 0,null),null===Dl)throw Error(o(349));0!==(30&ss)||Ss(n,t,a)}return a}function Ss(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=is.updateQueue)?(t={lastEffect:null,stores:null},is.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function js(e,t,n,r){t.value=n,t.getSnapshot=r,Cs(t)&&Ds(e)}function ks(e,t,n){return n((function(){Cs(t)&&Ds(e)}))}function Cs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ir(e,n)}catch(r){return!0}}function Ds(e){var t=Mo(e,1);null!==t&&rc(t,e,1,-1)}function Ts(e){var t=ys();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:e},t.queue=e,e=e.dispatch=Js.bind(null,is,e),[t.memoizedState,e]}function As(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=is.updateQueue)?(t={lastEffect:null,stores:null},is.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ps(){return bs().memoizedState}function Is(e,t,n,r){var a=ys();is.flags|=e,a.memoizedState=As(1|t,n,void 0,void 0===r?null:r)}function Rs(e,t,n,r){var a=bs();r=void 0===r?null:r;var o=void 0;if(null!==ls){var s=ls.memoizedState;if(o=s.destroy,null!==r&&fs(r,s.deps))return void(a.memoizedState=As(t,n,o,r))}is.flags|=e,a.memoizedState=As(1|t,n,o,r)}function Ms(e,t){return Is(8390656,8,e,t)}function Os(e,t){return Rs(2048,8,e,t)}function Ls(e,t){return Rs(4,2,e,t)}function $s(e,t){return Rs(4,4,e,t)}function Fs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Rs(4,4,Fs.bind(null,t,e),n)}function Bs(){}function Us(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ws(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fs(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Vs(e,t,n){return 0===(21&ss)?(e.baseState&&(e.baseState=!1,bi=!0),e.memoizedState=n):(ir(n,t)||(n=ft(),is.lanes|=n,Ol|=n,e.baseState=!0),t)}function Hs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=os.transition;os.transition={};try{e(!1),t()}finally{bt=n,os.transition=r}}function qs(){return bs().memoizedState}function Ys(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Ks(t,n);else if(null!==(n=Ro(e,t,n,r))){rc(n,e,r,tc()),Gs(n,t,r)}}function Js(e,t,n){var r=nc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Ks(t,a);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,i=o(s,n);if(a.hasEagerState=!0,a.eagerState=i,ir(i,s)){var l=t.interleaved;return null===l?(a.next=a,Io(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ro(e,t,a,r))&&(rc(n,e,r,a=tc()),Gs(n,t,r))}}function Qs(e){var t=e.alternate;return e===is||null!==t&&t===is}function Ks(e,t){us=ds=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Gs(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xs={readContext:Ao,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},Zs={readContext:Ao,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Ao,useEffect:Ms,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Is(4194308,4,Fs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Is(4194308,4,e,t)},useInsertionEffect:function(e,t){return Is(4,2,e,t)},useMemo:function(e,t){var n=ys();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ys();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ys.bind(null,is,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:Ts,useDebugValue:Bs,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=Ts(!1),t=e[0];return e=Hs.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=is,a=ys();if(ao){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Dl)throw Error(o(349));0!==(30&ss)||Ss(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Ms(ks.bind(null,r,s,e),[e]),r.flags|=2048,As(9,js.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ys(),t=Dl.identifierPrefix;if(ao){var n=Ga;t=":"+t+"R"+(n=(Ka&~(1<<32-st(Ka)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ps++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ei={readContext:Ao,useCallback:Us,useContext:Ao,useEffect:Os,useImperativeHandle:zs,useInsertionEffect:Ls,useLayoutEffect:$s,useMemo:Ws,useReducer:_s,useRef:Ps,useState:function(){return _s(xs)},useDebugValue:Bs,useDeferredValue:function(e){return Vs(bs(),ls.memoizedState,e)},useTransition:function(){return[_s(xs)[0],bs().memoizedState]},useMutableSource:Ns,useSyncExternalStore:Es,useId:qs,unstable_isNewReconciler:!1},ti={readContext:Ao,useCallback:Us,useContext:Ao,useEffect:Os,useImperativeHandle:zs,useInsertionEffect:Ls,useLayoutEffect:$s,useMemo:Ws,useReducer:ws,useRef:Ps,useState:function(){return ws(xs)},useDebugValue:Bs,useDeferredValue:function(e){var t=bs();return null===ls?t.memoizedState=e:Vs(t,ls.memoizedState,e)},useTransition:function(){return[ws(xs)[0],bs().memoizedState]},useMutableSource:Ns,useSyncExternalStore:Es,useId:qs,unstable_isNewReconciler:!1};function ni(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ri(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ai={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),o=Fo(r,a);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,a))&&(rc(t,e,a,r),Bo(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),o=Fo(r,a);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,a))&&(rc(t,e,a,r),Bo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),a=Fo(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=zo(e,a,r))&&(rc(t,e,r,n),Bo(t,e,r))}};function oi(e,t,n,r,a,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,o))}function si(e,t,n){var r=!1,a=ka,o=t.contextType;return"object"===typeof o&&null!==o?o=Ao(o):(a=Pa(t)?Ta:Ca.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):ka),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ai,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function ii(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ai.enqueueReplaceState(t,t.state,null)}function li(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Lo(e);var o=t.contextType;"object"===typeof o&&null!==o?a.context=Ao(o):(o=Pa(t)?Ta:Ca.current,a.context=Aa(e,o)),a.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(ri(e,t,o,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ai.enqueueReplaceState(a,a.state,null),Wo(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ci(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var a=n}catch(o){a="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:a,digest:null}}function di(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ui(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var hi="function"===typeof WeakMap?WeakMap:Map;function pi(e,t,n){(n=Fo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vl||(Vl=!0,Hl=r),ui(0,t)},n}function mi(e,t,n){(n=Fo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ui(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ui(0,t),"function"!==typeof r&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fi(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hi;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=jc.bind(null,e,t,n),t.then(e,e))}function gi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vi(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fo(-1,1)).tag=2,zo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yi=x.ReactCurrentOwner,bi=!1;function xi(e,t,n,r){t.child=null===e?wo(t,null,n,r):_o(t,e.child,n,r)}function _i(e,t,n,r,a){n=n.render;var o=t.ref;return To(t,a),r=gs(e,t,n,r,o,a),n=vs(),null===e||bi?(ao&&n&&eo(t),t.flags|=1,xi(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vi(e,t,a))}function wi(e,t,n,r,a){if(null===e){var o=n.type;return"function"!==typeof o||Ic(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ni(e,t,o,r,a))}if(o=e.child,0===(e.lanes&a)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Vi(e,t,a)}return t.flags|=1,(e=Rc(o,r)).ref=t.ref,e.return=t,t.child=e}function Ni(e,t,n,r,a){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(bi=!1,t.pendingProps=r=o,0===(e.lanes&a))return t.lanes=e.lanes,Vi(e,t,a);0!==(131072&e.flags)&&(bi=!0)}}return ji(e,t,n,r,a)}function Ei(e,t,n){var r=t.pendingProps,a=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ja(Il,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ja(Il,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,ja(Il,Pl),Pl|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,ja(Il,Pl),Pl|=r;return xi(e,t,a,n),t.child}function Si(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ji(e,t,n,r,a){var o=Pa(n)?Ta:Ca.current;return o=Aa(t,o),To(t,a),n=gs(e,t,n,r,o,a),r=vs(),null===e||bi?(ao&&r&&eo(t),t.flags|=1,xi(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vi(e,t,a))}function ki(e,t,n,r,a){if(Pa(n)){var o=!0;Oa(t)}else o=!1;if(To(t,a),null===t.stateNode)Wi(e,t),si(t,n,r),li(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,i=t.memoizedProps;s.props=i;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ao(c):c=Aa(t,c=Pa(n)?Ta:Ca.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate;u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==r||l!==c)&&ii(t,s,r,c),Oo=!1;var h=t.memoizedState;s.state=h,Wo(t,r,s,a),l=t.memoizedState,i!==r||h!==l||Da.current||Oo?("function"===typeof d&&(ri(t,n,d,r),l=t.memoizedState),(i=Oo||oi(t,n,i,r,h,l,c))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=i):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,$o(e,t),i=t.memoizedProps,c=t.type===t.elementType?i:ni(t.type,i),s.props=c,u=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ao(l):l=Aa(t,l=Pa(n)?Ta:Ca.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==u||h!==l)&&ii(t,s,r,l),Oo=!1,h=t.memoizedState,s.state=h,Wo(t,r,s,a);var m=t.memoizedState;i!==u||h!==m||Da.current||Oo?("function"===typeof p&&(ri(t,n,p,r),m=t.memoizedState),(c=Oo||oi(t,n,c,r,h,m,l)||!1)?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,m,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),s.props=r,s.state=m,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ci(e,t,n,r,o,a)}function Ci(e,t,n,r,a,o){Si(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&La(t,n,!1),Vi(e,t,o);r=t.stateNode,yi.current=t;var i=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=_o(t,e.child,null,o),t.child=_o(t,null,i,o)):xi(e,t,i,o),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function Di(e){var t=e.stateNode;t.pendingContext?Ra(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ra(0,t.context,!1),Ko(e,t.containerInfo)}function Ti(e,t,n,r,a){return mo(),fo(a),t.flags|=256,xi(e,t,n,r),t.child}var Ai,Pi,Ii,Ri,Mi={dehydrated:null,treeContext:null,retryLane:0};function Oi(e){return{baseLanes:e,cachePool:null,transitions:null}}function Li(e,t,n){var r,a=t.pendingProps,s=es.current,i=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),ja(es,1&s),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,i?(a=t.mode,i=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==i?(i.childLanes=0,i.pendingProps=l):i=Lc(l,a,0,null),e=Oc(e,a,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Oi(n),t.memoizedState=Mi,e):$i(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,i){if(n)return 256&t.flags?(t.flags&=-257,Fi(e,t,i,r=di(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=Lc({mode:"visible",children:r.children},a,0,null),(s=Oc(s,a,i,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&_o(t,e.child,null,i),t.child.memoizedState=Oi(i),t.memoizedState=Mi,s);if(0===(1&t.mode))return Fi(e,t,i,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Fi(e,t,i,r=di(s=Error(o(419)),r,void 0))}if(l=0!==(i&e.childLanes),bi||l){if(null!==(r=Dl)){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|i))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Mo(e,a),rc(r,e,a,-1))}return gc(),Fi(e,t,i,r=di(Error(o(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ro=ca(a.nextSibling),no=t,ao=!0,oo=null,null!==e&&(Ya[Ja++]=Ka,Ya[Ja++]=Ga,Ya[Ja++]=Qa,Ka=e.id,Ga=e.overflow,Qa=t),t=$i(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,s,n);if(i){i=a.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Rc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?i=Rc(r,i):(i=Oc(i,l,n,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,l=null===(l=e.child.memoizedState)?Oi(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Mi,a}return e=(i=e.child).sibling,a=Rc(i,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function $i(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fi(e,t,n,r){return null!==r&&fo(r),_o(t,e.child,null,n),(e=$i(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zi(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Do(e.return,t,n)}function Bi(e,t,n,r,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a)}function Ui(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(xi(e,t,r.children,n),0!==(2&(r=es.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zi(e,n,t);else if(19===e.tag)zi(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ja(es,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ts(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Bi(t,!1,a,n,o);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ts(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Bi(t,!0,n,null,o);break;case"together":Bi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wi(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vi(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hi(e,t){if(!ao)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qi(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Yi(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qi(t),null;case 1:case 17:return Pa(t.type)&&Ia(),qi(t),null;case 3:return r=t.stateNode,Go(),Sa(Da),Sa(Ca),rs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(ic(oo),oo=null))),Pi(e,t),qi(t),null;case 5:Zo(t);var a=Qo(Jo.current);if(n=t.type,null!==e&&null!=t.stateNode)Ii(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return qi(t),null}if(e=Qo(qo.current),ho(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ha]=t,r[pa]=s,e=0!==(1&t.mode),n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(a=0;a<Mr.length;a++)Fr(Mr[a],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":K(r,s),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Fr("invalid",r);break;case"textarea":ae(r,s),Fr("invalid",r)}for(var l in ye(n,s),a=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",""+c]):i.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fr("scroll",r)}switch(n){case"input":q(r),Z(r,s,!0);break;case"textarea":q(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=r,Ai(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Fr("cancel",e),Fr("close",e),a=r;break;case"iframe":case"object":case"embed":Fr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Mr.length;a++)Fr(Mr[a],e);a=r;break;case"source":Fr("error",e),a=r;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),a=r;break;case"details":Fr("toggle",e),a=r;break;case"input":K(e,r),a=Q(e,r),Fr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Fr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Fr("invalid",e)}for(s in ye(n,a),c=a)if(c.hasOwnProperty(s)){var d=c[s];"style"===s?ge(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===s?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(i.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Fr("scroll",e):null!=d&&b(e,s,d,l))}switch(n){case"input":q(e),Z(e,r,!1);break;case"textarea":q(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qi(t),null;case 6:if(e&&null!=t.stateNode)Ri(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=Qo(Jo.current),Qo(qo.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(s=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return qi(t),null;case 13:if(Sa(es),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ao&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),mo(),t.flags|=98560,s=!1;else if(s=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[ha]=t}else mo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qi(t),s=!1}else null!==oo&&(ic(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&es.current)?0===Rl&&(Rl=3):gc())),null!==t.updateQueue&&(t.flags|=4),qi(t),null);case 4:return Go(),Pi(e,t),null===e&&Ur(t.stateNode.containerInfo),qi(t),null;case 10:return Co(t.type._context),qi(t),null;case 19:if(Sa(es),null===(s=t.memoizedState))return qi(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)Hi(s,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ts(e))){for(t.flags|=128,Hi(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ja(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Ge()>Ul&&(t.flags|=128,r=!0,Hi(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ts(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hi(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ao)return qi(t),null}else 2*Ge()-s.renderingStartTime>Ul&&1073741824!==n&&(t.flags|=128,r=!0,Hi(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ge(),t.sibling=null,n=es.current,ja(es,r?1&n|2:1&n),t):(qi(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(qi(t),6&t.subtreeFlags&&(t.flags|=8192)):qi(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ji(e,t){switch(to(t),t.tag){case 1:return Pa(t.type)&&Ia(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Go(),Sa(Da),Sa(Ca),rs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zo(t),null;case 13:if(Sa(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));mo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sa(es),null;case 4:return Go(),null;case 10:return Co(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ai=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Pi=function(){},Ii=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Qo(qo.current);var o,s=null;switch(n){case"input":a=Q(e,a),r=Q(e,r),s=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(d in ye(n,r),n=null,a)if(!r.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(i.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=a?a[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(i.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Fr("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Ri=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qi=!1,Ki=!1,Gi="function"===typeof WeakSet?WeakSet:Set,Xi=null;function Zi(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var o=a.destroy;a.destroy=void 0,void 0!==o&&el(t,n,o)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[fa],delete t[ga],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function il(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(at,n)}catch(i){}switch(n.tag){case 5:Ki||Zi(n,t);case 6:var r=dl,a=ul;dl=null,hl(e,t,n),ul=a,null!==(dl=r)&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Ut(e)):la(dl,n.stateNode));break;case 4:r=dl,a=ul,dl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),dl=r,ul=a;break;case 0:case 11:case 14:case 15:if(!Ki&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var o=a,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&el(n,t,s),a=a.next}while(a!==r)}hl(e,t,n);break;case 1:if(!Ki&&(Zi(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){Sc(n,t,i)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Ki=(r=Ki)||null!==n.memoizedState,hl(e,t,n),Ki=r):hl(e,t,n);break;default:hl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Gi),t.forEach((function(t){var r=Dc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function fl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,i=t,l=i;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(o(160));pl(s,i,a),dl=null,ul=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){Sc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Sc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:fl(t,e),vl(e),512&r&&null!==n&&Zi(n,n.return);break;case 5:if(fl(t,e),vl(e),512&r&&null!==n&&Zi(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Sc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,i=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&G(a,s),be(l,i);var d=be(l,s);for(i=0;i<c.length;i+=2){var u=c[i],h=c[i+1];"style"===u?ge(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):b(a,u,h,d)}switch(l){case"input":X(a,s);break;case"textarea":oe(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?ne(a,!!s.multiple,m,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[pa]=s}catch(g){Sc(e,e.return,g)}}break;case 6:if(fl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(o(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){Sc(e,e.return,g)}}break;case 3:if(fl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:fl(t,e),vl(e);break;case 13:fl(t,e),vl(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Bl=Ge())),4&r&&ml(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Ki=(d=Ki)||u,fl(t,e),Ki=d):fl(t,e),vl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xi=e,u=e.child;null!==u;){for(h=Xi=u;null!==Xi;){switch(m=(p=Xi).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zi(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){Sc(r,n,g)}}break;case 5:Zi(p,p.return);break;case 22:if(null!==p.memoizedState){_l(h);continue}}null!==m?(m.return=p,Xi=m):_l(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,i=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",i))}catch(g){Sc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),vl(e),4&r&&ml(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cl(e,il(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;ll(e,il(e),s);break;default:throw Error(o(161))}}catch(i){Sc(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Xi=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Xi;){var a=Xi,o=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Qi;if(!s){var i=a.alternate,l=null!==i&&null!==i.memoizedState||Ki;i=Qi;var c=Ki;if(Qi=s,(Ki=l)&&!c)for(Xi=a;null!==Xi;)l=(s=Xi).child,22===s.tag&&null!==s.memoizedState?wl(a):null!==l?(l.return=s,Xi=l):wl(a);for(;null!==o;)Xi=o,bl(o,t,n),o=o.sibling;Xi=a,Qi=i,Ki=c}xl(e)}else 0!==(8772&a.subtreeFlags)&&null!==o?(o.return=a,Xi=o):xl(e)}}function xl(e){for(;null!==Xi;){var t=Xi;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ki||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ki)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ni(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Vo(t,s,r);break;case 3:var i=t.updateQueue;if(null!==i){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vo(t,i,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Ut(h)}}}break;default:throw Error(o(163))}Ki||512&t.flags&&al(t)}catch(Yl){Sc(t,t.return,Yl)}}if(t===e){Xi=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xi=n;break}Xi=t.return}}function _l(e){for(;null!==Xi;){var t=Xi;if(t===e){Xi=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xi=n;break}Xi=t.return}}function wl(e){for(;null!==Xi;){var t=Xi;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Sc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){Sc(t,a,l)}}var o=t.return;try{al(t)}catch(l){Sc(t,o,l)}break;case 5:var s=t.return;try{al(t)}catch(l){Sc(t,s,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Xi=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Xi=i;break}Xi=t.return}}var Nl,El=Math.ceil,Sl=x.ReactCurrentDispatcher,jl=x.ReactCurrentOwner,kl=x.ReactCurrentBatchConfig,Cl=0,Dl=null,Tl=null,Al=0,Pl=0,Il=Ea(0),Rl=0,Ml=null,Ol=0,Ll=0,$l=0,Fl=null,zl=null,Bl=0,Ul=1/0,Wl=null,Vl=!1,Hl=null,ql=null,Jl=!1,Ql=null,Kl=0,Gl=0,Xl=null,Zl=-1,ec=0;function tc(){return 0!==(6&Cl)?Ge():-1!==Zl?Zl:Zl=Ge()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Al?Al&-Al:null!==go.transition?(0===ec&&(ec=ft()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function rc(e,t,n,r){if(50<Gl)throw Gl=0,Xl=null,Error(o(185));vt(e,n,r),0!==(2&Cl)&&e===Dl||(e===Dl&&(0===(2&Cl)&&(Ll|=n),4===Rl&&lc(e,Al)),ac(e,r),1===n&&0===Cl&&0===(1&t.mode)&&(Ul=Ge()+500,Fa&&Ua()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),i=1<<s,l=a[s];-1===l?0!==(i&n)&&0===(i&r)||(a[s]=pt(i,t)):l<=t&&(e.expiredLanes|=i),o&=~i}}(e,t);var r=ht(e,e===Dl?Al:0);if(0===r)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){Fa=!0,Ba(e)}(cc.bind(null,e)):Ba(cc.bind(null,e)),sa((function(){0===(6&Cl)&&Ua()})),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function oc(e,t){if(Zl=-1,ec=0,0!==(6&Cl))throw Error(o(327));var n=e.callbackNode;if(Nc()&&e.callbackNode!==n)return null;var r=ht(e,e===Dl?Al:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var a=Cl;Cl|=2;var s=fc();for(Dl===e&&Al===t||(Wl=null,Ul=Ge()+500,pc(e,t));;)try{bc();break}catch(l){mc(e,l)}ko(),Sl.current=s,Cl=a,null!==Tl?t=0:(Dl=null,Al=0,t=Rl)}if(0!==t){if(2===t&&(0!==(a=mt(e))&&(r=a,t=sc(e,a))),1===t)throw n=Ml,pc(e,0),lc(e,r),ac(e,Ge()),n;if(6===t)lc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],o=a.getSnapshot;a=a.value;try{if(!ir(o(),a))return!1}catch(i){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=vc(e,r))&&(0!==(s=mt(e))&&(r=s,t=sc(e,s))),1===t))throw n=Ml,pc(e,0),lc(e,r),ac(e,Ge()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:wc(e,zl,Wl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=Bl+500-Ge())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,zl,Wl),t);break}wc(e,zl,Wl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var i=31-st(r);s=1<<i,(i=t[i])>a&&(a=i),r&=~s}if(r=a,10<(r=(120>(r=Ge()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,zl,Wl),r);break}wc(e,zl,Wl);break;default:throw Error(o(329))}}}return ac(e,Ge()),e.callbackNode===n?oc.bind(null,e):null}function sc(e,t){var n=Fl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=zl,zl=n,null!==t&&ic(t)),e}function ic(e){null===zl?zl=e:zl.push.apply(zl,e)}function lc(e,t){for(t&=~$l,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Cl))throw Error(o(327));Nc();var t=ht(e,0);if(0===(1&t))return ac(e,Ge()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=mt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Ml,pc(e,0),lc(e,t),ac(e,Ge()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Wl),ac(e,Ge()),null}function dc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Ul=Ge()+500,Fa&&Ua())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Cl)&&Nc();var t=Cl;Cl|=1;var n=kl.transition,r=bt;try{if(kl.transition=null,bt=1,e)return e()}finally{bt=r,kl.transition=n,0===(6&(Cl=t))&&Ua()}}function hc(){Pl=Il.current,Sa(Il)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Tl)for(n=Tl.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ia();break;case 3:Go(),Sa(Da),Sa(Ca),rs();break;case 5:Zo(r);break;case 4:Go();break;case 13:case 19:Sa(es);break;case 10:Co(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Dl=e,Tl=e=Rc(e.current,null),Al=Pl=t,Rl=0,Ml=null,$l=Ll=Ol=0,zl=Fl=null,null!==Po){for(t=0;t<Po.length;t++)if(null!==(r=(n=Po[t]).interleaved)){n.interleaved=null;var a=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=a,r.next=s}n.pending=r}Po=null}return e}function mc(e,t){for(;;){var n=Tl;try{if(ko(),as.current=Xs,ds){for(var r=is.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}ds=!1}if(ss=0,cs=ls=is=null,us=!1,hs=0,jl.current=null,null===n||null===n.return){Rl=1,Ml=t,Tl=null;break}e:{var s=e,i=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=gi(i);if(null!==m){m.flags&=-257,vi(m,i,l,0,t),1&m.mode&&fi(s,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fi(s,d,t),gc();break e}c=Error(o(426))}else if(ao&&1&l.mode){var v=gi(i);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vi(v,i,l,0,t),fo(ci(c,l));break e}}s=c=ci(c,l),4!==Rl&&(Rl=2),null===Fl?Fl=[s]:Fl.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Uo(s,pi(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===ql||!ql.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Uo(s,mi(s,l,t));break e}}s=s.return}while(null!==s)}_c(n)}catch(x){t=x,Tl===n&&null!==n&&(Tl=n=n.return);continue}break}}function fc(){var e=Sl.current;return Sl.current=Xs,null===e?Xs:e}function gc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Dl||0===(268435455&Ol)&&0===(268435455&Ll)||lc(Dl,Al)}function vc(e,t){var n=Cl;Cl|=2;var r=fc();for(Dl===e&&Al===t||(Wl=null,pc(e,t));;)try{yc();break}catch(a){mc(e,a)}if(ko(),Cl=n,Sl.current=r,null!==Tl)throw Error(o(261));return Dl=null,Al=0,Rl}function yc(){for(;null!==Tl;)xc(Tl)}function bc(){for(;null!==Tl&&!Qe();)xc(Tl)}function xc(e){var t=Nl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?_c(e):Tl=t,jl.current=null}function _c(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Yi(n,t,Pl)))return void(Tl=n)}else{if(null!==(n=Ji(n,t)))return n.flags&=32767,void(Tl=n);if(null===e)return Rl=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Rl&&(Rl=5)}function wc(e,t,n){var r=bt,a=kl.transition;try{kl.transition=null,bt=1,function(e,t,n,r){do{Nc()}while(null!==Ql);if(0!==(6&Cl))throw Error(o(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),o=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~o}}(e,s),e===Dl&&(Tl=Dl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Jl||(Jl=!0,Tc(tt,(function(){return Nc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=kl.transition,kl.transition=null;var i=bt;bt=1;var l=Cl;Cl|=4,jl.current=null,function(e,t){if(ea=Vt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(_){n=null;break e}var i=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==a&&3!==h.nodeType||(l=i+a),h!==s||0!==r&&3!==h.nodeType||(c=i+r),3===h.nodeType&&(i+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===a&&(l=i),p===s&&++u===r&&(c=i),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Vt=!1,Xi=t;null!==Xi;)if(e=(t=Xi).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xi=e;else for(;null!==Xi;){t=Xi;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,v=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ni(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(_){Sc(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Xi=e;break}Xi=t.return}f=tl,tl=!1}(e,n),gl(n,e),mr(ta),Vt=!!ea,ta=ea=null,e.current=n,yl(n,e,a),Ke(),Cl=l,bt=i,kl.transition=s}else e.current=n;if(Jl&&(Jl=!1,Ql=e,Kl=a),s=e.pendingLanes,0===s&&(ql=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Ge()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Vl)throw Vl=!1,e=Hl,Hl=null,e;0!==(1&Kl)&&0!==e.tag&&Nc(),s=e.pendingLanes,0!==(1&s)?e===Xl?Gl++:(Gl=0,Xl=e):Gl=0,Ua()}(e,t,n,r)}finally{kl.transition=a,bt=r}return null}function Nc(){if(null!==Ql){var e=xt(Kl),t=kl.transition,n=bt;try{if(kl.transition=null,bt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Kl=0,0!==(6&Cl))throw Error(o(331));var a=Cl;for(Cl|=4,Xi=e.current;null!==Xi;){var s=Xi,i=s.child;if(0!==(16&Xi.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xi=d;null!==Xi;){var u=Xi;switch(u.tag){case 0:case 11:case 15:nl(8,u,s)}var h=u.child;if(null!==h)h.return=u,Xi=h;else for(;null!==Xi;){var p=(u=Xi).sibling,m=u.return;if(ol(u),u===d){Xi=null;break}if(null!==p){p.return=m,Xi=p;break}Xi=m}}}var f=s.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xi=s}}if(0!==(2064&s.subtreeFlags)&&null!==i)i.return=s,Xi=i;else e:for(;null!==Xi;){if(0!==(2048&(s=Xi).flags))switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Xi=y;break e}Xi=s.return}}var b=e.current;for(Xi=b;null!==Xi;){var x=(i=Xi).child;if(0!==(2064&i.subtreeFlags)&&null!==x)x.return=i,Xi=x;else e:for(i=b;null!==Xi;){if(0!==(2048&(l=Xi).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(w){Sc(l,l.return,w)}if(l===i){Xi=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Xi=_;break e}Xi=l.return}}if(Cl=a,Ua(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(at,e)}catch(w){}r=!0}return r}finally{bt=n,kl.transition=t}}return!1}function Ec(e,t,n){e=zo(e,t=pi(0,t=ci(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),ac(e,t))}function Sc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ql||!ql.has(r))){t=zo(t,e=mi(t,e=ci(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),ac(t,e));break}}t=t.return}}function jc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Dl===e&&(Al&n)===n&&(4===Rl||3===Rl&&(130023424&Al)===Al&&500>Ge()-Bl?pc(e,0):$l|=n),ac(e,t)}function kc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=tc();null!==(e=Mo(e,t))&&(vt(e,t,n),ac(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),kc(e,n)}function Dc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),kc(e,n)}function Tc(e,t){return Ye(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,r){return new Ac(e,t,n,r)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,a,s){var i=2;if(r=e,"function"===typeof e)Ic(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case N:return Oc(n.children,a,s,t);case E:i=8,a|=8;break;case S:return(e=Pc(12,n,t,2|a)).elementType=S,e.lanes=s,e;case D:return(e=Pc(13,n,t,a)).elementType=D,e.lanes=s,e;case T:return(e=Pc(19,n,t,a)).elementType=T,e.lanes=s,e;case I:return Lc(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case j:i=10;break e;case k:i=9;break e;case C:i=11;break e;case A:i=14;break e;case P:i=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Pc(i,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Oc(e,t,n,r){return(e=Pc(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Pc(22,e,r,t)).elementType=I,e.lanes=n,e.stateNode={isHidden:!1},e}function $c(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,a,o,s,i,l){return e=new zc(e,t,n,i,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Pc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lo(o),e}function Uc(e){if(!e)return ka;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Pa(n))return Ma(e,n,t)}return t}function Wc(e,t,n,r,a,o,s,i,l){return(e=Bc(n,r,!0,e,0,o,0,i,l)).context=Uc(null),n=e.current,(o=Fo(r=tc(),a=nc(n))).callback=void 0!==t&&null!==t?t:null,zo(n,o,a),e.current.lanes=a,vt(e,a,r),ac(e,r),e}function Vc(e,t,n,r){var a=t.current,o=tc(),s=nc(a);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fo(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zo(a,t,s))&&(rc(e,a,s,o),Bo(e,a,s)),s}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Yc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Da.current)bi=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bi=!1,function(e,t,n){switch(t.tag){case 3:Di(t),mo();break;case 5:Xo(t);break;case 1:Pa(t.type)&&Oa(t);break;case 4:Ko(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;ja(No,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(ja(es,1&es.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Li(e,t,n):(ja(es,1&es.current),null!==(e=Vi(e,t,n))?e.sibling:null);ja(es,1&es.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ui(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),ja(es,es.current),r)break;return null;case 22:case 23:return t.lanes=0,Ei(e,t,n)}return Vi(e,t,n)}(e,t,n);bi=0!==(131072&e.flags)}else bi=!1,ao&&0!==(1048576&t.flags)&&Za(t,qa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wi(e,t),e=t.pendingProps;var a=Aa(t,Ca.current);To(t,n),a=gs(null,t,r,e,a,n);var s=vs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pa(r)?(s=!0,Oa(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Lo(t),a.updater=ai,t.stateNode=a,a._reactInternals=t,li(t,r,e,n),t=Ci(null,t,r,!0,s,n)):(t.tag=0,ao&&s&&eo(t),xi(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wi(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===A)return 14}return 2}(r),e=ni(r,e),a){case 0:t=ji(null,t,r,e,n);break e;case 1:t=ki(null,t,r,e,n);break e;case 11:t=_i(null,t,r,e,n);break e;case 14:t=wi(null,t,r,ni(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,ji(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 1:return r=t.type,a=t.pendingProps,ki(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 3:e:{if(Di(t),null===e)throw Error(o(387));r=t.pendingProps,a=(s=t.memoizedState).element,$o(e,t),Wo(t,r,null,n);var i=t.memoizedState;if(r=i.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ti(e,t,r,n,a=ci(Error(o(423)),t));break e}if(r!==a){t=Ti(e,t,r,n,a=ci(Error(o(424)),t));break e}for(ro=ca(t.stateNode.containerInfo.firstChild),no=t,ao=!0,oo=null,n=wo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(mo(),r===a){t=Vi(e,t,n);break e}xi(e,t,r,n)}t=t.child}return t;case 5:return Xo(t),null===e&&co(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,i=a.children,na(r,a)?i=null:null!==s&&na(r,s)&&(t.flags|=32),Si(e,t),xi(e,t,i,n),t.child;case 6:return null===e&&co(t),null;case 13:return Li(e,t,n);case 4:return Ko(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=_o(t,null,r,n):xi(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,_i(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 7:return xi(e,t,t.pendingProps,n),t.child;case 8:case 12:return xi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,ja(No,r._currentValue),r._currentValue=i,null!==s)if(ir(s.value,i)){if(s.children===a.children&&!Da.current){t=Vi(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){i=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=Fo(-1,n&-n)).tag=2;var d=s.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Do(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)i=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(i=s.return))throw Error(o(341));i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Do(i,n,t),i=s.sibling}else i=s.child;if(null!==i)i.return=s;else for(i=s;null!==i;){if(i===t){i=null;break}if(null!==(s=i.sibling)){s.return=i.return,i=s;break}i=i.return}s=i}xi(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,To(t,n),r=r(a=Ao(a)),t.flags|=1,xi(e,t,r,n),t.child;case 14:return a=ni(r=t.type,t.pendingProps),wi(e,t,r,a=ni(r.type,a),n);case 15:return Ni(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ni(r,a),Wi(e,t),t.tag=1,Pa(r)?(e=!0,Oa(t)):e=!1,To(t,n),si(t,r,a),li(t,r,a,n),Ci(null,t,r,!0,e,n);case 19:return Ui(e,t,n);case 22:return Ei(e,t,n)}throw Error(o(156,t.tag))};var Jc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Gc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function ed(e,t,n,r,a){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof a){var i=a;a=function(){var e=Hc(s);i.call(e)}}Vc(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var o=r;r=function(){var e=Hc(s);o.call(e)}}var s=Wc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=s,e[ma]=s.current,Ur(8===e.nodeType?e.parentNode:e),uc(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var i=r;r=function(){var e=Hc(l);i.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[ma]=l.current,Ur(8===e.nodeType?e.parentNode:e),uc((function(){Vc(t,l,n,r)})),l}(n,t,e,a,r);return Hc(s)}Kc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Vc(e,t,null,null)},Kc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Vc(null,e,null,null)})),t[ma]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&Lt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),ac(t,Ge()),0===(6&Cl)&&(Ul=Ge()+500,Ua()))}break;case 13:uc((function(){var t=Mo(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Yc(e,1)}},wt=function(e){if(13===e.tag){var t=Mo(e,134217728);if(null!==t)rc(t,e,134217728,tc());Yc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=nc(e),n=Mo(e,t);if(null!==n)rc(n,e,t,tc());Yc(e,t)}},Et=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=_a(r);if(!a)throw Error(o(90));Y(r),X(r,a)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=dc,De=uc;var td={usingClientEntryPoint:!1,Events:[ba,xa,_a,je,ke,dc]},nd={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rd={bundleType:nd.bundleType,version:nd.version,rendererPackageName:nd.rendererPackageName,rendererConfig:nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{at=ad.inject(rd),ot=ad}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Gc(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Gc(e))throw Error(o(299));var n=!1,r="",a=Jc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,a),e[ma]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(o(200));return ed(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Gc(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",i=Jc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(i=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,a,0,s,i),e[ma]=t.current,Ur(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Kc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(o(200));return ed(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc((function(){ed(null,null,e,!1,(function(){e._reactRootContainer=null,e[ma]=null}))})),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return ed(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},736:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(374));class o extends a.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t){let{config:n,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";"plain"===r?a="pl":"phrase"===r?a="ph":"websearch"===r&&(a="w");const o=void 0===n?"":`(${n})`;return this.url.searchParams.append(e,`${a}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach((e=>{let[t,n]=e;this.url.searchParams.append(t,`eq.${n}`)})),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}}t.default=o},745:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const r=n(400);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`}},768:(e,t,n)=>{n.d(t,{oR:()=>k});var r=n(43);let a={data:""},o=e=>"object"==typeof window?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||a,s=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,i=/\/\*[^]*?\*\/|  +/g,l=/\n+/g,c=(e,t)=>{let n="",r="",a="";for(let o in e){let s=e[o];"@"==o[0]?"i"==o[1]?n=o+" "+s+";":r+="f"==o[1]?c(s,o):o+"{"+c(s,"k"==o[1]?"":t)+"}":"object"==typeof s?r+=c(s,t?t.replace(/([^,])+/g,(e=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,(t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)))):o):null!=s&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=c.p?c.p(o,s):o+":"+s+";")}return n+(t&&a?t+"{"+a+"}":a)+r},d={},u=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+u(e[n]);return t}return e},h=(e,t,n,r,a)=>{let o=u(e),h=d[o]||(d[o]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(o));if(!d[h]){let t=o!==e?e:(e=>{let t,n,r=[{}];for(;t=s.exec(e.replace(i,""));)t[4]?r.shift():t[3]?(n=t[3].replace(l," ").trim(),r.unshift(r[0][n]=r[0][n]||{})):r[0][t[1]]=t[2].replace(l," ").trim();return r[0]})(e);d[h]=c(a?{["@keyframes "+h]:t}:t,n?"":"."+h)}let p=n&&d.g?d.g:null;return n&&(d.g=d[h]),((e,t,n,r)=>{r?t.data=t.data.replace(r,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(d[h],t,r,p),h};function p(e){let t=this||{},n=e.call?e(t.p):e;return h(n.unshift?n.raw?((e,t,n)=>e.reduce(((e,r,a)=>{let o=t[a];if(o&&o.call){let e=o(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;o=t?"."+t:e&&"object"==typeof e?e.props?"":c(e,""):!1===e?"":e}return e+r+(null==o?"":o)}),""))(n,[].slice.call(arguments,1),t.p):n.reduce(((e,n)=>Object.assign(e,n&&n.call?n(t.p):n)),{}):n,o(t.target),t.g,t.o,t.k)}p.bind({g:1});let m,f,g,v=p.bind({k:1});function y(e,t){let n=this||{};return function(){let r=arguments;function a(o,s){let i=Object.assign({},o),l=i.className||a.className;n.p=Object.assign({theme:f&&f()},i),n.o=/ *go\d+/.test(l),i.className=p.apply(n,r)+(l?" "+l:""),t&&(i.ref=s);let c=e;return e[0]&&(c=i.as||e,delete i.as),g&&c[0]&&g(i),m(c,i)}return t?t(a):a}}var b=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,x=(()=>{let e=0;return()=>(++e).toString()})(),_=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),w=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,20)};case 1:return{...e,toasts:e.toasts.map((e=>e.id===t.toast.id?{...e,...t.toast}:e))};case 2:let{toast:n}=t;return w(e,{type:e.toasts.find((e=>e.id===n.id))?1:0,toast:n});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map((e=>e.id===r||void 0===r?{...e,dismissed:!0,visible:!1}:e))};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter((e=>e.id!==t.toastId))};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map((e=>({...e,pauseDuration:e.pauseDuration+a})))}}},N=[],E={toasts:[],pausedAt:void 0},S=e=>{E=w(E,e),N.forEach((e=>{e(E)}))},j=e=>(t,n)=>{let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",n=arguments.length>2?arguments[2]:void 0;return{createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||x()}}(t,e,n);return S({type:2,toast:r}),r.id},k=(e,t)=>j("blank")(e,t);k.error=j("error"),k.success=j("success"),k.loading=j("loading"),k.custom=j("custom"),k.dismiss=e=>{S({type:3,toastId:e})},k.remove=e=>S({type:4,toastId:e}),k.promise=(e,t,n)=>{let r=k.loading(t.loading,{...n,...null==n?void 0:n.loading});return"function"==typeof e&&(e=e()),e.then((e=>{let a=t.success?b(t.success,e):void 0;return a?k.success(a,{id:r,...n,...null==n?void 0:n.success}):k.dismiss(r),e})).catch((e=>{let a=t.error?b(t.error,e):void 0;a?k.error(a,{id:r,...n,...null==n?void 0:n.error}):k.dismiss(r)})),e};new Map;var C=v`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,D=v`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,T=v`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,A=y("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${C} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${D} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${T} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,P=v`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,I=y("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${P} 1s linear infinite;
`,R=v`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,M=v`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,O=y("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${R} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${M} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,L=y("div")`
  position: absolute;
`,$=y("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,F=v`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,z=y("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${F} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,B=e=>{let{toast:t}=e,{icon:n,type:a,iconTheme:o}=t;return void 0!==n?"string"==typeof n?r.createElement(z,null,n):n:"blank"===a?null:r.createElement($,null,r.createElement(I,{...o}),"loading"!==a&&r.createElement(L,null,"error"===a?r.createElement(A,{...o}):r.createElement(O,{...o})))},U=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,W=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,V=y("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,H=y("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`;r.memo((e=>{let{toast:t,position:n,style:a,children:o}=e,s=t.height?((e,t)=>{let n=e.includes("top")?1:-1,[r,a]=_()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[U(n),W(n)];return{animation:t?`${v(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${v(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(t.position||n||"top-center",t.visible):{opacity:0},i=r.createElement(B,{toast:t}),l=r.createElement(H,{...t.ariaProps},b(t.message,t));return r.createElement(V,{className:t.className,style:{...s,...a,...t.style}},"function"==typeof o?o({icon:i,message:l}):r.createElement(r.Fragment,null,i,l))}));!function(e,t,n,r){c.p=t,m=e,f=n,g=r}(r.createElement);p`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`},799:(e,t,n)=>{n.d(t,{UU:()=>Ft});class r extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class a extends r{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class o extends r{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class s extends r{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var i;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(i||(i={}));var l=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function i(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))};class c{constructor(e){let{headers:t={},customFetch:r,region:a=i.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=a,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return l(this,void 0,void 0,(function*(){try{const{headers:r,method:i,body:l}=t;let c,d={},{region:u}=t;u||(u=this.region),u&&"any"!==u&&(d["x-region"]=u),l&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",c=l):"string"===typeof l?(d["Content-Type"]="text/plain",c=l):"undefined"!==typeof FormData&&l instanceof FormData?c=l:(d["Content-Type"]="application/json",c=JSON.stringify(l)));const h=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),r),body:c}).catch((e=>{throw new a(e)})),p=h.headers.get("x-relay-error");if(p&&"true"===p)throw new o(h);if(!h.ok)throw new s(h);let m,f=(null!==(n=h.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return m="application/json"===f?yield h.json():"application/octet-stream"===f?yield h.blob():"text/event-stream"===f?h:"multipart/form-data"===f?yield h.formData():yield h.text(),{data:m,error:null}}catch(r){return{data:null,error:r}}}))}}var d=n(980);const{PostgrestClient:u,PostgrestQueryBuilder:h,PostgrestFilterBuilder:p,PostgrestTransformBuilder:m,PostgrestBuilder:f,PostgrestError:g}=d,v={"X-Client-Info":"realtime-js/2.11.2"};var y,b,x,_,w,N;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(y||(y={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(b||(b={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(x||(x={})),function(e){e.websocket="websocket"}(_||(_={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(w||(w={}));class E{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const r=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const s=n.decode(e.slice(o,o+r));o+=r;const i=n.decode(e.slice(o,o+a));o+=a;return{ref:null,topic:s,event:i,payload:JSON.parse(n.decode(e.slice(o,e.byteLength)))}}}class S{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(N||(N={}));const j=function(e,t){var n;const r=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce(((n,a)=>(n[a]=k(a,e,t,r),n)),{})},k=(e,t,n,r)=>{const a=t.find((t=>t.name===e)),o=null===a||void 0===a?void 0:a.type,s=n[e];return o&&!r.includes(o)?C(o,s):D(s)},C=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return I(t,n)}switch(e){case N.bool:return T(t);case N.float4:case N.float8:case N.int2:case N.int4:case N.int8:case N.numeric:case N.oid:return A(t);case N.json:case N.jsonb:return P(t);case N.timestamp:return R(t);case N.abstime:case N.date:case N.daterange:case N.int4range:case N.int8range:case N.money:case N.reltime:case N.text:case N.time:case N.timestamptz:case N.timetz:case N.tsrange:case N.tstzrange:default:return D(t)}},D=e=>e,T=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},A=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},P=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},I=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,r=e[n];if("{"===e[0]&&"}"===r){let r;const o=e.slice(1,n);try{r=JSON.parse("["+o+"]")}catch(a){r=o?o.split(","):[]}return r.map((e=>C(t,e)))}return e},R=e=>"string"===typeof e?e.replace(" ","T"):e,M=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class O{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(n)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var L,$,F,z;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(L||(L={}));class B{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=B.syncState(this.state,e,t,n),this.pendingDiffs.forEach((e=>{this.state=B.syncDiff(this.state,e,t,n)})),this.pendingDiffs=[],r()})),this.channel._on(n.diff,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=B.syncDiff(this.state,e,t,n),r())})),this.onJoin(((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})})),this.onLeave(((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,n,r){const a=this.cloneDeep(e),o=this.transformState(t),s={},i={};return this.map(a,((e,t)=>{o[e]||(i[e]=t)})),this.map(o,((e,t)=>{const n=a[e];if(n){const r=t.map((e=>e.presence_ref)),a=n.map((e=>e.presence_ref)),o=t.filter((e=>a.indexOf(e.presence_ref)<0)),l=n.filter((e=>r.indexOf(e.presence_ref)<0));o.length>0&&(s[e]=o),l.length>0&&(i[e]=l)}else s[e]=t})),this.syncDiff(a,{joins:s,leaves:i},n,r)}static syncDiff(e,t,n,r){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(a,((t,r)=>{var a;const o=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(r),o.length>0){const n=e[t].map((e=>e.presence_ref)),r=o.filter((e=>n.indexOf(e.presence_ref)<0));e[t].unshift(...r)}n(t,o,r)})),this.map(o,((t,n)=>{let a=e[t];if(!a)return;const o=n.map((e=>e.presence_ref));a=a.filter((e=>o.indexOf(e.presence_ref)<0)),e[t]=a,r(t,a,n),0===a.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((n=>t(n,e[n])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,n)=>{const r=e[n];return t[n]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}($||($={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(F||(F={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(z||(z={}));class U{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=b.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new O(this,x.join,this.params,this.timeout),this.rejoinTimer=new S((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=b.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=b.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=b.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=b.errored,this.rejoinTimer.scheduleTimeout())})),this._on(x.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new B(this),this.broadcastEndpointURL=M(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:o,private:s}}=this.params;this._onError((t=>null===e||void 0===e?void 0:e(z.CHANNEL_ERROR,t))),this._onClose((()=>null===e||void 0===e?void 0:e(z.CLOSED)));const i={},l={broadcast:a,presence:o,postgres_changes:null!==(r=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map((e=>e.filter)))&&void 0!==r?r:[],private:s};this.socket.accessTokenValue&&(i.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},i)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async t=>{let{postgres_changes:n}=t;var r;if(this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,a=null!==(r=null===t||void 0===t?void 0:t.length)&&void 0!==r?r:0,o=[];for(let r=0;r<a;r++){const a=t[r],{filter:{event:s,schema:i,table:l,filter:c}}=a,d=n&&n[r];if(!d||d.event!==s||d.schema!==i||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null===e||void 0===e||e(z.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));o.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=o,void(e&&e(z.SUBSCRIBED))}null===e||void 0===e||e(z.SUBSCRIBED)})).receive("error",(t=>{null===e||void 0===e||e(z.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null===e||void 0===e||e(z.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((n=>{var r,a,o;const s=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(o=null===(a=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===a?void 0:a.broadcast)||void 0===o?void 0:o.ack)||n("ok"),s.receive("ok",(()=>n("ok"))),s.receive("error",(()=>n("error"))),s.receive("timeout",(()=>n("timed out")))}));{const{event:o,payload:s}=e,i={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,i,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=b.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(x.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((n=>{const r=new O(this,x.leave,{},e);r.receive("ok",(()=>{t(),n("ok")})).receive("timeout",(()=>{t(),n("timed out")})).receive("error",(()=>{n("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,n){const r=new AbortController,a=setTimeout((()=>r.abort()),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),o}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new O(this,e,t,n);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,a;const o=e.toLocaleLowerCase(),{close:s,error:i,leave:l,join:c}=x;if(n&&[s,i,l,c].indexOf(o)>=0&&n!==this._joinRef())return;let d=this._onMessage(o,t,n);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,n,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===r?void 0:r.toLocaleLowerCase())===o})).map((e=>e.callback(d,n))):null===(a=this.bindings[o])||void 0===a||a.filter((e=>{var n,r,a,s,i,l;if(["broadcast","presence","postgres_changes"].includes(o)){if("id"in e){const o=e.id,s=null===(n=e.filter)||void 0===n?void 0:n.event;return o&&(null===(r=t.ids)||void 0===r?void 0:r.includes(o))&&("*"===s||(null===s||void 0===s?void 0:s.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const n=null===(i=null===(s=null===e||void 0===e?void 0:e.filter)||void 0===s?void 0:s.event)||void 0===i?void 0:i.toLocaleLowerCase();return"*"===n||n===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===o})).map((e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:n,commit_timestamp:r,type:a,errors:o}=e,s={schema:t,table:n,commit_timestamp:r,eventType:a,new:{},old:{},errors:o};d=Object.assign(Object.assign({},s),this._getPayloadRecords(e))}e.callback(d,n)}))}_isClosed(){return this.state===b.closed}_isJoined(){return this.state===b.joined}_isJoining(){return this.state===b.joining}_isLeaving(){return this.state===b.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===n&&U.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(x.close,{},e)}_onError(e){this._on(x.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=b.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=j(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=j(e.columns,e.old_record)),t}}const W=()=>{},V="undefined"!==typeof WebSocket;class H{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=v,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=W,this.conn=null,this.sendBuffer=[],this.serializer=new E,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint=`${e}/${_.websocket}`,this.httpEndpoint=M(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const a=null===(r=null===t||void 0===t?void 0:t.params)||void 0===r?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new S((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(V)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new q(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),n.e(198).then(n.t.bind(n,198,23)).then((e=>{let{default:t}=e;this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case y.connecting:return w.Connecting;case y.open:return w.Open;case y.closing:return w.Closing;default:return w.Closed}}isConnected(){return this.connectionState()===w.Open}channel(e){const t=new U(`realtime:${e}`,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},this);return this.channels.push(t),t}push(e){const{topic:t,event:n,payload:r,ref:a}=e,o=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${n} (${a})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let n=null;try{n=JSON.parse(atob(e.split(".")[1]))}catch(t){}if(n&&n.exp){if(!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`)}this.accessTokenValue=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(x.access_token,{access_token:e})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:n,payload:r,ref:a}=e;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${n} ${a&&"("+a+")"||""}`,r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(n,r,a))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(x.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?";return`${e}${n}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class q{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=y.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class Y extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function J(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class Q extends Y{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class K extends Y{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var G=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function i(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))};const X=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},Z=e=>{if(Array.isArray(e))return e.map((e=>Z(e)));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((e=>{let[n,r]=e;const a=n.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[a]=Z(r)})),t};var ee=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function i(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))};const te=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ne=(e,t,r)=>ee(void 0,void 0,void 0,(function*(){const a=yield G(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(n.bind(n,630))).Response:Response}));e instanceof a&&!(null===r||void 0===r?void 0:r.noResolveJson)?e.json().then((n=>{t(new Q(te(n),e.status||500))})).catch((e=>{t(new K(te(e),e))})):t(new K(te(e),e))}));function re(e,t,n,r,a,o){return ee(this,void 0,void 0,(function*(){return new Promise(((s,i)=>{e(n,((e,t,n,r)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))})(t,r,a,o)).then((e=>{if(!e.ok)throw e;return(null===r||void 0===r?void 0:r.noResolveJson)?e:e.json()})).then((e=>s(e))).catch((e=>ne(e,i,r)))}))}))}function ae(e,t,n,r){return ee(this,void 0,void 0,(function*(){return re(e,"GET",t,n,r)}))}function oe(e,t,n,r,a){return ee(this,void 0,void 0,(function*(){return re(e,"POST",t,r,a,n)}))}function se(e,t,n,r,a){return ee(this,void 0,void 0,(function*(){return re(e,"DELETE",t,r,a,n)}))}var ie=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function i(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))};const le={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ce={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class de{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=n,this.fetch=X(r)}uploadOrUpdate(e,t,n,r){return ie(this,void 0,void 0,(function*(){try{let a;const o=Object.assign(Object.assign({},ce),r);let s=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(o.upsert)});const i=o.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),i&&a.append("metadata",this.encodeMetadata(i)),a.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(a=n,a.append("cacheControl",o.cacheControl),i&&a.append("metadata",this.encodeMetadata(i))):(a=n,s["cache-control"]=`max-age=${o.cacheControl}`,s["content-type"]=o.contentType,i&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(i)))),(null===r||void 0===r?void 0:r.headers)&&(s=Object.assign(Object.assign({},s),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:a,headers:s},(null===o||void 0===o?void 0:o.duplex)?{duplex:o.duplex}:{})),u=yield d.json();if(d.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(a){if(J(a))return{data:null,error:a};throw a}}))}upload(e,t,n){return ie(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,n)}))}uploadToSignedUrl(e,t,n,r){return ie(this,void 0,void 0,(function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),s=new URL(this.url+`/object/upload/sign/${o}`);s.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:ce.upsert},r),o=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,o["cache-control"]=`max-age=${t.cacheControl}`,o["content-type"]=t.contentType);const i=yield this.fetch(s.toString(),{method:"PUT",body:e,headers:o}),l=yield i.json();if(i.ok)return{data:{path:a,fullPath:l.Key},error:null};return{data:null,error:l}}catch(i){if(J(i))return{data:null,error:i};throw i}}))}createSignedUploadUrl(e,t){return ie(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(r["x-upsert"]="true");const a=yield oe(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:r}),o=new URL(this.url+a.url),s=o.searchParams.get("token");if(!s)throw new Y("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:s},error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}))}update(e,t,n){return ie(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,n)}))}move(e,t,n){return ie(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}))}copy(e,t,n){return ie(this,void 0,void 0,(function*(){try{return{data:{path:(yield oe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}))}createSignedUrl(e,t,n){return ie(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),a=yield oe(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const o=(null===n||void 0===n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}))}createSignedUrls(e,t,n){return ie(this,void 0,void 0,(function*(){try{const r=yield oe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=(null===n||void 0===n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${a}`):null}))),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}))}download(e,t){return ie(this,void 0,void 0,(function*(){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),a=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield ae(this.fetch,`${this.url}/${n}/${t}${a}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(o){if(J(o))return{data:null,error:o};throw o}}))}info(e){return ie(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield ae(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Z(e),error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}))}exists(e){return ie(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n,r){return ee(this,void 0,void 0,(function*(){return re(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(J(n)&&n instanceof K){const e=n.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:n}}throw n}}))}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],a=(null===t||void 0===t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==a&&r.push(a);const o="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",s=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==s&&r.push(s);let i=r.join("&");return""!==i&&(i=`?${i}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${i}`)}}}remove(e){return ie(this,void 0,void 0,(function*(){try{return{data:yield se(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}}))}list(e,t,n){return ie(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},le),t),{prefix:e||""});return{data:yield oe(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ue={"X-Client-Info":"storage-js/2.7.1"};var he=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function i(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))};class pe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},ue),t),this.fetch=X(n)}listBuckets(){return he(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}}))}getBucket(e){return he(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return he(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}))}updateBucket(e,t){return he(this,void 0,void 0,(function*(){try{const n=yield function(e,t,n,r,a){return ee(this,void 0,void 0,(function*(){return re(e,"PUT",t,r,a,n)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:n,error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}))}emptyBucket(e){return he(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return he(this,void 0,void 0,(function*(){try{return{data:yield se(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}}))}}class me extends pe{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new de(this.url,this.headers,e,this.fetch)}}let fe="";fe="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const ge={headers:{"X-Client-Info":`supabase-js-${fe}/2.49.4`}},ve={schema:"public"},ye={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},be={};var xe=n(630),_e=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function i(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))};const we=e=>{let t;return t=e||("undefined"===typeof fetch?xe.default:fetch),function(){return t(...arguments)}},Ne=(e,t,n)=>{const r=we(n),a="undefined"===typeof Headers?xe.Headers:Headers;return(n,o)=>_e(void 0,void 0,void 0,(function*(){var s;const i=null!==(s=yield t())&&void 0!==s?s:e;let l=new a(null===o||void 0===o?void 0:o.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${i}`),r(n,Object.assign(Object.assign({},o),{headers:l}))}))};var Ee=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function i(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))};const Se="2.69.1",je=3e4,ke=9e4,Ce={"X-Client-Info":`gotrue-js/${Se}`},De="X-Supabase-Api-Version",Te={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Ae=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Pe extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Ie(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class Re extends Pe{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class Me extends Pe{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Oe extends Pe{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class Le extends Oe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class $e extends Oe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fe extends Oe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ze extends Oe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Be extends Oe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ue extends Oe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function We(e){return Ie(e)&&"AuthRetryableFetchError"===e.name}class Ve extends Oe{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class He extends Oe{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ye=" \t\n\r=".split(""),Je=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ye.length;t+=1)e[Ye[t].charCodeAt(0)]=-2;for(let t=0;t<qe.length;t+=1)e[qe[t].charCodeAt(0)]=t;return e})();function Qe(e,t,n){const r=Je[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Ke(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},o=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(0===(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,r,n)};for(let s=0;s<e.length;s+=1)Qe(e.charCodeAt(s),a,o);return t.join("")}function Ge(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Xe(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}Ge(r,t)}}function Ze(e){const t=[],n={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Qe(e.charCodeAt(a),n,r);return new Uint8Array(t)}const et=()=>"undefined"!==typeof window&&"undefined"!==typeof document,tt={tested:!1,writable:!1},nt=()=>{if(!et())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(tt.tested)return tt.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),tt.tested=!0,tt.writable=!0}catch(t){tt.tested=!0,tt.writable=!1}return tt.writable};const rt=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},at=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},ot=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(Km){return n}},st=async(e,t)=>{await e.removeItem(t)};class it{constructor(){this.promise=new it.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function lt(e){const t=e.split(".");if(3!==t.length)throw new He("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Ae.test(t[n]))throw new He("JWT not in base64url format");return{header:JSON.parse(Ke(t[0])),payload:JSON.parse(Ke(t[1])),signature:Ze(t[2]),raw:{header:t[0],payload:t[1]}}}function ct(e){return("0"+e.toString(16)).substr(-2)}async function dt(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ut(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,ct).join("")}();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await at(e,`${t}-code-verifier`,a);const o=await dt(r);return[o,r===o?"plain":"s256"]}it.promiseConstructor=Promise;const ht=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;var pt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const mt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ft=[502,503,504];async function gt(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new Ue(mt(e),0);if(ft.includes(e.status))throw new Ue(mt(e),e.status);let r,a;try{r=await e.json()}catch(s){throw new Me(mt(s),s)}const o=function(e){const t=e.headers.get(De);if(!t)return null;if(!t.match(ht))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(s){return null}}(e);if(o&&o.getTime()>=Te.timestamp&&"object"===typeof r&&r&&"string"===typeof r.code?a=r.code:"object"===typeof r&&r&&"string"===typeof r.error_code&&(a=r.error_code),a){if("weak_password"===a)throw new Ve(mt(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new Le}else if("object"===typeof r&&r&&"object"===typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0))throw new Ve(mt(r),e.status,r.weak_password.reasons);throw new Re(mt(r),e.status||500,a)}async function vt(e,t,n,r){var a;const o=Object.assign({},null===r||void 0===r?void 0:r.headers);o[De]||(o[De]=Te.name),(null===r||void 0===r?void 0:r.jwt)&&(o.Authorization=`Bearer ${r.jwt}`);const s=null!==(a=null===r||void 0===r?void 0:r.query)&&void 0!==a?a:{};(null===r||void 0===r?void 0:r.redirectTo)&&(s.redirect_to=r.redirectTo);const i=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await async function(e,t,n,r,a,o){const s=((e,t,n,r)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))})(t,r,a,o);let i;try{i=await e(n,Object.assign({},s))}catch(l){throw console.error(l),new Ue(mt(l),0)}i.ok||await gt(i);if(null===r||void 0===r?void 0:r.noResolveJson)return i;try{return await i.json()}catch(l){await gt(l)}}(e,t,n+i,{headers:o,noResolveJson:null===r||void 0===r?void 0:r.noResolveJson},{},null===r||void 0===r?void 0:r.body);return(null===r||void 0===r?void 0:r.xform)?null===r||void 0===r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function yt(e){var t;let n=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function bt(e){const t=yt(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function xt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function _t(e){return{data:e,error:null}}function wt(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:o}=e,s=pt(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:o},user:Object.assign({},s)},error:null}}function Nt(e){return e}var Et=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};class St{constructor(e){let{url:t="",headers:n={},fetch:r}=e;this.url=t,this.headers=n,this.fetch=rt(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await vt(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await vt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:xt})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=Et(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=null===n||void 0===n?void 0:n.newEmail,delete r.newEmail),await vt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:wt,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Ie(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await vt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:xt})}catch(t){if(Ie(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,r,a,o,s,i;try{const l={nextPage:null,lastPage:0,total:0},c=await vt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(a=null===(r=null===e||void 0===e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==a?a:""},xform:Nt});if(c.error)throw c.error;const d=await c.json(),u=null!==(o=c.headers.get("x-total-count"))&&void 0!==o?o:0,h=null!==(i=null===(s=c.headers.get("link"))||void 0===s?void 0:s.split(","))&&void 0!==i?i:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l[`${n}Page`]=t})),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ie(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await vt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:xt})}catch(t){if(Ie(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await vt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:xt})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await vt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:xt})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await vt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await vt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}}const jt={getItem:e=>nt()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{nt()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{nt()&&globalThis.localStorage.removeItem(e)}};function kt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const Ct=!!(globalThis&&nt()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Dt extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Tt extends Dt{}async function At(e,t,n){Ct&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),Ct&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw Ct&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Tt(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ct)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}Ct&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{Ct&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Pt={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ce,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function It(e,t,n){return await n()}class Rt{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Rt.nextInstanceID,Rt.nextInstanceID+=1,this.instanceID>0&&et()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Pt),e);if(this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new St({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=rt(r.fetch),this.lock=r.lock||It,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:et()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=At:this.lock=It,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:nt()?this.storage=jt:(this.memoryStorage={},this.storage=kt(this.memoryStorage)):(this.memoryStorage={},this.storage=kt(this.memoryStorage)),et()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger(`GoTrueClient@${this.instanceID} (${Se}) ${(new Date).toISOString()}`,...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach(((e,n)=>{t[n]=e}))}catch(r){}return n.searchParams.forEach(((e,n)=>{t[n]=e})),t}(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),et()&&this.detectSessionInUrl&&"none"!==n){const{data:r,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return Ie(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:s}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",s),await this._saveSession(o),setTimeout((async()=>{"recovery"===s?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ie(t)?{error:t}:{error:new Me("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const a=await vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:yt}),{data:o,error:s}=a;if(s||!o)return{data:{user:null,session:null},error:s};const i=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(a){if(Ie(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,n,r;try{let a;if("email"in e){const{email:n,password:r,options:o}=e;let s=null,i=null;"pkce"===this.flowType&&([s,i]=await ut(this.storage,this.storageKey)),a=await vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null===o||void 0===o?void 0:o.emailRedirectTo,body:{email:n,password:r,data:null!==(t=null===o||void 0===o?void 0:o.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken},code_challenge:s,code_challenge_method:i},xform:yt})}else{if(!("phone"in e))throw new Fe("You must provide either an email or phone number and a password");{const{phone:t,password:o,options:s}=e;a=await vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:o,data:null!==(n=null===s||void 0===s?void 0:s.data)&&void 0!==n?n:{},channel:null!==(r=null===s||void 0===s?void 0:s.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:yt})}}const{data:o,error:s}=a;if(s||!o)return{data:{user:null,session:null},error:s};const i=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(a){if(Ie(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:r,options:a}=e;t=await vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:bt})}else{if(!("phone"in e))throw new Fe("You must provide either an email or phone number and a password");{const{phone:n,password:r,options:a}=e;t=await vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:bt})}}const{data:n,error:r}=t;return r?{data:{user:null,session:null},error:r}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r}):{data:{user:null,session:null},error:new $e}}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await ot(this.storage,`${this.storageKey}-code-verifier`),[n,r]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:a}=await vt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:yt});if(await st(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==r&&void 0!==r?r:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new $e}}catch(a){if(Ie(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:a,nonce:o}=e,s=await vt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:r,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:yt}),{data:i,error:l}=s;return l?{data:{user:null,session:null},error:l}:i&&i.session&&i.user?(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:i,error:l}):{data:{user:null,session:null},error:new $e}}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,r,a,o;try{if("email"in e){const{email:r,options:a}=e;let o=null,s=null;"pkce"===this.flowType&&([o,s]=await ut(this.storage,this.storageKey));const{error:i}=await vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(n=null===a||void 0===a?void 0:a.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:o,code_challenge_method:s},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:t,options:n}=e,{data:s,error:i}=await vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null===n||void 0===n?void 0:n.data)&&void 0!==r?r:{},create_user:null===(a=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(o=null===n||void 0===n?void 0:n.channel)&&void 0!==o?o:"sms"}});return{data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:i}}throw new Fe("You must provide either an email or phone number.")}catch(s){if(Ie(s))return{data:{user:null,session:null},error:s};throw s}}async verifyOtp(e){var t,n;try{let r,a;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:o,error:s}=await vt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:yt});if(s)throw s;if(!o)throw new Error("An error occurred on token verification.");const i=o.session,l=o.user;return(null===i||void 0===i?void 0:i.access_token)&&(await this._saveSession(i),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(r){if(Ie(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,n,r;try{let a=null,o=null;return"pkce"===this.flowType&&([a,o]=await ut(this.storage,this.storageKey)),await vt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:_t})}catch(a){if(Ie(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Le;const{error:r}=await vt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:r,options:a}=e,{error:o}=await vt(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:n,type:r,options:a}=e,{data:o,error:s}=await vt(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null===o||void 0===o?void 0:o.message_id},error:s}}throw new Fe("You must provide either an email or phone number and a type")}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(e){}})()),n}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await ot(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<ke;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,r)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,r))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:xt}):await this._useSession((async e=>{var t,n,r;const{data:a,error:o}=e;if(o)throw o;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(n=a.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0,xform:xt}):{data:{user:null},error:new Le}}))}catch(t){if(Ie(t))return function(e){return Ie(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await st(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async n=>{const{data:r,error:a}=n;if(a)throw a;if(!r.session)throw new Le;const o=r.session;let s=null,i=null;"pkce"===this.flowType&&null!=e.email&&([s,i]=await ut(this.storage,this.storageKey));const{data:l,error:c}=await vt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:i}),jwt:o.access_token,xform:xt});if(c)throw c;return o.user=l.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}}))}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Le;const t=Date.now()/1e3;let n=t,r=!0,a=null;const{payload:o}=lt(e.access_token);if(o.exp&&(n=o.exp,r=n<=t),r){const{session:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:r,error:o}=await this._getUser(e.access_token);if(o)throw o;a={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Ie(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var n;if(!e){const{data:r,error:a}=t;if(a)throw a;e=null!==(n=r.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Le;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!et())throw new ze("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ze(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Be("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new ze("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Be("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:a,refresh_token:o,expires_in:s,expires_at:i,token_type:l}=e;if(!a||!s||!o||!l)throw new ze("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(s);let u=c+d;i&&(u=parseInt(i));const h=u-c;1e3*h<=je&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const p=u-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,u,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,u,c);const{data:m,error:f}=await this._getUser(a);if(f)throw f;const g={provider_token:n,provider_refresh_token:r,access_token:a,expires_in:d,expires_at:u,refresh_token:o,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(n){if(Ie(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ot(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var n;const{data:r,error:a}=t;if(a)return{error:a};const o=null===(n=r.session)||void 0===n?void 0:n.access_token;if(o){const{error:t}=await this.admin.signOut(o,e);if(t&&(!function(e){return Ie(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await st(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession((async t=>{var n,r;try{const{data:{session:r},error:a}=t;if(a)throw a;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(a){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=null;"pkce"===this.flowType&&([n,r]=await ut(this.storage,this.storageKey,!0));try{return await vt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Ie(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:r}=await this._useSession((async t=>{var n,r,a,o,s;const{data:i,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await vt(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(s=null===(o=i.session)||void 0===o?void 0:o.access_token)&&void 0!==s?s:void 0})}));if(r)throw r;return et()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),{data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null}}catch(n){if(Ie(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var n,r;const{data:a,error:o}=t;if(o)throw o;return await vt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(n=a.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0})}))}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await vt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:yt})),r=(e,t)=>{const n=200*Math.pow(2,e);return t&&We(t)&&Date.now()+n-a<je},new Promise(((e,t)=>{(async()=>{for(let o=0;o<1/0;o++)try{const t=await n(o);if(!r(o,null,t))return void e(t)}catch(a){if(!r(o,a))return void t(a)}})()})))}catch(a){if(this._debug(t,"error",a),Ie(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var n,r}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),et()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await ot(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n))return this._debug(t,"session is not valid"),void(null!==n&&await this._removeSession());const r=1e3*(null!==(e=n.expires_at)&&void 0!==e?e:1/0)-Date.now()<ke;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),We(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){return this._debug(t,"error",n),void console.error(n)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Le;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new it;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new Le;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(a){if(this._debug(r,"error",a),Ie(a)){const e={session:null,error:a};return We(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map((async n=>{try{await n.callback(e,t)}catch(a){r.push(a)}}));if(await Promise.all(a),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await at(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await st(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&et()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),je);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*n.expires_at-t)/je);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(n.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof Dt))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!et()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=[`provider=${encodeURIComponent(t)}`];if((null===n||void 0===n?void 0:n.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),(null===n||void 0===n?void 0:n.scopes)&&r.push(`scopes=${encodeURIComponent(n.scopes)}`),"pkce"===this.flowType){const[e,t]=await ut(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);r.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&r.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var n;const{data:r,error:a}=t;return a?{data:null,error:a}:await vt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var n,r;const{data:a,error:o}=t;if(o)return{data:null,error:o};const s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:i,error:l}=await vt(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null===i||void 0===i?void 0:i.totp)||void 0===r?void 0:r.qr_code)&&(i.totp.qr_code=`data:image/svg+xml;utf-8,${i.totp.qr_code}`),{data:i,error:null})}))}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:o,error:s}=await vt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:s})}))}catch(t){if(Ie(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:a}=t;return a?{data:null,error:a}:await vt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(t){if(Ie(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(null===e||void 0===e?void 0:e.factors)||[],r=n.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),a=n.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:n,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,n;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=lt(r.access_token);let s=null;o.aal&&(s=o.aal);let i=s;(null!==(n=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==n?n:[]).length>0&&(i="aal2");return{data:{currentLevel:s,nextLevel:i,currentAuthenticationMethods:o.amr||[]},error:null}}))))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find((t=>t.kid===e));if(t)return t;if(t=this.jwks.keys.find((t=>t.kid===e)),t&&this.jwks_cached_at+6e5>Date.now())return t;const{data:n,error:r}=await vt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(r)throw r;if(!n.keys||0===n.keys.length)throw new He("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),t=n.keys.find((t=>t.kid===e)),!t)throw new He("No matching signing key found in JWKS");return t}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]};try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};n=e.session.access_token}const{header:r,payload:a,signature:o,raw:{header:s,payload:i}}=lt(n);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:a,header:r,signature:o},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),c=await this.fetchJwk(r.kid,t),d=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!await crypto.subtle.verify(l,d,o,function(e){const t=[];return Xe(e,(e=>t.push(e))),new Uint8Array(t)}(`${s}.${i}`)))throw new He("Invalid JWT signature");return{data:{claims:a,header:r,signature:o},error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}}Rt.nextInstanceID=0;const Mt=Rt;class Ot extends Mt{constructor(e){super(e)}}var Lt=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function i(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))};class $t{constructor(e,t,n){var r,a,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const s=e.replace(/\/$/,"");this.realtimeUrl=`${s}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,this.functionsUrl=`${s}/functions/v1`;const i=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:n,auth:r,realtime:a,global:o}=e,{db:s,auth:i,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},s),n),auth:Object.assign(Object.assign({},i),r),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},c),o),accessToken:()=>Ee(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!==n&&void 0!==n?n:{},{db:ve,realtime:be,auth:Object.assign(Object.assign({},ye),{storageKey:i}),global:ge});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(a=l.global.headers)&&void 0!==a?a:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(o=l.auth)&&void 0!==o?o:{},this.headers,l.global.fetch),this.fetch=Ne(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new u(`${s}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new me(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Lt(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:r,persistSession:a,detectSessionInUrl:o,storage:s,storageKey:i,flowType:l,lock:c,debug:d}=e;const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ot({url:this.authUrl,headers:Object.assign(Object.assign({},u),t),storageKey:i,autoRefreshToken:r,persistSession:a,detectSessionInUrl:o,storage:s,flowType:l,lock:c,debug:d,fetch:n,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new H(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=n}}const Ft=(e,t,n)=>new $t(e,t,n)},829:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(736));t.default=class{constructor(e,t){let{headers:n={},schema:r,fetch:a}=t;this.url=e,this.headers=n,this.schema=r,this.fetch=a}select(e){let{head:t=!1,count:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t?"HEAD":"GET";let o=!1;const s=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!o?"":('"'===e&&(o=!o),e))).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new a.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),n||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:o=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=[`resolution=${n?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),o||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new a.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new a.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},980:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const a=r(n(210));t.PostgrestClient=a.default;const o=r(n(829));t.PostgrestQueryBuilder=o.default;const s=r(n(736));t.PostgrestFilterBuilder=s.default;const i=r(n(374));t.PostgrestTransformBuilder=i.default;const l=r(n(286));t.PostgrestBuilder=l.default;const c=r(n(611));t.PostgrestError=c.default,t.default={PostgrestClient:a.default,PostgrestQueryBuilder:o.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:l.default,PostgrestError:c.default}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var i=2&a&&r;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,n.d(o,s),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{198:"f77ab7e2",453:"42e6a660"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="fincentiva-crm:";n.l=(r,a,o,s)=>{if(e[r])e[r].push(a);else{var i,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+o){i=u;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+o),i.src=r),e[r]=[a];var h=(t,n)=>{i.onerror=i.onload=null,clearTimeout(p);var a=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=h.bind(null,i.onerror),i.onload=h.bind(null,i.onload),l&&document.head.appendChild(i)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var o=new Promise(((n,r)=>a=e[t]=[n,r]));r.push(a[2]=o);var s=n.p+n.u(t),i=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",i.name="ChunkLoadError",i.type=o,i.request=s,a[1](i)}}),"chunk-"+t,t)}};var t=(t,r)=>{var a,o,s=r[0],i=r[1],l=r[2],c=0;if(s.some((t=>0!==e[t]))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(l)l(n)}for(t&&t(r);c<s.length;c++)o=s[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkfincentiva_crm=self.webpackChunkfincentiva_crm||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r,a=n(43),o=n.t(a,2),s=n(391),i=n(950),l=n.t(i,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const d="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function p(e,t){return{usr:e.state,key:e.key,idx:t}}function m(e,t,n,r){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function f(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function g(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function v(e,t,n,a){void 0===a&&(a={});let{window:o=document.defaultView,v5Compat:s=!1}=a,i=o.history,l=r.Pop,h=null,g=v();function v(){return(i.state||{idx:null}).idx}function y(){l=r.Pop;let e=v(),t=null==e?null:e-g;g=e,h&&h({action:l,location:x.location,delta:t})}function b(e){let t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"===typeof e?e:f(e);return n=n.replace(/ $/,"%20"),u(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,i.replaceState(c({},i.state,{idx:g}),""));let x={get action(){return l},get location(){return e(o,i)},listen(e){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(d,y),h=e,()=>{o.removeEventListener(d,y),h=null}},createHref:e=>t(o,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=r.Push;let a=m(x.location,e,t);n&&n(a,e),g=v()+1;let c=p(a,g),d=x.createHref(a);try{i.pushState(c,"",d)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;o.location.assign(d)}s&&h&&h({action:l,location:x.location,delta:1})},replace:function(e,t){l=r.Replace;let a=m(x.location,e,t);n&&n(a,e),g=v();let o=p(a,g),c=x.createHref(a);i.replaceState(o,"",c),s&&h&&h({action:l,location:x.location,delta:0})},go:e=>i.go(e)};return x}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,n){return void 0===n&&(n="/"),x(e,t,n,!1)}function x(e,t,n,r){let a=R(("string"===typeof t?g(t):t).pathname||"/",n);if(null==a)return null;let o=_(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(o);let s=null;for(let i=0;null==s&&i<o.length;++i){let e=I(a);s=A(o[i],e,r)}return s}function _(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(e,a,o)=>{let s={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(u(s.relativePath.startsWith(r),'Absolute route path "'+s.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(r.length));let i=F([r,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+i+'".'),_(e.children,t,l,i)),(null!=e.path||e.index)&&t.push({path:i,score:T(i,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of w(e.path))a(e,t,r);else a(e,t)})),t}function w(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return a?[o,""]:[o];let s=w(r.join("/")),i=[];return i.push(...s.map((e=>""===e?o:[o,e].join("/")))),a&&i.push(...s),i.map((t=>e.startsWith("/")&&""===t?"/":t))}const N=/^:[\w-]+$/,E=3,S=2,j=1,k=10,C=-2,D=e=>"*"===e;function T(e,t){let n=e.split("/"),r=n.length;return n.some(D)&&(r+=C),t&&(r+=S),n.filter((e=>!D(e))).reduce(((e,t)=>e+(N.test(t)?E:""===t?j:k)),r)}function A(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,a={},o="/",s=[];for(let i=0;i<r.length;++i){let e=r[i],l=i===r.length-1,c="/"===o?t:t.slice(o.length)||"/",d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),s.push({params:a,pathname:F([o,d.pathname]),pathnameBase:z(F([o,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(o=F([o,d.pathnameBase]))}return s}function P(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let o=new RegExp(a,t?void 0:"i");return[o,r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],s=o.replace(/(.)\/+$/,"$1"),i=a.slice(1),l=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=i[n]||"";s=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=i[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:o,pathnameBase:s,pattern:e}}function I(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function M(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function O(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function L(e,t){let n=O(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function $(e,t,n,r){let a;void 0===r&&(r=!1),"string"===typeof e?a=g(e):(a=c({},e),u(!a.pathname||!a.pathname.includes("?"),M("?","pathname","search",a)),u(!a.pathname||!a.pathname.includes("#"),M("#","pathname","hash",a)),u(!a.search||!a.search.includes("#"),M("#","search","hash",a)));let o,s=""===e||""===a.pathname,i=s?"/":a.pathname;if(null==i)o=n;else{let e=t.length-1;if(!r&&i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:a=""}="string"===typeof e?g(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:B(r),hash:U(a)}}(a,o),d=i&&"/"!==i&&i.endsWith("/"),h=(s||"."===i)&&n.endsWith("/");return l.pathname.endsWith("/")||!d&&!h||(l.pathname+="/"),l}const F=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),B=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",U=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const V=["post","put","patch","delete"],H=(new Set(V),["get",...V]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q.apply(this,arguments)}const Y=a.createContext(null);const J=a.createContext(null);const Q=a.createContext(null);const K=a.createContext(null);const G=a.createContext({outlet:null,matches:[],isDataRoute:!1});const X=a.createContext(null);function Z(){return null!=a.useContext(K)}function ee(){return Z()||u(!1),a.useContext(K).location}function te(e){a.useContext(Q).static||a.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=a.useContext(G);return e?function(){let{router:e}=pe(ue.UseNavigateStable),t=fe(he.UseNavigateStable),n=a.useRef(!1);te((()=>{n.current=!0}));let r=a.useCallback((function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,q({fromRouteId:t},a)))}),[e,t]);return r}():function(){Z()||u(!1);let e=a.useContext(Y),{basename:t,future:n,navigator:r}=a.useContext(Q),{matches:o}=a.useContext(G),{pathname:s}=ee(),i=JSON.stringify(L(o,n.v7_relativeSplatPath)),l=a.useRef(!1);te((()=>{l.current=!0}));let c=a.useCallback((function(n,a){if(void 0===a&&(a={}),!l.current)return;if("number"===typeof n)return void r.go(n);let o=$(n,JSON.parse(i),s,"path"===a.relative);null==e&&"/"!==t&&(o.pathname="/"===o.pathname?t:F([t,o.pathname])),(a.replace?r.replace:r.push)(o,a.state,a)}),[t,r,i,s,e]);return c}()}function re(){let{matches:e}=a.useContext(G),t=e[e.length-1];return t?t.params:{}}function ae(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=a.useContext(Q),{matches:o}=a.useContext(G),{pathname:s}=ee(),i=JSON.stringify(L(o,r.v7_relativeSplatPath));return a.useMemo((()=>$(e,JSON.parse(i),s,"path"===n)),[e,i,s,n])}function oe(e,t,n,o){Z()||u(!1);let{navigator:s,static:i}=a.useContext(Q),{matches:l}=a.useContext(G),c=l[l.length-1],d=c?c.params:{},h=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let p,m=ee();if(t){var f;let e="string"===typeof t?g(t):t;"/"===h||(null==(f=e.pathname)?void 0:f.startsWith(h))||u(!1),p=e}else p=m;let v=p.pathname||"/",y=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=!i&&n&&n.matches&&n.matches.length>0?n.matches:b(e,{pathname:y});let _=de(x&&x.map((e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:F([h,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:F([h,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,o);return t&&_?a.createElement(K.Provider,{value:{location:q({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:r.Pop}},_):_}function se(){let e=function(){var e;let t=a.useContext(X),n=me(he.UseRouteError),r=fe(he.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:o},n):null,null)}const ie=a.createElement(se,null);class le extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(G.Provider,{value:this.props.routeContext},a.createElement(X.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:n,children:r}=e,o=a.useContext(Y);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(G.Provider,{value:t},r)}function de(e,t,n,r){var o;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var s;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(s=r)&&s.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let i=e,l=null==(o=n)?void 0:o.errors;if(null!=l){let e=i.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||u(!1),i=i.slice(0,Math.min(i.length,e+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let a=0;a<i.length;a++){let e=i[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=a),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){c=!0,i=d>=0?i.slice(0,d+1):[i[0]];break}}}return i.reduceRight(((e,r,o)=>{let s,u=!1,h=null,p=null;var m;n&&(s=l&&r.route.id?l[r.route.id]:void 0,h=r.route.errorElement||ie,c&&(d<0&&0===o?(m="route-fallback",!1||ge[m]||(ge[m]=!0),u=!0,p=null):d===o&&(u=!0,p=r.route.hydrateFallbackElement||null)));let f=t.concat(i.slice(0,o+1)),g=()=>{let t;return t=s?h:u?p:r.route.Component?a.createElement(r.route.Component,null):r.route.element?r.route.element:e,a.createElement(ce,{match:r,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===o)?a.createElement(le,{location:n.location,revalidation:n.revalidation,component:h,error:s,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()}),null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),he=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(he||{});function pe(e){let t=a.useContext(Y);return t||u(!1),t}function me(e){let t=a.useContext(J);return t||u(!1),t}function fe(e){let t=function(){let e=a.useContext(G);return e||u(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||u(!1),n.route.id}const ge={};function ve(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}o.startTransition;function ye(e){let{to:t,replace:n,state:r,relative:o}=e;Z()||u(!1);let{future:s,static:i}=a.useContext(Q),{matches:l}=a.useContext(G),{pathname:c}=ee(),d=ne(),h=$(t,L(l,s.v7_relativeSplatPath),c,"path"===o),p=JSON.stringify(h);return a.useEffect((()=>d(JSON.parse(p),{replace:n,state:r,relative:o})),[d,p,o,n,r]),null}function be(e){u(!1)}function xe(e){let{basename:t="/",children:n=null,location:o,navigationType:s=r.Pop,navigator:i,static:l=!1,future:c}=e;Z()&&u(!1);let d=t.replace(/^\/*/,"/"),h=a.useMemo((()=>({basename:d,navigator:i,static:l,future:q({v7_relativeSplatPath:!1},c)})),[d,c,i,l]);"string"===typeof o&&(o=g(o));let{pathname:p="/",search:m="",hash:f="",state:v=null,key:y="default"}=o,b=a.useMemo((()=>{let e=R(p,d);return null==e?null:{location:{pathname:e,search:m,hash:f,state:v,key:y},navigationType:s}}),[d,p,m,f,v,y,s]);return null==b?null:a.createElement(Q.Provider,{value:h},a.createElement(K.Provider,{children:n,value:b}))}function _e(e){let{children:t,location:n}=e;return oe(we(t),n)}new Promise((()=>{}));a.Component;function we(e,t){void 0===t&&(t=[]);let n=[];return a.Children.forEach(e,((e,r)=>{if(!a.isValidElement(e))return;let o=[...t,r];if(e.type===a.Fragment)return void n.push.apply(n,we(e.props.children,o));e.type!==be&&u(!1),e.props.index&&e.props.children&&u(!1);let s={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=we(e.props.children,o)),n.push(s)})),n}function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ne.apply(this,arguments)}function Ee(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Se=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Yv){}new Map;const je=o.startTransition;l.flushSync,o.useId;function ke(e){let{basename:t,children:n,future:r,window:o}=e,s=a.useRef();var i;null==s.current&&(s.current=(void 0===(i={window:o,v5Compat:!0})&&(i={}),v((function(e,t){let{pathname:n,search:r,hash:a}=e.location;return m("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:f(t)}),null,i)));let l=s.current,[c,d]=a.useState({action:l.action,location:l.location}),{v7_startTransition:u}=r||{},h=a.useCallback((e=>{u&&je?je((()=>d(e))):d(e)}),[d,u]);return a.useLayoutEffect((()=>l.listen(h)),[l,h]),a.useEffect((()=>ve(r)),[r]),a.createElement(xe,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const Ce="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,De=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Te=a.forwardRef((function(e,t){let n,{onClick:r,relative:o,reloadDocument:s,replace:i,state:l,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,m=Ee(e,Se),{basename:g}=a.useContext(Q),v=!1;if("string"===typeof d&&De.test(d)&&(n=d,Ce))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=R(t.pathname,g);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:v=!0}catch(Yv){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;Z()||u(!1);let{basename:r,navigator:o}=a.useContext(Q),{hash:s,pathname:i,search:l}=ae(e,{relative:n}),c=i;return"/"!==r&&(c="/"===i?r:F([r,i])),o.createHref({pathname:c,search:l,hash:s})}(d,{relative:o}),b=function(e,t){let{target:n,replace:r,state:o,preventScrollReset:s,relative:i,viewTransition:l}=void 0===t?{}:t,c=ne(),d=ee(),u=ae(e,{relative:i});return a.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:f(d)===f(u);c(e,{replace:n,state:o,preventScrollReset:s,relative:i,viewTransition:l})}}),[d,c,u,r,o,n,e,s,i,l])}(d,{replace:i,state:l,target:c,preventScrollReset:h,relative:o,viewTransition:p});return a.createElement("a",Ne({},m,{href:n||y,onClick:v||s?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:c}))}));var Ae,Pe;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ae||(Ae={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Pe||(Pe={}));var Ie=n(799);const Re="SUPERADMIN",Me="ADVISOR",Oe="COMPANY_ADMIN",Le={[Re]:"Administrador",[Me]:"Asesor",[Oe]:"Admin de Empresa"};var $e=n(579);const Fe="crm_user",ze="crm_token",Be="crm_token_exp",Ue=(0,a.createContext)(void 0),We=()=>{const e=(0,a.useContext)(Ue);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},Ve=e=>{let{children:t}=e;const[n,r]=(0,a.useState)(null),[o,s]=(0,a.useState)(null),[i,l]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null),u=()=>`${Math.random().toString(36).substring(2,15)}${Date.now().toString(36)}`,h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;const n=new Date;n.setHours(n.getHours()+t),localStorage.setItem(ze,e),localStorage.setItem(Be,n.toISOString())};(0,a.useEffect)((()=>{(()=>{try{const e=localStorage.getItem(ze);if(e&&!(()=>{const e=localStorage.getItem(Be);if(!e)return!0;const t=new Date(e);return new Date>t})()){const e=localStorage.getItem(Fe);e&&r(JSON.parse(e))}else e&&(console.log("La sesi\xf3n ha expirado"),localStorage.removeItem(ze),localStorage.removeItem(Be),localStorage.removeItem(Fe))}catch(c){console.error("Error checking stored session:",c)}finally{l(!1)}})();const e=e=>{e.key===Fe&&(e.newValue?r(JSON.parse(e.newValue)):(r(null),s(null)))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}),[]);const p={user:n,session:o,loading:i,error:c,signIn:async(e,t)=>{try{if(l(!0),d(null),"admin@fincentiva.com"===e&&"admin123"===t){const e={id:"1",email:"admin@fincentiva.com",name:"Administrador",role:"SUPERADMIN"},t=u();return h(t),localStorage.setItem(Fe,JSON.stringify(e)),r(e),{data:{user:e},error:null}}const n="Credenciales inv\xe1lidas";return d(new Error(n)),{data:null,error:n}}catch(c){return console.error("Error signing in:",c),d(c instanceof Error?c:new Error("Error al iniciar sesi\xf3n")),{error:c,data:null}}finally{l(!1)}},signInWithCode:async(e,t)=>{try{l(!0),d(null),console.log("Starting signInWithCode process..."),console.log(`Attempting to authenticate ${t} with code: ${e}`);const o="https://ydnygntfkrleiseuciwq.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczOTk5MjQwNiwiZXhwIjoyMDU1NTY4NDA2fQ.TwhEGW9DK4DTQQRquT6Z9UW8T8UjLX-hp9uKdRjWAhs";console.log("Creating Supabase client with URL:",o);const i=(0,Ie.UU)(o,s);let c=null,p=null;try{if(t===Me){console.log("Querying advisors table...");const{data:t,error:n}=await i.from("advisors").select("*").eq("access_code",e).limit(1);c=t&&t.length>0?t[0]:null,p=n,console.log("Advisors query result:",{dataFound:!!c,error:p?p.message:null})}else{if(t!==Oe)return console.error("Invalid user type:",t),{data:null,error:"Tipo de usuario no v\xe1lido"};{var n;console.log("Querying company_admins table...");const{error:t}=await i.from("company_admins").select("id").limit(1);if(t&&"object"===typeof t&&"message"in t&&null!==(n=t.message)&&void 0!==n&&n.includes('relation "company_admins" does not exist')){console.error("The company_admins table does not exist in the database");const{data:t,error:n}=await i.from("advisors").select("*").eq("access_code",e).limit(1);c=t&&t.length>0?t[0]:null,p=n,console.log("Fallback to advisors table result:",{dataFound:!!c,error:p?p.message:null})}else{const{data:t,error:n}=await i.from("company_admins").select("*").eq("access_code",e).limit(1);c=t&&t.length>0?t[0]:null,p=n,console.log("Company admins query result:",{dataFound:!!c,error:p?p.message:null})}}}}catch(a){console.error("Error during database query:",a),p=a}if(p){console.error("Database error:",p);return{data:null,error:"Error de base de datos: "+(p instanceof Error||p.message?p.message||p.toString():"Error desconocido")}}if(!c)return console.log("No user found with provided access code"),{data:null,error:"C\xf3digo de acceso inv\xe1lido"};console.log("User data found:",{id:c.id,email:c.email,role:t});const m={id:c.id,email:c.email,name:c.name,role:t,entityId:t===Oe?c.company_id:c.id,companyId:c.company_id||null},f=u();return h(f),localStorage.setItem(Fe,JSON.stringify(m)),r(m),console.log("Login successful, user info stored in localStorage"),{data:{user:m},error:null}}catch(c){console.error("Error signing in with code:",c);const t=c instanceof Error?c:new Error("Error al iniciar sesi\xf3n");return d(t),{error:t.message,data:null}}finally{l(!1)}},signOut:async()=>{try{localStorage.removeItem(Fe),localStorage.removeItem(ze),localStorage.removeItem(Be),r(null),s(null)}catch(c){console.error("Error signing out:",c)}},setUser:r};return(0,$e.jsx)(Ue.Provider,{value:p,children:t})};let He=function(e){return e.VIEW_APPLICATIONS="VIEW_APPLICATIONS",e.CREATE_APPLICATION="CREATE_APPLICATION",e.EDIT_APPLICATION="EDIT_APPLICATION",e.CHANGE_APPLICATION_STATUS="CHANGE_APPLICATION_STATUS",e.ASSIGN_APPLICATION="ASSIGN_APPLICATION",e.DELETE_APPLICATION="DELETE_APPLICATION",e.VIEW_COMPANIES="VIEW_COMPANIES",e.CREATE_COMPANY="CREATE_COMPANY",e.EDIT_COMPANY="EDIT_COMPANY",e.DELETE_COMPANY="DELETE_COMPANY",e.ASSIGN_COMPANY_ADMIN="ASSIGN_COMPANY_ADMIN",e.VIEW_CLIENTS="VIEW_CLIENTS",e.CREATE_CLIENT="CREATE_CLIENT",e.EDIT_CLIENT="EDIT_CLIENT",e.DELETE_CLIENT="DELETE_CLIENT",e.VIEW_ADVISORS="VIEW_ADVISORS",e.CREATE_ADVISOR="CREATE_ADVISOR",e.EDIT_ADVISOR="EDIT_ADVISOR",e.DELETE_ADVISOR="DELETE_ADVISOR",e.VIEW_DASHBOARD="VIEW_DASHBOARD",e.VIEW_REPORTS="VIEW_REPORTS",e.UPLOAD_DOCUMENTS="UPLOAD_DOCUMENTS",e}({});const qe={[Re]:Object.values(He),[Me]:[He.VIEW_APPLICATIONS,He.CREATE_APPLICATION,He.EDIT_APPLICATION,He.CHANGE_APPLICATION_STATUS,He.VIEW_COMPANIES,He.VIEW_CLIENTS,He.CREATE_CLIENT,He.EDIT_CLIENT,He.VIEW_DASHBOARD,He.UPLOAD_DOCUMENTS],[Oe]:[He.VIEW_APPLICATIONS,He.VIEW_COMPANIES,He.VIEW_CLIENTS,He.VIEW_DASHBOARD,He.CHANGE_APPLICATION_STATUS]};function Ye(e,t){var n;return e&&t&&(null===(n=qe[e])||void 0===n?void 0:n.includes(t))||!1}const Je=(0,a.createContext)(void 0),Qe=()=>{const e=(0,a.useContext)(Je);if(void 0===e)throw new Error("usePermissions must be used within a PermissionsProvider");return e},Ke=e=>{let{children:t}=e;const{user:n}=We(),[r,o]=(0,a.useState)([]),s={userCan:e=>!(!n||!n.role)&&(n.role===Re||Ye(n.role,e)),userCanAll:e=>!(!n||!n.role)&&(n.role===Re||function(e,t){return!(!e||!t.length)&&t.every((t=>Ye(e,t)))}(n.role,e)),userCanAny:e=>!(!n||!n.role)&&(n.role===Re||function(e,t){return!(!e||!t.length)&&t.some((t=>Ye(e,t)))}(n.role,e)),shouldFilterByEntity:()=>!(!n||!n.role)&&(n.role===Me||n.role===Oe),getEntityFilter:()=>n&&n.role&&n.entityId?n.role===Re?null:n.role===Me?(console.log(`[getEntityFilter] Enforcing STRICT advisor filter: advisor_id=${n.entityId}`),{advisor_id:n.entityId}):n.role===Oe?(console.log(`[getEntityFilter] Company admin filter: company_id=${n.entityId}`),{company_id:n.entityId}):null:null,isAdmin:()=>(null===n||void 0===n?void 0:n.role)===Re,isAdvisor:()=>(null===n||void 0===n?void 0:n.role)===Me,isCompanyAdmin:()=>(null===n||void 0===n?void 0:n.role)===Oe,loadPermissions:async()=>{}};return(0,$e.jsx)(Je.Provider,{value:s,children:t})};function Ge(e,t){let{title:n,titleId:r,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Xe=a.forwardRef(Ge),Ze={};if("undefined"!==typeof window){const e=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{const r=new Audio(t);r.volume=.2,r.addEventListener("canplaythrough",(()=>{Ze[t]=r,console.log(`Successfully preloaded sound: ${t}`)})),r.addEventListener("error",(r=>{console.warn(`Error preloading sound ${t}:`,r),n<2&&setTimeout((()=>e(t,n+1)),1e3)})),r.load()}catch(r){console.error(`Failed to preload sound ${t}:`,r)}};["/sounds/clean-notification.mp3","/sounds/notification-simple.mp3","/sounds/triple-tone.mp3","/sounds/beep.mp3","/sounds/alert.mp3","/sounds/approval.mp3"].forEach((t=>e(t)))}if("undefined"!==typeof window&&!document.documentElement.hasAttribute("data-listeners-added")){document.documentElement.setAttribute("data-listeners-added","true");const e=["click","touchstart","keydown"],t=()=>{document.documentElement.setAttribute("data-user-interacted","true"),e.forEach((e=>{document.removeEventListener(e,t)}));try{const e=new Audio;e.volume=.01,e.play().catch((()=>{}))}catch(Yv){}};e.forEach((e=>{document.addEventListener(e,t)})),console.log("User interaction listeners added for sound enablement")}const et=e=>{let{title:t,message:n,type:r="info",duration:o=5e3,onClose:s,playSound:i=!0,soundType:l="notification",customSound:c,centerScreen:d=!1,relatedItemId:u}=e;const[h,p]=(0,a.useState)(!0),[m,f]=(0,a.useState)(!1),[g,v]=(0,a.useState)(!1),y=()=>{f(!0),setTimeout((()=>{p(!1),s&&s()}),300)};(0,a.useEffect)((()=>{if(o>0){const e=setTimeout((()=>{y()}),o);return()=>clearTimeout(e)}}),[o]),(0,a.useEffect)((()=>{i&&!g&&(v(!0),b())}),[i,c,l,g]);const b=()=>{try{const e=[c||"/sounds/clean-notification.mp3","/sounds/notification-simple.mp3","/sounds/triple-tone.mp3","/sounds/beep.mp3","/sounds/alert.mp3"],t=e=>new Promise(((t,n)=>{try{if(Ze[e]){const r=Ze[e];return r.currentTime=0,void r.play().then((()=>{console.log(`Successfully played preloaded sound: ${e}`),t()})).catch((t=>{console.warn(`Failed to play preloaded sound ${e}:`,t),n(t)}))}const r=new Audio(e);r.volume=.2,r.oncanplaythrough=()=>{r.play().then((()=>{console.log(`Successfully played sound: ${e}`),t()})).catch((t=>{console.warn(`Failed to play sound ${e}:`,t),n(t)}))},r.onerror=t=>{console.warn(`Error loading sound ${e}:`,t),n(t)},r.load(),setTimeout((()=>{n(new Error(`Timeout loading sound ${e}`))}),1500)}catch(r){console.warn(`Exception while trying to play ${e}:`,r),n(r)}})),n=r=>{if(r>=e.length)return void console.error("All sound playback attempts failed");const a=e[r];t(a).catch((()=>{n(r+1)}))};n(0)}catch(e){console.error("Failed to play notification sound:",e)}};if(!h)return null;const x={info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",title:"text-blue-900"},success:{bg:"bg-green-50",border:"border-green-200",text:"text-green-800",title:"text-green-900"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",title:"text-yellow-900"},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",title:"text-red-900"}},_=(e=>{switch(e){case"info":case"new_application":case"new_message":default:return"info";case"success":case"approval_required":case"application_status_updated":return"success";case"warning":return"warning";case"error":case"application_comment":return"error"}})(r),w=x[_]||x.info,N=d?"fixed inset-0 flex items-center justify-center z-50":"fixed top-5 right-5 z-50 max-w-md w-full",E=d?"w-full max-w-xl mx-4":"w-full",S=n&&n.trim().startsWith("<");return(0,$e.jsx)("div",{className:N,children:(0,$e.jsx)("div",{className:`${w.bg} ${w.border} ${w.text} rounded-lg shadow-lg p-4 border ${m?"animate-popup-exit":"animate-popup-entry"} ${E}`,children:(0,$e.jsxs)("div",{className:"flex justify-between items-start",children:[(0,$e.jsxs)("div",{className:"flex-1",children:[(0,$e.jsx)("h3",{className:`text-base font-semibold ${w.title}`,children:t}),(()=>{if(!S)return(0,$e.jsx)("div",{className:"mt-1 text-sm",children:n});const e=(new DOMParser).parseFromString(n,"text/html").body,t=e.querySelector("div");t&&t.className.includes("grid")&&(t.className="grid grid-cols-2 gap-2 text-sm mt-2");e.querySelectorAll(".font-semibold").forEach((e=>{e.className="font-semibold text-gray-700"}));const r=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Tipo:")}));if(r){var a;const t=null===(a=r.textContent)||void 0===a?void 0:a.trim().toLowerCase();if(t)if(t.includes("planes seleccionados")){const t=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Pago mensual:")}));t&&(t.className="text-gray-900 font-bold text-blue-600")}else if(t.includes("solicitud de efectivo")){const t=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Monto solicitado:")}));t&&(t.className="text-gray-900 font-bold text-green-600")}else if(t.includes("simulaci\xf3n de producto")){const t=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Monto:")}));t&&(t.className="text-gray-900 font-bold text-purple-600")}else if(t.includes("pr\xe9stamo")){const t=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Monto del pr\xe9stamo:")}));t&&(t.className="text-gray-900 font-bold text-orange-600")}}return Array.from(e.querySelectorAll("div")).filter((e=>e.previousElementSibling&&e.previousElementSibling.className.includes("font-semibold"))).forEach((e=>{e.className.includes("font-bold")||(e.className="text-gray-900")})),(0,$e.jsx)("div",{className:"mt-2 notification-content prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.innerHTML}})})()]}),(0,$e.jsx)("button",{onClick:y,className:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-500 focus:outline-none",children:(0,$e.jsx)(Xe,{className:"h-5 w-5"})})]})})})};var tt=n(509);let nt=function(e){return e.INFO="info",e.SUCCESS="success",e.WARNING="warning",e.ERROR="error",e.NEW_APPLICATION="new_application",e.APPROVAL_REQUIRED="approval_required",e.NEW_MESSAGE="new_message",e.APPLICATION_STATUS_UPDATED="application_status_updated",e.APPLICATION_COMMENT="application_comment",e}({});const rt=(0,a.createContext)(void 0),at=()=>{const e=(0,a.useContext)(rt);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e},ot=e=>{let{children:t}=e;const{user:n}=We(),[r,o]=(0,a.useState)([]),[s,i]=(0,a.useState)(0),[l,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(null),h=(0,a.useRef)(null),[p,m]=(0,a.useState)(new Map),f=(0,a.useRef)(!1),g=(0,a.useRef)(new Date),v=(0,a.useRef)(new Date);(0,a.useEffect)((()=>{if(n){b();try{const e=localStorage.getItem("notified_application_ids");if(e){const t=JSON.parse(e);if(Array.isArray(t)){const e=new Map,n=Date.now();t.forEach((t=>{e.set(t,n)})),m(e),x(e),console.log(`Converted ${e.size} notified application IDs from old format to new format`)}else if("object"===typeof t){const e=new Map;Object.entries(t).forEach((t=>{let[n,r]=t;e.set(n,r)})),m(e),console.log(`Loaded ${e.size} notified application IDs from localStorage`)}}else console.log("No previously notified applications found in localStorage");_()}catch(e){console.error("Error loading notified applications:",e),m(new Map)}v.current=new Date,g.current=new Date(Date.now()-1e4);const t=setTimeout((()=>{y(),h.current=setInterval((()=>{const e=new Date,t=e.getTime()-v.current.getTime(),n=e.getTime()-g.current.getTime();t>15e3&&n>5e3?E():console.log(`Skipping notification check (last check: ${(t/1e3).toFixed(1)}s ago, last notification: ${(n/1e3).toFixed(1)}s ago)`)}),2e4)}),5e3);return()=>{h.current&&clearInterval(h.current),clearTimeout(t)}}}),[n]);const y=async()=>{try{const{data:e,error:t}=await tt.ND.from("applications").select("id, created_at, application_type, client_name, company_name, status, amount").order("created_at",{ascending:!1}).limit(1);if(t)throw t;if(e&&e.length>0){const t=e[0],n=t.id,r=new Date(t.created_at);if(console.log(`System initialized with reference to last application: ${n} created at ${r.toISOString()}`),!p.has(n)){const e={notifiedAt:(new Date).toISOString(),notificationType:"initialization",applicationType:t.application_type,amount:t.amount,clientName:t.client_name,companyName:t.company_name,status:t.status};w(n,t.created_at,e)}}E()}catch(e){console.error("Error initializing with last application timestamp:",e),E()}};(0,a.useEffect)((()=>{const e=r.filter((e=>!e.read)).length;i(e)}),[r]);const b=async()=>{try{const e=localStorage.getItem("notifications");if(e){const t=JSON.parse(e);o(t.map((e=>({...e,createdAt:new Date(e.createdAt)}))))}}catch(e){console.error("Error loading notifications:",e)}},x=e=>{try{const t={};e.forEach(((e,n)=>{t[n]=e})),localStorage.setItem("notified_application_ids",JSON.stringify(t)),console.log(`Saved ${e.size} notified application IDs to localStorage`)}catch(t){console.error("Error saving notified applications:",t)}},_=()=>{try{const e=Date.now()-864e5;let t=0,n=0;const r=new Map;p.forEach(((a,o)=>{t++,a>e?r.set(o,a):n++})),n>0?(console.log(`Cleaned up ${n} old notification records (${t-n} retained)`),m(r),x(r)):t>0&&console.log(`No old notifications to clean up (${t} notifications are all within 24 hours)`)}catch(e){console.error("Error cleaning up old notifications:",e)}},w=(e,t,n)=>{if(p.has(e))console.log(`Application ${e} already marked as notified (duplicate protection)`);else try{let a;if(t)try{const e=new Date(t);a=e.getTime()+1e3,console.log(`Using application creation time for notification: ${e.toISOString()}`)}catch(r){console.warn(`Error parsing creation timestamp "${t}":`,r),a=Date.now()}else a=Date.now();const o=n||{notifiedAt:new Date(a).toISOString(),notificationType:"application"},s=new Map(p);s.set(e,a),m(s);try{const t=`notification_metadata_${e}`;localStorage.setItem(t,JSON.stringify(o))}catch(r){console.warn("Error saving notification metadata:",r)}x(s),g.current=new Date,console.log(`Marked application ${e} as notified at ${new Date(a).toISOString()}`)}catch(r){console.error("Error marking application as notified:",r)}},N=()=>"\n      SELECT id, client_name, application_type, company_name, created_at, status, \n             amount, term, interest_rate, monthly_payment, client_email, client_phone\n      FROM applications \n      WHERE created_at > NOW() - INTERVAL '30 seconds'\n      ORDER BY created_at DESC\n      LIMIT 5\n    ",E=async()=>{if(!f.current&&n){f.current=!0,v.current=new Date;try{console.log("Checking for new notifications..."),console.log(`${p.size} already notified application IDs: `,Array.from(p.keys()).slice(0,3).join(", "));let t="";try{t=await(async()=>{try{const{data:e,error:t}=await tt.ND.from("applications").select("application_type").order("created_at",{ascending:!1}).limit(1);if(t||!e||0===e.length)return console.warn("Error checking latest application type, using default query"),N();const n=e[0].application_type;console.log(`Latest application type: ${n}`);let r="";return r="",`\n        SELECT id, client_name, application_type, company_name, created_at, status, \n               amount, term, interest_rate, monthly_payment, client_email, client_phone ${r}\n        FROM applications \n        WHERE created_at > NOW() - INTERVAL '30 seconds'\n        ORDER BY created_at DESC\n        LIMIT 5\n      `}catch(e){return console.error("Error building optimized query:",e),N()}})(),console.log("Using optimized query for latest application type");const e=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})});if(e.ok){const t=await e.json();if(t.data&&t.data.length>0){console.log(`Received ${t.data.length} applications from the last 30 seconds`);const e=t.data.filter((e=>{if(p.has(e.id))return console.log(`Skipping already notified application: ${e.id}`),!1;const t=new Date(e.created_at);if((new Date).getTime()-t.getTime()>6e4){console.log(`Skipping too old application: ${e.id} created at ${t.toISOString()}`);const n={notifiedAt:(new Date).toISOString(),notificationType:"application",applicationType:e.application_type,amount:e.amount,clientName:e.client_name,companyName:e.company_name,status:e.status};return w(e.id,e.created_at,n),!1}return!0}));if(console.log(`Found ${e.length} new applications after filtering`),0===e.length)return console.log("No truly new applications found (already notified or too old)"),void(f.current=!1);const n=e[0],r=n.id;if(d&&d.relatedItemId===r)return console.log(`Already showing notification for application ${r} - skipping`),void(f.current=!1);console.log(`New application detected: ${r} (created ${new Date(n.created_at).toISOString()})`);const a={notifiedAt:(new Date).toISOString(),notificationType:"application",applicationType:n.application_type,amount:n.amount,clientName:n.client_name,companyName:n.company_name,status:n.status};w(r,n.created_at,a);const o=new Date(n.created_at),s=new Intl.DateTimeFormat("es-MX",{day:"2-digit",month:"2-digit",year:"numeric"}).format(o),i=new Intl.DateTimeFormat("es-MX",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(o),c=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(Number(n.amount||0)),u=null!==n.interest_rate&&void 0!==n.interest_rate?`${n.interest_rate}%`:"N/A",h=null!==n.monthly_payment&&void 0!==n.monthly_payment?new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(Number(n.monthly_payment)):"N/A";let m="No especificado";if(n.application_type){const e=n.application_type.replace(/\/$/,"");m="selected_plans"===e?"Planes seleccionados":"product_simulations"===e?"Simulaci\xf3n de producto":"cash_requests"===e?"Solicitud de efectivo":"car_backed_loan_applications"===e?"Pr\xe9stamo con garant\xeda de auto":"auto_loan_applications"===e?"Pr\xe9stamo para auto":e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}const v=(e,t)=>{const n=`\n                <div class="font-semibold text-gray-700">Cliente:</div>\n                <div class="text-gray-900">${t.client_name||"Sin nombre"}</div>\n                \n                <div class="font-semibold text-gray-700">Empresa:</div>\n                <div class="text-gray-900">${t.company_name||"No especificada"}</div>\n                \n                <div class="font-semibold text-gray-700">Tipo:</div>\n                <div class="text-gray-900">${e}</div>\n              `;let r="";r="selected_plans"===t.application_type?`\n                  <div class="font-semibold text-gray-700">Monto:</div>\n                  <div class="text-gray-900">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term||"N/A"} ${1===t.term?"mes":"meses"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                  \n                  <div class="font-semibold text-gray-700">Pago mensual:</div>\n                  <div class="text-gray-900">${h}</div>\n                `:"product_simulations"===t.application_type?`\n                  <div class="font-semibold text-gray-700">Monto:</div>\n                  <div class="text-gray-900 font-bold">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term&&t.term>0?t.term+(1===t.term?" mes":" meses"):"N/A"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                `:"cash_requests"===t.application_type?`\n                  <div class="font-semibold text-gray-700">Monto solicitado:</div>\n                  <div class="text-gray-900 font-bold">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term&&t.term>0?t.term+(1===t.term?" mes":" meses"):"N/A"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                `:"car_backed_loan_applications"===t.application_type||"auto_loan_applications"===t.application_type?`\n                  <div class="font-semibold text-gray-700">Monto del pr\xe9stamo:</div>\n                  <div class="text-gray-900 font-bold">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term&&t.term>0?t.term+(1===t.term?" mes":" meses"):"N/A"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                  \n                  <div class="font-semibold text-gray-700">Pago mensual:</div>\n                  <div class="text-gray-900">${h}</div>\n                `:`\n                  <div class="font-semibold text-gray-700">Monto:</div>\n                  <div class="text-gray-900">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term&&t.term>0?t.term+(1===t.term?" mes":" meses"):"N/A"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                  \n                  <div class="font-semibold text-gray-700">Pago mensual:</div>\n                  <div class="text-gray-900">${h}</div>\n                `;return`\n                <div class="grid grid-cols-2 gap-2 text-sm mt-2">\n                  ${n}\n                  ${r}\n                  ${`\n                <div class="font-semibold text-gray-700">Email:</div>\n                <div class="text-gray-900">${t.client_email||"No especificado"}</div>\n                \n                <div class="font-semibold text-gray-700">Tel\xe9fono:</div>\n                <div class="text-gray-900">${t.client_phone||"No especificado"}</div>\n                \n                <div class="font-semibold text-gray-700">Fecha:</div>\n                <div class="text-gray-900">${s} ${i}</div>\n              `}\n                </div>\n              `},y=v(m,n),b="\ud83d\udcbc Nueva solicitud recibida",x={title:b,message:`Cliente: ${n.client_name||"Sin nombre"} - ${n.company_name||"Empresa no especificada"}`,type:nt.NEW_APPLICATION,relatedItemType:"application",relatedItemId:r};S(x),j({title:b,message:y,type:nt.NEW_APPLICATION,playSound:l,soundType:"notification",duration:1e4,customSound:"/sounds/clean-notification.mp3",centerScreen:!0,relatedItemId:r}),g.current=new Date}else console.log("No new applications found in the past 30 seconds")}else console.warn("Failed to fetch notifications: server returned an error status")}catch(e){console.warn("Connection to database failed, skipping notification check")}}catch(t){console.error("Error checking for new notifications:",t)}finally{f.current=!1}}},S=e=>{const t={...e,id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),createdAt:new Date,read:!1,timestamp:new Date};o((e=>{const n=[t,...e];return localStorage.setItem("notifications",JSON.stringify(n)),n}))},j=e=>{d&&(d.title===e.title&&d.message===e.message||e.relatedItemId&&d.relatedItemId===e.relatedItemId)?console.log(`Ignoring duplicate popup: ${e.relatedItemId||"unknown ID"}`):(k(),console.log(`Showing popup: ${e.title} ${e.relatedItemId?`(ID: ${e.relatedItemId})`:""}`),setTimeout((()=>{u(e),setTimeout((()=>{u(null)}),e.duration||5e3)}),50))},k=()=>{d&&(console.log("Clearing existing popup"),u(null))},C={notifications:r,unreadCount:s,addNotification:S,markAsRead:e=>{o((t=>{const n=t.map((t=>t.id===e?{...t,read:!0,isRead:!0}:t));return localStorage.setItem("notifications",JSON.stringify(n)),n}))},markAllAsRead:()=>{o((e=>{const t=e.map((e=>({...e,read:!0,isRead:!0})));return localStorage.setItem("notifications",JSON.stringify(t)),t}))},clearNotifications:()=>{o([]),localStorage.setItem("notifications",JSON.stringify([]))},showPopup:j,soundEnabled:l,toggleSound:()=>{const e=!l;c(e),localStorage.setItem("notification_sound_enabled",e.toString())},setSoundEnabled:c};return(0,$e.jsxs)(rt.Provider,{value:C,children:[t,d&&(0,$e.jsx)(et,{title:d.title,message:d.message,type:d.type,duration:d.duration,playSound:d.playSound,soundType:d.soundType,customSound:d.customSound,onClose:()=>u(null),centerScreen:d.centerScreen})]})},st=e=>{let{children:t}=e;const n=We(),{user:r,loading:o}=n,s=n.error,i=ee(),[l,c]=a.useState(0),[d,u]=a.useState(!1),[h,p]=a.useState(!1);if(a.useEffect((()=>{if(!o)return;const e=setInterval((()=>{c((e=>e+1))}),1e3);return 8===l&&fetch("http://localhost:3100/health",{method:"GET"}).then((e=>{e.ok||p(!0)})).catch((()=>{p(!0)})),()=>clearInterval(e)}),[o,l]),o)return(0,$e.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-base-200 p-4",children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg text-primary"}),(0,$e.jsx)("p",{className:"mt-3 text-base-content",children:"Verificando sesi\xf3n..."}),l>10&&(0,$e.jsxs)("div",{className:"mt-6 max-w-md p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,$e.jsx)("p",{className:"text-yellow-700",children:"La verificaci\xf3n est\xe1 tomando m\xe1s tiempo de lo esperado."}),(0,$e.jsxs)("ul",{className:"mt-2 list-disc list-inside text-sm text-yellow-600",children:[(0,$e.jsx)("li",{children:"Aseg\xfarate de que el servidor est\xe1 funcionando correctamente"}),(0,$e.jsx)("li",{children:"Verifica tu conexi\xf3n a internet"}),(0,$e.jsx)("li",{children:"El servidor MCP debe estar ejecut\xe1ndose en el puerto 3100"}),h&&(0,$e.jsx)("li",{className:"text-red-600 font-semibold",children:"No se puede conectar al servidor MCP"}),s&&(0,$e.jsxs)("li",{className:"text-red-600 font-semibold",children:["Error: ",s.message]})]}),(0,$e.jsxs)("div",{className:"mt-4 flex flex-col space-y-2",children:[(0,$e.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600 transition-colors",children:"Recargar p\xe1gina"}),(0,$e.jsx)("button",{onClick:()=>window.location.href="/login",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"Ir a la p\xe1gina de login"})]})]})]});if(!r){const e="default"!==i.key;return(0,$e.jsx)(ye,{to:"/login",state:{from:i,sessionExpired:e},replace:!0})}return(0,$e.jsx)($e.Fragment,{children:t})},it=()=>{const[e,t]=(0,a.useState)(null),[n,r]=(0,a.useState)(null),[o,s]=(0,a.useState)(!0),[i,l]=(0,a.useState)(0),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)({}),p=async()=>{try{const{data:e,error:n}=await tt.ND.from("users").select("count",{count:"exact",head:!0});console.log("Supabase connection check:",{data:e,error:n}),t(!n),n&&h((e=>({...e,supabase:n.message})))}catch(Yv){const n=Yv instanceof Error?Yv.message:String(Yv);console.error("Supabase connection error:",Yv),t(!1),h((e=>({...e,supabase:n})))}},m=async()=>{try{const e=new AbortController,t=setTimeout((()=>e.abort()),1e4);console.log("Checking MCP connection at http://localhost:3100/health");const n=await fetch("http://localhost:3100/health",{method:"GET",signal:e.signal});if(clearTimeout(t),!n.ok){const e=await n.text();return console.error("MCP server responded with error:",n.status,e),r(!1),void h((t=>({...t,mcp:`Status ${n.status}: ${e.substring(0,100)}${e.length>100?"...":""}`})))}const a=await n.json();console.log("MCP server response:",a),r(!0)}catch(Yv){const t=Yv instanceof Error?Yv.message:String(Yv);console.warn("MCP server connection error:",Yv),r(!1),h((e=>({...e,mcp:t})))}};return(0,a.useEffect)((()=>{try{const e="true"===sessionStorage.getItem("healthcheck_dismissed"),t="true"===localStorage.getItem("healthcheck_dismissed");if(e||t)return console.log("\ud83d\udd15 HealthCheck was previously dismissed, hiding notification"),void d(!0)}catch(Yv){console.error("\u274c Could not read dismiss state from storage",Yv)}window.resetHealthCheckDismissed=()=>{try{sessionStorage.removeItem("healthcheck_dismissed"),sessionStorage.removeItem("healthcheck_dismissed_at"),localStorage.removeItem("healthcheck_dismissed"),localStorage.removeItem("healthcheck_dismissed_at"),d(!1),console.log("\u2705 HealthCheck dismiss state cleared. Notification will show again.")}catch(Yv){console.error("\u274c Could not clear dismiss state",Yv)}};(async()=>{s(!0),await Promise.all([p(),m()]),s(!1)})()}),[]),(0,a.useEffect)((()=>{if(c)return;let t;return e&&n||!(i<5)||(console.log(`Setting up retry interval (attempt ${i+1}/5)...`),t=setTimeout((()=>{console.log(`Retrying connections (attempt ${i+1}/5)...`);(async()=>{s(!0),await Promise.all([p(),m()]),s(!1),l((e=>e+1))})()}),Math.min(5e3+5e3*i,3e4))),()=>{t&&clearTimeout(t)}}),[e,n,i,c]),null},lt=e=>{let{children:t,variant:n="primary",size:r="md",isLoading:a=!1,isDisabled:o=!1,isOutlined:s=!1,leftIcon:i,rightIcon:l,className:c="",...d}=e;const u=["btn",s?`btn-outline btn-${n}`:`btn-${n}`,"md"!==r?`btn-${r}`:"",a?"loading":"",o?"btn-disabled":"",c].filter(Boolean).join(" ");return(0,$e.jsxs)("button",{className:u,disabled:o||a,...d,children:[!a&&i&&(0,$e.jsx)("span",{className:"mr-2",children:i}),t,!a&&l&&(0,$e.jsx)("span",{className:"ml-2",children:l})]})},ct=()=>{var e;const[t,n]=(0,a.useState)("code"),[r,o]=(0,a.useState)(""),[s,i]=(0,a.useState)(""),[l,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(Me),[h,p]=(0,a.useState)(null),[m,f]=(0,a.useState)(!1),[g,v]=(0,a.useState)(null),{signIn:y,signInWithCode:b}=We(),x=ne(),_=ee().state,w=(null===_||void 0===_||null===(e=_.from)||void 0===e?void 0:e.pathname)||"/dashboard";(0,a.useEffect)((()=>{if(null!==_&&void 0!==_&&_.sessionExpired){v("Su sesi\xf3n ha expirado. Por favor, inicie sesi\xf3n nuevamente.");const e=setTimeout((()=>{v(null)}),5e3);return()=>clearTimeout(e)}}),[_]);return(0,$e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-base-200",children:(0,$e.jsx)("div",{className:"card flex-shrink-0 w-full max-w-sm shadow-2xl bg-base-100",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsxs)("div",{className:"text-center mb-4",children:[(0,$e.jsx)("h1",{className:"text-4xl font-bold text-primary",children:"Fincentiva"}),(0,$e.jsx)("p",{className:"text-sm opacity-70 mt-1",children:"CRM"})]}),(0,$e.jsxs)("div",{className:"tabs tabs-boxed mb-4",children:[(0,$e.jsx)("a",{className:"tab "+("code"===t?"tab-active":""),onClick:()=>n("code"),children:"C\xf3digo de Acceso"}),(0,$e.jsx)("a",{className:"tab "+("admin"===t?"tab-active":""),onClick:()=>n("admin"),children:"Administrador"})]}),g&&(0,$e.jsxs)("div",{className:"alert alert-warning mb-4",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,$e.jsx)("span",{children:g})]}),(0,$e.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),p(null),v(null),f(!0);try{if("admin"===t){const{data:e,error:t}=await y(r,s);if(t)return p("Credenciales inv\xe1lidas"),void f(!1);e&&x(w,{replace:!0})}else{if(!l.trim())return p("Debe ingresar un c\xf3digo de acceso"),void f(!1);console.log(`Attempting login with access code: ${l}, user type: ${d}`);const{data:e,error:t}=await b(l,d);if(console.log("Login response:",{data:e?"Data available":"No data",error:t}),t)return p(t instanceof Error?t.message:String(t)),void f(!1);e&&x(w,{replace:!0})}}catch(n){p("Error al iniciar sesi\xf3n"),console.error(n)}finally{f(!1)}},children:[h&&(0,$e.jsxs)("div",{className:"alert alert-error mb-4",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:h})]}),"admin"===t?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Correo electr\xf3nico"})}),(0,$e.jsx)("input",{type:"email",placeholder:"correo@ejemplo.com",className:"input input-bordered",value:r,onChange:e=>o(e.target.value),required:!0})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Contrase\xf1a"})}),(0,$e.jsx)("input",{type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",className:"input input-bordered",value:s,onChange:e=>i(e.target.value),required:!0})]}),(0,$e.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:[(0,$e.jsx)("p",{children:"Usuario de prueba: admin@fincentiva.com"}),(0,$e.jsx)("p",{children:"Contrase\xf1a: admin123"})]})]}):(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tipo de Usuario"})}),(0,$e.jsxs)("select",{className:"select select-bordered w-full",value:d,onChange:e=>u(e.target.value),children:[(0,$e.jsx)("option",{value:Me,children:Le[Me]}),(0,$e.jsx)("option",{value:Oe,children:Le[Oe]})]})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"C\xf3digo de Acceso"})}),(0,$e.jsx)("input",{type:"text",placeholder:"Ingrese su c\xf3digo de acceso",className:"input input-bordered",value:l,onChange:e=>c(e.target.value),required:!0})]}),(0,$e.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:[(0,$e.jsx)("p",{children:"C\xf3digos de prueba:"}),(0,$e.jsx)("p",{children:"Asesor: 0095"}),(0,$e.jsx)("p",{children:"Administrador de empresa: 1234"})]})]}),(0,$e.jsx)("div",{className:"form-control mt-6",children:(0,$e.jsx)(lt,{type:"submit",variant:"primary",isLoading:m,className:"w-full",children:"Iniciar Sesi\xf3n"})})]})]})})})};function dt(e,t){let{title:n,titleId:r,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const ut=a.forwardRef(dt);function ht(e,t){let{title:n,titleId:r,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0 1 18 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3 1.5 1.5 3-3.75"}))}const pt=a.forwardRef(ht);function mt(e,t){let{title:n,titleId:r,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ft=a.forwardRef(mt);function gt(e,t){let{title:n,titleId:r,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const vt=a.forwardRef(gt);function yt(e,t){let{title:n,titleId:r,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const bt=a.forwardRef(yt);let xt=function(e){return e.AUTO_LOAN="AUTO_LOAN",e.CAR_BACKED_LOAN="CAR_BACKED_LOAN",e.PERSONAL_LOAN="PERSONAL_LOAN",e.CASH_ADVANCE="CASH_ADVANCE",e.SELECTED_PLANS="selected_plans",e.PRODUCT_SIMULATIONS="product_simulations",e.CASH_REQUESTS="cash_requests",e.CUSTOM_AMOUNT="custom_amount",e}({});const _t={[xt.AUTO_LOAN]:"Cr\xe9dito Automotriz",[xt.CAR_BACKED_LOAN]:"Cr\xe9dito con Garant\xeda Automotriz",[xt.PERSONAL_LOAN]:"Pr\xe9stamo Personal",[xt.CASH_ADVANCE]:"Adelanto de Efectivo",[xt.SELECTED_PLANS]:"Planes Seleccionados",[xt.PRODUCT_SIMULATIONS]:"Simulaci\xf3n de Producto",[xt.CASH_REQUESTS]:"Solicitud de Efectivo",[xt.CUSTOM_AMOUNT]:"Monto personalizado"};let wt=function(e){return e.PENDING="pending",e.IN_REVIEW="in_review",e.APPROVED="approved",e.REJECTED="rejected",e.CANCELLED="cancelled",e.EXPIRED="expired",e.COMPLETED="completed",e.SOLICITUD="solicitud",e.NEW="new",e.POR_DISPERSAR="por_dispersar",e}({});const Nt={[wt.NEW]:"Nuevo",[wt.PENDING]:"Pendiente",[wt.IN_REVIEW]:"En Revisi\xf3n",[wt.APPROVED]:"Aprobado",[wt.REJECTED]:"Rechazado",[wt.POR_DISPERSAR]:"Por Dispersar",[wt.COMPLETED]:"Completado",[wt.CANCELLED]:"Cancelado",[wt.EXPIRED]:"Expirado",[wt.SOLICITUD]:"Pendiente"},Et={[wt.NEW]:"info",[wt.PENDING]:"warning",[wt.IN_REVIEW]:"secondary",[wt.APPROVED]:"success",[wt.REJECTED]:"error",[wt.POR_DISPERSAR]:"accent",[wt.COMPLETED]:"primary",[wt.CANCELLED]:"neutral",[wt.EXPIRED]:"error",[wt.SOLICITUD]:"warning"},St=(wt.NEW,wt.PENDING,wt.IN_REVIEW,wt.APPROVED,wt.REJECTED,wt.POR_DISPERSAR,wt.COMPLETED,wt.CANCELLED,wt.EXPIRED,wt.SOLICITUD,e=>null===e||void 0===e?"$0.00":new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(e)),jt=e=>{if(!e)return"";return new Date(e).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},kt=()=>{const[e,t]=(0,a.useState)(!1),{notifications:n,unreadCount:r,markAsRead:o,markAllAsRead:s,clearNotifications:i,soundEnabled:l,toggleSound:c}=at(),d=()=>{t(!e),!e&&r>0&&s()},u=e=>{switch(e){case nt.SUCCESS:return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-success",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case nt.ERROR:return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-error",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case nt.WARNING:return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-warning",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});case nt.NEW_APPLICATION:return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-info",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})});case nt.APPROVAL_REQUIRED:return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-primary",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})});default:return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-info",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}},h=e=>{const t=(new Date).getTime()-new Date(e).getTime();if(t<864e5){const e=Math.floor(t/36e5);if(e<1){const e=Math.floor(t/6e4);return e<=0?"Ahora":`Hace ${e} min`}return`Hace ${e} ${1===e?"hora":"horas"}`}if(t<6048e5){return["Dom","Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b"][new Date(e).getDay()]}const n=new Date(e);return`${n.getDate()}/${n.getMonth()+1}`};return(0,$e.jsxs)("div",{className:"relative",children:[(0,$e.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,$e.jsx)("button",{onClick:d,className:"btn btn-ghost btn-circle","aria-label":"Notificaciones",children:(0,$e.jsxs)("div",{className:"indicator",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),r>0&&(0,$e.jsx)("span",{className:"badge badge-xs badge-primary indicator-item",children:r>9?"9+":r})]})}),e&&(0,$e.jsxs)("div",{className:"dropdown-content bg-base-100 shadow-xl rounded-box mt-4",style:{width:"350px",maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"absolute",right:0,zIndex:50},children:[(0,$e.jsx)("div",{className:"p-3 border-b border-base-200",children:(0,$e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,$e.jsx)("h3",{className:"font-bold",children:"Notificaciones"}),(0,$e.jsxs)("div",{className:"flex gap-2",children:[(0,$e.jsx)("button",{onClick:c,className:"btn btn-xs btn-ghost","aria-label":l?"Desactivar sonido":"Activar sonido",children:l?(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}):(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),n.length>0&&(0,$e.jsx)("button",{onClick:i,className:"btn btn-xs btn-ghost","aria-label":"Limpiar notificaciones",children:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]})}),(0,$e.jsx)("div",{children:0===n.length?(0,$e.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 mx-auto mb-2 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),(0,$e.jsx)("p",{children:"No tienes notificaciones."})]}):(0,$e.jsx)("div",{children:n.map((e=>(0,$e.jsx)("div",{className:"border-b border-base-200 hover:bg-base-200 transition-colors "+(e.read?"":"bg-base-200"),children:(e.type===nt.APPROVAL_REQUIRED||e.type===nt.NEW_APPLICATION)&&e.relatedItemId&&"application"===e.relatedItemType?/^app-\d+$/.test(e.relatedItemId)?(0,$e.jsxs)("div",{className:"flex items-start p-3 gap-3",children:[(0,$e.jsx)("div",{className:"mt-1",children:u(e.type)}),(0,$e.jsxs)("div",{className:"flex-1",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start",children:[(0,$e.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,$e.jsx)("span",{className:"text-xs text-gray-500",children:h(e.timestamp||e.createdAt)})]}),(0,$e.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message})]})]}):(0,$e.jsxs)(Te,{to:`/applications/${e.relatedItemId}`,className:"flex items-start p-3 gap-3",onClick:()=>o(e.id),children:[(0,$e.jsx)("div",{className:"mt-1",children:u(e.type)}),(0,$e.jsxs)("div",{className:"flex-1",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start",children:[(0,$e.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,$e.jsx)("span",{className:"text-xs text-gray-500",children:h(e.timestamp||e.createdAt)})]}),(0,$e.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message})]})]}):(0,$e.jsxs)("div",{className:"flex items-start p-3 gap-3",children:[(0,$e.jsx)("div",{className:"mt-1",children:u(e.type)}),(0,$e.jsxs)("div",{className:"flex-1",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start",children:[(0,$e.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,$e.jsx)("span",{className:"text-xs text-gray-500",children:h(e.timestamp||e.createdAt)})]}),(0,$e.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message})]})]})},e.id)))})})]})]}),e&&(0,$e.jsx)("div",{className:"fixed inset-0 z-40",onClick:d,"aria-hidden":"true"})]})},Ct=e=>{var t;let{toggleSidebar:n}=e;const{user:r,signOut:o}=We(),[s,i]=(0,a.useState)(!1);return(0,$e.jsxs)("div",{className:"navbar bg-base-100 border-b",children:[(0,$e.jsxs)("div",{className:"flex-1",children:[(0,$e.jsx)("button",{className:"btn btn-ghost lg:hidden","aria-label":"Toggle sidebar",onClick:n,children:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h8m-8 6h16"})})}),(0,$e.jsx)("span",{className:"text-xl font-bold text-primary",children:"Fincentiva CRM"})]}),(0,$e.jsxs)("div",{className:"flex-none gap-2",children:[(0,$e.jsx)(kt,{}),(0,$e.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,$e.jsx)("button",{tabIndex:0,className:"btn btn-ghost btn-circle avatar",onClick:()=>{i(!s)},"aria-label":"User menu",children:(0,$e.jsx)("div",{className:"bg-primary text-primary-content rounded-full w-10 h-10 flex items-center justify-center",children:(0,$e.jsx)("span",{className:"text-lg font-bold",children:null!==r&&void 0!==r&&r.name?r.name.charAt(0).toUpperCase():null===r||void 0===r||null===(t=r.email)||void 0===t?void 0:t.charAt(0).toUpperCase()})})}),s&&(0,$e.jsxs)("ul",{tabIndex:0,className:"mt-3 z-[1] p-2 shadow menu menu-sm dropdown-content bg-base-100 rounded-box w-52",children:[(0,$e.jsxs)("li",{className:"p-3 border-b",children:[(0,$e.jsx)("span",{className:"font-bold",children:(null===r||void 0===r?void 0:r.name)||(null===r||void 0===r?void 0:r.email)}),(0,$e.jsx)("span",{className:"text-xs opacity-70 block",children:null!==r&&void 0!==r&&r.role&&Le[r.role]||"Usuario"})]}),(0,$e.jsx)("li",{children:(0,$e.jsx)(Te,{to:"/profile",className:"justify-between",children:"Mi Perfil"})}),(0,$e.jsx)("li",{children:(0,$e.jsx)("button",{onClick:async()=>{await o()},children:"Cerrar Sesi\xf3n"})})]})]})]})]})},Dt=e=>{let{isOpen:t}=e;const n=ee(),{userCan:r}=Qe(),{user:a}=We(),o=[{label:"Dashboard",path:"/dashboard",icon:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),permission:He.VIEW_DASHBOARD},{label:"Solicitudes",path:"/applications",icon:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),permission:He.VIEW_APPLICATIONS},{label:"Empresas",path:"/companies",icon:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),permission:He.VIEW_COMPANIES,visibleFor:[Re,Me]},{label:"Asesores",path:"/advisors",icon:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),permission:He.VIEW_ADVISORS},{label:(null===a||void 0===a?void 0:a.role)===Oe?"Empleados":"Clientes",path:"/clients",icon:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),permission:He.VIEW_CLIENTS},{label:"Mensajes",path:"/messages",icon:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},{label:"Administraci\xf3n",path:"/admin",icon:(0,$e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),visibleFor:[Re]}].filter((e=>(!e.permission||r(e.permission))&&(!e.visibleFor||!(null!==a&&void 0!==a&&a.role)||e.visibleFor.includes(a.role))));return(0,$e.jsxs)("div",{className:`lg:block fixed top-0 bottom-0 lg:left-0 w-64 bg-base-200 pt-4 transition-all duration-300 ${t?"left-0":"-left-64"} z-20 lg:z-0 shadow-lg`,children:[(0,$e.jsx)("div",{className:"px-6 pb-4 flex items-center border-b border-gray-200",children:(0,$e.jsx)("div",{className:"text-primary text-2xl font-bold",children:"Fincentiva"})}),(0,$e.jsx)("ul",{className:"menu p-2 pt-4",children:o.map((e=>(0,$e.jsx)("li",{children:(0,$e.jsxs)(Te,{to:e.path,className:n.pathname===e.path?"active":"",children:[e.icon,e.label]})},e.path)))})]})},Tt=e=>{let{children:t}=e;const[n,r]=(0,a.useState)(!1),o=()=>{r(!n)};return(0,$e.jsxs)("div",{className:"min-h-screen bg-base-200",children:[(0,$e.jsx)(Dt,{isOpen:n}),(0,$e.jsxs)("div",{className:"lg:ml-64 flex flex-col min-h-screen",children:[(0,$e.jsx)(Ct,{toggleSidebar:o}),(0,$e.jsx)("main",{className:"flex flex-col flex-1 min-h-0 p-4",children:t})]}),n&&(0,$e.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-10 lg:hidden",onClick:o})]})};function At(e,t){let{title:n,titleId:r,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,a.createElement("path",{fillRule:"evenodd",d:"M11.47 2.47a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06l-6.22-6.22V21a.75.75 0 0 1-1.5 0V4.81l-6.22 6.22a.75.75 0 1 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const Pt=a.forwardRef(At);function It(e,t){let{title:n,titleId:r,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,a.createElement("path",{fillRule:"evenodd",d:"M12 2.25a.75.75 0 0 1 .75.75v16.19l6.22-6.22a.75.75 0 1 1 1.06 1.06l-7.5 7.5a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 1 1 1.06-1.06l6.22 6.22V3a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const Rt=a.forwardRef(It),Mt=e=>{let{title:t,value:n,previousValue:r,formatValue:a=e=>e.toString(),icon:o,color:s="blue",isPercentage:i=!1,isLoading:l=!1,className:c="",tooltip:d,onClick:u,children:h}=e;const p=void 0===r||"number"!==typeof n?null:0===r?n>0?100:0:(n-r)/Math.abs(r)*100,m=null!==p&&p>0,f=null!==p&&p<0,g={blue:"bg-blue-50 text-blue-700 border-blue-200",green:"bg-green-50 text-green-700 border-green-200",red:"bg-red-50 text-red-700 border-red-200",yellow:"bg-yellow-50 text-yellow-700 border-yellow-200",purple:"bg-purple-50 text-purple-700 border-purple-200",indigo:"bg-indigo-50 text-indigo-700 border-indigo-200",gray:"bg-gray-50 text-gray-700 border-gray-200"},v=g[s]||g.blue,y=m?"text-green-600 bg-green-50":f?"text-red-600 bg-red-50":"text-gray-600 bg-gray-50",b="function"===typeof u;return(0,$e.jsx)("div",{className:`border rounded-lg shadow-sm overflow-hidden ${c} ${b?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:u,children:(0,$e.jsxs)("div",{className:"p-4",children:[(0,$e.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,$e.jsxs)("h3",{className:"text-sm font-medium text-gray-600 group relative",children:[t,d&&(0,$e.jsx)("span",{className:"hidden group-hover:block absolute bottom-full left-0 bg-gray-800 text-white text-xs rounded py-1 px-2 whitespace-nowrap z-10",children:d})]}),o&&(0,$e.jsx)("div",{className:`p-2 rounded-full ${v}`,children:o})]}),l?(0,$e.jsx)("div",{className:"animate-pulse h-8 bg-gray-200 rounded w-3/4 my-2"}):(0,$e.jsxs)("div",{className:"flex items-end",children:[(0,$e.jsxs)("span",{className:"text-2xl font-semibold",children:[a(n),i&&"%"]}),null!==p&&(0,$e.jsxs)("div",{className:`ml-2 px-2 py-0.5 rounded-md text-xs flex items-center ${y}`,children:[m?(0,$e.jsx)(Pt,{className:"h-3 w-3 mr-1"}):f?(0,$e.jsx)(Rt,{className:"h-3 w-3 mr-1"}):null,Math.abs(p).toFixed(1),"%"]})]}),h]})})};function Ot(e){return e+.5|0}const Lt=(e,t,n)=>Math.max(Math.min(e,n),t);function $t(e){return Lt(Ot(2.55*e),0,255)}function Ft(e){return Lt(Ot(255*e),0,255)}function zt(e){return Lt(Ot(e/2.55)/100,0,1)}function Bt(e){return Lt(Ot(100*e),0,100)}const Ut={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Wt=[..."0123456789ABCDEF"],Vt=e=>Wt[15&e],Ht=e=>Wt[(240&e)>>4]+Wt[15&e],qt=e=>(240&e)>>4===(15&e);function Yt(e){var t=(e=>qt(e.r)&&qt(e.g)&&qt(e.b)&&qt(e.a))(e)?Vt:Ht;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const Jt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Qt(e,t,n){const r=t*Math.min(n,1-n),a=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-r*Math.max(Math.min(a-3,9-a,1),-1)};return[a(0),a(8),a(4)]}function Kt(e,t,n){const r=function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(r+e/60)%6;return n-n*t*Math.max(Math.min(a,4-a,1),0)};return[r(5),r(3),r(1)]}function Gt(e,t,n){const r=Qt(e,1,.5);let a;for(t+n>1&&(a=1/(t+n),t*=a,n*=a),a=0;a<3;a++)r[a]*=1-t-n,r[a]+=t;return r}function Xt(e){const t=e.r/255,n=e.g/255,r=e.b/255,a=Math.max(t,n,r),o=Math.min(t,n,r),s=(a+o)/2;let i,l,c;return a!==o&&(c=a-o,l=s>.5?c/(2-a-o):c/(a+o),i=function(e,t,n,r,a){return e===a?(t-n)/r+(t<n?6:0):t===a?(n-e)/r+2:(e-t)/r+4}(t,n,r,c,a),i=60*i+.5),[0|i,l||0,s]}function Zt(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(Ft)}function en(e,t,n){return Zt(Qt,e,t,n)}function tn(e){return(e%360+360)%360}function nn(e){const t=Jt.exec(e);let n,r=255;if(!t)return;t[5]!==n&&(r=t[6]?$t(+t[5]):Ft(+t[5]));const a=tn(+t[2]),o=+t[3]/100,s=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return Zt(Gt,e,t,n)}(a,o,s):"hsv"===t[1]?function(e,t,n){return Zt(Kt,e,t,n)}(a,o,s):en(a,o,s),{r:n[0],g:n[1],b:n[2],a:r}}const rn={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},an={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let on;function sn(e){on||(on=function(){const e={},t=Object.keys(an),n=Object.keys(rn);let r,a,o,s,i;for(r=0;r<t.length;r++){for(s=i=t[r],a=0;a<n.length;a++)o=n[a],i=i.replace(o,rn[o]);o=parseInt(an[s],16),e[i]=[o>>16&255,o>>8&255,255&o]}return e}(),on.transparent=[0,0,0,0]);const t=on[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const ln=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const cn=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,dn=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function un(e,t,n){if(e){let r=Xt(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,0===t?360:1)),r=en(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function hn(e,t){return e?Object.assign(t||{},e):e}function pn(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Ft(e[3]))):(t=hn(e,{r:0,g:0,b:0,a:1})).a=Ft(t.a),t}function mn(e){return"r"===e.charAt(0)?function(e){const t=ln.exec(e);let n,r,a,o=255;if(t){if(t[7]!==n){const e=+t[7];o=t[8]?$t(e):Lt(255*e,0,255)}return n=+t[1],r=+t[3],a=+t[5],n=255&(t[2]?$t(n):Lt(n,0,255)),r=255&(t[4]?$t(r):Lt(r,0,255)),a=255&(t[6]?$t(a):Lt(a,0,255)),{r:n,g:r,b:a,a:o}}}(e):nn(e)}class fn{constructor(e){if(e instanceof fn)return e;const t=typeof e;let n;"object"===t?n=pn(e):"string"===t&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*Ut[e[1]],g:255&17*Ut[e[2]],b:255&17*Ut[e[3]],a:5===n?17*Ut[e[4]]:255}:7!==n&&9!==n||(t={r:Ut[e[1]]<<4|Ut[e[2]],g:Ut[e[3]]<<4|Ut[e[4]],b:Ut[e[5]]<<4|Ut[e[6]],a:9===n?Ut[e[7]]<<4|Ut[e[8]]:255})),t}(e)||sn(e)||mn(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=hn(this._rgb);return e&&(e.a=zt(e.a)),e}set rgb(e){this._rgb=pn(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${zt(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid?Yt(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=Xt(e),n=t[0],r=Bt(t[1]),a=Bt(t[2]);return e.a<255?`hsla(${n}, ${r}%, ${a}%, ${zt(e.a)})`:`hsl(${n}, ${r}%, ${a}%)`}(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,r=e.rgb;let a;const o=t===a?.5:t,s=2*o-1,i=n.a-r.a,l=((s*i===-1?s:(s+i)/(1+s*i))+1)/2;a=1-l,n.r=255&l*n.r+a*r.r+.5,n.g=255&l*n.g+a*r.g+.5,n.b=255&l*n.b+a*r.b+.5,n.a=o*n.a+(1-o)*r.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,n){const r=dn(zt(e.r)),a=dn(zt(e.g)),o=dn(zt(e.b));return{r:Ft(cn(r+n*(dn(zt(t.r))-r))),g:Ft(cn(a+n*(dn(zt(t.g))-a))),b:Ft(cn(o+n*(dn(zt(t.b))-o))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new fn(this.rgb)}alpha(e){return this._rgb.a=Ft(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=Ot(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return un(this._rgb,2,e),this}darken(e){return un(this._rgb,2,-e),this}saturate(e){return un(this._rgb,1,e),this}desaturate(e){return un(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=Xt(e);n[0]=tn(n[0]+t),n=en(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function gn(){}const vn=(()=>{let e=0;return()=>e++})();function yn(e){return null===e||void 0===e}function bn(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function xn(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function _n(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function wn(e,t){return _n(e)?e:t}function Nn(e,t){return"undefined"===typeof e?t:e}const En=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Sn(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function jn(e,t,n,r){let a,o,s;if(bn(e))if(o=e.length,r)for(a=o-1;a>=0;a--)t.call(n,e[a],a);else for(a=0;a<o;a++)t.call(n,e[a],a);else if(xn(e))for(s=Object.keys(e),o=s.length,a=0;a<o;a++)t.call(n,e[s[a]],s[a])}function kn(e,t){let n,r,a,o;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(a=e[n],o=t[n],a.datasetIndex!==o.datasetIndex||a.index!==o.index)return!1;return!0}function Cn(e){if(bn(e))return e.map(Cn);if(xn(e)){const t=Object.create(null),n=Object.keys(e),r=n.length;let a=0;for(;a<r;++a)t[n[a]]=Cn(e[n[a]]);return t}return e}function Dn(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function Tn(e,t,n,r){if(!Dn(e))return;const a=t[e],o=n[e];xn(a)&&xn(o)?An(a,o,r):t[e]=Cn(o)}function An(e,t,n){const r=bn(t)?t:[t],a=r.length;if(!xn(e))return e;const o=(n=n||{}).merger||Tn;let s;for(let i=0;i<a;++i){if(s=r[i],!xn(s))continue;const t=Object.keys(s);for(let r=0,a=t.length;r<a;++r)o(t[r],e,s,n)}return e}function Pn(e,t){return An(e,t,{merger:In})}function In(e,t,n){if(!Dn(e))return;const r=t[e],a=n[e];xn(r)&&xn(a)?Pn(r,a):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Cn(a))}const Rn={"":e=>e,x:e=>e.x,y:e=>e.y};function Mn(e,t){const n=Rn[t]||(Rn[t]=function(e){const t=function(e){const t=e.split("."),n=[];let r="";for(const a of t)r+=a,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}(e);return e=>{for(const n of t){if(""===n)break;e=e&&e[n]}return e}}(t));return n(e)}function On(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Ln=e=>"undefined"!==typeof e,$n=e=>"function"===typeof e,Fn=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};const zn=Math.PI,Bn=2*zn,Un=Bn+zn,Wn=Number.POSITIVE_INFINITY,Vn=zn/180,Hn=zn/2,qn=zn/4,Yn=2*zn/3,Jn=Math.log10,Qn=Math.sign;function Kn(e,t,n){return Math.abs(e-t)<n}function Gn(e){const t=Math.round(e);e=Kn(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Jn(e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function Xn(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function Zn(e,t,n){let r,a,o;for(r=0,a=e.length;r<a;r++)o=e[r][n],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function er(e){return e*(zn/180)}function tr(e){return e*(180/zn)}function nr(e){if(!_n(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function rr(e,t){const n=t.x-e.x,r=t.y-e.y,a=Math.sqrt(n*n+r*r);let o=Math.atan2(r,n);return o<-.5*zn&&(o+=Bn),{angle:o,distance:a}}function ar(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function or(e,t){return(e-t+Un)%Bn-zn}function sr(e){return(e%Bn+Bn)%Bn}function ir(e,t,n,r){const a=sr(e),o=sr(t),s=sr(n),i=sr(o-a),l=sr(s-a),c=sr(a-o),d=sr(a-s);return a===o||a===s||r&&o===s||i>l&&c<d}function lr(e,t,n){return Math.max(t,Math.min(n,e))}function cr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function dr(e,t,n){n=n||(n=>e[n]<t);let r,a=e.length-1,o=0;for(;a-o>1;)r=o+a>>1,n(r)?o=r:a=r;return{lo:o,hi:a}}const ur=(e,t,n,r)=>dr(e,n,r?r=>{const a=e[r][t];return a<n||a===n&&e[r+1][t]===n}:r=>e[r][t]<n),hr=(e,t,n)=>dr(e,n,(r=>e[r][t]>=n));const pr=["push","pop","shift","splice","unshift"];function mr(e,t){const n=e._chartjs;if(!n)return;const r=n.listeners,a=r.indexOf(t);-1!==a&&r.splice(a,1),r.length>0||(pr.forEach((t=>{delete e[t]})),delete e._chartjs)}function fr(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const gr="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function vr(e,t){let n=[],r=!1;return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];n=o,r||(r=!0,gr.call(window,(()=>{r=!1,e.apply(t,n)})))}}const yr=e=>"start"===e?"left":"end"===e?"right":"center",br=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2;function xr(e,t,n){const r=t.length;let a=0,o=r;if(e._sorted){const{iScale:s,vScale:i,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=s.axis,{min:u,max:h,minDefined:p,maxDefined:m}=s.getUserBounds();if(p){if(a=Math.min(ur(l,d,u).lo,n?r:ur(t,d,s.getPixelForValue(u)).lo),c){const e=l.slice(0,a+1).reverse().findIndex((e=>!yn(e[i.axis])));a-=Math.max(0,e)}a=lr(a,0,r-1)}if(m){let e=Math.max(ur(l,s.axis,h,!0).hi+1,n?0:ur(t,d,s.getPixelForValue(h),!0).hi+1);if(c){const t=l.slice(e-1).findIndex((e=>!yn(e[i.axis])));e+=Math.max(0,t)}o=lr(e,a,r)-a}else o=r-a}return{start:a,count:o}}function _r(e){const{xScale:t,yScale:n,_scaleRanges:r}=e,a={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=a,!0;const o=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,a),o}const wr=e=>0===e||1===e,Nr=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*Bn/n),Er=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Bn/n)+1,Sr={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Hn),easeOutSine:e=>Math.sin(e*Hn),easeInOutSine:e=>-.5*(Math.cos(zn*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>wr(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>wr(e)?e:Nr(e,.075,.3),easeOutElastic:e=>wr(e)?e:Er(e,.075,.3),easeInOutElastic(e){const t=.1125;return wr(e)?e:e<.5?.5*Nr(2*e,t,.45):.5+.5*Er(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-Sr.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*Sr.easeInBounce(2*e):.5*Sr.easeOutBounce(2*e-1)+.5};function jr(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function kr(e){return jr(e)?e:new fn(e)}function Cr(e){return jr(e)?e:new fn(e).saturate(.5).darken(.1).hexString()}const Dr=["x","y","borderWidth","radius","tension"],Tr=["color","borderColor","backgroundColor"];const Ar=new Map;function Pr(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let r=Ar.get(n);return r||(r=new Intl.NumberFormat(e,t),Ar.set(n,r)),r}(t,n).format(e)}const Ir={values:e=>bn(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const r=this.chart.options.locale;let a,o=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(a="scientific"),o=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const s=Jn(Math.abs(o)),i=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:a,minimumFractionDigits:i,maximumFractionDigits:i};return Object.assign(l,this.options.ticks.format),Pr(e,r,l)},logarithmic(e,t,n){if(0===e)return"0";const r=n[t].significand||e/Math.pow(10,Math.floor(Jn(e)));return[1,2,3,5,10,15].includes(r)||t>.8*n.length?Ir.numeric.call(this,e,t,n):""}};var Rr={formatters:Ir};const Mr=Object.create(null),Or=Object.create(null);function Lr(e,t){if(!t)return e;const n=t.split(".");for(let r=0,a=n.length;r<a;++r){const t=n[r];e=e[t]||(e[t]=Object.create(null))}return e}function $r(e,t,n){return"string"===typeof t?An(Lr(e,t),n):An(Lr(e,""),t)}class Fr{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>Cr(t.backgroundColor),this.hoverBorderColor=(e,t)=>Cr(t.borderColor),this.hoverColor=(e,t)=>Cr(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return $r(this,e,t)}get(e){return Lr(this,e)}describe(e,t){return $r(Or,e,t)}override(e,t){return $r(Mr,e,t)}route(e,t,n,r){const a=Lr(this,e),o=Lr(this,n),s="_"+t;Object.defineProperties(a,{[s]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[s],t=o[r];return xn(e)?Object.assign({},t,e):Nn(e,t)},set(e){this[s]=e}}})}apply(e){e.forEach((e=>e(this)))}}var zr=new Fr({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:Tr},numbers:{type:"number",properties:Dr}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Rr.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function Br(e,t,n,r,a){let o=t[a];return o||(o=t[a]=e.measureText(a).width,n.push(a)),o>r&&(r=o),r}function Ur(e,t,n){const r=e.currentDevicePixelRatio,a=0!==n?Math.max(n/2,.5):0;return Math.round((t-a)*r)/r+a}function Wr(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Vr(e,t,n,r){Hr(e,t,n,r,null)}function Hr(e,t,n,r,a){let o,s,i,l,c,d,u,h;const p=t.pointStyle,m=t.rotation,f=t.radius;let g=(m||0)*Vn;if(p&&"object"===typeof p&&(o=p.toString(),"[object HTMLImageElement]"===o||"[object HTMLCanvasElement]"===o))return e.save(),e.translate(n,r),e.rotate(g),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void e.restore();if(!(isNaN(f)||f<=0)){switch(e.beginPath(),p){default:a?e.ellipse(n,r,a/2,f,0,0,Bn):e.arc(n,r,f,0,Bn),e.closePath();break;case"triangle":d=a?a/2:f,e.moveTo(n+Math.sin(g)*d,r-Math.cos(g)*f),g+=Yn,e.lineTo(n+Math.sin(g)*d,r-Math.cos(g)*f),g+=Yn,e.lineTo(n+Math.sin(g)*d,r-Math.cos(g)*f),e.closePath();break;case"rectRounded":c=.516*f,l=f-c,s=Math.cos(g+qn)*l,u=Math.cos(g+qn)*(a?a/2-c:l),i=Math.sin(g+qn)*l,h=Math.sin(g+qn)*(a?a/2-c:l),e.arc(n-u,r-i,c,g-zn,g-Hn),e.arc(n+h,r-s,c,g-Hn,g),e.arc(n+u,r+i,c,g,g+Hn),e.arc(n-h,r+s,c,g+Hn,g+zn),e.closePath();break;case"rect":if(!m){l=Math.SQRT1_2*f,d=a?a/2:l,e.rect(n-d,r-l,2*d,2*l);break}g+=qn;case"rectRot":u=Math.cos(g)*(a?a/2:f),s=Math.cos(g)*f,i=Math.sin(g)*f,h=Math.sin(g)*(a?a/2:f),e.moveTo(n-u,r-i),e.lineTo(n+h,r-s),e.lineTo(n+u,r+i),e.lineTo(n-h,r+s),e.closePath();break;case"crossRot":g+=qn;case"cross":u=Math.cos(g)*(a?a/2:f),s=Math.cos(g)*f,i=Math.sin(g)*f,h=Math.sin(g)*(a?a/2:f),e.moveTo(n-u,r-i),e.lineTo(n+u,r+i),e.moveTo(n+h,r-s),e.lineTo(n-h,r+s);break;case"star":u=Math.cos(g)*(a?a/2:f),s=Math.cos(g)*f,i=Math.sin(g)*f,h=Math.sin(g)*(a?a/2:f),e.moveTo(n-u,r-i),e.lineTo(n+u,r+i),e.moveTo(n+h,r-s),e.lineTo(n-h,r+s),g+=qn,u=Math.cos(g)*(a?a/2:f),s=Math.cos(g)*f,i=Math.sin(g)*f,h=Math.sin(g)*(a?a/2:f),e.moveTo(n-u,r-i),e.lineTo(n+u,r+i),e.moveTo(n+h,r-s),e.lineTo(n-h,r+s);break;case"line":s=a?a/2:Math.cos(g)*f,i=Math.sin(g)*f,e.moveTo(n-s,r-i),e.lineTo(n+s,r+i);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(g)*(a?a/2:f),r+Math.sin(g)*f);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function qr(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Yr(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Jr(e){e.restore()}function Qr(e,t,n,r,a){if(!t)return e.lineTo(n.x,n.y);if("middle"===a){const r=(t.x+n.x)/2;e.lineTo(r,t.y),e.lineTo(r,n.y)}else"after"===a!==!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Kr(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function Gr(e,t,n,r,a){if(a.strikethrough||a.underline){const o=e.measureText(r),s=t-o.actualBoundingBoxLeft,i=t+o.actualBoundingBoxRight,l=n-o.actualBoundingBoxAscent,c=n+o.actualBoundingBoxDescent,d=a.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=a.decorationWidth||2,e.moveTo(s,d),e.lineTo(i,d),e.stroke()}}function Xr(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Zr(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=bn(t)?t:[t],i=o.strokeWidth>0&&""!==o.strokeColor;let l,c;for(e.save(),e.font=a.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),yn(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,o),l=0;l<s.length;++l)c=s[l],o.backdrop&&Xr(e,o.backdrop),i&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),yn(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(c,n,r,o.maxWidth)),e.fillText(c,n,r,o.maxWidth),Gr(e,n,r,c,o),r+=Number(a.lineHeight);e.restore()}function ea(e,t){const{x:n,y:r,w:a,h:o,radius:s}=t;e.arc(n+s.topLeft,r+s.topLeft,s.topLeft,1.5*zn,zn,!0),e.lineTo(n,r+o-s.bottomLeft),e.arc(n+s.bottomLeft,r+o-s.bottomLeft,s.bottomLeft,zn,Hn,!0),e.lineTo(n+a-s.bottomRight,r+o),e.arc(n+a-s.bottomRight,r+o-s.bottomRight,s.bottomRight,Hn,0,!0),e.lineTo(n+a,r+s.topRight),e.arc(n+a-s.topRight,r+s.topRight,s.topRight,0,-Hn,!0),e.lineTo(n+s.topLeft,r)}const ta=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,na=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function ra(e,t){const n=(""+e).match(ta);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}function aa(e,t){const n={},r=xn(t),a=r?Object.keys(t):t,o=xn(e)?r?n=>Nn(e[n],e[t[n]]):t=>e[t]:()=>e;for(const s of a)n[s]=+o(s)||0;return n}function oa(e){return aa(e,{top:"y",right:"x",bottom:"y",left:"x"})}function sa(e){return aa(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ia(e){const t=oa(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function la(e,t){e=e||{},t=t||zr.font;let n=Nn(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));let r=Nn(e.style,t.style);r&&!(""+r).match(na)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const a={family:Nn(e.family,t.family),lineHeight:ra(Nn(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:Nn(e.weight,t.weight),string:""};return a.string=function(e){return!e||yn(e.size)||yn(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(a),a}function ca(e,t,n,r){let a,o,s,i=!0;for(a=0,o=e.length;a<o;++a)if(s=e[a],void 0!==s&&(void 0!==t&&"function"===typeof s&&(s=s(t),i=!1),void 0!==n&&bn(s)&&(s=s[n%s.length],i=!1),void 0!==s))return r&&!i&&(r.cacheable=!1),s}function da(e,t){return Object.assign(Object.create(e),t)}function ua(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const a=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof n&&(n=wa("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:a,_fallback:n,_getTarget:r,override:r=>ua([r,...e],t,a,n)};return new Proxy(o,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,r)=>ga(n,r,(()=>function(e,t,n,r){let a;for(const o of t)if(a=wa(ma(o,e),n),"undefined"!==typeof a)return fa(e,a)?xa(n,r,e,a):a}(r,t,e,n))),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>Na(e).includes(t),ownKeys:e=>Na(e),set(e,t,n){const a=e._storage||(e._storage=r());return e[t]=a[t]=n,delete e._keys,!0}})}function ha(e,t,n,r){const a={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:pa(e,r),setContext:t=>ha(e,t,n,r),override:a=>ha(e.override(a),t,n,r)};return new Proxy(a,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>ga(e,t,(()=>function(e,t,n){const{_proxy:r,_context:a,_subProxy:o,_descriptors:s}=e;let i=r[t];$n(i)&&s.isScriptable(t)&&(i=function(e,t,n,r){const{_proxy:a,_context:o,_subProxy:s,_stack:i}=n;if(i.has(e))throw new Error("Recursion detected: "+Array.from(i).join("->")+"->"+e);i.add(e);let l=t(o,s||r);i.delete(e),fa(e,l)&&(l=xa(a._scopes,a,e,l));return l}(t,i,e,n));bn(i)&&i.length&&(i=function(e,t,n,r){const{_proxy:a,_context:o,_subProxy:s,_descriptors:i}=n;if("undefined"!==typeof o.index&&r(e))return t[o.index%t.length];if(xn(t[0])){const n=t,r=a._scopes.filter((e=>e!==n));t=[];for(const l of n){const n=xa(r,a,e,l);t.push(ha(n,o,s&&s[e],i))}}return t}(t,i,e,s.isIndexable));fa(t,i)&&(i=ha(i,a,o&&o[t],s));return i}(e,t,n))),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,r)=>(e[n]=r,delete t[n],!0)})}function pa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:n=t.scriptable,_indexable:r=t.indexable,_allKeys:a=t.allKeys}=e;return{allKeys:a,scriptable:n,indexable:r,isScriptable:$n(n)?n:()=>n,isIndexable:$n(r)?r:()=>r}}const ma=(e,t)=>e?e+On(t):t,fa=(e,t)=>xn(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function ga(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const r=n();return e[t]=r,r}function va(e,t,n){return $n(e)?e(t,n):e}const ya=(e,t)=>!0===e?t:"string"===typeof e?Mn(t,e):void 0;function ba(e,t,n,r,a){for(const o of t){const t=ya(n,o);if(t){e.add(t);const o=va(t._fallback,n,a);if("undefined"!==typeof o&&o!==n&&o!==r)return o}else if(!1===t&&"undefined"!==typeof r&&n!==r)return null}return!1}function xa(e,t,n,r){const a=t._rootScopes,o=va(t._fallback,n,r),s=[...e,...a],i=new Set;i.add(r);let l=_a(i,s,n,o||n,r);return null!==l&&(("undefined"===typeof o||o===n||(l=_a(i,s,o,l,r),null!==l))&&ua(Array.from(i),[""],a,o,(()=>function(e,t,n){const r=e._getTarget();t in r||(r[t]={});const a=r[t];if(bn(a)&&xn(n))return n;return a||{}}(t,n,r))))}function _a(e,t,n,r,a){for(;n;)n=ba(e,t,n,r,a);return n}function wa(e,t){for(const n of t){if(!n)continue;const t=n[e];if("undefined"!==typeof t)return t}}function Na(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter((e=>!e.startsWith("_"))))t.add(e);return Array.from(t)}(e._scopes)),t}const Ea=Number.EPSILON||1e-14,Sa=(e,t)=>t<e.length&&!e[t].skip&&e[t],ja=e=>"x"===e?"y":"x";function ka(e,t,n,r){const a=e.skip?t:e,o=t,s=n.skip?t:n,i=ar(o,a),l=ar(s,o);let c=i/(i+l),d=l/(i+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const u=r*c,h=r*d;return{previous:{x:o.x-u*(s.x-a.x),y:o.y-u*(s.y-a.y)},next:{x:o.x+h*(s.x-a.x),y:o.y+h*(s.y-a.y)}}}function Ca(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const n=ja(t),r=e.length,a=Array(r).fill(0),o=Array(r);let s,i,l,c=Sa(e,0);for(s=0;s<r;++s)if(i=l,l=c,c=Sa(e,s+1),l){if(c){const e=c[t]-l[t];a[s]=0!==e?(c[n]-l[n])/e:0}o[s]=i?c?Qn(a[s-1])!==Qn(a[s])?0:(a[s-1]+a[s])/2:a[s-1]:a[s]}!function(e,t,n){const r=e.length;let a,o,s,i,l,c=Sa(e,0);for(let d=0;d<r-1;++d)l=c,c=Sa(e,d+1),l&&c&&(Kn(t[d],0,Ea)?n[d]=n[d+1]=0:(a=n[d]/t[d],o=n[d+1]/t[d],i=Math.pow(a,2)+Math.pow(o,2),i<=9||(s=3/Math.sqrt(i),n[d]=a*s*t[d],n[d+1]=o*s*t[d])))}(e,a,o),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const r=ja(n),a=e.length;let o,s,i,l=Sa(e,0);for(let c=0;c<a;++c){if(s=i,i=l,l=Sa(e,c+1),!i)continue;const a=i[n],d=i[r];s&&(o=(a-s[n])/3,i[`cp1${n}`]=a-o,i[`cp1${r}`]=d-o*t[c]),l&&(o=(l[n]-a)/3,i[`cp2${n}`]=a+o,i[`cp2${r}`]=d+o*t[c])}}(e,o,t)}function Da(e,t,n){return Math.max(Math.min(e,n),t)}function Ta(e,t,n,r,a){let o,s,i,l;if(t.spanGaps&&(e=e.filter((e=>!e.skip))),"monotone"===t.cubicInterpolationMode)Ca(e,a);else{let n=r?e[e.length-1]:e[0];for(o=0,s=e.length;o<s;++o)i=e[o],l=ka(n,i,e[Math.min(o+1,s-(r?0:1))%s],t.tension),i.cp1x=l.previous.x,i.cp1y=l.previous.y,i.cp2x=l.next.x,i.cp2y=l.next.y,n=i}t.capBezierPoints&&function(e,t){let n,r,a,o,s,i=qr(e[0],t);for(n=0,r=e.length;n<r;++n)s=o,o=i,i=n<r-1&&qr(e[n+1],t),o&&(a=e[n],s&&(a.cp1x=Da(a.cp1x,t.left,t.right),a.cp1y=Da(a.cp1y,t.top,t.bottom)),i&&(a.cp2x=Da(a.cp2x,t.left,t.right),a.cp2y=Da(a.cp2y,t.top,t.bottom)))}(e,n)}function Aa(){return"undefined"!==typeof window&&"undefined"!==typeof document}function Pa(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function Ia(e,t,n){let r;return"string"===typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*t.parentNode[n])):r=e,r}const Ra=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const Ma=["top","right","bottom","left"];function Oa(e,t,n){const r={};n=n?"-"+n:"";for(let a=0;a<4;a++){const o=Ma[a];r[o]=parseFloat(e[t+"-"+o+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function La(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:r}=t,a=Ra(n),o="border-box"===a.boxSizing,s=Oa(a,"padding"),i=Oa(a,"border","width"),{x:l,y:c,box:d}=function(e,t){const n=e.touches,r=n&&n.length?n[0]:e,{offsetX:a,offsetY:o}=r;let s,i,l=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(a,o,e.target))s=a,i=o;else{const e=t.getBoundingClientRect();s=r.clientX-e.left,i=r.clientY-e.top,l=!0}return{x:s,y:i,box:l}}(e,n),u=s.left+(d&&i.left),h=s.top+(d&&i.top);let{width:p,height:m}=t;return o&&(p-=s.width+i.width,m-=s.height+i.height),{x:Math.round((l-u)/p*n.width/r),y:Math.round((c-h)/m*n.height/r)}}const $a=e=>Math.round(10*e)/10;function Fa(e,t,n,r){const a=Ra(e),o=Oa(a,"margin"),s=Ia(a.maxWidth,e,"clientWidth")||Wn,i=Ia(a.maxHeight,e,"clientHeight")||Wn,l=function(e,t,n){let r,a;if(void 0===t||void 0===n){const o=e&&Pa(e);if(o){const e=o.getBoundingClientRect(),s=Ra(o),i=Oa(s,"border","width"),l=Oa(s,"padding");t=e.width-l.width-i.width,n=e.height-l.height-i.height,r=Ia(s.maxWidth,o,"clientWidth"),a=Ia(s.maxHeight,o,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:r||Wn,maxHeight:a||Wn}}(e,t,n);let{width:c,height:d}=l;if("content-box"===a.boxSizing){const e=Oa(a,"border","width"),t=Oa(a,"padding");c-=t.width+e.width,d-=t.height+e.height}c=Math.max(0,c-o.width),d=Math.max(0,r?c/r:d-o.height),c=$a(Math.min(c,s,l.maxWidth)),d=$a(Math.min(d,i,l.maxHeight)),c&&!d&&(d=$a(c/2));return(void 0!==t||void 0!==n)&&r&&l.height&&d>l.height&&(d=l.height,c=$a(Math.floor(d*r))),{width:c,height:d}}function za(e,t,n){const r=t||1,a=Math.floor(e.height*r),o=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const s=e.canvas;return s.style&&(n||!s.style.height&&!s.style.width)&&(s.style.height=`${e.height}px`,s.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==r||s.height!==a||s.width!==o)&&(e.currentDevicePixelRatio=r,s.height=a,s.width=o,e.ctx.setTransform(r,0,0,r,0,0),!0)}const Ba=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Aa()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(Yv){}return e}();function Ua(e,t){const n=function(e,t){return Ra(e).getPropertyValue(t)}(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Wa(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Va(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:"middle"===r?n<.5?e.y:t.y:"after"===r?n<1?e.y:t.y:n>0?t.y:e.y}}function Ha(e,t,n,r){const a={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},s=Wa(e,a,n),i=Wa(a,o,n),l=Wa(o,t,n),c=Wa(s,i,n),d=Wa(i,l,n);return Wa(c,d,n)}function qa(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function Ya(e,t){let n,r;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function Ja(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Qa(e){return"angle"===e?{between:ir,compare:or,normalize:sr}:{between:cr,compare:(e,t)=>e-t,normalize:e=>e}}function Ka(e){let{start:t,end:n,count:r,loop:a,style:o}=e;return{start:t%r,end:n%r,loop:a&&(n-t+1)%r===0,style:o}}function Ga(e,t,n){if(!n)return[e];const{property:r,start:a,end:o}=n,s=t.length,{compare:i,between:l,normalize:c}=Qa(r),{start:d,end:u,loop:h,style:p}=function(e,t,n){const{property:r,start:a,end:o}=n,{between:s,normalize:i}=Qa(r),l=t.length;let c,d,{start:u,end:h,loop:p}=e;if(p){for(u+=l,h+=l,c=0,d=l;c<d&&s(i(t[u%l][r]),a,o);++c)u--,h--;u%=l,h%=l}return h<u&&(h+=l),{start:u,end:h,loop:p,style:e.style}}(e,t,n),m=[];let f,g,v,y=!1,b=null;const x=()=>y||l(a,v,f)&&0!==i(a,v),_=()=>!y||0===i(o,f)||l(o,v,f);for(let w=d,N=d;w<=u;++w)g=t[w%s],g.skip||(f=c(g[r]),f!==v&&(y=l(f,a,o),null===b&&x()&&(b=0===i(f,a)?w:N),null!==b&&_()&&(m.push(Ka({start:b,end:w,loop:h,count:s,style:p})),b=null),N=w,v=f));return null!==b&&m.push(Ka({start:b,end:u,loop:h,count:s,style:p})),m}function Xa(e,t){const n=[],r=e.segments;for(let a=0;a<r.length;a++){const o=Ga(r[a],e.points,t);o.length&&n.push(...o)}return n}function Za(e,t,n,r){return r&&r.setContext&&n?function(e,t,n,r){const a=e._chart.getContext(),o=eo(e.options),{_datasetIndex:s,options:{spanGaps:i}}=e,l=n.length,c=[];let d=o,u=t[0].start,h=u;function p(e,t,r,a){const o=i?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=o;for(;n[t%l].skip;)t+=o;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:r,style:a}),d=a,u=t%l)}}for(const m of t){u=i?u:m.start;let e,t=n[u%l];for(h=u+1;h<=m.end;h++){const o=n[h%l];e=eo(r.setContext(da(a,{type:"segment",p0:t,p1:o,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:s}))),to(e,d)&&p(u,h-1,m.loop,d),t=o,d=e}u<h-1&&p(u,h-1,m.loop,d)}return c}(e,t,n,r):t}function eo(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function to(e,t){if(!t)return!1;const n=[],r=function(e,t){return jr(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,r)!==JSON.stringify(t,r)}class no{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,r){const a=t.listeners[r],o=t.duration;a.forEach((r=>r({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(n-t.start,o)})))}_refresh(){this._request||(this._running=!0,this._request=gr.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach(((n,r)=>{if(!n.running||!n.items.length)return;const a=n.items;let o,s=a.length-1,i=!1;for(;s>=0;--s)o=a[s],o._active?(o._total>n.duration&&(n.duration=o._total),o.tick(e),i=!0):(a[s]=a[a.length-1],a.pop());i&&(r.draw(),this._notify(r,n,e,"progress")),a.length||(n.running=!1,this._notify(r,n,e,"complete"),n.initial=!1),t+=a.length})),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(((e,t)=>Math.max(e,t._duration)),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ro=new no;const ao="transparent",oo={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const r=kr(e||ao),a=r.valid&&kr(t||ao);return a&&a.valid?a.mix(r,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class so{constructor(e,t,n,r){const a=t[n];r=ca([e.to,r,a,e.from]);const o=ca([e.from,a,r]);this._active=!0,this._fn=e.fn||oo[e.type||typeof o],this._easing=Sr[e.easing]||Sr.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const r=this._target[this._prop],a=n-this._start,o=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=ca([e.to,t,r,e.from]),this._from=ca([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,r=this._prop,a=this._from,o=this._loop,s=this._to;let i;if(this._active=a!==s&&(o||t<n),!this._active)return this._target[r]=s,void this._notify(!0);t<0?this._target[r]=a:(i=t/n%2,i=o&&i>1?2-i:i,i=this._easing(Math.min(1,Math.max(0,i))),this._target[r]=this._fn(a,s,i))}wait(){const e=this._promises||(this._promises=[]);return new Promise(((t,n)=>{e.push({res:t,rej:n})}))}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][t]()}}class io{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!xn(e))return;const t=Object.keys(zr.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach((r=>{const a=e[r];if(!xn(a))return;const o={};for(const e of t)o[e]=a[e];(bn(a.properties)&&a.properties||[r]).forEach((e=>{e!==r&&n.has(e)||n.set(e,o)}))}))}_animateOptions(e,t){const n=t.options,r=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!r)return[];const a=this._createAnimations(r,n);return n.$shared&&function(e,t){const n=[],r=Object.keys(t);for(let a=0;a<r.length;a++){const t=e[r[a]];t&&t.active()&&n.push(t.wait())}return Promise.all(n)}(e.options.$animations,n).then((()=>{e.options=n}),(()=>{})),a}_createAnimations(e,t){const n=this._properties,r=[],a=e.$animations||(e.$animations={}),o=Object.keys(t),s=Date.now();let i;for(i=o.length-1;i>=0;--i){const l=o[i];if("$"===l.charAt(0))continue;if("options"===l){r.push(...this._animateOptions(e,t));continue}const c=t[l];let d=a[l];const u=n.get(l);if(d){if(u&&d.active()){d.update(u,c,s);continue}d.cancel()}u&&u.duration?(a[l]=d=new so(u,e,l,c),r.push(d)):e[l]=c}return r}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(ro.add(this._chart,n),!0):void 0}}function lo(e,t){const n=e&&e.options||{},r=n.reverse,a=void 0===n.min?t:0,o=void 0===n.max?t:0;return{start:r?o:a,end:r?a:o}}function co(e,t){const n=[],r=e._getSortedDatasetMetas(t);let a,o;for(a=0,o=r.length;a<o;++a)n.push(r[a].index);return n}function uo(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=e.keys,o="single"===r.mode;let s,i,l,c;if(null===t)return;let d=!1;for(s=0,i=a.length;s<i;++s){if(l=+a[s],l===n){if(d=!0,r.all)continue;break}c=e.values[l],_n(c)&&(o||0===t||Qn(t)===Qn(c))&&(t+=c)}return d||r.all?t:0}function ho(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function po(e,t,n){const r=e[t]||(e[t]={});return r[n]||(r[n]={})}function mo(e,t,n,r){for(const a of t.getMatchingVisibleMetas(r).reverse()){const t=e[a.index];if(n&&t>0||!n&&t<0)return a.index}return null}function fo(e,t){const{chart:n,_cachedMeta:r}=e,a=n._stacks||(n._stacks={}),{iScale:o,vScale:s,index:i}=r,l=o.axis,c=s.axis,d=function(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}(o,s,r),u=t.length;let h;for(let p=0;p<u;++p){const e=t[p],{[l]:n,[c]:o}=e;h=(e._stacks||(e._stacks={}))[c]=po(a,d,n),h[i]=o,h._top=mo(h,s,!0,r.type),h._bottom=mo(h,s,!1,r.type);(h._visualValues||(h._visualValues={}))[i]=o}}function go(e,t){const n=e.scales;return Object.keys(n).filter((e=>n[e].axis===t)).shift()}function vo(e,t){const n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[r]||void 0===t[r][n])return;delete t[r][n],void 0!==t[r]._visualValues&&void 0!==t[r]._visualValues[n]&&delete t[r]._visualValues[n]}}}const yo=e=>"reset"===e||"none"===e,bo=(e,t)=>t?e:Object.assign({},e);class xo{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=ho(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&vo(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),r=(e,t,n,r)=>"x"===e?t:"r"===e?r:n,a=t.xAxisID=Nn(n.xAxisID,go(e,"x")),o=t.yAxisID=Nn(n.yAxisID,go(e,"y")),s=t.rAxisID=Nn(n.rAxisID,go(e,"r")),i=t.indexAxis,l=t.iAxisID=r(i,a,o,s),c=t.vAxisID=r(i,o,a,s);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(s),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&mr(this._data,this),e._stacked&&vo(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(xn(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:n,vScale:r}=t,a="x"===n.axis?"x":"y",o="x"===r.axis?"x":"y",s=Object.keys(e),i=new Array(s.length);let l,c,d;for(l=0,c=s.length;l<c;++l)d=s[l],i[l]={[a]:d,[o]:e[d]};return i}(t,e)}else if(n!==t){if(n){mr(n,this);const e=this._cachedMeta;vo(e),e._parsed=[]}t&&Object.isExtensible(t)&&(a=this,(r=t)._chartjs?r._chartjs.listeners.push(a):(Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[a]}}),pr.forEach((e=>{const t="_onData"+On(e),n=r[e];Object.defineProperty(r,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,a=new Array(e),o=0;o<e;o++)a[o]=arguments[o];const s=n.apply(this,a);return r._chartjs.listeners.forEach((e=>{"function"===typeof e[t]&&e[t](...a)})),s}})})))),this._syncList=[],this._data=t}var r,a}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let r=!1;this._dataCheck();const a=t._stacked;t._stacked=ho(t.vScale,t),t.stack!==n.stack&&(r=!0,vo(t),t.stack=n.stack),this._resyncElements(e),(r||a!==t._stacked)&&(fo(this,t._parsed),t._stacked=ho(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:r}=this,{iScale:a,_stacked:o}=n,s=a.axis;let i,l,c,d=0===e&&t===r.length||n._sorted,u=e>0&&n._parsed[e-1];if(!1===this._parsing)n._parsed=r,n._sorted=!0,c=r;else{c=bn(r[e])?this.parseArrayData(n,r,e,t):xn(r[e])?this.parseObjectData(n,r,e,t):this.parsePrimitiveData(n,r,e,t);const a=()=>null===l[s]||u&&l[s]<u[s];for(i=0;i<t;++i)n._parsed[i+e]=l=c[i],d&&(a()&&(d=!1),u=l);n._sorted=d}o&&fo(this,c)}parsePrimitiveData(e,t,n,r){const{iScale:a,vScale:o}=e,s=a.axis,i=o.axis,l=a.getLabels(),c=a===o,d=new Array(r);let u,h,p;for(u=0,h=r;u<h;++u)p=u+n,d[u]={[s]:c||a.parse(l[p],p),[i]:o.parse(t[p],p)};return d}parseArrayData(e,t,n,r){const{xScale:a,yScale:o}=e,s=new Array(r);let i,l,c,d;for(i=0,l=r;i<l;++i)c=i+n,d=t[c],s[i]={x:a.parse(d[0],c),y:o.parse(d[1],c)};return s}parseObjectData(e,t,n,r){const{xScale:a,yScale:o}=e,{xAxisKey:s="x",yAxisKey:i="y"}=this._parsing,l=new Array(r);let c,d,u,h;for(c=0,d=r;c<d;++c)u=c+n,h=t[u],l[c]={x:a.parse(Mn(h,s),u),y:o.parse(Mn(h,i),u)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const r=this.chart,a=this._cachedMeta,o=t[e.axis];return uo({keys:co(r,!0),values:t._stacks[e.axis]._visualValues},o,a.index,{mode:n})}updateRangeFromParsed(e,t,n,r){const a=n[t.axis];let o=null===a?NaN:a;const s=r&&n._stacks[t.axis];r&&s&&(r.values=s,o=uo(r,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const n=this._cachedMeta,r=n._parsed,a=n._sorted&&e===n.iScale,o=r.length,s=this._getOtherScale(e),i=((e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:co(n,!0),values:null})(t,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(e){const{min:t,max:n,minDefined:r,maxDefined:a}=e.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:a?n:Number.POSITIVE_INFINITY}}(s);let u,h;function p(){h=r[u];const t=h[s.axis];return!_n(h[e.axis])||c>t||d<t}for(u=0;u<o&&(p()||(this.updateRangeFromParsed(l,e,h,i),!a));++u);if(a)for(u=o-1;u>=0;--u)if(!p()){this.updateRangeFromParsed(l,e,h,i);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let r,a,o;for(r=0,a=t.length;r<a;++r)o=t[r][e.axis],_n(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,r=t.vScale,a=this.getParsed(e);return{label:n?""+n.getLabelForValue(a[n.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,n,r,a;return xn(e)?(t=e.top,n=e.right,r=e.bottom,a=e.left):t=n=r=a=e,{top:t,right:n,bottom:r,left:a,disabled:!1===e}}(Nn(this.options.clip,function(e,t,n){if(!1===n)return!1;const r=lo(e,n),a=lo(t,n);return{top:a.end,right:r.end,bottom:a.start,left:r.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,r=n.data||[],a=t.chartArea,o=[],s=this._drawStart||0,i=this._drawCount||r.length-s,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(e,a,s,i),c=s;c<s+i;++c){const t=r[c];t.hidden||(t.active&&l?o.push(t):t.draw(e,a))}for(c=0;c<o.length;++c)o[c].draw(e,a)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const r=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];a=t.$context||(t.$context=function(e,t,n){return da(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),a.parsed=this.getParsed(e),a.raw=r.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=function(e,t){return da(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),a.dataset=r,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=n,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0;const r="active"===t,a=this._cachedDataOpts,o=e+"-"+t,s=a[o],i=this.enableOptionSharing&&Ln(n);if(s)return bo(s,i);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),d=r?[`${e}Hover`,"hover",e,""]:[e,""],u=l.getOptionScopes(this.getDataset(),c),h=Object.keys(zr.elements[e]),p=l.resolveNamedOptions(u,h,(()=>this.getContext(n,r,t)),d);return p.$shared&&(p.$shared=i,a[o]=Object.freeze(bo(p,i))),p}_resolveAnimations(e,t,n){const r=this.chart,a=this._cachedDataOpts,o=`animation-${t}`,s=a[o];if(s)return s;let i;if(!1!==r.options.animation){const r=this.chart.config,a=r.datasetAnimationScopeKeys(this._type,t),o=r.getOptionScopes(this.getDataset(),a);i=r.createResolver(o,this.getContext(e,n,t))}const l=new io(r,i&&i.animations);return i&&i._cacheable&&(a[o]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||yo(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),r=this._sharedOptions,a=this.getSharedOptions(n),o=this.includeOptions(t,a)||a!==r;return this.updateSharedOptions(a,t,n),{sharedOptions:a,includeOptions:o}}updateElement(e,t,n,r){yo(r)?Object.assign(e,n):this._resolveAnimations(t,r).update(e,n)}updateSharedOptions(e,t,n){e&&!yo(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,r){e.active=r;const a=this.getStyle(t,r);this._resolveAnimations(t,n,r).update(e,{options:!r&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[s,i,l]of this._syncList)this[s](i,l);this._syncList=[];const r=n.length,a=t.length,o=Math.min(a,r);o&&this.parse(0,o),a>r?this._insertElements(r,a-r,e):a<r&&this._removeElements(a,r-a)}_insertElements(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._cachedMeta,a=r.data,o=e+t;let s;const i=e=>{for(e.length+=t,s=e.length-1;s>=o;s--)e[s]=e[s-t]};for(i(a),s=e;s<o;++s)a[s]=new this.dataElementType;this._parsing&&i(r._parsed),this.parse(e,t),n&&this.updateElements(a,e,t,"reset")}updateElements(e,t,n,r){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(e,t);n._stacked&&vo(n,r)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,r]=e;this[t](n,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function _o(e){const t=e.iScale,n=function(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let r=[];for(let t=0,a=n.length;t<a;t++)r=r.concat(n[t].controller.getAllParsedValues(e));e._cache.$bar=fr(r.sort(((e,t)=>e-t)))}return e._cache.$bar}(t,e.type);let r,a,o,s,i=t._length;const l=()=>{32767!==o&&-32768!==o&&(Ln(s)&&(i=Math.min(i,Math.abs(o-s)||i)),s=o)};for(r=0,a=n.length;r<a;++r)o=t.getPixelForValue(n[r]),l();for(s=void 0,r=0,a=t.ticks.length;r<a;++r)o=t.getPixelForTick(r),l();return i}function wo(e,t,n,r){return bn(e)?function(e,t,n,r){const a=n.parse(e[0],r),o=n.parse(e[1],r),s=Math.min(a,o),i=Math.max(a,o);let l=s,c=i;Math.abs(s)>Math.abs(i)&&(l=i,c=s),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:a,end:o,min:s,max:i}}(e,t,n,r):t[n.axis]=n.parse(e,r),t}function No(e,t,n,r){const a=e.iScale,o=e.vScale,s=a.getLabels(),i=a===o,l=[];let c,d,u,h;for(c=n,d=n+r;c<d;++c)h=t[c],u={},u[a.axis]=i||a.parse(s[c],c),l.push(wo(h,u,o,c));return l}function Eo(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function So(e,t,n,r){let a=t.borderSkipped;const o={};if(!a)return void(e.borderSkipped=o);if(!0===a)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:s,end:i,reverse:l,top:c,bottom:d}=function(e){let t,n,r,a,o;return e.horizontal?(t=e.base>e.x,n="left",r="right"):(t=e.base<e.y,n="bottom",r="top"),t?(a="end",o="start"):(a="start",o="end"),{start:n,end:r,reverse:t,top:a,bottom:o}}(e);"middle"===a&&n&&(e.enableBorderRadius=!0,(n._top||0)===r?a=c:(n._bottom||0)===r?a=d:(o[jo(d,s,i,l)]=!0,a=c)),o[jo(a,s,i,l)]=!0,e.borderSkipped=o}function jo(e,t,n,r){var a,o,s;return r?(s=n,e=ko(e=(a=e)===(o=t)?s:a===s?o:a,n,t)):e=ko(e,t,n),e}function ko(e,t,n){return"start"===e?t:"end"===e?n:e}function Co(e,t,n){let{inflateAmount:r}=t;e.inflateAmount="auto"===r?1===n?.33:0:r}class Do extends xo{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,n,r){return No(e,t,n,r)}parseArrayData(e,t,n,r){return No(e,t,n,r)}parseObjectData(e,t,n,r){const{iScale:a,vScale:o}=e,{xAxisKey:s="x",yAxisKey:i="y"}=this._parsing,l="x"===a.axis?s:i,c="x"===o.axis?s:i,d=[];let u,h,p,m;for(u=n,h=n+r;u<h;++u)m=t[u],p={},p[a.axis]=a.parse(Mn(m,l),u),d.push(wo(Mn(m,c),p,o,u));return d}updateRangeFromParsed(e,t,n,r){super.updateRangeFromParsed(e,t,n,r);const a=n._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:r}=t,a=this.getParsed(e),o=a._custom,s=Eo(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+n.getLabelForValue(a[n.axis]),value:s}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,r){const a="reset"===r,{index:o,_cachedMeta:{vScale:s}}=this,i=s.getBasePixel(),l=s.isHorizontal(),c=this._getRuler(),{sharedOptions:d,includeOptions:u}=this._getSharedOptions(t,r);for(let h=t;h<t+n;h++){const t=this.getParsed(h),n=a||yn(t[s.axis])?{base:i,head:i}:this._calculateBarValuePixels(h),p=this._calculateBarIndexPixels(h,c),m=(t._stacks||{})[s.axis],f={horizontal:l,base:n.base,enableBorderRadius:!m||Eo(t._custom)||o===m._top||o===m._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};u&&(f.options=d||this.resolveDataElementOptions(h,e[h].active?"active":r));const g=f.options||e[h].options;So(f,g,m,o),Co(f,g,c.ratio),this.updateElement(e[h],h,f,r)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,r=n.getMatchingVisibleMetas(this._type).filter((e=>e.controller.options.grouped)),a=n.options.stacked,o=[],s=this._cachedMeta.controller.getParsed(t),i=s&&s[n.axis],l=e=>{const t=e._parsed.find((e=>e[n.axis]===i)),r=t&&t[e.vScale.axis];if(yn(r)||isNaN(r))return!0};for(const c of r)if((void 0===t||!l(c))&&((!1===a||-1===o.indexOf(c.stack)||void 0===a&&void 0===c.stack)&&o.push(c.stack),c.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,n){const r=this._getStacks(e,n),a=void 0!==t?r.indexOf(t):-1;return-1===a?r.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,r=[];let a,o;for(a=0,o=t.data.length;a<o;++a)r.push(n.getPixelForValue(this.getParsed(a)[n.axis],a));const s=e.barThickness;return{min:s||_o(t),pixels:r,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:s?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:r},options:{base:a,minBarLength:o}}=this,s=a||0,i=this.getParsed(e),l=i._custom,c=Eo(l);let d,u,h=i[t.axis],p=0,m=n?this.applyStack(t,i,n):h;m!==h&&(p=m-h,m=h),c&&(h=l.barStart,m=l.barEnd-l.barStart,0!==h&&Qn(h)!==Qn(l.barEnd)&&(p=0),p+=h);const f=yn(a)||c?p:a;let g=t.getPixelForValue(f);if(d=this.chart.getDataVisibility(e)?t.getPixelForValue(p+m):g,u=d-g,Math.abs(u)<o){u=function(e,t,n){return 0!==e?Qn(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(u,t,s)*o,h===s&&(g-=u/2);const e=t.getPixelForDecimal(0),a=t.getPixelForDecimal(1),l=Math.min(e,a),p=Math.max(e,a);g=Math.max(Math.min(g,p),l),d=g+u,n&&!c&&(i._stacks[t.axis]._visualValues[r]=t.getValueForPixel(d)-t.getValueForPixel(g))}if(g===t.getPixelForValue(s)){const e=Qn(u)*t.getLineWidthForValue(s)/2;g+=e,u-=e}return{size:u,base:g,head:d,center:d+u/2}}_calculateBarIndexPixels(e,t){const n=t.scale,r=this.options,a=r.skipNull,o=Nn(r.maxBarThickness,1/0);let s,i;if(t.grouped){const n=a?this._getStackCount(e):t.stackCount,l="flex"===r.barThickness?function(e,t,n,r){const a=t.pixels,o=a[e];let s=e>0?a[e-1]:null,i=e<a.length-1?a[e+1]:null;const l=n.categoryPercentage;null===s&&(s=o-(null===i?t.end-t.start:i-o)),null===i&&(i=o+o-s);const c=o-(o-Math.min(s,i))/2*l;return{chunk:Math.abs(i-s)/2*l/r,ratio:n.barPercentage,start:c}}(e,t,r,n):function(e,t,n,r){const a=n.barThickness;let o,s;return yn(a)?(o=t.min*n.categoryPercentage,s=n.barPercentage):(o=a*r,s=1),{chunk:o/r,ratio:s,start:t.pixels[e]-o/2}}(e,t,r,n),c=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0);s=l.start+l.chunk*c+l.chunk/2,i=Math.min(o,l.chunk*l.ratio)}else s=n.getPixelForValue(this.getParsed(e)[n.axis],e),i=Math.min(o,t.min*t.ratio);return{base:s-i/2,head:s+i/2,center:s,size:i}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,r=n.length;let a=0;for(;a<r;++a)null===this.getParsed(a)[t.axis]||n[a].hidden||n[a].draw(this._ctx)}}class To extends xo{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:r}}=e.legend.options;return t.labels.map(((t,a)=>{const o=e.getDatasetMeta(0).controller.getStyle(a);return{text:t,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,fontColor:r,lineWidth:o.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(a),index:a}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=n;else{let a,o,s=e=>+n[e];if(xn(n[e])){const{key:e="value"}=this._parsing;s=t=>+Mn(n[t],e)}for(a=e,o=e+t;a<o;++a)r._parsed[a]=s(a)}}_getRotation(){return er(this.options.rotation-90)}_getCircumference(){return er(this.options.circumference)}_getRotationExtents(){let e=Bn,t=-Bn;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const r=this.chart.getDatasetMeta(n).controller,a=r._getRotation(),o=r._getCircumference();e=Math.min(e,a),t=Math.max(t,a+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,r=this._cachedMeta,a=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,s=Math.max((Math.min(n.width,n.height)-o)/2,0),i=Math.min((l=this.options.cutout,c=s,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const d=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:p,ratioY:m,offsetX:f,offsetY:g}=function(e,t,n){let r=1,a=1,o=0,s=0;if(t<Bn){const i=e,l=i+t,c=Math.cos(i),d=Math.sin(i),u=Math.cos(l),h=Math.sin(l),p=(e,t,r)=>ir(e,i,l,!0)?1:Math.max(t,t*n,r,r*n),m=(e,t,r)=>ir(e,i,l,!0)?-1:Math.min(t,t*n,r,r*n),f=p(0,c,u),g=p(Hn,d,h),v=m(zn,c,u),y=m(zn+Hn,d,h);r=(f-v)/2,a=(g-y)/2,o=-(f+v)/2,s=-(g+y)/2}return{ratioX:r,ratioY:a,offsetX:o,offsetY:s}}(h,u,i),v=(n.width-o)/p,y=(n.height-o)/m,b=Math.max(Math.min(v,y)/2,0),x=En(this.options.radius,b),_=(x-Math.max(x*i,0))/this._getVisibleDatasetWeightTotal();this.offsetX=f*x,this.offsetY=g*x,r.total=this.calculateTotal(),this.outerRadius=x-_*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_*d,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const n=this.options,r=this._cachedMeta,a=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*a/Bn)}updateElements(e,t,n,r){const a="reset"===r,o=this.chart,s=o.chartArea,i=o.options.animation,l=(s.left+s.right)/2,c=(s.top+s.bottom)/2,d=a&&i.animateScale,u=d?0:this.innerRadius,h=d?0:this.outerRadius,{sharedOptions:p,includeOptions:m}=this._getSharedOptions(t,r);let f,g=this._getRotation();for(f=0;f<t;++f)g+=this._circumference(f,a);for(f=t;f<t+n;++f){const t=this._circumference(f,a),n=e[f],o={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+t,circumference:t,outerRadius:h,innerRadius:u};m&&(o.options=p||this.resolveDataElementOptions(f,n.active?"active":r)),g+=t,this.updateElement(n,f,o,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,r=0;for(n=0;n<t.length;n++){const a=e._parsed[n];null===a||isNaN(a)||!this.chart.getDataVisibility(n)||t[n].hidden||(r+=Math.abs(a))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Bn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,r=n.data.labels||[],a=Pr(t._parsed[e],n.options.locale);return{label:r[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const n=this.chart;let r,a,o,s,i;if(!e)for(r=0,a=n.data.datasets.length;r<a;++r)if(n.isDatasetVisible(r)){o=n.getDatasetMeta(r),e=o.data,s=o.controller;break}if(!e)return 0;for(r=0,a=e.length;r<a;++r)i=s.resolveDataElementOptions(r),"inner"!==i.borderAlign&&(t=Math.max(t,i.borderWidth||0,i.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,r=e.length;n<r;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(Nn(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Ao extends xo{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:r=[],_dataset:a}=t,o=this.chart._animationsDisabled;let{start:s,count:i}=xr(t,r,o);this._drawStart=s,this._drawCount=i,_r(t)&&(s=0,i=r.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!a._decimated,n.points=r;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:l},e),this.updateElements(r,s,i,e)}updateElements(e,t,n,r){const a="reset"===r,{iScale:o,vScale:s,_stacked:i,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(t,r),u=o.axis,h=s.axis,{spanGaps:p,segment:m}=this.options,f=Xn(p)?p:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||a||"none"===r,v=t+n,y=e.length;let b=t>0&&this.getParsed(t-1);for(let x=0;x<y;++x){const n=e[x],p=g?n:{};if(x<t||x>=v){p.skip=!0;continue}const y=this.getParsed(x),_=yn(y[h]),w=p[u]=o.getPixelForValue(y[u],x),N=p[h]=a||_?s.getBasePixel():s.getPixelForValue(i?this.applyStack(s,y,i):y[h],x);p.skip=isNaN(w)||isNaN(N)||_,p.stop=x>0&&Math.abs(y[u]-b[u])>f,m&&(p.parsed=y,p.raw=l.data[x]),d&&(p.options=c||this.resolveDataElementOptions(x,n.active?"active":r)),g||this.updateElement(n,x,p,r),b=y}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return n;const a=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(n,a,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class Po extends To{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function Io(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ro{static override(e){Object.assign(Ro.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Io()}parse(){return Io()}format(){return Io()}add(){return Io()}diff(){return Io()}startOf(){return Io()}endOf(){return Io()}}var Mo=Ro;function Oo(e,t,n,r){const{controller:a,data:o,_sorted:s}=e,i=a._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(i&&t===i.axis&&"r"!==t&&s&&o.length){const s=i._reversePixels?hr:ur;if(!r){const r=s(o,t,n);if(l){const{vScale:t}=a._cachedMeta,{_parsed:n}=e,o=n.slice(0,r.lo+1).reverse().findIndex((e=>!yn(e[t.axis])));r.lo-=Math.max(0,o);const s=n.slice(r.hi).findIndex((e=>!yn(e[t.axis])));r.hi+=Math.max(0,s)}return r}if(a._sharedOptions){const e=o[0],r="function"===typeof e.getRange&&e.getRange(t);if(r){const e=s(o,t,n-r),a=s(o,t,n+r);return{lo:e.lo,hi:a.hi}}}}return{lo:0,hi:o.length-1}}function Lo(e,t,n,r,a){const o=e.getSortedVisibleDatasetMetas(),s=n[t];for(let i=0,l=o.length;i<l;++i){const{index:e,data:n}=o[i],{lo:l,hi:c}=Oo(o[i],t,s,a);for(let t=l;t<=c;++t){const a=n[t];a.skip||r(a,e,t)}}}function $o(e,t,n,r,a){const o=[];if(!a&&!e.isPointInArea(t))return o;return Lo(e,n,t,(function(n,s,i){(a||qr(n,e.chartArea,0))&&n.inRange(t.x,t.y,r)&&o.push({element:n,datasetIndex:s,index:i})}),!0),o}function Fo(e,t,n,r,a,o){let s=[];const i=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,r){const a=t?Math.abs(e.x-r.x):0,o=n?Math.abs(e.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}(n);let l=Number.POSITIVE_INFINITY;return Lo(e,n,t,(function(n,c,d){const u=n.inRange(t.x,t.y,a);if(r&&!u)return;const h=n.getCenterPoint(a);if(!(!!o||e.isPointInArea(h))&&!u)return;const p=i(t,h);p<l?(s=[{element:n,datasetIndex:c,index:d}],l=p):p===l&&s.push({element:n,datasetIndex:c,index:d})})),s}function zo(e,t,n,r,a,o){return o||e.isPointInArea(t)?"r"!==n||r?Fo(e,t,n,r,a,o):function(e,t,n,r){let a=[];return Lo(e,n,t,(function(e,n,o){const{startAngle:s,endAngle:i}=e.getProps(["startAngle","endAngle"],r),{angle:l}=rr(e,{x:t.x,y:t.y});ir(l,s,i)&&a.push({element:e,datasetIndex:n,index:o})})),a}(e,t,n,a):[]}function Bo(e,t,n,r,a){const o=[],s="x"===n?"inXRange":"inYRange";let i=!1;return Lo(e,n,t,((e,r,l)=>{e[s]&&e[s](t[n],a)&&(o.push({element:e,datasetIndex:r,index:l}),i=i||e.inRange(t.x,t.y,a))})),r&&!i?[]:o}var Uo={evaluateInteractionItems:Lo,modes:{index(e,t,n,r){const a=La(t,e),o=n.axis||"x",s=n.includeInvisible||!1,i=n.intersect?$o(e,a,o,r,s):zo(e,a,o,!1,r,s),l=[];return i.length?(e.getSortedVisibleDatasetMetas().forEach((e=>{const t=i[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})})),l):[]},dataset(e,t,n,r){const a=La(t,e),o=n.axis||"xy",s=n.includeInvisible||!1;let i=n.intersect?$o(e,a,o,r,s):zo(e,a,o,!1,r,s);if(i.length>0){const t=i[0].datasetIndex,n=e.getDatasetMeta(t).data;i=[];for(let e=0;e<n.length;++e)i.push({element:n[e],datasetIndex:t,index:e})}return i},point:(e,t,n,r)=>$o(e,La(t,e),n.axis||"xy",r,n.includeInvisible||!1),nearest(e,t,n,r){const a=La(t,e),o=n.axis||"xy",s=n.includeInvisible||!1;return zo(e,a,o,n.intersect,r,s)},x:(e,t,n,r)=>Bo(e,La(t,e),"x",n.intersect,r),y:(e,t,n,r)=>Bo(e,La(t,e),"y",n.intersect,r)}};const Wo=["left","top","right","bottom"];function Vo(e,t){return e.filter((e=>e.pos===t))}function Ho(e,t){return e.filter((e=>-1===Wo.indexOf(e.pos)&&e.box.axis===t))}function qo(e,t){return e.sort(((e,n)=>{const r=t?n:e,a=t?e:n;return r.weight===a.weight?r.index-a.index:r.weight-a.weight}))}function Yo(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:r,stackWeight:a}=n;if(!e||!Wo.includes(r))continue;const o=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return t}(e),{vBoxMaxWidth:r,hBoxMaxHeight:a}=t;let o,s,i;for(o=0,s=e.length;o<s;++o){i=e[o];const{fullSize:s}=i.box,l=n[i.stack],c=l&&i.stackWeight/l.weight;i.horizontal?(i.width=c?c*r:s&&t.availableWidth,i.height=a):(i.width=r,i.height=c?c*a:s&&t.availableHeight)}return n}function Jo(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function Qo(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Ko(e,t,n,r){const{pos:a,box:o}=n,s=e.maxPadding;if(!xn(a)){n.size&&(e[a]-=n.size);const t=r[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?o.height:o.width),n.size=t.size/t.count,e[a]+=n.size}o.getPadding&&Qo(s,o.getPadding());const i=Math.max(0,t.outerWidth-Jo(s,e,"left","right")),l=Math.max(0,t.outerHeight-Jo(s,e,"top","bottom")),c=i!==e.w,d=l!==e.h;return e.w=i,e.h=l,n.horizontal?{same:c,other:d}:{same:d,other:c}}function Go(e,t){const n=t.maxPadding;function r(e){const r={left:0,top:0,right:0,bottom:0};return e.forEach((e=>{r[e]=Math.max(t[e],n[e])})),r}return r(e?["left","right"]:["top","bottom"])}function Xo(e,t,n,r){const a=[];let o,s,i,l,c,d;for(o=0,s=e.length,c=0;o<s;++o){i=e[o],l=i.box,l.update(i.width||t.w,i.height||t.h,Go(i.horizontal,t));const{same:s,other:u}=Ko(t,n,i,r);c|=s&&a.length,d=d||u,l.fullSize||a.push(i)}return c&&Xo(a,t,n,r)||d}function Zo(e,t,n,r,a){e.top=n,e.left=t,e.right=t+r,e.bottom=n+a,e.width=r,e.height=a}function es(e,t,n,r){const a=n.padding;let{x:o,y:s}=t;for(const i of e){const e=i.box,l=r[i.stack]||{count:1,placed:0,weight:1},c=i.stackWeight/l.weight||1;if(i.horizontal){const r=t.w*c,o=l.size||e.height;Ln(l.start)&&(s=l.start),e.fullSize?Zo(e,a.left,s,n.outerWidth-a.right-a.left,o):Zo(e,t.left+l.placed,s,r,o),l.start=s,l.placed+=r,s=e.bottom}else{const r=t.h*c,s=l.size||e.width;Ln(l.start)&&(o=l.start),e.fullSize?Zo(e,o,a.top,s,n.outerHeight-a.bottom-a.top):Zo(e,o,t.top+l.placed,s,r),l.start=o,l.placed+=r,o=e.right}}t.x=o,t.y=s}var ts={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,r){if(!e)return;const a=ia(e.options.layout.padding),o=Math.max(t-a.width,0),s=Math.max(n-a.height,0),i=function(e){const t=function(e){const t=[];let n,r,a,o,s,i;for(n=0,r=(e||[]).length;n<r;++n)a=e[n],({position:o,options:{stack:s,stackWeight:i=1}}=a),t.push({index:n,box:a,pos:o,horizontal:a.isHorizontal(),weight:a.weight,stack:s&&o+s,stackWeight:i});return t}(e),n=qo(t.filter((e=>e.box.fullSize)),!0),r=qo(Vo(t,"left"),!0),a=qo(Vo(t,"right")),o=qo(Vo(t,"top"),!0),s=qo(Vo(t,"bottom")),i=Ho(t,"x"),l=Ho(t,"y");return{fullSize:n,leftAndTop:r.concat(o),rightAndBottom:a.concat(l).concat(s).concat(i),chartArea:Vo(t,"chartArea"),vertical:r.concat(a).concat(l),horizontal:o.concat(s).concat(i)}}(e.boxes),l=i.vertical,c=i.horizontal;jn(e.boxes,(e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()}));const d=l.reduce(((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1),0)||1,u=Object.freeze({outerWidth:t,outerHeight:n,padding:a,availableWidth:o,availableHeight:s,vBoxMaxWidth:o/2/d,hBoxMaxHeight:s/2}),h=Object.assign({},a);Qo(h,ia(r));const p=Object.assign({maxPadding:h,w:o,h:s,x:a.left,y:a.top},a),m=Yo(l.concat(c),u);Xo(i.fullSize,p,u,m),Xo(l,p,u,m),Xo(c,p,u,m)&&Xo(l,p,u,m),function(e){const t=e.maxPadding;function n(n){const r=Math.max(t[n]-e[n],0);return e[n]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(p),es(i.leftAndTop,p,u,m),p.x+=p.w,p.y+=p.h,es(i.rightAndBottom,p,u,m),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},jn(i.chartArea,(t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})}))}};class ns{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,r){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):n)}}isAttached(e){return!0}updateConfig(e){}}class rs extends ns{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const as="$chartjs",os={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ss=e=>null===e||""===e;const is=!!Ba&&{passive:!0};function ls(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,is)}function cs(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function ds(e,t,n){const r=e.canvas,a=new MutationObserver((e=>{let t=!1;for(const n of e)t=t||cs(n.addedNodes,r),t=t&&!cs(n.removedNodes,r);t&&n()}));return a.observe(document,{childList:!0,subtree:!0}),a}function us(e,t,n){const r=e.canvas,a=new MutationObserver((e=>{let t=!1;for(const n of e)t=t||cs(n.removedNodes,r),t=t&&!cs(n.addedNodes,r);t&&n()}));return a.observe(document,{childList:!0,subtree:!0}),a}const hs=new Map;let ps=0;function ms(){const e=window.devicePixelRatio;e!==ps&&(ps=e,hs.forEach(((t,n)=>{n.currentDevicePixelRatio!==e&&t()})))}function fs(e,t,n){const r=e.canvas,a=r&&Pa(r);if(!a)return;const o=vr(((e,t)=>{const r=a.clientWidth;n(e,t),r<a.clientWidth&&n()}),window),s=new ResizeObserver((e=>{const t=e[0],n=t.contentRect.width,r=t.contentRect.height;0===n&&0===r||o(n,r)}));return s.observe(a),function(e,t){hs.size||window.addEventListener("resize",ms),hs.set(e,t)}(e,o),s}function gs(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){hs.delete(e),hs.size||window.removeEventListener("resize",ms)}(e)}function vs(e,t,n){const r=e.canvas,a=vr((t=>{null!==e.ctx&&n(function(e,t){const n=os[e.type]||e.type,{x:r,y:a}=La(e,t);return{type:n,chart:t,native:e,x:void 0!==r?r:null,y:void 0!==a?a:null}}(t,e))}),e);return function(e,t,n){e&&e.addEventListener(t,n,is)}(r,t,a),a}class ys extends ns{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,r=e.getAttribute("height"),a=e.getAttribute("width");if(e[as]={initial:{height:r,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",ss(a)){const t=Ua(e,"width");void 0!==t&&(e.width=t)}if(ss(r))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Ua(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[as])return!1;const n=t[as].initial;["height","width"].forEach((e=>{const r=n[e];yn(r)?t.removeAttribute(e):t.setAttribute(e,r)}));const r=n.style||{};return Object.keys(r).forEach((e=>{t.style[e]=r[e]})),t.width=t.width,delete t[as],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),a={attach:ds,detach:us,resize:fs}[t]||vs;r[t]=a(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),r=n[t];if(!r)return;({attach:gs,detach:gs,resize:gs}[t]||ls)(e,t,r),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,r){return Fa(e,t,n,r)}isAttached(e){const t=e&&Pa(e);return!(!t||!t.isConnected)}}class bs{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return Xn(this.x)&&Xn(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const r={};return e.forEach((e=>{r[e]=n[e]&&n[e].active()?n[e]._to:this[e]})),r}}function xs(e,t){const n=e.options.ticks,r=function(e){const t=e.options.offset,n=e._tickSize(),r=e._length/n+(t?0:1),a=e._maxLength/n;return Math.floor(Math.min(r,a))}(e),a=Math.min(n.maxTicksLimit||r,r),o=n.major.enabled?function(e){const t=[];let n,r;for(n=0,r=e.length;n<r;n++)e[n].major&&t.push(n);return t}(t):[],s=o.length,i=o[0],l=o[s-1],c=[];if(s>a)return function(e,t,n,r){let a,o=0,s=n[0];for(r=Math.ceil(r),a=0;a<e.length;a++)a===s&&(t.push(e[a]),o++,s=n[o*r])}(t,c,o,s/a),c;const d=function(e,t,n){const r=function(e){const t=e.length;let n,r;if(t<2)return!1;for(r=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==r)return!1;return r}(e),a=t.length/n;if(!r)return Math.max(a,1);const o=function(e){const t=[],n=Math.sqrt(e);let r;for(r=1;r<n;r++)e%r===0&&(t.push(r),t.push(e/r));return n===(0|n)&&t.push(n),t.sort(((e,t)=>e-t)).pop(),t}(r);for(let s=0,i=o.length-1;s<i;s++){const e=o[s];if(e>a)return e}return Math.max(a,1)}(o,t,a);if(s>0){let e,n;const r=s>1?Math.round((l-i)/(s-1)):null;for(_s(t,c,d,yn(r)?0:i-r,i),e=0,n=s-1;e<n;e++)_s(t,c,d,o[e],o[e+1]);return _s(t,c,d,l,yn(r)?t.length:l+r),c}return _s(t,c,d),c}function _s(e,t,n,r,a){const o=Nn(r,0),s=Math.min(Nn(a,e.length),e.length);let i,l,c,d=0;for(n=Math.ceil(n),a&&(i=a-r,n=i/Math.floor(i/n)),c=o;c<0;)d++,c=Math.round(o+d*n);for(l=Math.max(o,0);l<s;l++)l===c&&(t.push(e[l]),d++,c=Math.round(o+d*n))}const ws=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n,Ns=(e,t)=>Math.min(t||e,e);function Es(e,t){const n=[],r=e.length/t,a=e.length;let o=0;for(;o<a;o+=r)n.push(e[Math.floor(o)]);return n}function Ss(e,t,n){const r=e.ticks.length,a=Math.min(t,r-1),o=e._startPixel,s=e._endPixel,i=1e-6;let l,c=e.getPixelForTick(a);if(!(n&&(l=1===r?Math.max(c-o,s-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(a-1))/2,c+=a<t?l:-l,c<o-i||c>s+i)))return c}function js(e){return e.drawTicks?e.tickLength:0}function ks(e,t){if(!e.display)return 0;const n=la(e.font,t),r=ia(e.padding);return(bn(e.text)?e.text.length:1)*n.lineHeight+r.height}function Cs(e,t,n){let r=yr(e);return(n&&"right"!==t||!n&&"right"===t)&&(r=(e=>"left"===e?"right":"right"===e?"left":e)(r)),r}class Ds extends bs{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:r}=this;return e=wn(e,Number.POSITIVE_INFINITY),t=wn(t,Number.NEGATIVE_INFINITY),n=wn(n,Number.POSITIVE_INFINITY),r=wn(r,Number.NEGATIVE_INFINITY),{min:wn(e,n),max:wn(t,r),minDefined:_n(e),maxDefined:_n(t)}}getMinMax(e){let t,{min:n,max:r,minDefined:a,maxDefined:o}=this.getUserBounds();if(a&&o)return{min:n,max:r};const s=this.getMatchingVisibleMetas();for(let i=0,l=s.length;i<l;++i)t=s[i].controller.getMinMax(this,e),a||(n=Math.min(n,t.min)),o||(r=Math.max(r,t.max));return n=o&&n>r?r:n,r=a&&n>r?n:r,{min:wn(n,wn(r,n)),max:wn(r,wn(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Sn(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:r,grace:a,ticks:o}=this.options,s=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){const{min:r,max:a}=e,o=En(t,(a-r)/2),s=(e,t)=>n&&0===e?0:e+t;return{min:s(r,-Math.abs(o)),max:s(a,o)}}(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const i=s<this.ticks.length;this._convertTicksToLabels(i?Es(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=xs(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),i&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Sn(this.options.afterUpdate,[this])}beforeSetDimensions(){Sn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Sn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Sn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Sn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,r,a;for(n=0,r=e.length;n<r;n++)a=e[n],a.label=Sn(t.callback,[a.value,n,e],this)}afterTickToLabelConversion(){Sn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Sn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=Ns(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,a=t.maxRotation;let o,s,i,l=r;if(!this._isVisible()||!t.display||r>=a||n<=1||!this.isHorizontal())return void(this.labelRotation=r);const c=this._getLabelSizes(),d=c.widest.width,u=c.highest.height,h=lr(this.chart.width-d,0,this.maxWidth);o=e.offset?this.maxWidth/n:h/(n-1),d+6>o&&(o=h/(n-(e.offset?.5:1)),s=this.maxHeight-js(e.grid)-t.padding-ks(e.title,this.chart.options.font),i=Math.sqrt(d*d+u*u),l=tr(Math.min(Math.asin(lr((c.highest.height+6)/o,-1,1)),Math.asin(lr(s/i,-1,1))-Math.asin(lr(u/i,-1,1)))),l=Math.max(r,Math.min(a,l))),this.labelRotation=l}afterCalculateLabelRotation(){Sn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Sn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:r,grid:a}}=this,o=this._isVisible(),s=this.isHorizontal();if(o){const o=ks(r,t.options.font);if(s?(e.width=this.maxWidth,e.height=js(a)+o):(e.height=this.maxHeight,e.width=js(a)+o),n.display&&this.ticks.length){const{first:t,last:r,widest:a,highest:o}=this._getLabelSizes(),i=2*n.padding,l=er(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(s){const t=n.mirror?0:d*a.width+c*o.height;e.height=Math.min(this.maxHeight,e.height+t+i)}else{const t=n.mirror?0:c*a.width+d*o.height;e.width=Math.min(this.maxWidth,e.width+t+i)}this._calculatePadding(t,r,d,c)}}this._handleMargins(),s?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,r){const{ticks:{align:a,padding:o},position:s}=this.options,i=0!==this.labelRotation,l="top"!==s&&"x"===this.axis;if(this.isHorizontal()){const s=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,u=0;i?l?(d=r*e.width,u=n*t.height):(d=n*e.height,u=r*t.width):"start"===a?u=t.width:"end"===a?d=e.width:"inner"!==a&&(d=e.width/2,u=t.width/2),this.paddingLeft=Math.max((d-s+o)*this.width/(this.width-s),0),this.paddingRight=Math.max((u-c+o)*this.width/(this.width-c),0)}else{let n=t.height/2,r=e.height/2;"start"===a?(n=0,r=e.height):"end"===a&&(n=t.height,r=0),this.paddingTop=n+o,this.paddingBottom=r+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Sn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)yn(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=Es(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:r,_longestTextCache:a}=this,o=[],s=[],i=Math.floor(t/Ns(t,n));let l,c,d,u,h,p,m,f,g,v,y,b=0,x=0;for(l=0;l<t;l+=i){if(u=e[l].label,h=this._resolveTickFontOptions(l),r.font=p=h.string,m=a[p]=a[p]||{data:{},gc:[]},f=h.lineHeight,g=v=0,yn(u)||bn(u)){if(bn(u))for(c=0,d=u.length;c<d;++c)y=u[c],yn(y)||bn(y)||(g=Br(r,m.data,m.gc,g,y),v+=f)}else g=Br(r,m.data,m.gc,g,u),v=f;o.push(g),s.push(v),b=Math.max(g,b),x=Math.max(v,x)}!function(e,t){jn(e,(e=>{const n=e.gc,r=n.length/2;let a;if(r>t){for(a=0;a<r;++a)delete e.data[n[a]];n.splice(0,r)}}))}(a,t);const _=o.indexOf(b),w=s.indexOf(x),N=e=>({width:o[e]||0,height:s[e]||0});return{first:N(0),last:N(t-1),widest:N(_),highest:N(w),widths:o,heights:s}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return lr(this._alignToPixels?Ur(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=function(e,t,n){return da(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=da(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=er(this.labelRotation),n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,s=a?a.widest.width+o:0,i=a?a.highest.height+o:0;return this.isHorizontal()?i*n>s*r?s/n:i/r:i*r<s*n?i/n:s/r}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,r=this.options,{grid:a,position:o,border:s}=r,i=a.offset,l=this.isHorizontal(),c=this.ticks.length+(i?1:0),d=js(a),u=[],h=s.setContext(this.getContext()),p=h.display?h.width:0,m=p/2,f=function(e){return Ur(n,e,p)};let g,v,y,b,x,_,w,N,E,S,j,k;if("top"===o)g=f(this.bottom),_=this.bottom-d,N=g-m,S=f(e.top)+m,k=e.bottom;else if("bottom"===o)g=f(this.top),S=e.top,k=f(e.bottom)-m,_=g+m,N=this.top+d;else if("left"===o)g=f(this.right),x=this.right-d,w=g-m,E=f(e.left)+m,j=e.right;else if("right"===o)g=f(this.left),E=e.left,j=f(e.right)-m,x=g+m,w=this.left+d;else if("x"===t){if("center"===o)g=f((e.top+e.bottom)/2+.5);else if(xn(o)){const e=Object.keys(o)[0],t=o[e];g=f(this.chart.scales[e].getPixelForValue(t))}S=e.top,k=e.bottom,_=g+m,N=_+d}else if("y"===t){if("center"===o)g=f((e.left+e.right)/2);else if(xn(o)){const e=Object.keys(o)[0],t=o[e];g=f(this.chart.scales[e].getPixelForValue(t))}x=g-m,w=x-d,E=e.left,j=e.right}const C=Nn(r.ticks.maxTicksLimit,c),D=Math.max(1,Math.ceil(c/C));for(v=0;v<c;v+=D){const e=this.getContext(v),t=a.setContext(e),r=s.setContext(e),o=t.lineWidth,c=t.color,d=r.dash||[],h=r.dashOffset,p=t.tickWidth,m=t.tickColor,f=t.tickBorderDash||[],g=t.tickBorderDashOffset;y=Ss(this,v,i),void 0!==y&&(b=Ur(n,y,o),l?x=w=E=j=b:_=N=S=k=b,u.push({tx1:x,ty1:_,tx2:w,ty2:N,x1:E,y1:S,x2:j,y2:k,width:o,color:c,borderDash:d,borderDashOffset:h,tickWidth:p,tickColor:m,tickBorderDash:f,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,u}_computeLabelItems(e){const t=this.axis,n=this.options,{position:r,ticks:a}=n,o=this.isHorizontal(),s=this.ticks,{align:i,crossAlign:l,padding:c,mirror:d}=a,u=js(n.grid),h=u+c,p=d?-c:h,m=-er(this.labelRotation),f=[];let g,v,y,b,x,_,w,N,E,S,j,k,C="middle";if("top"===r)_=this.bottom-p,w=this._getXAxisLabelAlignment();else if("bottom"===r)_=this.top+p,w=this._getXAxisLabelAlignment();else if("left"===r){const e=this._getYAxisLabelAlignment(u);w=e.textAlign,x=e.x}else if("right"===r){const e=this._getYAxisLabelAlignment(u);w=e.textAlign,x=e.x}else if("x"===t){if("center"===r)_=(e.top+e.bottom)/2+h;else if(xn(r)){const e=Object.keys(r)[0],t=r[e];_=this.chart.scales[e].getPixelForValue(t)+h}w=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===r)x=(e.left+e.right)/2-h;else if(xn(r)){const e=Object.keys(r)[0],t=r[e];x=this.chart.scales[e].getPixelForValue(t)}w=this._getYAxisLabelAlignment(u).textAlign}"y"===t&&("start"===i?C="top":"end"===i&&(C="bottom"));const D=this._getLabelSizes();for(g=0,v=s.length;g<v;++g){y=s[g],b=y.label;const e=a.setContext(this.getContext(g));N=this.getPixelForTick(g)+a.labelOffset,E=this._resolveTickFontOptions(g),S=E.lineHeight,j=bn(b)?b.length:1;const t=j/2,n=e.color,i=e.textStrokeColor,c=e.textStrokeWidth;let u,h=w;if(o?(x=N,"inner"===w&&(h=g===v-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),k="top"===r?"near"===l||0!==m?-j*S+S/2:"center"===l?-D.highest.height/2-t*S+S:-D.highest.height+S/2:"near"===l||0!==m?S/2:"center"===l?D.highest.height/2-t*S:D.highest.height-j*S,d&&(k*=-1),0===m||e.showLabelBackdrop||(x+=S/2*Math.sin(m))):(_=N,k=(1-j)*S/2),e.showLabelBackdrop){const t=ia(e.backdropPadding),n=D.heights[g],r=D.widths[g];let a=k-t.top,o=0-t.left;switch(C){case"middle":a-=n/2;break;case"bottom":a-=n}switch(w){case"center":o-=r/2;break;case"right":o-=r;break;case"inner":g===v-1?o-=r:g>0&&(o-=r/2)}u={left:o,top:a,width:r+t.width,height:n+t.height,color:e.backdropColor}}f.push({label:b,font:E,textOffset:k,options:{rotation:m,color:n,strokeColor:i,strokeWidth:c,textAlign:h,textBaseline:C,translation:[x,_],backdrop:u}})}return f}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-er(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align?n="right":"inner"===t.align&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:r,padding:a}}=this.options,o=e+a,s=this._getLabelSizes().widest.width;let i,l;return"left"===t?r?(l=this.right+a,"near"===n?i="left":"center"===n?(i="center",l+=s/2):(i="right",l+=s)):(l=this.right-o,"near"===n?i="right":"center"===n?(i="center",l-=s/2):(i="left",l=this.left)):"right"===t?r?(l=this.left+a,"near"===n?i="right":"center"===n?(i="center",l-=s/2):(i="left",l-=s)):(l=this.left+o,"near"===n?i="left":"center"===n?(i="center",l+=s/2):(i="right",l=this.right)):i="right",{textAlign:i,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:r,width:a,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,r,a,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex((t=>t.value===e));if(n>=0){return t.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const s=(e,t,r)=>{r.width&&r.color&&(n.save(),n.lineWidth=r.width,n.strokeStyle=r.color,n.setLineDash(r.borderDash||[]),n.lineDashOffset=r.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(a=0,o=r.length;a<o;++a){const e=r[a];t.drawOnChartArea&&s({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&s({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:r}}=this,a=n.setContext(this.getContext()),o=n.display?a.width:0;if(!o)return;const s=r.setContext(this.getContext(0)).lineWidth,i=this._borderValue;let l,c,d,u;this.isHorizontal()?(l=Ur(e,this.left,o)-o/2,c=Ur(e,this.right,s)+s/2,d=u=i):(d=Ur(e,this.top,o)-o/2,u=Ur(e,this.bottom,s)+s/2,l=c=i),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(l,d),t.lineTo(c,u),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,n=this._computeLabelArea();n&&Yr(t,n);const r=this.getLabelItems(e);for(const a of r){const e=a.options,n=a.font;Zr(t,a.label,0,a.textOffset,n,e)}n&&Jr(t)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:r}}=this;if(!n.display)return;const a=la(n.font),o=ia(n.padding),s=n.align;let i=a.lineHeight/2;"bottom"===t||"center"===t||xn(t)?(i+=o.bottom,bn(n.text)&&(i+=a.lineHeight*(n.text.length-1))):i+=o.top;const{titleX:l,titleY:c,maxWidth:d,rotation:u}=function(e,t,n,r){const{top:a,left:o,bottom:s,right:i,chart:l}=e,{chartArea:c,scales:d}=l;let u,h,p,m=0;const f=s-a,g=i-o;if(e.isHorizontal()){if(h=br(r,o,i),xn(n)){const e=Object.keys(n)[0],r=n[e];p=d[e].getPixelForValue(r)+f-t}else p="center"===n?(c.bottom+c.top)/2+f-t:ws(e,n,t);u=i-o}else{if(xn(n)){const e=Object.keys(n)[0],r=n[e];h=d[e].getPixelForValue(r)-g+t}else h="center"===n?(c.left+c.right)/2-g+t:ws(e,n,t);p=br(r,s,a),m="left"===n?-Hn:Hn}return{titleX:h,titleY:p,maxWidth:u,rotation:m}}(this,i,t,s);Zr(e,n.text,0,0,a,{color:n.color,maxWidth:d,rotation:u,textAlign:Cs(s,t,r),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=Nn(e.grid&&e.grid.z,-1),r=Nn(e.border&&e.border.z,0);return this._isVisible()&&this.draw===Ds.prototype.draw?[{z:n,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[];let a,o;for(a=0,o=t.length;a<o;++a){const o=t[a];o[n]!==this.id||e&&o.type!==e||r.push(o)}return r}_resolveTickFontOptions(e){return la(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ts{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;(function(e){return"id"in e&&"defaults"in e})(t)&&(n=this.register(t));const r=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in r||(r[a]=e,function(e,t,n){const r=An(Object.create(null),[n?zr.get(n):{},zr.get(t),e.defaults]);zr.set(t,r),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((n=>{const r=n.split("."),a=r.pop(),o=[e].concat(r).join("."),s=t[n].split("."),i=s.pop(),l=s.join(".");zr.route(o,a,l,i)}))}(t,e.defaultRoutes);e.descriptors&&zr.describe(t,e.descriptors)}(e,o,n),this.override&&zr.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,r=this.scope;n in t&&delete t[n],r&&n in zr[r]&&(delete zr[r][n],this.override&&delete Mr[n])}}class As{constructor(){this.controllers=new Ts(xo,"datasets",!0),this.elements=new Ts(bs,"elements"),this.plugins=new Ts(Object,"plugins"),this.scales=new Ts(Ds,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}_each(e,t,n){[...t].forEach((t=>{const r=n||this._getRegistryForType(t);n||r.isForType(t)||r===this.plugins&&t.id?this._exec(e,r,t):jn(t,(t=>{const r=n||this._getRegistryForType(t);this._exec(e,r,t)}))}))}_exec(e,t,n){const r=On(e);Sn(n["before"+r],[],n),t[e](n),Sn(n["after"+r],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const r=t.get(e);if(void 0===r)throw new Error('"'+e+'" is not a registered '+n+".");return r}}var Ps=new As;class Is{constructor(){this._init=[]}notify(e,t,n,r){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const a=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(a,e,t,n);return"afterDestroy"===t&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,n,r){r=r||{};for(const a of e){const e=a.plugin;if(!1===Sn(e[n],[t,r,a.options],e)&&r.cancelable)return!1}return!0}invalidate(){yn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,r=Nn(n.options&&n.options.plugins,{}),a=function(e){const t={},n=[],r=Object.keys(Ps.plugins.items);for(let o=0;o<r.length;o++)n.push(Ps.getPlugin(r[o]));const a=e.plugins||[];for(let o=0;o<a.length;o++){const e=a[o];-1===n.indexOf(e)&&(n.push(e),t[e.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==r||t?function(e,t,n,r){let{plugins:a,localIds:o}=t;const s=[],i=e.getContext();for(const l of a){const t=l.id,a=Rs(n[t],r);null!==a&&s.push({plugin:l,options:Ms(e.config,{plugin:l,local:o[t]},a,i)})}return s}(e,a,r,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,r=(e,t)=>e.filter((e=>!t.some((t=>e.plugin.id===t.plugin.id))));this._notify(r(t,n),e,"stop"),this._notify(r(n,t),e,"start")}}function Rs(e,t){return t||!1!==e?!0===e?{}:e:null}function Ms(e,t,n,r){let{plugin:a,local:o}=t;const s=e.pluginScopeKeys(a),i=e.getOptionScopes(n,s);return o&&a.defaults&&i.push(a.defaults),e.createResolver(i,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Os(e,t){const n=zr.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function Ls(e){if("x"===e||"y"===e||"r"===e)return e}function $s(e){if(Ls(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const o of n){const t=o.axis||("top"===(a=o.position)||"bottom"===a?"x":"left"===a||"right"===a?"y":void 0)||e.length>1&&Ls(e[0].toLowerCase());if(t)return t}var a;throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function Fs(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function zs(e,t){const n=Mr[e.type]||{scales:{}},r=t.scales||{},a=Os(e.type,t),o=Object.create(null);return Object.keys(r).forEach((t=>{const s=r[t];if(!xn(s))return console.error(`Invalid scale configuration for scale: ${t}`);if(s._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const i=$s(t,s,function(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter((t=>t.xAxisID===e||t.yAxisID===e));if(n.length)return Fs(e,"x",n[0])||Fs(e,"y",n[0])}return{}}(t,e),zr.scales[s.type]),l=function(e,t){return e===t?"_index_":"_value_"}(i,a),c=n.scales||{};o[t]=Pn(Object.create(null),[{axis:i},s,c[i],c[l]])})),e.data.datasets.forEach((n=>{const a=n.type||e.type,s=n.indexAxis||Os(a,t),i=(Mr[a]||{}).scales||{};Object.keys(i).forEach((e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,s),a=n[t+"AxisID"]||t;o[a]=o[a]||Object.create(null),Pn(o[a],[{axis:t},r[a],i[e]])}))})),Object.keys(o).forEach((e=>{const t=o[e];Pn(t,[zr.scales[t.type],zr.scale])})),o}function Bs(e){const t=e.options||(e.options={});t.plugins=Nn(t.plugins,{}),t.scales=zs(e,t)}function Us(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Ws=new Map,Vs=new Set;function Hs(e,t){let n=Ws.get(e);return n||(n=t(),Ws.set(e,n),Vs.add(n)),n}const qs=(e,t,n)=>{const r=Mn(t,n);void 0!==r&&e.add(r)};class Ys{constructor(e){this._config=function(e){return(e=e||{}).data=Us(e.data),Bs(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Us(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Bs(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Hs(e,(()=>[[`datasets.${e}`,""]]))}datasetAnimationScopeKeys(e,t){return Hs(`${e}.transition.${t}`,(()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]]))}datasetElementScopeKeys(e,t){return Hs(`${e}-${t}`,(()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]]))}pluginScopeKeys(e){const t=e.id;return Hs(`${this.type}-plugin-${t}`,(()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]]))}_cachedScopes(e,t){const n=this._scopeCache;let r=n.get(e);return r&&!t||(r=new Map,n.set(e,r)),r}getOptionScopes(e,t,n){const{options:r,type:a}=this,o=this._cachedScopes(e,n),s=o.get(t);if(s)return s;const i=new Set;t.forEach((t=>{e&&(i.add(e),t.forEach((t=>qs(i,e,t)))),t.forEach((e=>qs(i,r,e))),t.forEach((e=>qs(i,Mr[a]||{},e))),t.forEach((e=>qs(i,zr,e))),t.forEach((e=>qs(i,Or,e)))}));const l=Array.from(i);return 0===l.length&&l.push(Object.create(null)),Vs.has(t)&&o.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,Mr[t]||{},zr.datasets[t]||{},{type:t},zr,Or]}resolveNamedOptions(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const a={$shared:!0},{resolver:o,subPrefixes:s}=Js(this._resolverCache,e,r);let i=o;if(function(e,t){const{isScriptable:n,isIndexable:r}=pa(e);for(const a of t){const t=n(a),o=r(a),s=(o||t)&&e[a];if(t&&($n(s)||Qs(s))||o&&bn(s))return!0}return!1}(o,t)){a.$shared=!1;i=ha(o,n=$n(n)?n():n,this.createResolver(e,n,s))}for(const l of t)a[l]=i[l];return a}createResolver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],r=arguments.length>3?arguments[3]:void 0;const{resolver:a}=Js(this._resolverCache,e,n);return xn(t)?ha(a,t,void 0,r):a}}function Js(e,t,n){let r=e.get(t);r||(r=new Map,e.set(t,r));const a=n.join();let o=r.get(a);if(!o){o={resolver:ua(t,n),subPrefixes:n.filter((e=>!e.toLowerCase().includes("hover")))},r.set(a,o)}return o}const Qs=e=>xn(e)&&Object.getOwnPropertyNames(e).some((t=>$n(e[t])));const Ks=["top","bottom","left","right","chartArea"];function Gs(e,t){return"top"===e||"bottom"===e||-1===Ks.indexOf(e)&&"x"===t}function Xs(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function Zs(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Sn(n&&n.onComplete,[e],t)}function ei(e){const t=e.chart,n=t.options.animation;Sn(n&&n.onProgress,[e],t)}function ti(e){return Aa()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const ni={},ri=e=>{const t=ti(e);return Object.values(ni).filter((e=>e.canvas===t)).pop()};function ai(e,t,n){const r=Object.keys(e);for(const a of r){const r=+a;if(r>=t){const o=e[a];delete e[a],(n>0||r>t)&&(e[r+n]=o)}}}function oi(e,t,n){return e.options.clip?e[n]:t[n]}class si{static defaults=(()=>zr)();static instances=(()=>ni)();static overrides=(()=>Mr)();static registry=(()=>Ps)();static version="4.4.8";static getChart=(()=>ri)();static register(){Ps.add(...arguments),ii()}static unregister(){Ps.remove(...arguments),ii()}constructor(e,t){const n=this.config=new Ys(t),r=ti(e),a=ri(r);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(e){return!Aa()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?rs:ys}(r)),this.platform.updateConfig(n);const s=this.platform.acquireContext(r,o.aspectRatio),i=s&&s.canvas,l=i&&i.height,c=i&&i.width;this.id=vn(),this.ctx=s,this.canvas=i,this.width=c,this.height=l,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Is,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let n;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t?(clearTimeout(n),n=setTimeout(e,t,a)):e.apply(this,a),t}}((e=>this.update(e)),o.resizeDelay||0),this._dataChanges=[],ni[this.id]=this,s&&i?(ro.listen(this,"complete",Zs),ro.listen(this,"progress",ei),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:r,_aspectRatio:a}=this;return yn(e)?t&&a?a:r?n/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Ps}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():za(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Wr(this.canvas,this.ctx),this}stop(){return ro.stop(this),this}resize(e,t){ro.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,r=this.canvas,a=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,t,a),s=n.devicePixelRatio||this.platform.getDevicePixelRatio(),i=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,za(this,s,!0)&&(this.notifyPlugins("resize",{size:o}),Sn(n.onResize,[this,o],this),this.attached&&this._doResize(i)&&this.render())}ensureScalesHaveIDs(){jn(this.options.scales||{},((e,t)=>{e.id=t}))}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,r=Object.keys(n).reduce(((e,t)=>(e[t]=!1,e)),{});let a=[];t&&(a=a.concat(Object.keys(t).map((e=>{const n=t[e],r=$s(e,n),a="r"===r,o="x"===r;return{options:n,dposition:a?"chartArea":o?"bottom":"left",dtype:a?"radialLinear":o?"category":"linear"}})))),jn(a,(t=>{const a=t.options,o=a.id,s=$s(o,a),i=Nn(a.type,t.dtype);void 0!==a.position&&Gs(a.position,s)===Gs(t.dposition)||(a.position=t.dposition),r[o]=!0;let l=null;if(o in n&&n[o].type===i)l=n[o];else{l=new(Ps.getScale(i))({id:o,type:i,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(a,e)})),jn(r,((e,t)=>{e||delete n[t]})),jn(n,(e=>{ts.configure(this,e,e.options),ts.addBox(this,e)}))}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort(((e,t)=>e.index-t.index)),n>t){for(let e=t;e<n;++e)this._destroyDatasetMeta(e);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(Xs("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach(((e,n)=>{0===t.filter((t=>t===e._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,r;for(this._removeUnreferencedMetasets(),n=0,r=t.length;n<r;n++){const r=t[n];let a=this.getDatasetMeta(n);const o=r.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=o,a.indexAxis=r.indexAxis||Os(o,this.options),a.order=r.order||0,a.index=n,a.label=""+r.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const t=Ps.getController(o),{datasetElementType:r,dataElementType:s}=zr.datasets[o];Object.assign(t,{dataElementType:Ps.getElement(s),datasetElementType:r&&Ps.getElement(r)}),a.controller=new t(this,n),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){jn(this.data.datasets,((e,t)=>{this.getDatasetMeta(t).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!r&&-1===a.indexOf(e);e.buildOrUpdateElements(t),o=Math.max(+e.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),r||jn(a,(e=>{e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Xs("z","_idx"));const{_active:s,_lastEvent:i}=this;i?this._eventHandler(i,!0):s.length&&this._updateHoverStyles(s,s,!0),this.render()}_updateScales(){jn(this.scales,(e=>{ts.removeBox(this,e)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);Fn(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:r,count:a}of t){ai(e,r,"_removeElements"===n?-a:a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=t=>new Set(e.filter((e=>e[0]===t)).map(((e,t)=>t+","+e.splice(1).join(",")))),r=n(0);for(let a=1;a<t;a++)if(!Fn(r,n(a)))return;return Array.from(r).map((e=>e.split(","))).map((e=>({method:e[1],start:+e[2],count:+e[3]})))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;ts.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],jn(this.boxes,(e=>{n&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))}),this),this._layers.forEach(((e,t)=>{e._idx=t})),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,$n(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),r={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(n.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(ro.has(this)?this.attached&&!ro.running(this)&&ro.start(this):(this.draw(),Zs({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let r,a;for(r=0,a=t.length;r<a;++r){const a=t[r];e&&!a.visible||n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n=e._clip,r=!n.disabled,a=function(e,t){const{xScale:n,yScale:r}=e;return n&&r?{left:oi(n,t,"left"),right:oi(n,t,"right"),top:oi(r,t,"top"),bottom:oi(r,t,"bottom")}:t}(e,this.chartArea),o={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",o)&&(r&&Yr(t,{left:!1===n.left?0:a.left-n.left,right:!1===n.right?this.width:a.right+n.right,top:!1===n.top?0:a.top-n.top,bottom:!1===n.bottom?this.height:a.bottom+n.bottom}),e.controller.draw(),r&&Jr(t),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return qr(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,r){const a=Uo.modes[t];return"function"===typeof a?a(this,e,n,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let r=n.filter((e=>e&&e._dataset===t)).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context=da(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const r=n?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,r);Ln(t)?(a.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),o.update(a,{visible:n}),this.update((t=>t.datasetIndex===e?r:void 0)))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ro.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Wr(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete ni[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(n,r)=>{t.addEventListener(this,n,r),e[n]=r},r=(e,t,n)=>{e.offsetX=t,e.offsetY=n,this._eventHandler(e)};jn(this.options.events,(e=>n(e,r)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(n,r)=>{t.addEventListener(this,n,r),e[n]=r},r=(n,r)=>{e[n]&&(t.removeEventListener(this,n,r),delete e[n])},a=(e,t)=>{this.canvas&&this.resize(e,t)};let o;const s=()=>{r("attach",s),this.attached=!0,this.resize(),n("resize",a),n("detach",o)};o=()=>{this.attached=!1,r("resize",a),this._stop(),this._resize(0,0),n("attach",s)},t.isAttached(this.canvas)?s():o()}unbindEvents(){jn(this._listeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._listeners={},jn(this._responsiveListeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const r=n?"set":"remove";let a,o,s,i;for("dataset"===t&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+r+"DatasetHoverStyle"]()),s=0,i=e.length;s<i;++s){o=e[s];const t=o&&this.getDatasetMeta(o.datasetIndex).controller;t&&t[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map((e=>{let{datasetIndex:t,index:n}=e;const r=this.getDatasetMeta(t);if(!r)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:r.data[n],index:n}}));!kn(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return 1===this._plugins._cache.filter((t=>t.plugin.id===e)).length}_updateHoverStyles(e,t,n){const r=this.options.hover,a=(e,t)=>e.filter((e=>!t.some((t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)))),o=a(t,e),s=n?e:a(e,t);o.length&&this.updateHoverStyle(o,r.mode,!1),s.length&&r.mode&&this.updateHoverStyle(s,r.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",n,r))return;const a=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,r),(a||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:r=[],options:a}=this,o=t,s=this._getActiveElements(e,r,n,o),i=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,n,r){return n&&"mouseout"!==e.type?r?t:e:null}(e,this._lastEvent,n,i);n&&(this._lastEvent=null,Sn(a.onHover,[e,s,this],this),i&&Sn(a.onClick,[e,s,this],this));const c=!kn(s,r);return(c||t)&&(this._active=s,this._updateHoverStyles(s,r,t)),this._lastEvent=l,c}_getActiveElements(e,t,n,r){if("mouseout"===e.type)return[];if(!n)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,r)}}function ii(){return jn(si.instances,(e=>e._plugins.invalidate()))}function li(e,t,n,r){const a=aa(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const o=(n-t)/2,s=Math.min(o,r*t/2),i=e=>{const t=(n-Math.min(o,e))*r/2;return lr(e,0,Math.min(o,t))};return{outerStart:i(a.outerStart),outerEnd:i(a.outerEnd),innerStart:lr(a.innerStart,0,s),innerEnd:lr(a.innerEnd,0,s)}}function ci(e,t,n,r){return{x:n+e*Math.cos(t),y:r+e*Math.sin(t)}}function di(e,t,n,r,a,o){const{x:s,y:i,startAngle:l,pixelMargin:c,innerRadius:d}=t,u=Math.max(t.outerRadius+r+n-c,0),h=d>0?d+r+n+c:0;let p=0;const m=a-l;if(r){const e=((d>0?d-r:0)+(u>0?u-r:0))/2;p=(m-(0!==e?m*e/(e+r):m))/2}const f=(m-Math.max(.001,m*u-n/zn)/u)/2,g=l+f+p,v=a-f-p,{outerStart:y,outerEnd:b,innerStart:x,innerEnd:_}=li(t,h,u,v-g),w=u-y,N=u-b,E=g+y/w,S=v-b/N,j=h+x,k=h+_,C=g+x/j,D=v-_/k;if(e.beginPath(),o){const t=(E+S)/2;if(e.arc(s,i,u,E,t),e.arc(s,i,u,t,S),b>0){const t=ci(N,S,s,i);e.arc(t.x,t.y,b,S,v+Hn)}const n=ci(k,v,s,i);if(e.lineTo(n.x,n.y),_>0){const t=ci(k,D,s,i);e.arc(t.x,t.y,_,v+Hn,D+Math.PI)}const r=(v-_/h+(g+x/h))/2;if(e.arc(s,i,h,v-_/h,r,!0),e.arc(s,i,h,r,g+x/h,!0),x>0){const t=ci(j,C,s,i);e.arc(t.x,t.y,x,C+Math.PI,g-Hn)}const a=ci(w,g,s,i);if(e.lineTo(a.x,a.y),y>0){const t=ci(w,E,s,i);e.arc(t.x,t.y,y,g-Hn,E)}}else{e.moveTo(s,i);const t=Math.cos(E)*u+s,n=Math.sin(E)*u+i;e.lineTo(t,n);const r=Math.cos(S)*u+s,a=Math.sin(S)*u+i;e.lineTo(r,a)}e.closePath()}function ui(e,t,n,r,a){const{fullCircles:o,startAngle:s,circumference:i,options:l}=t,{borderWidth:c,borderJoinStyle:d,borderDash:u,borderDashOffset:h}=l,p="inner"===l.borderAlign;if(!c)return;e.setLineDash(u||[]),e.lineDashOffset=h,p?(e.lineWidth=2*c,e.lineJoin=d||"round"):(e.lineWidth=c,e.lineJoin=d||"bevel");let m=t.endAngle;if(o){di(e,t,n,r,m,a);for(let t=0;t<o;++t)e.stroke();isNaN(i)||(m=s+(i%Bn||Bn))}p&&function(e,t,n){const{startAngle:r,pixelMargin:a,x:o,y:s,outerRadius:i,innerRadius:l}=t;let c=a/i;e.beginPath(),e.arc(o,s,i,r-c,n+c),l>a?(c=a/l,e.arc(o,s,l,n+c,r-c,!0)):e.arc(o,s,a,n+Hn,r-Hn),e.closePath(),e.clip()}(e,t,m),o||(di(e,t,n,r,m,a),e.stroke())}class hi extends bs{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const r=this.getProps(["x","y"],n),{angle:a,distance:o}=rr(r,{x:e,y:t}),{startAngle:s,endAngle:i,innerRadius:l,outerRadius:c,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),u=(this.options.spacing+this.options.borderWidth)/2,h=Nn(d,i-s),p=ir(a,s,i)&&s!==i,m=h>=Bn||p,f=cr(o,l+u,c+u);return m&&f}getCenterPoint(e){const{x:t,y:n,startAngle:r,endAngle:a,innerRadius:o,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:i,spacing:l}=this.options,c=(r+a)/2,d=(o+s+l+i)/2;return{x:t+Math.cos(c)*d,y:n+Math.sin(c)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:n}=this,r=(t.offset||0)/4,a=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>Bn?Math.floor(n/Bn):0,0===n||this.innerRadius<0||this.outerRadius<0)return;e.save();const s=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(s)*r,Math.sin(s)*r);const i=r*(1-Math.sin(Math.min(zn,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,r,a){const{fullCircles:o,startAngle:s,circumference:i}=t;let l=t.endAngle;if(o){di(e,t,n,r,l,a);for(let t=0;t<o;++t)e.fill();isNaN(i)||(l=s+(i%Bn||Bn))}di(e,t,n,r,l,a),e.fill()}(e,this,i,a,o),ui(e,this,i,a,o),e.restore()}}function pi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=Nn(n.borderCapStyle,t.borderCapStyle),e.setLineDash(Nn(n.borderDash,t.borderDash)),e.lineDashOffset=Nn(n.borderDashOffset,t.borderDashOffset),e.lineJoin=Nn(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Nn(n.borderWidth,t.borderWidth),e.strokeStyle=Nn(n.borderColor,t.borderColor)}function mi(e,t,n){e.lineTo(n.x,n.y)}function fi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.length,{start:a=0,end:o=r-1}=n,{start:s,end:i}=t,l=Math.max(a,s),c=Math.min(o,i),d=a<s&&o<s||a>i&&o>i;return{count:r,start:l,loop:t.loop,ilen:c<l&&!d?r+c-l:c-l}}function gi(e,t,n,r){const{points:a,options:o}=t,{count:s,start:i,loop:l,ilen:c}=fi(a,n,r),d=function(e){return e.stepped?Qr:e.tension||"monotone"===e.cubicInterpolationMode?Kr:mi}(o);let u,h,p,{move:m=!0,reverse:f}=r||{};for(u=0;u<=c;++u)h=a[(i+(f?c-u:u))%s],h.skip||(m?(e.moveTo(h.x,h.y),m=!1):d(e,p,h,f,o.stepped),p=h);return l&&(h=a[(i+(f?c:0))%s],d(e,p,h,f,o.stepped)),!!l}function vi(e,t,n,r){const a=t.points,{count:o,start:s,ilen:i}=fi(a,n,r),{move:l=!0,reverse:c}=r||{};let d,u,h,p,m,f,g=0,v=0;const y=e=>(s+(c?i-e:e))%o,b=()=>{p!==m&&(e.lineTo(g,m),e.lineTo(g,p),e.lineTo(g,f))};for(l&&(u=a[y(0)],e.moveTo(u.x,u.y)),d=0;d<=i;++d){if(u=a[y(d)],u.skip)continue;const t=u.x,n=u.y,r=0|t;r===h?(n<p?p=n:n>m&&(m=n),g=(v*g+t)/++v):(b(),e.lineTo(t,n),h=r,v=0,p=m=n),f=n}b()}function yi(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?vi:gi}const bi="function"===typeof Path2D;function xi(e,t,n,r){bi&&!t.options.segment?function(e,t,n,r){let a=t._path;a||(a=t._path=new Path2D,t.path(a,n,r)&&a.closePath()),pi(e,t.options),e.stroke(a)}(e,t,n,r):function(e,t,n,r){const{segments:a,options:o}=t,s=yi(t);for(const i of a)pi(e,o,i.style),e.beginPath(),s(e,t,i,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}(e,t,n,r)}class _i extends bs{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const r=n.spanGaps?this._loop:this._fullLoop;Ta(this._points,n,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const n=e.points,r=e.options.spanGaps,a=n.length;if(!a)return[];const o=!!e._loop,{start:s,end:i}=function(e,t,n,r){let a=0,o=t-1;if(n&&!r)for(;a<t&&!e[a].skip;)a++;for(;a<t&&e[a].skip;)a++;for(a%=t,n&&(o+=a);o>a&&e[o%t].skip;)o--;return o%=t,{start:a,end:o}}(n,a,o,r);return Za(e,!0===r?[{start:s,end:i,loop:o}]:function(e,t,n,r){const a=e.length,o=[];let s,i=t,l=e[t];for(s=t+1;s<=n;++s){const n=e[s%a];n.skip||n.stop?l.skip||(r=!1,o.push({start:t%a,end:(s-1)%a,loop:r}),t=i=n.stop?s:null):(i=s,l.skip&&(t=s)),l=n}return null!==i&&o.push({start:t%a,end:i%a,loop:r}),o}(n,s,i<s?i+a:i,!!e._fullLoop&&0===s&&i===a-1),n,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,r=e[t],a=this.points,o=Xa(this,{property:t,start:r,end:r});if(!o.length)return;const s=[],i=function(e){return e.stepped?Va:e.tension||"monotone"===e.cubicInterpolationMode?Ha:Wa}(n);let l,c;for(l=0,c=o.length;l<c;++l){const{start:c,end:d}=o[l],u=a[c],h=a[d];if(u===h){s.push(u);continue}const p=i(u,h,Math.abs((r-u[t])/(h[t]-u[t])),n.stepped);p[t]=e[t],s.push(p)}return 1===s.length?s[0]:s}pathSegment(e,t,n){return yi(this)(e,this,t,n)}path(e,t,n){const r=this.segments,a=yi(this);let o=this._loop;t=t||0,n=n||this.points.length-t;for(const s of r)o&=a(e,this,s,{start:t,end:t+n-1});return!!o}draw(e,t,n,r){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),xi(e,this,n,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function wi(e,t,n,r){const a=e.options,{[n]:o}=e.getProps([n],r);return Math.abs(t-o)<a.radius+a.hitRadius}class Ni extends bs{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const r=this.options,{x:a,y:o}=this.getProps(["x","y"],n);return Math.pow(e-a,2)+Math.pow(t-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return wi(this,e,"x",t)}inYRange(e,t){return wi(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this.options;this.skip||n.radius<.1||!qr(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,Vr(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Ei(e,t){const{x:n,y:r,base:a,width:o,height:s}=e.getProps(["x","y","base","width","height"],t);let i,l,c,d,u;return e.horizontal?(u=s/2,i=Math.min(n,a),l=Math.max(n,a),c=r-u,d=r+u):(u=o/2,i=n-u,l=n+u,c=Math.min(r,a),d=Math.max(r,a)),{left:i,top:c,right:l,bottom:d}}function Si(e,t,n,r){return e?0:lr(t,n,r)}function ji(e){const t=Ei(e),n=t.right-t.left,r=t.bottom-t.top,a=function(e,t,n){const r=e.options.borderWidth,a=e.borderSkipped,o=oa(r);return{t:Si(a.top,o.top,0,n),r:Si(a.right,o.right,0,t),b:Si(a.bottom,o.bottom,0,n),l:Si(a.left,o.left,0,t)}}(e,n/2,r/2),o=function(e,t,n){const{enableBorderRadius:r}=e.getProps(["enableBorderRadius"]),a=e.options.borderRadius,o=sa(a),s=Math.min(t,n),i=e.borderSkipped,l=r||xn(a);return{topLeft:Si(!l||i.top||i.left,o.topLeft,0,s),topRight:Si(!l||i.top||i.right,o.topRight,0,s),bottomLeft:Si(!l||i.bottom||i.left,o.bottomLeft,0,s),bottomRight:Si(!l||i.bottom||i.right,o.bottomRight,0,s)}}(e,n/2,r/2);return{outer:{x:t.left,y:t.top,w:n,h:r,radius:o},inner:{x:t.left+a.l,y:t.top+a.t,w:n-a.l-a.r,h:r-a.t-a.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,o.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(a.b,a.r))}}}}function ki(e,t,n,r){const a=null===t,o=null===n,s=e&&!(a&&o)&&Ei(e,r);return s&&(a||cr(t,s.left,s.right))&&(o||cr(n,s.top,s.bottom))}function Ci(e,t){e.rect(t.x,t.y,t.w,t.h)}function Di(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.x!==n.x?-t:0,a=e.y!==n.y?-t:0,o=(e.x+e.w!==n.x+n.w?t:0)-r,s=(e.y+e.h!==n.y+n.h?t:0)-a;return{x:e.x+r,y:e.y+a,w:e.w+o,h:e.h+s,radius:e.radius}}class Ti extends bs{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:r}}=this,{inner:a,outer:o}=ji(this),s=(i=o.radius).topLeft||i.topRight||i.bottomLeft||i.bottomRight?ea:Ci;var i;e.save(),o.w===a.w&&o.h===a.h||(e.beginPath(),s(e,Di(o,t,a)),e.clip(),s(e,Di(a,-t,o)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),s(e,Di(a,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,n){return ki(this,e,t,n)}inXRange(e,t){return ki(this,e,null,t)}inYRange(e,t){return ki(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+r)/2:t,y:a?n:(n+r)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}function Ai(e,t,n,r){if(r)return;let a=t[e],o=n[e];return"angle"===e&&(a=sr(a),o=sr(o)),{property:e,start:a,end:o}}function Pi(e,t,n){for(;t>e;t--){const e=n[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function Ii(e,t,n,r){return e&&t?r(e[n],t[n]):e?e[n]:t?t[n]:0}function Ri(e,t){let n=[],r=!1;return bn(e)?(r=!0,n=e):n=function(e,t){const{x:n=null,y:r=null}=e||{},a=t.points,o=[];return t.segments.forEach((e=>{let{start:t,end:s}=e;s=Pi(t,s,a);const i=a[t],l=a[s];null!==r?(o.push({x:i.x,y:r}),o.push({x:l.x,y:r})):null!==n&&(o.push({x:n,y:i.y}),o.push({x:n,y:l.y}))})),o}(e,t),n.length?new _i({points:n,options:{tension:0},_loop:r,_fullLoop:r}):null}function Mi(e){return e&&!1!==e.fill}function Oi(e,t,n){let r=e[t].fill;const a=[t];let o;if(!n)return r;for(;!1!==r&&-1===a.indexOf(r);){if(!_n(r))return r;if(o=e[r],!o)return!1;if(o.visible)return r;a.push(r),r=o.fill}return!1}function Li(e,t,n){const r=function(e){const t=e.options,n=t.fill;let r=Nn(n&&n.target,n);void 0===r&&(r=!!t.backgroundColor);if(!1===r||null===r)return!1;if(!0===r)return"origin";return r}(e);if(xn(r))return!isNaN(r.value)&&r;let a=parseFloat(r);return _n(a)&&Math.floor(a)===a?function(e,t,n,r){"-"!==e&&"+"!==e||(n=t+n);if(n===t||n<0||n>=r)return!1;return n}(r[0],t,a,n):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function $i(e,t,n){const r=[];for(let a=0;a<n.length;a++){const o=n[a],{first:s,last:i,point:l}=Fi(o,t,"x");if(!(!l||s&&i))if(s)r.unshift(l);else if(e.push(l),!i)break}e.push(...r)}function Fi(e,t,n){const r=e.interpolate(t,n);if(!r)return{};const a=r[n],o=e.segments,s=e.points;let i=!1,l=!1;for(let c=0;c<o.length;c++){const e=o[c],t=s[e.start][n],r=s[e.end][n];if(cr(a,t,r)){i=a===t,l=a===r;break}}return{first:i,last:l,point:r}}class zi{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,n){const{x:r,y:a,radius:o}=this;return t=t||{start:0,end:Bn},e.arc(r,a,o,t.end,t.start,!0),!n.bounds}interpolate(e){const{x:t,y:n,radius:r}=this,a=e.angle;return{x:t+Math.cos(a)*r,y:n+Math.sin(a)*r,angle:a}}}function Bi(e){const{chart:t,fill:n,line:r}=e;if(_n(n))return function(e,t){const n=e.getDatasetMeta(t),r=n&&e.isDatasetVisible(t);return r?n.dataset:null}(t,n);if("stack"===n)return function(e){const{scale:t,index:n,line:r}=e,a=[],o=r.segments,s=r.points,i=function(e,t){const n=[],r=e.getMatchingVisibleMetas("line");for(let a=0;a<r.length;a++){const e=r[a];if(e.index===t)break;e.hidden||n.unshift(e.dataset)}return n}(t,n);i.push(Ri({x:null,y:t.bottom},r));for(let l=0;l<o.length;l++){const e=o[l];for(let t=e.start;t<=e.end;t++)$i(a,s[t],i)}return new _i({points:a,options:{}})}(e);if("shape"===n)return!0;const a=function(e){const t=e.scale||{};if(t.getPointPositionForValue)return function(e){const{scale:t,fill:n}=e,r=t.options,a=t.getLabels().length,o=r.reverse?t.max:t.min,s=function(e,t,n){let r;return r="start"===e?n:"end"===e?t.options.reverse?t.min:t.max:xn(e)?e.value:t.getBaseValue(),r}(n,t,o),i=[];if(r.grid.circular){const e=t.getPointPositionForValue(0,o);return new zi({x:e.x,y:e.y,radius:t.getDistanceFromCenterForValue(s)})}for(let l=0;l<a;++l)i.push(t.getPointPositionForValue(l,s));return i}(e);return function(e){const{scale:t={},fill:n}=e,r=function(e,t){let n=null;return"start"===e?n=t.bottom:"end"===e?n=t.top:xn(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}(n,t);if(_n(r)){const e=t.isHorizontal();return{x:e?r:null,y:e?null:r}}return null}(e)}(e);return a instanceof zi?a:Ri(a,r)}function Ui(e,t,n){const r=Bi(t),{line:a,scale:o,axis:s}=t,i=a.options,l=i.fill,c=i.backgroundColor,{above:d=c,below:u=c}=l||{};r&&a.points.length&&(Yr(e,n),function(e,t){const{line:n,target:r,above:a,below:o,area:s,scale:i}=t,l=n._loop?"angle":t.axis;e.save(),"x"===l&&o!==a&&(Wi(e,r,s.top),Vi(e,{line:n,target:r,color:a,scale:i,property:l}),e.restore(),e.save(),Wi(e,r,s.bottom));Vi(e,{line:n,target:r,color:o,scale:i,property:l}),e.restore()}(e,{line:a,target:r,above:d,below:u,area:n,scale:o,axis:s}),Jr(e))}function Wi(e,t,n){const{segments:r,points:a}=t;let o=!0,s=!1;e.beginPath();for(const i of r){const{start:r,end:l}=i,c=a[r],d=a[Pi(r,l,a)];o?(e.moveTo(c.x,c.y),o=!1):(e.lineTo(c.x,n),e.lineTo(c.x,c.y)),s=!!t.pathSegment(e,i,{move:s}),s?e.closePath():e.lineTo(d.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function Vi(e,t){const{line:n,target:r,property:a,color:o,scale:s}=t,i=function(e,t,n){const r=e.segments,a=e.points,o=t.points,s=[];for(const i of r){let{start:e,end:r}=i;r=Pi(e,r,a);const l=Ai(n,a[e],a[r],i.loop);if(!t.segments){s.push({source:i,target:l,start:a[e],end:a[r]});continue}const c=Xa(t,l);for(const t of c){const e=Ai(n,o[t.start],o[t.end],t.loop),r=Ga(i,a,e);for(const a of r)s.push({source:a,target:t,start:{[n]:Ii(l,e,"start",Math.max)},end:{[n]:Ii(l,e,"end",Math.min)}})}}return s}(n,r,a);for(const{source:l,target:c,start:d,end:u}of i){const{style:{backgroundColor:t=o}={}}=l,i=!0!==r;e.save(),e.fillStyle=t,Hi(e,s,i&&Ai(a,d,u)),e.beginPath();const h=!!n.pathSegment(e,l);let p;if(i){h?e.closePath():qi(e,r,u,a);const t=!!r.pathSegment(e,c,{move:h,reverse:!0});p=h&&t,p||qi(e,r,d,a)}e.closePath(),e.fill(p?"evenodd":"nonzero"),e.restore()}}function Hi(e,t,n){const{top:r,bottom:a}=t.chart.chartArea,{property:o,start:s,end:i}=n||{};"x"===o&&(e.beginPath(),e.rect(s,r,i-s,a-r),e.clip())}function qi(e,t,n,r){const a=t.interpolate(n,r);a&&e.lineTo(a.x,a.y)}var Yi={id:"filler",afterDatasetsUpdate(e,t,n){const r=(e.data.datasets||[]).length,a=[];let o,s,i,l;for(s=0;s<r;++s)o=e.getDatasetMeta(s),i=o.dataset,l=null,i&&i.options&&i instanceof _i&&(l={visible:e.isDatasetVisible(s),index:s,fill:Li(i,s,r),chart:e,axis:o.controller.options.indexAxis,scale:o.vScale,line:i}),o.$filler=l,a.push(l);for(s=0;s<r;++s)l=a[s],l&&!1!==l.fill&&(l.fill=Oi(a,s,n.propagate))},beforeDraw(e,t,n){const r="beforeDraw"===n.drawTime,a=e.getSortedVisibleDatasetMetas(),o=e.chartArea;for(let s=a.length-1;s>=0;--s){const t=a[s].$filler;t&&(t.line.updateControlPoints(o,t.axis),r&&t.fill&&Ui(e.ctx,t,o))}},beforeDatasetsDraw(e,t,n){if("beforeDatasetsDraw"!==n.drawTime)return;const r=e.getSortedVisibleDatasetMetas();for(let a=r.length-1;a>=0;--a){const t=r[a].$filler;Mi(t)&&Ui(e.ctx,t,e.chartArea)}},beforeDatasetDraw(e,t,n){const r=t.meta.$filler;Mi(r)&&"beforeDatasetDraw"===n.drawTime&&Ui(e.ctx,r,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Ji=(e,t)=>{let{boxHeight:n=t,boxWidth:r=t}=e;return e.usePointStyle&&(n=Math.min(n,t),r=e.pointStyleWidth||Math.min(r,t)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(t,n)}};class Qi extends bs{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Sn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter((t=>e.filter(t,this.chart.data)))),e.sort&&(t=t.sort(((t,n)=>e.sort(t,n,this.chart.data)))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const n=e.labels,r=la(n.font),a=r.size,o=this._computeTitleHeight(),{boxWidth:s,itemHeight:i}=Ji(n,a);let l,c;t.font=r.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(o,a,s,i)+10):(c=this.maxHeight,l=this._fitCols(o,r,s,i)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,r){const{ctx:a,maxWidth:o,options:{labels:{padding:s}}}=this,i=this.legendHitBoxes=[],l=this.lineWidths=[0],c=r+s;let d=e;a.textAlign="left",a.textBaseline="middle";let u=-1,h=-c;return this.legendItems.forEach(((e,p)=>{const m=n+t/2+a.measureText(e.text).width;(0===p||l[l.length-1]+m+2*s>o)&&(d+=c,l[l.length-(p>0?0:1)]=0,h+=c,u++),i[p]={left:0,top:h,row:u,width:m,height:r},l[l.length-1]+=m+s})),d}_fitCols(e,t,n,r){const{ctx:a,maxHeight:o,options:{labels:{padding:s}}}=this,i=this.legendHitBoxes=[],l=this.columnSizes=[],c=o-e;let d=s,u=0,h=0,p=0,m=0;return this.legendItems.forEach(((e,o)=>{const{itemWidth:f,itemHeight:g}=function(e,t,n,r,a){const o=function(e,t,n,r){let a=e.text;a&&"string"!==typeof a&&(a=a.reduce(((e,t)=>e.length>t.length?e:t)));return t+n.size/2+r.measureText(a).width}(r,e,t,n),s=function(e,t,n){let r=e;"string"!==typeof t.text&&(r=Ki(t,n));return r}(a,r,t.lineHeight);return{itemWidth:o,itemHeight:s}}(n,t,a,e,r);o>0&&h+g+2*s>c&&(d+=u+s,l.push({width:u,height:h}),p+=u+s,m++,u=h=0),i[o]={left:p,top:h,col:m,width:f,height:g},u=Math.max(u,f),h+=g+s})),d+=u,l.push({width:u,height:h}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:r},rtl:a}}=this,o=qa(a,this.left,this.width);if(this.isHorizontal()){let a=0,s=br(n,this.left+r,this.right-this.lineWidths[a]);for(const i of t)a!==i.row&&(a=i.row,s=br(n,this.left+r,this.right-this.lineWidths[a])),i.top+=this.top+e+r,i.left=o.leftForLtr(o.x(s),i.width),s+=i.width+r}else{let a=0,s=br(n,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const i of t)i.col!==a&&(a=i.col,s=br(n,this.top+e+r,this.bottom-this.columnSizes[a].height)),i.top=s,i.left+=this.left+r,i.left=o.leftForLtr(o.x(i.left),i.width),s+=i.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;Yr(e,this),this._draw(),Jr(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:r}=this,{align:a,labels:o}=e,s=zr.color,i=qa(e.rtl,this.left,this.width),l=la(o.font),{padding:c}=o,d=l.size,u=d/2;let h;this.drawTitle(),r.textAlign=i.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=l.string;const{boxWidth:p,boxHeight:m,itemHeight:f}=Ji(o,d),g=this.isHorizontal(),v=this._computeTitleHeight();h=g?{x:br(a,this.left+c,this.right-n[0]),y:this.top+c+v,line:0}:{x:this.left+c,y:br(a,this.top+v+c,this.bottom-t[0].height),line:0},Ya(this.ctx,e.textDirection);const y=f+c;this.legendItems.forEach(((b,x)=>{r.strokeStyle=b.fontColor,r.fillStyle=b.fontColor;const _=r.measureText(b.text).width,w=i.textAlign(b.textAlign||(b.textAlign=o.textAlign)),N=p+u+_;let E=h.x,S=h.y;i.setWidth(this.width),g?x>0&&E+N+c>this.right&&(S=h.y+=y,h.line++,E=h.x=br(a,this.left+c,this.right-n[h.line])):x>0&&S+y>this.bottom&&(E=h.x=E+t[h.line].width+c,h.line++,S=h.y=br(a,this.top+v+c,this.bottom-t[h.line].height));if(function(e,t,n){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;r.save();const a=Nn(n.lineWidth,1);if(r.fillStyle=Nn(n.fillStyle,s),r.lineCap=Nn(n.lineCap,"butt"),r.lineDashOffset=Nn(n.lineDashOffset,0),r.lineJoin=Nn(n.lineJoin,"miter"),r.lineWidth=a,r.strokeStyle=Nn(n.strokeStyle,s),r.setLineDash(Nn(n.lineDash,[])),o.usePointStyle){const s={radius:m*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:a},l=i.xPlus(e,p/2);Hr(r,s,l,t+u,o.pointStyleWidth&&p)}else{const o=t+Math.max((d-m)/2,0),s=i.leftForLtr(e,p),l=sa(n.borderRadius);r.beginPath(),Object.values(l).some((e=>0!==e))?ea(r,{x:s,y:o,w:p,h:m,radius:l}):r.rect(s,o,p,m),r.fill(),0!==a&&r.stroke()}r.restore()}(i.x(E),S,b),E=((e,t,n,r)=>e===(r?"left":"right")?n:"center"===e?(t+n)/2:t)(w,E+p+u,g?E+N:this.right,e.rtl),function(e,t,n){Zr(r,n.text,e,t+f/2,l,{strikethrough:n.hidden,textAlign:i.textAlign(n.textAlign)})}(i.x(E),S,b),g)h.x+=N+c;else if("string"!==typeof b.text){const e=l.lineHeight;h.y+=Ki(b,e)+c}else h.y+=y})),Ja(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=la(t.font),r=ia(t.padding);if(!t.display)return;const a=qa(e.rtl,this.left,this.width),o=this.ctx,s=t.position,i=n.size/2,l=r.top+i;let c,d=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,d=br(e.align,d,this.right-u);else{const t=this.columnSizes.reduce(((e,t)=>Math.max(e,t.height)),0);c=l+br(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const h=br(s,d,d+u);o.textAlign=a.textAlign(yr(s)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=n.string,Zr(o,t.text,h,c,n)}_computeTitleHeight(){const e=this.options.title,t=la(e.font),n=ia(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,r,a;if(cr(e,this.left,this.right)&&cr(t,this.top,this.bottom))for(a=this.legendHitBoxes,n=0;n<a.length;++n)if(r=a[n],cr(e,r.left,r.left+r.width)&&cr(t,r.top,r.top+r.height))return this.legendItems[n];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const o=this._hoveredItem,s=(a=n,null!==(r=o)&&null!==a&&r.datasetIndex===a.datasetIndex&&r.index===a.index);o&&!s&&Sn(t.onLeave,[e,o,this],this),this._hoveredItem=n,n&&!s&&Sn(t.onHover,[e,n,this],this)}else n&&Sn(t.onClick,[e,n,this],this);var r,a}}function Ki(e,t){return t*(e.text?e.text.length:0)}var Gi={id:"legend",_element:Qi,start(e,t,n){const r=e.legend=new Qi({ctx:e.ctx,options:n,chart:e});ts.configure(e,r,n),ts.addBox(e,r)},stop(e){ts.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const r=e.legend;ts.configure(e,r,n),r.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const r=t.datasetIndex,a=n.chart;a.isDatasetVisible(r)?(a.hide(r),t.hidden=!0):(a.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:a,color:o,useBorderRadius:s,borderRadius:i}}=e.legend.options;return e._getSortedDatasetMetas().map((e=>{const l=e.controller.getStyle(n?0:void 0),c=ia(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:o,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:r||l.pointStyle,rotation:l.rotation,textAlign:a||l.textAlign,borderRadius:s&&(i||l.borderRadius),datasetIndex:e.index}}),this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Xi extends bs{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const r=bn(n.text)?n.text.length:1;this._padding=ia(n.padding);const a=r*la(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:n,bottom:r,right:a,options:o}=this,s=o.align;let i,l,c,d=0;return this.isHorizontal()?(l=br(s,n,a),c=t+e,i=a-n):("left"===o.position?(l=n+e,c=br(s,r,t),d=-.5*zn):(l=a-e,c=br(s,t,r),d=.5*zn),i=r-t),{titleX:l,titleY:c,maxWidth:i,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=la(t.font),r=n.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:s,rotation:i}=this._drawArgs(r);Zr(e,t.text,0,0,n,{color:t.color,maxWidth:s,rotation:i,textAlign:yr(t.align),textBaseline:"middle",translation:[a,o]})}}var Zi={id:"title",_element:Xi,start(e,t,n){!function(e,t){const n=new Xi({ctx:e.ctx,options:t,chart:e});ts.configure(e,n,t),ts.addBox(e,n),e.titleBlock=n}(e,n)},stop(e){const t=e.titleBlock;ts.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const r=e.titleBlock;ts.configure(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const el={average(e){if(!e.length)return!1;let t,n,r=new Set,a=0,o=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();r.add(e.x),a+=e.y,++o}}if(0===o||0===r.size)return!1;return{x:[...r].reduce(((e,t)=>e+t))/r.size,y:a/o}},nearest(e,t){if(!e.length)return!1;let n,r,a,o=t.x,s=t.y,i=Number.POSITIVE_INFINITY;for(n=0,r=e.length;n<r;++n){const r=e[n].element;if(r&&r.hasValue()){const e=ar(t,r.getCenterPoint());e<i&&(i=e,a=r)}}if(a){const e=a.tooltipPosition();o=e.x,s=e.y}return{x:o,y:s}}};function tl(e,t){return t&&(bn(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function nl(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function rl(e,t){const{element:n,datasetIndex:r,index:a}=t,o=e.getDatasetMeta(r).controller,{label:s,value:i}=o.getLabelAndValue(a);return{chart:e,label:s,parsed:o.getParsed(a),raw:e.data.datasets[r].data[a],formattedValue:i,dataset:o.getDataset(),dataIndex:a,datasetIndex:r,element:n}}function al(e,t){const n=e.chart.ctx,{body:r,footer:a,title:o}=e,{boxWidth:s,boxHeight:i}=t,l=la(t.bodyFont),c=la(t.titleFont),d=la(t.footerFont),u=o.length,h=a.length,p=r.length,m=ia(t.padding);let f=m.height,g=0,v=r.reduce(((e,t)=>e+t.before.length+t.lines.length+t.after.length),0);if(v+=e.beforeBody.length+e.afterBody.length,u&&(f+=u*c.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),v){f+=p*(t.displayColors?Math.max(i,l.lineHeight):l.lineHeight)+(v-p)*l.lineHeight+(v-1)*t.bodySpacing}h&&(f+=t.footerMarginTop+h*d.lineHeight+(h-1)*t.footerSpacing);let y=0;const b=function(e){g=Math.max(g,n.measureText(e).width+y)};return n.save(),n.font=c.string,jn(e.title,b),n.font=l.string,jn(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?s+2+t.boxPadding:0,jn(r,(e=>{jn(e.before,b),jn(e.lines,b),jn(e.after,b)})),y=0,n.font=d.string,jn(e.footer,b),n.restore(),g+=m.width,{width:g,height:f}}function ol(e,t,n,r){const{x:a,width:o}=n,{width:s,chartArea:{left:i,right:l}}=e;let c="center";return"center"===r?c=a<=(i+l)/2?"left":"right":a<=o/2?c="left":a>=s-o/2&&(c="right"),function(e,t,n,r){const{x:a,width:o}=r,s=n.caretSize+n.caretPadding;return"left"===e&&a+o+s>t.width||"right"===e&&a-o-s<0||void 0}(c,e,t,n)&&(c="center"),c}function sl(e,t,n){const r=n.yAlign||t.yAlign||function(e,t){const{y:n,height:r}=t;return n<r/2?"top":n>e.height-r/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||ol(e,t,n,r),yAlign:r}}function il(e,t,n,r){const{caretSize:a,caretPadding:o,cornerRadius:s}=e,{xAlign:i,yAlign:l}=n,c=a+o,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=sa(s);let m=function(e,t){let{x:n,width:r}=e;return"right"===t?n-=r:"center"===t&&(n-=r/2),n}(t,i);const f=function(e,t,n){let{y:r,height:a}=e;return"top"===t?r+=n:r-="bottom"===t?a+n:a/2,r}(t,l,c);return"center"===l?"left"===i?m+=c:"right"===i&&(m-=c):"left"===i?m-=Math.max(d,h)+a:"right"===i&&(m+=Math.max(u,p)+a),{x:lr(m,0,r.width-t.width),y:lr(f,0,r.height-t.height)}}function ll(e,t,n){const r=ia(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-r.right:e.x+r.left}function cl(e){return tl([],nl(e))}function dl(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const ul={beforeTitle:gn,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:gn,beforeBody:gn,beforeLabel:gn,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return yn(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:gn,afterBody:gn,beforeFooter:gn,footer:gn,afterFooter:gn};function hl(e,t,n,r){const a=e[t].call(n,r);return"undefined"===typeof a?ul[t].call(n,r):a}class pl extends bs{static positioners=(()=>el)();constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&t.options.animation&&n.animations,a=new io(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,da(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}getTitle(e,t){const{callbacks:n}=t,r=hl(n,"beforeTitle",this,e),a=hl(n,"title",this,e),o=hl(n,"afterTitle",this,e);let s=[];return s=tl(s,nl(r)),s=tl(s,nl(a)),s=tl(s,nl(o)),s}getBeforeBody(e,t){return cl(hl(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,r=[];return jn(e,(e=>{const t={before:[],lines:[],after:[]},a=dl(n,e);tl(t.before,nl(hl(a,"beforeLabel",this,e))),tl(t.lines,hl(a,"label",this,e)),tl(t.after,nl(hl(a,"afterLabel",this,e))),r.push(t)})),r}getAfterBody(e,t){return cl(hl(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,r=hl(n,"beforeFooter",this,e),a=hl(n,"footer",this,e),o=hl(n,"afterFooter",this,e);let s=[];return s=tl(s,nl(r)),s=tl(s,nl(a)),s=tl(s,nl(o)),s}_createItems(e){const t=this._active,n=this.chart.data,r=[],a=[],o=[];let s,i,l=[];for(s=0,i=t.length;s<i;++s)l.push(rl(this.chart,t[s]));return e.filter&&(l=l.filter(((t,r,a)=>e.filter(t,r,a,n)))),e.itemSort&&(l=l.sort(((t,r)=>e.itemSort(t,r,n)))),jn(l,(t=>{const n=dl(e.callbacks,t);r.push(hl(n,"labelColor",this,t)),a.push(hl(n,"labelPointStyle",this,t)),o.push(hl(n,"labelTextColor",this,t))})),this.labelColors=r,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),r=this._active;let a,o=[];if(r.length){const e=el[n.position].call(this,r,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const t=this._size=al(this,n),s=Object.assign({},e,t),i=sl(this.chart,n,s),l=il(n,s,i,this.chart);this.xAlign=i.xAlign,this.yAlign=i.yAlign,a={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(a={opacity:0});this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,r){const a=this.getCaretPosition(e,n,r);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,n){const{xAlign:r,yAlign:a}=this,{caretSize:o,cornerRadius:s}=n,{topLeft:i,topRight:l,bottomLeft:c,bottomRight:d}=sa(s),{x:u,y:h}=e,{width:p,height:m}=t;let f,g,v,y,b,x;return"center"===a?(b=h+m/2,"left"===r?(f=u,g=f-o,y=b+o,x=b-o):(f=u+p,g=f+o,y=b-o,x=b+o),v=f):(g="left"===r?u+Math.max(i,c)+o:"right"===r?u+p-Math.max(l,d)-o:this.caretX,"top"===a?(y=h,b=y-o,f=g-o,v=g+o):(y=h+m,b=y+o,f=g+o,v=g-o),x=y),{x1:f,x2:g,x3:v,y1:y,y2:b,y3:x}}drawTitle(e,t,n){const r=this.title,a=r.length;let o,s,i;if(a){const l=qa(n.rtl,this.x,this.width);for(e.x=ll(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",o=la(n.titleFont),s=n.titleSpacing,t.fillStyle=n.titleColor,t.font=o.string,i=0;i<a;++i)t.fillText(r[i],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s,i+1===a&&(e.y+=n.titleMarginBottom-s)}}_drawColorBox(e,t,n,r,a){const o=this.labelColors[n],s=this.labelPointStyles[n],{boxHeight:i,boxWidth:l}=a,c=la(a.bodyFont),d=ll(this,"left",a),u=r.x(d),h=i<c.lineHeight?(c.lineHeight-i)/2:0,p=t.y+h;if(a.usePointStyle){const t={radius:Math.min(l,i)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},n=r.leftForLtr(u,l)+l/2,c=p+i/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,Vr(e,t,n,c),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Vr(e,t,n,c)}else{e.lineWidth=xn(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const t=r.leftForLtr(u,l),n=r.leftForLtr(r.xPlus(u,1),l-2),s=sa(o.borderRadius);Object.values(s).some((e=>0!==e))?(e.beginPath(),e.fillStyle=a.multiKeyBackground,ea(e,{x:t,y:p,w:l,h:i,radius:s}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),ea(e,{x:n,y:p+1,w:l-2,h:i-2,radius:s}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(t,p,l,i),e.strokeRect(t,p,l,i),e.fillStyle=o.backgroundColor,e.fillRect(n,p+1,l-2,i-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:r}=this,{bodySpacing:a,bodyAlign:o,displayColors:s,boxHeight:i,boxWidth:l,boxPadding:c}=n,d=la(n.bodyFont);let u=d.lineHeight,h=0;const p=qa(n.rtl,this.x,this.width),m=function(n){t.fillText(n,p.x(e.x+h),e.y+u/2),e.y+=u+a},f=p.textAlign(o);let g,v,y,b,x,_,w;for(t.textAlign=o,t.textBaseline="middle",t.font=d.string,e.x=ll(this,f,n),t.fillStyle=n.bodyColor,jn(this.beforeBody,m),h=s&&"right"!==f?"center"===o?l/2+c:l+2+c:0,b=0,_=r.length;b<_;++b){for(g=r[b],v=this.labelTextColors[b],t.fillStyle=v,jn(g.before,m),y=g.lines,s&&y.length&&(this._drawColorBox(t,e,b,p,n),u=Math.max(d.lineHeight,i)),x=0,w=y.length;x<w;++x)m(y[x]),u=d.lineHeight;jn(g.after,m)}h=0,u=d.lineHeight,jn(this.afterBody,m),e.y-=a}drawFooter(e,t,n){const r=this.footer,a=r.length;let o,s;if(a){const i=qa(n.rtl,this.x,this.width);for(e.x=ll(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=i.textAlign(n.footerAlign),t.textBaseline="middle",o=la(n.footerFont),t.fillStyle=n.footerColor,t.font=o.string,s=0;s<a;++s)t.fillText(r[s],i.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+n.footerSpacing}}drawBackground(e,t,n,r){const{xAlign:a,yAlign:o}=this,{x:s,y:i}=e,{width:l,height:c}=n,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=sa(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(s+d,i),"top"===o&&this.drawCaret(e,t,n,r),t.lineTo(s+l-u,i),t.quadraticCurveTo(s+l,i,s+l,i+u),"center"===o&&"right"===a&&this.drawCaret(e,t,n,r),t.lineTo(s+l,i+c-p),t.quadraticCurveTo(s+l,i+c,s+l-p,i+c),"bottom"===o&&this.drawCaret(e,t,n,r),t.lineTo(s+h,i+c),t.quadraticCurveTo(s,i+c,s,i+c-h),"center"===o&&"left"===a&&this.drawCaret(e,t,n,r),t.lineTo(s,i+d),t.quadraticCurveTo(s,i,s+d,i),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,r=n&&n.x,a=n&&n.y;if(r||a){const n=el[e.position].call(this,this._active,this._eventPosition);if(!n)return;const o=this._size=al(this,e),s=Object.assign({},n,this._size),i=sl(t,e,s),l=il(e,s,i,t);r._to===l.x&&a._to===l.y||(this.xAlign=i.xAlign,this.yAlign=i.yAlign,this.width=o.width,this.height=o.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},a={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=ia(t.padding),s=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&s&&(e.save(),e.globalAlpha=n,this.drawBackground(a,e,r,t),Ya(e,t.textDirection),a.y+=o.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),Ja(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,r=e.map((e=>{let{datasetIndex:t,index:n}=e;const r=this.chart.getDatasetMeta(t);if(!r)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:r.data[n],index:n}})),a=!kn(n,r),o=this._positionChanged(r,t);(a||o)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,a=this._active||[],o=this._getActiveElements(e,a,t,n),s=this._positionChanged(o,e),i=t||!kn(o,a)||s;return i&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),i}_getActiveElements(e,t,n,r){const a=this.options;if("mouseout"===e.type)return[];if(!r)return t.filter((e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index)));const o=this.chart.getElementsAtEventForMode(e,a.mode,a,n);return a.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:n,caretY:r,options:a}=this,o=el[a.position].call(this,e,t);return!1!==o&&(n!==o.x||r!==o.y)}}var ml={id:"tooltip",_element:pl,positioners:el,afterInit(e,t,n){n&&(e.tooltip=new pl({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:ul},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function fl(e,t,n,r){const a=e.indexOf(t);if(-1===a)return((e,t,n,r)=>("string"===typeof t?(n=e.push(t)-1,r.unshift({index:n,label:t})):isNaN(t)&&(n=null),n))(e,t,n,r);return a!==e.lastIndexOf(t)?n:a}function gl(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class vl extends Ds{static id="category";static defaults=(()=>({ticks:{callback:gl}}))();constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:n,label:r}of t)e[n]===r&&e.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(yn(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:lr(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:fl(n,e,Nn(t,e),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:r}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(n=0),t||(r=this.getLabels().length-1)),this.min=n,this.max=r}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,r=[];let a=this.getLabels();a=0===e&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=e;o<=t;o++)r.push({value:o});return r}getLabelForValue(e){return gl.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function yl(e,t){const n=[],{bounds:r,step:a,min:o,max:s,precision:i,count:l,maxTicks:c,maxDigits:d,includeBounds:u}=e,h=a||1,p=c-1,{min:m,max:f}=t,g=!yn(o),v=!yn(s),y=!yn(l),b=(f-m)/(d+1);let x,_,w,N,E=Gn((f-m)/p/h)*h;if(E<1e-14&&!g&&!v)return[{value:m},{value:f}];N=Math.ceil(f/E)-Math.floor(m/E),N>p&&(E=Gn(N*E/p/h)*h),yn(i)||(x=Math.pow(10,i),E=Math.ceil(E*x)/x),"ticks"===r?(_=Math.floor(m/E)*E,w=Math.ceil(f/E)*E):(_=m,w=f),g&&v&&a&&function(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}((s-o)/a,E/1e3)?(N=Math.round(Math.min((s-o)/E,c)),E=(s-o)/N,_=o,w=s):y?(_=g?o:_,w=v?s:w,N=l-1,E=(w-_)/N):(N=(w-_)/E,N=Kn(N,Math.round(N),E/1e3)?Math.round(N):Math.ceil(N));const S=Math.max(nr(E),nr(_));x=Math.pow(10,yn(i)?S:i),_=Math.round(_*x)/x,w=Math.round(w*x)/x;let j=0;for(g&&(u&&_!==o?(n.push({value:o}),_<o&&j++,Kn(Math.round((_+j*E)*x)/x,o,bl(o,b,e))&&j++):_<o&&j++);j<N;++j){const e=Math.round((_+j*E)*x)/x;if(v&&e>s)break;n.push({value:e})}return v&&u&&w!==s?n.length&&Kn(n[n.length-1].value,s,bl(s,b,e))?n[n.length-1].value=s:n.push({value:s}):v&&w!==s||n.push({value:w}),n}function bl(e,t,n){let{horizontal:r,minRotation:a}=n;const o=er(a),s=(r?Math.sin(o):Math.cos(o))||.001,i=.75*t*(""+e).length;return Math.min(t/s,i)}class xl extends Ds{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return yn(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:r,max:a}=this;const o=e=>r=t?r:e,s=e=>a=n?a:e;if(e){const e=Qn(r),t=Qn(a);e<0&&t<0?s(0):e>0&&t>0&&o(0)}if(r===a){let t=0===a?1:Math.abs(.05*a);s(a+t),e||o(r-t)}this.min=r,this.max=a}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:n,stepSize:r}=e;return r?(t=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,t>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${t} ticks. Limiting to 1000.`),t=1e3)):(t=this.computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const r=yl({maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&Zn(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const r=(n-t)/Math.max(e.length-1,1)/2;t-=r,n+=r}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return Pr(e,this.chart.options.locale,this.options.ticks.format)}}class _l extends xl{static id="linear";static defaults=(()=>({ticks:{callback:Rr.formatters.numeric}}))();determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=_n(e)?e:0,this.max=_n(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=er(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/r))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Rr.formatters.logarithmic;Rr.formatters.numeric;const wl={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Nl=Object.keys(wl);function El(e,t){return e-t}function Sl(e,t){if(yn(t))return null;const n=e._adapter,{parser:r,round:a,isoWeekday:o}=e._parseOpts;let s=t;return"function"===typeof r&&(s=r(s)),_n(s)||(s="string"===typeof r?n.parse(s,r):n.parse(s)),null===s?null:(a&&(s="week"!==a||!Xn(o)&&!0!==o?n.startOf(s,a):n.startOf(s,"isoWeek",o)),+s)}function jl(e,t,n,r){const a=Nl.length;for(let o=Nl.indexOf(e);o<a-1;++o){const e=wl[Nl[o]],a=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(a*e.size))<=r)return Nl[o]}return Nl[a-1]}function kl(e,t,n){if(n){if(n.length){const{lo:r,hi:a}=dr(n,t);e[n[r]>=t?n[r]:n[a]]=!0}}else e[t]=!0}function Cl(e,t,n){const r=[],a={},o=t.length;let s,i;for(s=0;s<o;++s)i=t[s],a[i]=s,r.push({value:i,major:!1});return 0!==o&&n?function(e,t,n,r){const a=e._adapter,o=+a.startOf(t[0].value,r),s=t[t.length-1].value;let i,l;for(i=o;i<=s;i=+a.add(i,1,r))l=n[i],l>=0&&(t[l].major=!0);return t}(e,r,a,n):r}class Dl extends Ds{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.time||(e.time={}),r=this._adapter=new Mo(e.adapters.date);r.init(t),Pn(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:Sl(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:r,max:a,minDefined:o,maxDefined:s}=this.getUserBounds();function i(e){o||isNaN(e.min)||(r=Math.min(r,e.min)),s||isNaN(e.max)||(a=Math.max(a,e.max))}o&&s||(i(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||i(this.getMinMax(!1))),r=_n(r)&&!isNaN(r)?r:+t.startOf(Date.now(),n),a=_n(a)&&!isNaN(a)?a:+t.endOf(Date.now(),n)+1,this.min=Math.min(r,a-1),this.max=Math.max(r+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,r="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const a=this.min,o=function(e,t,n){let r=0,a=e.length;for(;r<a&&e[r]<t;)r++;for(;a>r&&e[a-1]>n;)a--;return r>0||a<e.length?e.slice(r,a):e}(r,a,this.max);return this._unit=t.unit||(n.autoSkip?jl(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):function(e,t,n,r,a){for(let o=Nl.length-1;o>=Nl.indexOf(n);o--){const n=Nl[o];if(wl[n].common&&e._adapter.diff(a,r,n)>=t-1)return n}return Nl[n?Nl.indexOf(n):0]}(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(let t=Nl.indexOf(e)+1,n=Nl.length;t<n;++t)if(wl[Nl[t]].common)return Nl[t]}(this._unit):void 0,this.initOffsets(r),e.reverse&&o.reverse(),Cl(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((e=>+e.value)))}initOffsets(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0,a=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),r=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),a=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);const o=n.length<3?.5:.25;r=lr(r,0,o),a=lr(a,0,o),this._offsets={start:r,end:a,factor:1/(r+1+a)}}_generate(){const e=this._adapter,t=this.min,n=this.max,r=this.options,a=r.time,o=a.unit||jl(a.minUnit,t,n,this._getLabelCapacity(t)),s=Nn(r.ticks.stepSize,1),i="week"===o&&a.isoWeekday,l=Xn(i)||!0===i,c={};let d,u,h=t;if(l&&(h=+e.startOf(h,"isoWeek",i)),h=+e.startOf(h,l?"day":o),e.diff(n,t,o)>1e5*s)throw new Error(t+" and "+n+" are too far apart with stepSize of "+s+" "+o);const p="data"===r.ticks.source&&this.getDataTimestamps();for(d=h,u=0;d<n;d=+e.add(d,s,o),u++)kl(c,d,p);return d!==n&&"ticks"!==r.bounds&&1!==u||kl(c,d,p),Object.keys(c).sort(El).map((e=>+e))}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const n=this.options.time.displayFormats,r=this._unit,a=t||n[r];return this._adapter.format(e,a)}_tickFormatFunction(e,t,n,r){const a=this.options,o=a.ticks.callback;if(o)return Sn(o,[e,t,n],this);const s=a.time.displayFormats,i=this._unit,l=this._majorUnit,c=i&&s[i],d=l&&s[l],u=n[t],h=l&&d&&u&&u.major;return this._adapter.format(e,r||(h?d:c))}generateTickLabels(e){let t,n,r;for(t=0,n=e.length;t<n;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,r=er(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(r),o=Math.sin(r),s=this._resolveTickFontOptions(0).size;return{w:n*a+s*o,h:n*o+s*a}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,r=n[t.unit]||n.millisecond,a=this._tickFormatFunction(e,0,Cl(this,[e],this._majorUnit),r),o=this._getLabelSize(a),s=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return s>0?s:1}getDataTimestamps(){let e,t,n=this._cache.data||[];if(n.length)return n;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(e=0,t=r.length;e<t;++e)n=n.concat(r[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const r=this.getLabels();for(t=0,n=r.length;t<n;++t)e.push(Sl(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return fr(e.sort(El))}}const Tl="label";function Al(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Pl(e,t){e.labels=t}function Il(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tl;const r=[];e.datasets=t.map((t=>{const a=e.datasets.find((e=>e[n]===t[n]));return a&&t.data&&!r.includes(a)?(r.push(a),Object.assign(a,t),a):{...t}}))}function Rl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tl;const n={labels:[],datasets:[]};return Pl(n,e.labels),Il(n,e.datasets,t),n}function Ml(e,t){const{height:n=150,width:r=300,redraw:o=!1,datasetIdKey:s,type:i,data:l,options:c,plugins:d=[],fallbackContent:u,updateMode:h,...p}=e,m=(0,a.useRef)(null),f=(0,a.useRef)(null),g=()=>{m.current&&(f.current=new si(m.current,{type:i,data:Rl(l,s),options:c&&{...c},plugins:d}),Al(t,f.current))},v=()=>{Al(t,null),f.current&&(f.current.destroy(),f.current=null)};return(0,a.useEffect)((()=>{!o&&f.current&&c&&function(e,t){const n=e.options;n&&t&&Object.assign(n,t)}(f.current,c)}),[o,c]),(0,a.useEffect)((()=>{!o&&f.current&&Pl(f.current.config.data,l.labels)}),[o,l.labels]),(0,a.useEffect)((()=>{!o&&f.current&&l.datasets&&Il(f.current.config.data,l.datasets,s)}),[o,l.datasets]),(0,a.useEffect)((()=>{f.current&&(o?(v(),setTimeout(g)):f.current.update(h))}),[o,c,l.labels,l.datasets,h]),(0,a.useEffect)((()=>{f.current&&(v(),setTimeout(g))}),[i]),(0,a.useEffect)((()=>(g(),()=>v())),[]),a.createElement("canvas",{ref:m,role:"img",height:n,width:r,...p},u)}const Ol=(0,a.forwardRef)(Ml);function Ll(e,t){return si.register(t),(0,a.forwardRef)(((t,n)=>a.createElement(Ol,{...t,ref:n,type:e})))}const $l=Ll("line",Ao),Fl=Ll("bar",Do),zl=Ll("pie",Po);si.register(hi,ml,Gi,Zi);const Bl={Nuevo:"#FBBD23","En Revisi\xf3n":"#3ABFF8",Aprobado:"#36D399","Por Dispersar":"#C084FC",Rechazado:"#E11D48",Completado:"#059669",Cancelado:"#6E6E6E",Expirado:"#FF5757",pending:"#FBBD23",in_review:"#3ABFF8",approved:"#36D399",rejected:"#E11D48",completed:"#059669",cancelled:"#6E6E6E",por_dispersar:"#C084FC",expired:"#FF5757",default:"#cccccc"},Ul={pending:"Nuevo",in_review:"En Revisi\xf3n",approved:"Aprobado",rejected:"Rechazado",completed:"Completado",cancelled:"Cancelado",por_dispersar:"Por Dispersar",expired:"Expirado",new:"Nuevo",solicitud:"Nuevo",default:"Desconocido"},Wl=e=>{let{data:t,title:n="Distribuci\xf3n por Estado",height:r=240,showLegend:a=!0,className:o="",preserveOriginalStatuses:s=!1}=e;if(!t||0===t.length)return(0,$e.jsx)("div",{className:"flex items-center justify-center h-full bg-base-200 rounded-lg",children:(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})});const i={};s?t.forEach((e=>{const t=e.status.toLowerCase();i[t]||(i[t]=0),i[t]+=e.count})):t.forEach((e=>{const t=(e=>{const t=e.toLowerCase();return t.includes("pend")||"new"===t||"solicitud"===t||"nuevo"===t?"Nuevo":t.includes("review")||t.includes("revis")?"En Revisi\xf3n":t.includes("aprob")||t.includes("aprov")||t.includes("approv")?"Aprobado":t.includes("recha")||t.includes("reject")?"Rechazado":t.includes("comple")?"Completado":t.includes("cancel")?"Cancelado":t.includes("dispers")?"Por Dispersar":t.includes("expir")?"Expirado":"default"})(e.status);i[t]||(i[t]=0),i[t]+=e.count}));const l=Object.keys(i),c=Object.values(i),d=l.map((e=>{if(s){const t=e.toLowerCase();return t.includes("pend")||"new"===t||"solicitud"===t||"nuevo"===t?Bl.pending:t.includes("review")||t.includes("revis")?Bl.in_review:t.includes("aprob")||t.includes("aprov")||"aprobado"===t||t.includes("approv")?Bl.approved:t.includes("comple")?Bl.completed:t.includes("disper")?Bl.por_dispersar:t.includes("recha")||t.includes("reject")?Bl.rejected:t.includes("cancel")?Bl.cancelled:t.includes("expir")?Bl.expired:Bl.default}return Bl[e]||Bl.default})),u={labels:l.map((e=>{if(s){const t=Ul[e];return t||e.charAt(0).toUpperCase()+e.slice(1)}return Ul[e]||e})),datasets:[{data:c,backgroundColor:d,borderColor:d,borderWidth:1}]},h={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:a,position:"right",labels:{boxWidth:15,padding:15,font:{size:12}}},title:{display:!!n,text:n,font:{size:16}},tooltip:{callbacks:{label:e=>{const t=e.label||"",n=e.raw||0,r=c.reduce(((e,t)=>e+t),0);return`${t}: ${n} (${Math.round(n/r*100)}%)`}}}}};return(0,$e.jsx)("div",{className:`chart-container ${o}`,style:{height:`${r}px`},children:(0,$e.jsx)(zl,{data:u,options:h})})};si.register(vl,_l,Ni,_i,Zi,ml,Gi,Yi);const Vl=e=>{let{data:t,title:n="Solicitudes por Mes",height:r=300,className:o="",color:s="rgba(53, 162, 235, 0.7)",timePeriod:i="month"}=e;const[l,c]=(0,a.useState)({labels:[],datasets:[{label:"Solicitudes",data:[],borderColor:"rgba(53, 162, 235, 0.8)",backgroundColor:"rgba(53, 162, 235, 0.2)",fill:!0,tension:.3}]});(0,a.useEffect)((()=>{if(!t||0===t.length)return;const e=[...t].sort(((e,t)=>e.month.localeCompare(t.month)));let n=[];switch(i){case"day":n=d(e);break;case"week":n=u(e);break;case"year":n=h(e);break;default:n=e.map((e=>{const[t,n]=e.month.split("-");return{label:`${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][new Date(parseInt(t),parseInt(n)-1,1).getMonth()]} ${t}`,count:e.count}}))}const r=n.map((e=>e.label)),a=n.map((e=>e.count));c({labels:r,datasets:[{label:"Solicitudes",data:a,borderColor:s,backgroundColor:s.replace("0.7","0.1"),fill:!0,tension:.3}]})}),[t,s,i]);const d=e=>{const t=new Date,n=new Date;n.setDate(t.getDate()-30);const r={};for(let a=0;a<30;a++){const e=new Date;e.setDate(t.getDate()-a);const n=e.toISOString().split("T")[0];r[n]=0}return e.forEach((e=>{if(e.daily&&Array.isArray(e.daily))e.daily.forEach((e=>{const a=new Date(e.date);a>=n&&a<=t&&(r[e.date]=e.count)}));else{const[t,n]=e.month.split("-");if(`${t}-${n}`===(new Date).toISOString().split("T")[0].substring(0,7)){const t=(new Date).toISOString().split("T")[0];r[t]=e.count}}})),Object.entries(r).map((e=>{let[t,n]=e;const r=new Date(t);return{label:`${r.getDate().toString().padStart(2,"0")} ${r.toLocaleString("es-ES",{month:"short"})}`,count:n,date:t}})).sort(((e,t)=>e.date.localeCompare(t.date))).slice(-30)},u=e=>{const t=new Date,n=[];for(let a=0;a<5;a++){const e=new Date(t);e.setDate(t.getDate()-7*a);const r=new Date(e);r.setDate(e.getDate()-6);const o=e=>`${e.getDate()} ${e.toLocaleString("es-ES",{month:"short"})}`,s=r.toISOString().split("T")[0],i=e.toISOString().split("T")[0];n.unshift({label:`${o(r)} - ${o(e)}`,count:0,startDate:s,endDate:i})}const r={};return e.forEach((e=>{if(e.daily&&Array.isArray(e.daily))e.daily.forEach((e=>{r[e.date]=e.count}));else{const t=(new Date).toISOString().substring(0,7);if(e.month===t){const t=(new Date).toISOString().split("T")[0];r[t]=e.count}}})),Object.entries(r).forEach((e=>{let[t,r]=e;const a=n.find((e=>t>=e.startDate&&t<=e.endDate));a&&(a.count+=r)})),n},h=e=>{const t={};return e.forEach((e=>{const[n]=e.month.split("-");t[n]=(t[n]||0)+e.count})),Object.entries(t).map((e=>{let[t,n]=e;return{label:t,count:n}})).sort(((e,t)=>e.label.localeCompare(t.label)))},p={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!!n,text:n,font:{size:16}},tooltip:{callbacks:{label:e=>`Solicitudes: ${e.parsed.y}`}}},scales:{y:{beginAtZero:!0,ticks:{precision:0}},x:{grid:{display:!1}}}};return(0,$e.jsx)("div",{className:`chart-container ${o}`,style:{height:`${r}px`},children:t&&t.length>0?(0,$e.jsx)($l,{data:l,options:p}):(0,$e.jsx)("div",{className:"flex items-center justify-center h-full bg-base-200 rounded-lg",children:(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})})})};si.register(vl,_l,Ti,Zi,ml,Gi);const Hl=e=>{let{data:t,title:n="Distribuci\xf3n por Monto",height:r=300,className:o=""}=e;const[s,i]=(0,a.useState)({labels:[],datasets:[{label:"Solicitudes",data:[],backgroundColor:"rgba(255, 159, 64, 0.8)",borderColor:"rgba(255, 159, 64, 1)",borderWidth:1}]});(0,a.useEffect)((()=>{if(t&&Array.isArray(t)&&0!==t.length)try{const e=t.filter((e=>e&&"object"===typeof e&&"string"===typeof e.range&&""!==e.range&&"number"===typeof e.count));if(0===e.length)return void console.log("AmountRangeChart: No valid data items found");const n=[...e].sort(((e,t)=>{const n=e=>{if(!e)return 0;try{const t=e.match(/(\d+)/);return t?parseInt(t[1],10):0}catch(t){return console.error("Error parsing range:",e,t),0}};return n(e.range)-n(t.range)})),r=n.map((e=>e.range)),a=n.map((e=>e.count)),o=n.map(((e,t)=>{const r=t/(n.length-1||1);return`rgba(${Math.round(255-100*r)}, ${Math.round(120+60*r)}, ${Math.round(50+100*r)}, 0.8)`}));i({labels:r,datasets:[{label:"Solicitudes",data:a,backgroundColor:o,borderColor:o.map((e=>e.replace("0.8","1"))),borderWidth:1}]})}catch(e){console.error("Error processing chart data:",e)}else console.log("AmountRangeChart: No data or invalid data provided",t)}),[t]);const l={indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!!n,text:n,font:{size:16}},tooltip:{callbacks:{label:e=>`Solicitudes: ${e.parsed.x}`}}},scales:{x:{beginAtZero:!0,ticks:{precision:0}},y:{grid:{display:!1}}}};return(0,$e.jsx)("div",{className:`chart-container ${o}`,style:{height:`${r}px`},children:t&&Array.isArray(t)&&t.length>0?(0,$e.jsx)(Fl,{data:s,options:l}):(0,$e.jsx)("div",{className:"flex items-center justify-center h-full bg-base-200 rounded-lg",children:(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})})})};si.register(vl,_l,Ti,Zi,ml,Gi);const ql=e=>{let{data:t,title:n="Rendimiento de Asesores",height:r=350,className:o="",maxBars:s=10}=e;const[i,l]=(0,a.useState)({labels:[],datasets:[]}),[c,d]=(0,a.useState)([]);(0,a.useEffect)((()=>{if(!t||0===t.length)return;const e=[...t].sort(((e,t)=>t.total_applications-e.total_applications)).slice(0,s),n=e.map((e=>e.advisor_name)),r=e.map((e=>e.total_applications)),a=e.map((e=>e.approved_applications||0));d(n),l({labels:n,datasets:[{label:"Total Solicitudes",data:r,backgroundColor:"rgba(53, 162, 235, 0.7)",borderColor:"rgba(53, 162, 235, 1)",borderWidth:1},{label:"Aprobadas",data:a,backgroundColor:"rgba(75, 192, 192, 0.7)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]})}),[t,s]);const u={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!!n,text:n,font:{size:16}},tooltip:{callbacks:{label:e=>`${e.dataset.label||""}: ${e.parsed.y}`}}},scales:{y:{beginAtZero:!0,ticks:{precision:0}},x:{ticks:{callback:function(e,t){const n=c[t];return(null===n||void 0===n?void 0:n.length)>12?n.substr(0,10)+"...":n}}}}};return(0,$e.jsx)("div",{className:`chart-container ${o}`,style:{height:`${r}px`},children:t&&t.length>0?(0,$e.jsx)(Fl,{data:i,options:u}):(0,$e.jsx)("div",{className:"flex items-center justify-center h-full bg-base-200 rounded-lg",children:(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})})})};function Yl(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=Yl(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Jl(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=Yl(e))&&(r&&(r+=" "),r+=t);return r}Math.pow(10,8);const Ql=6048e5,Kl=6e4,Gl=36e5,Xl=Symbol.for("constructDateFrom");function Zl(e,t){return"function"===typeof e?e(t):e&&"object"===typeof e&&Xl in e?e[Xl](t):e instanceof Date?new e.constructor(t):new Date(t)}function ec(e,t){return Zl(t||e,e)}function tc(e,t){const n=()=>Zl(t?.in,NaN),r=t?.additionalDigits??2,a=function(e){const t={},n=e.split(nc.dateTimeDelimiter);let r;if(n.length>2)return t;/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],nc.timeZoneDelimiter.test(t.date)&&(t.date=e.split(nc.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length)));if(r){const e=nc.timezone.exec(r);e?(t.time=r.replace(e[1],""),t.timezone=e[1]):t.time=r}return t}(e);let o;if(a.date){const e=function(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:null===o?a:100*o,restDateString:e.slice((r[1]||r[2]).length)}}(a.date,r);o=function(e,t){if(null===t)return new Date(NaN);const n=e.match(rc);if(!n)return new Date(NaN);const r=!!n[4],a=sc(n[1]),o=sc(n[2])-1,s=sc(n[3]),i=sc(n[4]),l=sc(n[5])-1;if(r)return function(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}(0,i,l)?function(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=7*(t-1)+n+1-a;return r.setUTCDate(r.getUTCDate()+o),r}(t,i,l):new Date(NaN);{const e=new Date(0);return function(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(lc[t]||(cc(e)?29:28))}(t,o,s)&&function(e,t){return t>=1&&t<=(cc(e)?366:365)}(t,a)?(e.setUTCFullYear(t,o,Math.max(a,s)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!o||isNaN(+o))return n();const s=+o;let i,l=0;if(a.time&&(l=function(e){const t=e.match(ac);if(!t)return NaN;const n=ic(t[1]),r=ic(t[2]),a=ic(t[3]);if(!function(e,t,n){if(24===e)return 0===t&&0===n;return n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}(n,r,a))return NaN;return n*Gl+r*Kl+1e3*a}(a.time),isNaN(l)))return n();if(!a.timezone){const e=new Date(s+l),n=ec(0,t?.in);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}return i=function(e){if("Z"===e)return 0;const t=e.match(oc);if(!t)return 0;const n="+"===t[1]?-1:1,r=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,a))return NaN;return n*(r*Gl+a*Kl)}(a.timezone),isNaN(i)?n():ec(s+l+i,t?.in)}const nc={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},rc=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ac=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,oc=/^([+-])(\d{2})(?::?(\d{2}))?$/;function sc(e){return e?parseInt(e):1}function ic(e){return e&&parseFloat(e.replace(",","."))||0}const lc=[31,null,31,30,31,30,31,31,30,31,30,31];function cc(e){return e%400===0||e%4===0&&e%100!==0}const dc={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function uc(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const hc={date:uc({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:uc({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:uc({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},pc={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function mc(e){return(t,n)=>{let r;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,a=n?.width?String(n.width):t;r=e.formattingValues[a]||e.formattingValues[t]}else{const t=e.defaultWidth,a=n?.width?String(n.width):e.defaultWidth;r=e.values[a]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}const fc={ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:mc({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:mc({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:mc({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:mc({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:mc({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function gc(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=t.match(a);if(!o)return null;const s=o[0],i=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(i)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(i,(e=>e.test(s))):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(i,(e=>e.test(s)));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(s.length)}}}function vc(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t.match(e.matchPattern);if(!r)return null;const a=r[0],o=t.match(e.parsePattern);if(!o)return null;let s=e.valueCallback?e.valueCallback(o[0]):o[0];s=n.valueCallback?n.valueCallback(s):s;return{value:s,rest:t.slice(a.length)}}}const yc={ordinalNumber:vc({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:gc({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:gc({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:gc({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:gc({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:gc({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},bc={code:"en-US",formatDistance:(e,t,n)=>{let r;const a=dc[e];return r="string"===typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:hc,formatRelative:(e,t,n,r)=>pc[e],localize:fc,match:yc,options:{weekStartsOn:0,firstWeekContainsDate:1}},xc=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},_c=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},wc={p:_c,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return xc(e,t);let o;switch(r){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;default:o=t.dateTime({width:"full"})}return o.replace("{{date}}",xc(r,t)).replace("{{time}}",_c(a,t))}},Nc=/^D+$/,Ec=/^Y+$/,Sc=["D","DD","YY","YYYY"];function jc(e){return Nc.test(e)}function kc(e){return Ec.test(e)}function Cc(e,t,n){const r=function(e,t,n){const r="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(console.warn(r),Sc.includes(e))throw new RangeError(r)}let Dc={};function Tc(){return Dc}function Ac(){return Object.assign({},Tc())}function Pc(e,t){const n=function(e){return"function"===typeof e&&e.prototype?.constructor===e}(t)?new t(0):Zl(t,0);return n.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),n.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n}class Ic{subPriority=0;validate(e,t){return!0}}class Rc extends Ic{constructor(e,t,n,r,a){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=r,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class Mc extends Ic{priority=10;subPriority=-1;constructor(e,t){super(),this.context=e||(e=>Zl(t,e))}set(e,t){return t.timestampIsSet?e:Zl(e,Pc(e,this.context))}}class Oc{run(e,t,n,r){const a=this.parse(e,t,n,r);return a?{setter:new Rc(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,n){return!0}}const Lc=/^(1[0-2]|0?\d)/,$c=/^(3[0-1]|[0-2]?\d)/,Fc=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,zc=/^(5[0-3]|[0-4]?\d)/,Bc=/^(2[0-3]|[0-1]?\d)/,Uc=/^(2[0-4]|[0-1]?\d)/,Wc=/^(1[0-1]|0?\d)/,Vc=/^(1[0-2]|0?\d)/,Hc=/^[0-5]?\d/,qc=/^[0-5]?\d/,Yc=/^\d/,Jc=/^\d{1,2}/,Qc=/^\d{1,3}/,Kc=/^\d{1,4}/,Gc=/^-?\d+/,Xc=/^-?\d/,Zc=/^-?\d{1,2}/,ed=/^-?\d{1,3}/,td=/^-?\d{1,4}/,nd=/^([+-])(\d{2})(\d{2})?|Z/,rd=/^([+-])(\d{2})(\d{2})|Z/,ad=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,od=/^([+-])(\d{2}):(\d{2})|Z/,sd=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function id(e,t){return e?{value:t(e.value),rest:e.rest}:e}function ld(e,t){const n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function cd(e,t){const n=t.match(e);if(!n)return null;if("Z"===n[0])return{value:0,rest:t.slice(1)};const r="+"===n[1]?1:-1,a=n[2]?parseInt(n[2],10):0,o=n[3]?parseInt(n[3],10):0,s=n[5]?parseInt(n[5],10):0;return{value:r*(a*Gl+o*Kl+1e3*s),rest:t.slice(n[0].length)}}function dd(e){return ld(Gc,e)}function ud(e,t){switch(e){case 1:return ld(Yc,t);case 2:return ld(Jc,t);case 3:return ld(Qc,t);case 4:return ld(Kc,t);default:return ld(new RegExp("^\\d{1,"+e+"}"),t)}}function hd(e,t){switch(e){case 1:return ld(Xc,t);case 2:return ld(Zc,t);case 3:return ld(ed,t);case 4:return ld(td,t);default:return ld(new RegExp("^-?\\d{1,"+e+"}"),t)}}function pd(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function md(e,t){const n=t>0,r=n?t:1-t;let a;if(r<=50)a=e||100;else{const t=r+50;a=e+100*Math.trunc(t/100)-(e>=t%100?100:0)}return n?a:1-a}function fd(e){return e%400===0||e%4===0&&e%100!==0}function gd(e,t){const n=Tc(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=ec(e,t?.in),o=a.getDay(),s=(o<r?7:0)+o-r;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function vd(e,t){const n=ec(e,t?.in),r=n.getFullYear(),a=Tc(),o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=Zl(t?.in||e,0);s.setFullYear(r+1,0,o),s.setHours(0,0,0,0);const i=gd(s,t),l=Zl(t?.in||e,0);l.setFullYear(r,0,o),l.setHours(0,0,0,0);const c=gd(l,t);return+n>=+i?r+1:+n>=+c?r:r-1}function yd(e,t){return gd(e,{...t,weekStartsOn:1})}function bd(e,t){const n=Tc(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=vd(e,t),o=Zl(t?.in||e,0);o.setFullYear(a,0,r),o.setHours(0,0,0,0);return gd(o,t)}function xd(e,t){const n=ec(e,t?.in),r=+gd(n,t)-+bd(n,t);return Math.round(r/Ql)+1}function _d(e,t,n){const r=ec(e,n?.in),a=xd(r,n)-t;return r.setDate(r.getDate()-7*a),ec(r,n?.in)}function wd(e,t){const n=ec(e,t?.in),r=n.getFullYear(),a=Zl(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=yd(a),s=Zl(n,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const i=yd(s);return n.getTime()>=o.getTime()?r+1:n.getTime()>=i.getTime()?r:r-1}function Nd(e,t){const n=wd(e,t),r=Zl(t?.in||e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),yd(r)}function Ed(e,t){const n=ec(e,t?.in),r=+yd(n)-+Nd(n);return Math.round(r/Ql)+1}function Sd(e,t,n){const r=ec(e,n?.in),a=Ed(r,n)-t;return r.setDate(r.getDate()-7*a),r}const jd=[31,28,31,30,31,30,31,31,30,31,30,31],kd=[31,29,31,30,31,30,31,31,30,31,30,31];function Cd(e,t,n){const r=ec(e,n?.in);return isNaN(t)?Zl(n?.in||e,NaN):t?(r.setDate(r.getDate()+t),r):r}function Dd(e,t,n){const r=Tc(),a=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=ec(e,n?.in),s=o.getDay(),i=7-a;return Cd(o,t<0||t>6?t-(s+i)%7:((t%7+7)%7+i)%7-(s+i)%7,n)}function Td(e,t){const n=ec(e,t?.in).getDay();return 0===n?7:n}function Ad(e,t,n){const r=ec(e,n?.in);return Cd(r,t-Td(r,n),n)}function Pd(e){const t=ec(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}const Id={G:new class extends Oc{priority=140;parse(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}set(e,t,n){return t.era=n,e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]},y:new class extends Oc{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,n){const r=e=>({year:e,isTwoDigitYear:"yy"===t});switch(t){case"y":return id(ud(4,e),r);case"yo":return id(n.ordinalNumber(e,{unit:"year"}),r);default:return id(ud(t.length,e),r)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n){const r=e.getFullYear();if(n.isTwoDigitYear){const t=md(n.year,r);return e.setFullYear(t,0,1),e.setHours(0,0,0,0),e}const a="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},Y:new class extends Oc{priority=130;parse(e,t,n){const r=e=>({year:e,isTwoDigitYear:"YY"===t});switch(t){case"Y":return id(ud(4,e),r);case"Yo":return id(n.ordinalNumber(e,{unit:"year"}),r);default:return id(ud(t.length,e),r)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n,r){const a=vd(e,r);if(n.isTwoDigitYear){const t=md(n.year,a);return e.setFullYear(t,0,r.firstWeekContainsDate),e.setHours(0,0,0,0),gd(e,r)}const o="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(o,0,r.firstWeekContainsDate),e.setHours(0,0,0,0),gd(e,r)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:new class extends Oc{priority=130;parse(e,t){return hd("R"===t?4:t.length,e)}set(e,t,n){const r=Zl(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),yd(r)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:new class extends Oc{priority=130;parse(e,t){return hd("u"===t?4:t.length,e)}set(e,t,n){return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},Q:new class extends Oc{priority=120;parse(e,t,n){switch(t){case"Q":case"QQ":return ud(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:new class extends Oc{priority=120;parse(e,t,n){switch(t){case"q":case"qq":return ud(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:new class extends Oc{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,n){const r=e=>e-1;switch(t){case"M":return id(ld(Lc,e),r);case"MM":return id(ud(2,e),r);case"Mo":return id(n.ordinalNumber(e,{unit:"month"}),r);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}},L:new class extends Oc{priority=110;parse(e,t,n){const r=e=>e-1;switch(t){case"L":return id(ld(Lc,e),r);case"LL":return id(ud(2,e),r);case"Lo":return id(n.ordinalNumber(e,{unit:"month"}),r);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:new class extends Oc{priority=100;parse(e,t,n){switch(t){case"w":return ld(zc,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return ud(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n,r){return gd(_d(e,n,r),r)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:new class extends Oc{priority=100;parse(e,t,n){switch(t){case"I":return ld(zc,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return ud(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n){return yd(Sd(e,n))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:new class extends Oc{priority=90;subPriority=1;parse(e,t,n){switch(t){case"d":return ld($c,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return ud(t.length,e)}}validate(e,t){const n=fd(e.getFullYear()),r=e.getMonth();return n?t>=1&&t<=kd[r]:t>=1&&t<=jd[r]}set(e,t,n){return e.setDate(n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:new class extends Oc{priority=90;subpriority=1;parse(e,t,n){switch(t){case"D":case"DD":return ld(Fc,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return ud(t.length,e)}}validate(e,t){return fd(e.getFullYear())?t>=1&&t<=366:t>=1&&t<=365}set(e,t,n){return e.setMonth(0,n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:new class extends Oc{priority=90;parse(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Dd(e,n,r)).setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]},e:new class extends Oc{priority=90;parse(e,t,n,r){const a=e=>{const t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return id(ud(t.length,e),a);case"eo":return id(n.ordinalNumber(e,{unit:"day"}),a);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Dd(e,n,r)).setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:new class extends Oc{priority=90;parse(e,t,n,r){const a=e=>{const t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return id(ud(t.length,e),a);case"co":return id(n.ordinalNumber(e,{unit:"day"}),a);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Dd(e,n,r)).setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:new class extends Oc{priority=90;parse(e,t,n){const r=e=>0===e?7:e;switch(t){case"i":case"ii":return ud(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return id(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiii":return id(n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiiii":return id(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);default:return id(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r)}}validate(e,t){return t>=1&&t<=7}set(e,t,n){return(e=Ad(e,n)).setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:new class extends Oc{priority=80;parse(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(pd(n),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]},b:new class extends Oc{priority=80;parse(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(pd(n),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]},B:new class extends Oc{priority=80;parse(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(pd(n),0,0,0),e}incompatibleTokens=["a","b","t","T"]},h:new class extends Oc{priority=70;parse(e,t,n){switch(t){case"h":return ld(Vc,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return ud(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,n){const r=e.getHours()>=12;return r&&n<12?e.setHours(n+12,0,0,0):r||12!==n?e.setHours(n,0,0,0):e.setHours(0,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]},H:new class extends Oc{priority=70;parse(e,t,n){switch(t){case"H":return ld(Bc,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return ud(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,n){return e.setHours(n,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]},K:new class extends Oc{priority=70;parse(e,t,n){switch(t){case"K":return ld(Wc,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return ud(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.getHours()>=12&&n<12?e.setHours(n+12,0,0,0):e.setHours(n,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]},k:new class extends Oc{priority=70;parse(e,t,n){switch(t){case"k":return ld(Uc,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return ud(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,n){const r=n<=24?n%24:n;return e.setHours(r,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]},m:new class extends Oc{priority=60;parse(e,t,n){switch(t){case"m":return ld(Hc,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return ud(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setMinutes(n,0,0),e}incompatibleTokens=["t","T"]},s:new class extends Oc{priority=50;parse(e,t,n){switch(t){case"s":return ld(qc,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return ud(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setSeconds(n,0),e}incompatibleTokens=["t","T"]},S:new class extends Oc{priority=30;parse(e,t){return id(ud(t.length,e),(e=>Math.trunc(e*Math.pow(10,3-t.length))))}set(e,t,n){return e.setMilliseconds(n),e}incompatibleTokens=["t","T"]},X:new class extends Oc{priority=10;parse(e,t){switch(t){case"X":return cd(nd,e);case"XX":return cd(rd,e);case"XXXX":return cd(ad,e);case"XXXXX":return cd(sd,e);default:return cd(od,e)}}set(e,t,n){return t.timestampIsSet?e:Zl(e,e.getTime()-Pd(e)-n)}incompatibleTokens=["t","T","x"]},x:new class extends Oc{priority=10;parse(e,t){switch(t){case"x":return cd(nd,e);case"xx":return cd(rd,e);case"xxxx":return cd(ad,e);case"xxxxx":return cd(sd,e);default:return cd(od,e)}}set(e,t,n){return t.timestampIsSet?e:Zl(e,e.getTime()-Pd(e)-n)}incompatibleTokens=["t","T","X"]},t:new class extends Oc{priority=40;parse(e){return dd(e)}set(e,t,n){return[Zl(e,1e3*n),{timestampIsSet:!0}]}incompatibleTokens="*"},T:new class extends Oc{priority=20;parse(e){return dd(e)}set(e,t,n){return[Zl(e,n),{timestampIsSet:!0}]}incompatibleTokens="*"}},Rd=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Md=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Od=/^'([^]*?)'?$/,Ld=/''/g,$d=/\S/,Fd=/[a-zA-Z]/;function zd(e,t,n,r){const a=()=>Zl(r?.in||n,NaN),o=Ac(),s=r?.locale??o.locale??bc,i=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,l=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!t)return e?a():ec(n,r?.in);const c={firstWeekContainsDate:i,weekStartsOn:l,locale:s},d=[new Mc(r?.in,n)],u=t.match(Md).map((e=>{const t=e[0];if(t in wc){return(0,wc[t])(e,s.formatLong)}return e})).join("").match(Rd),h=[];for(let g of u){!r?.useAdditionalWeekYearTokens&&kc(g)&&Cc(g,t,e),!r?.useAdditionalDayOfYearTokens&&jc(g)&&Cc(g,t,e);const n=g[0],o=Id[n];if(o){const{incompatibleTokens:t}=o;if(Array.isArray(t)){const e=h.find((e=>t.includes(e.token)||e.token===n));if(e)throw new RangeError(`The format string mustn't contain \`${e.fullToken}\` and \`${g}\` at the same time`)}else if("*"===o.incompatibleTokens&&h.length>0)throw new RangeError(`The format string mustn't contain \`${g}\` and any other token at the same time`);h.push({token:n,fullToken:g});const r=o.run(e,g,s.match,c);if(!r)return a();d.push(r.setter),e=r.rest}else{if(n.match(Fd))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");if("''"===g?g="'":"'"===n&&(g=g.match(Od)[1].replace(Ld,"'")),0!==e.indexOf(g))return a();e=e.slice(g.length)}}if(e.length>0&&$d.test(e))return a();const p=d.map((e=>e.priority)).sort(((e,t)=>t-e)).filter(((e,t,n)=>n.indexOf(e)===t)).map((e=>d.filter((t=>t.priority===e)).sort(((e,t)=>t.subPriority-e.subPriority)))).map((e=>e[0]));let m=ec(n,r?.in);if(isNaN(+m))return a();const f={};for(const g of p){if(!g.validate(m,c))return a();const e=g.set(m,f,c);Array.isArray(e)?(m=e[0],Object.assign(f,e[1])):m=e}return m}function Bd(e){return e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function Ud(e){return!(!Bd(e)&&"number"!==typeof e||isNaN(+ec(e)))}function Wd(e,t){return+ec(e)<+ec(t)}function Vd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=Zl.bind(null,e||n.find((e=>"object"===typeof e)));return n.map(a)}function Hd(e,t){const n=ec(e,t?.in);return n.setHours(0,0,0,0),n}function qd(e,t,n){const[r,a]=Vd(n?.in,e,t),o=Hd(r),s=Hd(a),i=+o-Pd(o),l=+s-Pd(s);return Math.round((i-l)/864e5)}function Yd(e,t){const n=ec(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Jd(e,t){const n=ec(e,t?.in);return qd(n,Yd(n))+1}function Qd(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Kd={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Qd("yy"===t?r%100:r,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):Qd(n+1,2)},d:(e,t)=>Qd(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>Qd(e.getHours()%12||12,t.length),H:(e,t)=>Qd(e.getHours(),t.length),m:(e,t)=>Qd(e.getMinutes(),t.length),s:(e,t)=>Qd(e.getSeconds(),t.length),S(e,t){const n=t.length,r=e.getMilliseconds();return Qd(Math.trunc(r*Math.pow(10,n-3)),t.length)}},Gd="midnight",Xd="noon",Zd="morning",eu="afternoon",tu="evening",nu="night",ru={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),r=t>0?t:1-t;return n.ordinalNumber(r,{unit:"year"})}return Kd.y(e,t)},Y:function(e,t,n,r){const a=vd(e,r),o=a>0?a:1-a;if("YY"===t){return Qd(o%100,2)}return"Yo"===t?n.ordinalNumber(o,{unit:"year"}):Qd(o,t.length)},R:function(e,t){return Qd(wd(e),t.length)},u:function(e,t){return Qd(e.getFullYear(),t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Qd(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Qd(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Kd.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Qd(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const a=xd(e,r);return"wo"===t?n.ordinalNumber(a,{unit:"week"}):Qd(a,t.length)},I:function(e,t,n){const r=Ed(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):Qd(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):Kd.d(e,t)},D:function(e,t,n){const r=Jd(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):Qd(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return Qd(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return Qd(o,t.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),a=0===r?7:r;switch(t){case"i":return String(a);case"ii":return Qd(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let a;switch(a=12===r?Xd:0===r?Gd:r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let a;switch(a=r>=17?tu:r>=12?eu:r>=4?Zd:nu,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return Kd.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):Kd.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):Qd(r,t.length)},k:function(e,t,n){let r=e.getHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):Qd(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Kd.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Kd.s(e,t)},S:function(e,t){return Kd.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return ou(r);case"XXXX":case"XX":return su(r);default:return su(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return ou(r);case"xxxx":case"xx":return su(r);default:return su(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+au(r,":");default:return"GMT"+su(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+au(r,":");default:return"GMT"+su(r,":")}},t:function(e,t,n){return Qd(Math.trunc(+e/1e3),t.length)},T:function(e,t,n){return Qd(+e,t.length)}};function au(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return 0===o?n+String(a):n+String(a)+t+Qd(o,2)}function ou(e,t){if(e%60===0){return(e>0?"-":"+")+Qd(Math.abs(e)/60,2)}return su(e,t)}function su(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e);return n+Qd(Math.trunc(r/60),2)+t+Qd(r%60,2)}const iu=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lu=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cu=/^'([^]*?)'?$/,du=/''/g,uu=/[a-zA-Z]/;function hu(e,t,n){const r=Tc(),a=n?.locale??r.locale??bc,o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=ec(e,n?.in);if(!Ud(i))throw new RangeError("Invalid time value");let l=t.match(lu).map((e=>{const t=e[0];if("p"===t||"P"===t){return(0,wc[t])(e,a.formatLong)}return e})).join("").match(iu).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:pu(e)};if(ru[t])return{isToken:!0,value:e};if(t.match(uu))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));a.localize.preprocessor&&(l=a.localize.preprocessor(i,l));const c={firstWeekContainsDate:o,weekStartsOn:s,locale:a};return l.map((r=>{if(!r.isToken)return r.value;const o=r.value;(!n?.useAdditionalWeekYearTokens&&kc(o)||!n?.useAdditionalDayOfYearTokens&&jc(o))&&Cc(o,t,String(e));return(0,ru[o[0]])(i,o,a.localize,c)})).join("")}function pu(e){const t=e.match(cu);return t?t[1].replace(du,"'"):e}function mu(e,t,n){const r=ec(e,n?.in);return r.setHours(t),r}function fu(e,t,n){const r=ec(e,n?.in);return r.setMinutes(t),r}function gu(e,t,n){const r=ec(e,n?.in);return r.setSeconds(t),r}function vu(e,t){const n=ec(e,t?.in);return n.setDate(1),n.setHours(0,0,0,0),n}function yu(e,t){const n=ec(e,t?.in),r=n.getMonth(),a=r-r%3;return n.setMonth(a,1),n.setHours(0,0,0,0),n}function bu(e,t){const n=ec(e,t?.in);return n.setHours(23,59,59,999),n}function xu(e,t){const n=Tc(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=ec(e,t?.in),o=a.getDay(),s=6+(o<r?-7:0)-(o-r);return a.setDate(a.getDate()+s),a.setHours(23,59,59,999),a}function _u(e,t){const n=ec(e,t?.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function wu(e,t,n){const[r,a]=Vd(n?.in,e,t);return r.getFullYear()===a.getFullYear()}function Nu(e,t,n){const[r,a]=Vd(n?.in,e,t);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function Eu(e,t,n){const[r,a]=Vd(n?.in,e,t);return+yu(r)===+yu(a)}function Su(e,t,n){const[r,a]=Vd(n?.in,e,t);return+Hd(r)===+Hd(a)}function ju(e,t){return+ec(e)===+ec(t)}function ku(e,t,n){const r=+ec(e,n?.in),[a,o]=[+ec(t.start,n?.in),+ec(t.end,n?.in)].sort(((e,t)=>e-t));return r>=a&&r<=o}function Cu(e,t){const n=ec(e,t?.in),r=n.getFullYear(),a=n.getMonth(),o=Zl(n,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function Du(e,t,n){const r=ec(e,n?.in),a=r.getFullYear(),o=r.getDate(),s=Zl(n?.in||e,0);s.setFullYear(a,t,15),s.setHours(0,0,0,0);const i=Cu(s);return r.setMonth(t,Math.min(o,i)),r}function Tu(e,t,n){const r=ec(e,n?.in),a=t-(Math.trunc(r.getMonth()/3)+1);return Du(r,r.getMonth()+3*a)}function Au(e,t){return ec(e,t?.in).getFullYear()}function Pu(e,t){return ec(e,t?.in).getMonth()}function Iu(e,t){const n=ec(e,t?.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function Ru(e,t){const n=ec(e,t?.in);return Math.trunc(n.getMonth()/3)+1}function Mu(e,t){return ec(e,t?.in).getHours()}function Ou(e,t){return ec(e,t?.in).getMinutes()}function Lu(e){return ec(e).getSeconds()}function $u(e,t,n){const r=ec(e,n?.in);if(isNaN(t))return Zl(n?.in||e,NaN);if(!t)return r;const a=r.getDate(),o=Zl(n?.in||e,r.getTime());o.setMonth(r.getMonth()+t+1,0);return a>=o.getDate()?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function Fu(e,t,n){return $u(e,-t,n)}function zu(e,t,n){const[r,a]=Vd(n?.in,e,t);return 12*(r.getFullYear()-a.getFullYear())+(r.getMonth()-a.getMonth())}function Bu(e,t,n){return $u(e,3*t,n)}function Uu(e,t,n){return Bu(e,-t,n)}function Wu(e,t,n){const[r,a]=Vd(n?.in,e,t);return 4*(r.getFullYear()-a.getFullYear())+(Ru(r)-Ru(a))}function Vu(e,t,n){return $u(e,12*t,n)}function Hu(e,t,n){return Vu(e,-t,n)}function qu(e,t,n){const[r,a]=Vd(n?.in,e,t);return r.getFullYear()-a.getFullYear()}function Yu(e,t){let n,r=t?.in;return e.forEach((e=>{r||"object"!==typeof e||(r=Zl.bind(null,e));const t=ec(e,r);(!n||n>t||isNaN(+t))&&(n=t)})),Zl(r,n||NaN)}function Ju(e,t){let n,r=t?.in;return e.forEach((e=>{r||"object"!==typeof e||(r=Zl.bind(null,e));const t=ec(e,r);(!n||n<t||isNaN(+t))&&(n=t)})),Zl(r,n||NaN)}function Qu(e,t,n){return Zl(n?.in||e,+ec(e)+t)}function Ku(e,t,n){return Qu(e,t*Gl,n)}function Gu(e,t,n){const r=ec(e,n?.in);return r.setTime(r.getTime()+t*Kl),r}function Xu(e,t,n){return Qu(e,1e3*t,n)}function Zu(e,t){return+ec(e)>+ec(t)}function eh(e,t){return ec(e,t?.in).getDay()}function th(e,t){return ec(e,t?.in).getDate()}function nh(e,t,n){return Cd(e,7*t,n)}function rh(e){return+ec(e)}function ah(e,t,n){const r=ec(e,n?.in);return isNaN(+r)?Zl(n?.in||e,NaN):(r.setFullYear(t),r)}function oh(e,t,n){const[r,a]=Vd(n?.in,e,t),o=sh(r,a),s=Math.abs(qd(r,a));r.setDate(r.getDate()-o*s);const i=o*(s-Number(sh(r,a)===-o));return 0===i?0:i}function sh(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}function ih(e,t,n){return nh(e,-t,n)}function lh(e,t,n){return Cd(e,-t,n)}var ch="undefined"!==typeof document?a.useLayoutEffect:a.useEffect;const dh={...o}.useInsertionEffect||(e=>e());function uh(){return"undefined"!==typeof window}function hh(e){return fh(e)?(e.nodeName||"").toLowerCase():"#document"}function ph(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function mh(e){var t;return null==(t=(fh(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function fh(e){return!!uh()&&(e instanceof Node||e instanceof ph(e).Node)}function gh(e){return!!uh()&&(e instanceof Element||e instanceof ph(e).Element)}function vh(e){return!!uh()&&(e instanceof HTMLElement||e instanceof ph(e).HTMLElement)}function yh(e){return!(!uh()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof ph(e).ShadowRoot)}function bh(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Sh(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function xh(e){return["table","td","th"].includes(hh(e))}function _h(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(Yv){return!1}}))}function wh(e){const t=Nh(),n=gh(e)?Sh(e):e;return["transform","translate","scale","rotate","perspective"].some((e=>!!n[e]&&"none"!==n[e]))||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function Nh(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Eh(e){return["html","body","#document"].includes(hh(e))}function Sh(e){return ph(e).getComputedStyle(e)}function jh(e){return gh(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function kh(e){if("html"===hh(e))return e;const t=e.assignedSlot||e.parentNode||yh(e)&&e.host||mh(e);return yh(t)?t.host:t}function Ch(e){const t=kh(e);return Eh(t)?e.ownerDocument?e.ownerDocument.body:e.body:vh(t)&&bh(t)?t:Ch(t)}function Dh(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const a=Ch(e),o=a===(null==(r=e.ownerDocument)?void 0:r.body),s=ph(a);if(o){const e=Th(s);return t.concat(s,s.visualViewport||[],bh(a)?a:[],e&&n?Dh(e):[])}return t.concat(a,Dh(a,[],n))}function Th(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const Ah=Math.min,Ph=Math.max,Ih=Math.round,Rh=Math.floor,Mh=e=>({x:e,y:e}),Oh={left:"right",right:"left",bottom:"top",top:"bottom"},Lh={start:"end",end:"start"};function $h(e,t){return"function"===typeof e?e(t):e}function Fh(e){return e.split("-")[0]}function zh(e){return e.split("-")[1]}function Bh(e){return"y"===e?"height":"width"}function Uh(e){return["top","bottom"].includes(Fh(e))?"y":"x"}function Wh(e){return"x"===Uh(e)?"y":"x"}function Vh(e){return e.replace(/start|end/g,(e=>Lh[e]))}function Hh(e){return e.replace(/left|right|bottom|top/g,(e=>Oh[e]))}function qh(e){return"number"!==typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function Yh(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function Jh(e,t,n){let{reference:r,floating:a}=e;const o=Uh(t),s=Wh(t),i=Bh(s),l=Fh(t),c="y"===o,d=r.x+r.width/2-a.width/2,u=r.y+r.height/2-a.height/2,h=r[i]/2-a[i]/2;let p;switch(l){case"top":p={x:d,y:r.y-a.height};break;case"bottom":p={x:d,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:u};break;case"left":p={x:r.x-a.width,y:u};break;default:p={x:r.x,y:r.y}}switch(zh(t)){case"start":p[s]-=h*(n&&c?-1:1);break;case"end":p[s]+=h*(n&&c?-1:1)}return p}async function Qh(e,t){var n;void 0===t&&(t={});const{x:r,y:a,platform:o,rects:s,elements:i,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=$h(t,e),m=qh(p),f=i[h?"floating"===u?"reference":"floating":u],g=Yh(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(f)))||n?f:f.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(i.floating)),boundary:c,rootBoundary:d,strategy:l})),v="floating"===u?{x:r,y:a,width:s.floating.width,height:s.floating.height}:s.reference,y=await(null==o.getOffsetParent?void 0:o.getOffsetParent(i.floating)),b=await(null==o.isElement?void 0:o.isElement(y))&&await(null==o.getScale?void 0:o.getScale(y))||{x:1,y:1},x=Yh(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-x.top+m.top)/b.y,bottom:(x.bottom-g.bottom+m.bottom)/b.y,left:(g.left-x.left+m.left)/b.x,right:(x.right-g.right+m.right)/b.x}}function Kh(e){const t=Sh(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=vh(e),o=a?e.offsetWidth:n,s=a?e.offsetHeight:r,i=Ih(n)!==o||Ih(r)!==s;return i&&(n=o,r=s),{width:n,height:r,$:i}}function Gh(e){return gh(e)?e:e.contextElement}function Xh(e){const t=Gh(e);if(!vh(t))return Mh(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=Kh(t);let s=(o?Ih(n.width):n.width)/r,i=(o?Ih(n.height):n.height)/a;return s&&Number.isFinite(s)||(s=1),i&&Number.isFinite(i)||(i=1),{x:s,y:i}}const Zh=Mh(0);function ep(e){const t=ph(e);return Nh()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Zh}function tp(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const a=e.getBoundingClientRect(),o=Gh(e);let s=Mh(1);t&&(r?gh(r)&&(s=Xh(r)):s=Xh(e));const i=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==ph(e))&&t}(o,n,r)?ep(o):Mh(0);let l=(a.left+i.x)/s.x,c=(a.top+i.y)/s.y,d=a.width/s.x,u=a.height/s.y;if(o){const e=ph(o),t=r&&gh(r)?ph(r):r;let n=e,a=Th(n);for(;a&&r&&t!==n;){const e=Xh(a),t=a.getBoundingClientRect(),r=Sh(a),o=t.left+(a.clientLeft+parseFloat(r.paddingLeft))*e.x,s=t.top+(a.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,u*=e.y,l+=o,c+=s,n=ph(a),a=Th(n)}}return Yh({width:d,height:u,x:l,y:c})}function np(e,t){const n=jh(e).scrollLeft;return t?t.left+n:tp(mh(e)).left+n}function rp(e,t,n){void 0===n&&(n=!1);const r=e.getBoundingClientRect();return{x:r.left+t.scrollLeft-(n?0:np(e,r)),y:r.top+t.scrollTop}}function ap(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=ph(e),r=mh(e),a=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,i=0,l=0;if(a){o=a.width,s=a.height;const e=Nh();(!e||e&&"fixed"===t)&&(i=a.offsetLeft,l=a.offsetTop)}return{width:o,height:s,x:i,y:l}}(e,n);else if("document"===t)r=function(e){const t=mh(e),n=jh(e),r=e.ownerDocument.body,a=Ph(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Ph(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+np(e);const i=-n.scrollTop;return"rtl"===Sh(r).direction&&(s+=Ph(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:s,y:i}}(mh(e));else if(gh(t))r=function(e,t){const n=tp(e,!0,"fixed"===t),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=vh(e)?Xh(e):Mh(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:a*o.x,y:r*o.y}}(t,n);else{const n=ep(e);r={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return Yh(r)}function op(e,t){const n=kh(e);return!(n===t||!gh(n)||Eh(n))&&("fixed"===Sh(n).position||op(n,t))}function sp(e,t,n){const r=vh(t),a=mh(t),o="fixed"===n,s=tp(e,!0,o,t);let i={scrollLeft:0,scrollTop:0};const l=Mh(0);if(r||!r&&!o)if(("body"!==hh(t)||bh(a))&&(i=jh(t)),r){const e=tp(t,!0,o,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else a&&(l.x=np(a));const c=!a||r||o?Mh(0):rp(a,i);return{x:s.left+i.scrollLeft-l.x-c.x,y:s.top+i.scrollTop-l.y-c.y,width:s.width,height:s.height}}function ip(e){return"static"===Sh(e).position}function lp(e,t){if(!vh(e)||"fixed"===Sh(e).position)return null;if(t)return t(e);let n=e.offsetParent;return mh(e)===n&&(n=n.ownerDocument.body),n}function cp(e,t){const n=ph(e);if(_h(e))return n;if(!vh(e)){let t=kh(e);for(;t&&!Eh(t);){if(gh(t)&&!ip(t))return t;t=kh(t)}return n}let r=lp(e,t);for(;r&&xh(r)&&ip(r);)r=lp(r,t);return r&&Eh(r)&&ip(r)&&!wh(r)?n:r||function(e){let t=kh(e);for(;vh(t)&&!Eh(t);){if(wh(t))return t;if(_h(t))return null;t=kh(t)}return null}(e)||n}const dp={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o="fixed"===a,s=mh(r),i=!!t&&_h(t.floating);if(r===s||i&&o)return n;let l={scrollLeft:0,scrollTop:0},c=Mh(1);const d=Mh(0),u=vh(r);if((u||!u&&!o)&&(("body"!==hh(r)||bh(s))&&(l=jh(r)),vh(r))){const e=tp(r);c=Xh(r),d.x=e.x+r.clientLeft,d.y=e.y+r.clientTop}const h=!s||u||o?Mh(0):rp(s,l,!0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+h.x,y:n.y*c.y-l.scrollTop*c.y+d.y+h.y}},getDocumentElement:mh,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[..."clippingAncestors"===n?_h(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let r=Dh(e,[],!1).filter((e=>gh(e)&&"body"!==hh(e))),a=null;const o="fixed"===Sh(e).position;let s=o?kh(e):e;for(;gh(s)&&!Eh(s);){const t=Sh(s),n=wh(s);n||"fixed"!==t.position||(a=null),(o?!n&&!a:!n&&"static"===t.position&&a&&["absolute","fixed"].includes(a.position)||bh(s)&&!n&&op(e,s))?r=r.filter((e=>e!==s)):a=t,s=kh(s)}return t.set(e,r),r}(t,this._c):[].concat(n),r],s=o[0],i=o.reduce(((e,n)=>{const r=ap(t,n,a);return e.top=Ph(r.top,e.top),e.right=Ah(r.right,e.right),e.bottom=Ah(r.bottom,e.bottom),e.left=Ph(r.left,e.left),e}),ap(t,s,a));return{width:i.right-i.left,height:i.bottom-i.top,x:i.left,y:i.top}},getOffsetParent:cp,getElementRects:async function(e){const t=this.getOffsetParent||cp,n=this.getDimensions,r=await n(e.floating);return{reference:sp(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Kh(e);return{width:t,height:n}},getScale:Xh,isElement:gh,isRTL:function(e){return"rtl"===Sh(e).direction}};function up(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function hp(e,t,n,r){void 0===r&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:s="function"===typeof ResizeObserver,layoutShift:i="function"===typeof IntersectionObserver,animationFrame:l=!1}=r,c=Gh(e),d=a||o?[...c?Dh(c):[],...Dh(t)]:[];d.forEach((e=>{a&&e.addEventListener("scroll",n,{passive:!0}),o&&e.addEventListener("resize",n)}));const u=c&&i?function(e,t){let n,r=null;const a=mh(e);function o(){var e;clearTimeout(n),null==(e=r)||e.disconnect(),r=null}return function s(i,l){void 0===i&&(i=!1),void 0===l&&(l=1),o();const c=e.getBoundingClientRect(),{left:d,top:u,width:h,height:p}=c;if(i||t(),!h||!p)return;const m={rootMargin:-Rh(u)+"px "+-Rh(a.clientWidth-(d+h))+"px "+-Rh(a.clientHeight-(u+p))+"px "+-Rh(d)+"px",threshold:Ph(0,Ah(1,l))||1};let f=!0;function g(t){const r=t[0].intersectionRatio;if(r!==l){if(!f)return s();r?s(!1,r):n=setTimeout((()=>{s(!1,1e-7)}),1e3)}1!==r||up(c,e.getBoundingClientRect())||s(),f=!1}try{r=new IntersectionObserver(g,{...m,root:a.ownerDocument})}catch(Yv){r=new IntersectionObserver(g,m)}r.observe(e)}(!0),o}(c,n):null;let h,p=-1,m=null;s&&(m=new ResizeObserver((e=>{let[r]=e;r&&r.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame((()=>{var e;null==(e=m)||e.observe(t)}))),n()})),c&&!l&&m.observe(c),m.observe(t));let f=l?tp(e):null;return l&&function t(){const r=tp(e);f&&!up(f,r)&&n();f=r,h=requestAnimationFrame(t)}(),n(),()=>{var e;d.forEach((e=>{a&&e.removeEventListener("scroll",n),o&&e.removeEventListener("resize",n)})),null==u||u(),null==(e=m)||e.disconnect(),m=null,l&&cancelAnimationFrame(h)}}const pp=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:s,middlewareData:i}=t,l=await async function(e,t){const{placement:n,platform:r,elements:a}=e,o=await(null==r.isRTL?void 0:r.isRTL(a.floating)),s=Fh(n),i=zh(n),l="y"===Uh(n),c=["left","top"].includes(s)?-1:1,d=o&&l?-1:1,u=$h(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:m}="number"===typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return i&&"number"===typeof m&&(p="end"===i?-1*m:m),l?{x:p*d,y:h*c}:{x:h*c,y:p*d}}(t,e);return s===(null==(n=i.offset)?void 0:n.placement)&&null!=(r=i.arrow)&&r.alignmentOffset?{}:{x:a+l.x,y:o+l.y,data:{...l,placement:s}}}}},mp=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:s,initialPlacement:i,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:f=!0,...g}=$h(e,t);if(null!=(n=o.arrow)&&n.alignmentOffset)return{};const v=Fh(a),y=Uh(i),b=Fh(i)===i,x=await(null==l.isRTL?void 0:l.isRTL(c.floating)),_=h||(b||!f?[Hh(i)]:function(e){const t=Hh(e);return[Vh(e),t,Vh(t)]}(i)),w="none"!==m;!h&&w&&_.push(...function(e,t,n,r){const a=zh(e);let o=function(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:s;default:return[]}}(Fh(e),"start"===n,r);return a&&(o=o.map((e=>e+"-"+a)),t&&(o=o.concat(o.map(Vh)))),o}(i,f,m,x));const N=[i,..._],E=await Qh(t,g),S=[];let j=(null==(r=o.flip)?void 0:r.overflows)||[];if(d&&S.push(E[v]),u){const e=function(e,t,n){void 0===n&&(n=!1);const r=zh(e),a=Wh(e),o=Bh(a);let s="x"===a?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=Hh(s)),[s,Hh(s)]}(a,s,x);S.push(E[e[0]],E[e[1]])}if(j=[...j,{placement:a,overflows:S}],!S.every((e=>e<=0))){var k,C;const e=((null==(k=o.flip)?void 0:k.index)||0)+1,t=N[e];if(t)return{data:{index:e,overflows:j},reset:{placement:t}};let n=null==(C=j.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:C.placement;if(!n)switch(p){case"bestFit":{var D;const e=null==(D=j.filter((e=>{if(w){const t=Uh(e.placement);return t===y||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:D[0];e&&(n=e);break}case"initialPlacement":n=i}if(a!==n)return{reset:{placement:n}}}return{}}}},fp=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:s,elements:i,middlewareData:l}=t,{element:c,padding:d=0}=$h(e,t)||{};if(null==c)return{};const u=qh(d),h={x:n,y:r},p=Wh(a),m=Bh(p),f=await s.getDimensions(c),g="y"===p,v=g?"top":"left",y=g?"bottom":"right",b=g?"clientHeight":"clientWidth",x=o.reference[m]+o.reference[p]-h[p]-o.floating[m],_=h[p]-o.reference[p],w=await(null==s.getOffsetParent?void 0:s.getOffsetParent(c));let N=w?w[b]:0;N&&await(null==s.isElement?void 0:s.isElement(w))||(N=i.floating[b]||o.floating[m]);const E=x/2-_/2,S=N/2-f[m]/2-1,j=Ah(u[v],S),k=Ah(u[y],S),C=j,D=N-f[m]-k,T=N/2-f[m]/2+E,A=Ph(C,Ah(T,D));const P=!l.arrow&&null!=zh(a)&&T!==A&&o.reference[m]/2-(T<C?j:k)-f[m]/2<0,I=P?T<C?T-C:T-D:0;return{[p]:h[p]+I,data:{[p]:A,centerOffset:T-A-I,...P&&{alignmentOffset:I}},reset:P}}}),gp=(e,t,n)=>{const r=new Map,a={platform:dp,...n},o={...a.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:s}=n,i=o.filter(Boolean),l=await(null==s.isRTL?void 0:s.isRTL(t));let c=await s.getElementRects({reference:e,floating:t,strategy:a}),{x:d,y:u}=Jh(c,r,l),h=r,p={},m=0;for(let f=0;f<i.length;f++){const{name:n,fn:o}=i[f],{x:g,y:v,data:y,reset:b}=await o({x:d,y:u,initialPlacement:r,placement:h,strategy:a,middlewareData:p,rects:c,platform:s,elements:{reference:e,floating:t}});d=null!=g?g:d,u=null!=v?v:u,p={...p,[n]:{...p[n],...y}},b&&m<=50&&(m++,"object"===typeof b&&(b.placement&&(h=b.placement),b.rects&&(c=!0===b.rects?await s.getElementRects({reference:e,floating:t,strategy:a}):b.rects),({x:d,y:u}=Jh(c,h,l))),f=-1)}return{x:d,y:u,placement:h,strategy:a,middlewareData:p}})(e,t,{...a,platform:o})};var vp="undefined"!==typeof document?a.useLayoutEffect:a.useEffect;function yp(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&"object"===typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;0!==r--;)if(!yp(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;0!==r--;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;0!==r--;){const n=a[r];if(("_owner"!==n||!e.$$typeof)&&!yp(e[n],t[n]))return!1}return!0}return e!==e&&t!==t}function bp(e){if("undefined"===typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function xp(e,t){const n=bp(e);return Math.round(t*n)/n}function _p(e){const t=a.useRef(e);return vp((()=>{t.current=e})),t}const wp=e=>({name:"arrow",options:e,fn(t){const{element:n,padding:r}="function"===typeof e?e(t):e;return n&&(a=n,{}.hasOwnProperty.call(a,"current"))?null!=n.current?fp({element:n.current,padding:r}).fn(t):{}:n?fp({element:n,padding:r}).fn(t):{};var a}}),Np=(e,t)=>({...pp(e),options:[e,t]}),Ep=(e,t)=>({...wp(e),options:[e,t]});const Sp="ArrowLeft",jp="ArrowRight",kp="ArrowUp",Cp="ArrowDown";const Dp=[Sp,jp],Tp=[kp,Cp],Ap={...o};let Pp=!1,Ip=0;const Rp=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Ip++;const Mp=Ap.useId||function(){const[e,t]=a.useState((()=>Pp?Rp():void 0));return ch((()=>{null==e&&t(Rp())}),[]),a.useEffect((()=>{Pp=!0}),[]),e};const Op=a.forwardRef((function(e,t){const{context:{placement:n,elements:{floating:r},middlewareData:{arrow:o,shift:s}},width:i=14,height:l=7,tipRadius:c=0,strokeWidth:d=0,staticOffset:u,stroke:h,d:p,style:{transform:m,...f}={},...g}=e;const v=Mp(),[y,b]=a.useState(!1);if(ch((()=>{if(!r)return;"rtl"===Sh(r).direction&&b(!0)}),[r]),!r)return null;const[x,_]=n.split("-"),w="top"===x||"bottom"===x;let N=u;(w&&null!=s&&s.x||!w&&null!=s&&s.y)&&(N=null);const E=2*d,S=E/2,j=i/2*(c/-8+1),k=l/2*c/4,C=!!p,D=N&&"end"===_?"bottom":"top";let T=N&&"end"===_?"right":"left";N&&y&&(T="end"===_?"left":"right");const A=null!=(null==o?void 0:o.x)?N||o.x:"",P=null!=(null==o?void 0:o.y)?N||o.y:"",I=p||"M0,0 H"+i+" L"+(i-j)+","+(l-k)+" Q"+i/2+","+l+" "+j+","+(l-k)+" Z",R={top:C?"rotate(180deg)":"",left:C?"rotate(90deg)":"rotate(-90deg)",bottom:C?"":"rotate(180deg)",right:C?"rotate(-90deg)":"rotate(90deg)"}[x];return(0,$e.jsxs)("svg",{...g,"aria-hidden":!0,ref:t,width:C?i:i+E,height:i,viewBox:"0 0 "+i+" "+(l>i?l:i),style:{position:"absolute",pointerEvents:"none",[T]:A,[D]:P,[x]:w||C?"100%":"calc(100% - "+E/2+"px)",transform:[R,m].filter((e=>!!e)).join(" "),...f},children:[E>0&&(0,$e.jsx)("path",{clipPath:"url(#"+v+")",fill:"none",stroke:h,strokeWidth:E+(p?0:1),d:I}),(0,$e.jsx)("path",{stroke:E&&!p?g.fill:"none",d:I}),(0,$e.jsx)("clipPath",{id:v,children:(0,$e.jsx)("rect",{x:-S,y:S*(C?-1:1),width:i+E,height:i})})]})}));function Lp(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach((e=>e(n)))},on(t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)},off(t,n){var r;null==(r=e.get(t))||r.delete(n)}}}const $p=a.createContext(null),Fp=a.createContext(null),zp=()=>{var e;return(null==(e=a.useContext($p))?void 0:e.id)||null},Bp=()=>a.useContext(Fp);function Up(e){const{open:t=!1,onOpenChange:n,elements:r}=e,o=Mp(),s=a.useRef({}),[i]=a.useState((()=>Lp())),l=null!=zp();const[c,d]=a.useState(r.reference),u=function(e){const t=a.useRef((()=>{}));return dh((()=>{t.current=e})),a.useCallback((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)}),[])}(((e,t,r)=>{s.current.openEvent=e?t:void 0,i.emit("openchange",{open:e,event:t,reason:r,nested:l}),null==n||n(e,t,r)})),h=a.useMemo((()=>({setPositionReference:d})),[]),p=a.useMemo((()=>({reference:c||r.reference||null,floating:r.floating||null,domReference:r.reference})),[c,r.reference,r.floating]);return a.useMemo((()=>({dataRef:s,open:t,onOpenChange:u,elements:p,events:i,floatingId:o,refs:h})),[t,u,p,i,o,h])}function Wp(e){void 0===e&&(e={});const{nodeId:t}=e,n=Up({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||n,o=r.elements,[s,l]=a.useState(null),[c,d]=a.useState(null),u=(null==o?void 0:o.domReference)||s,h=a.useRef(null),p=Bp();ch((()=>{u&&(h.current=u)}),[u]);const m=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:s,floating:l}={},transform:c=!0,whileElementsMounted:d,open:u}=e,[h,p]=a.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[m,f]=a.useState(r);yp(m,r)||f(r);const[g,v]=a.useState(null),[y,b]=a.useState(null),x=a.useCallback((e=>{e!==E.current&&(E.current=e,v(e))}),[]),_=a.useCallback((e=>{e!==S.current&&(S.current=e,b(e))}),[]),w=s||g,N=l||y,E=a.useRef(null),S=a.useRef(null),j=a.useRef(h),k=null!=d,C=_p(d),D=_p(o),T=_p(u),A=a.useCallback((()=>{if(!E.current||!S.current)return;const e={placement:t,strategy:n,middleware:m};D.current&&(e.platform=D.current),gp(E.current,S.current,e).then((e=>{const t={...e,isPositioned:!1!==T.current};P.current&&!yp(j.current,t)&&(j.current=t,i.flushSync((()=>{p(t)})))}))}),[m,t,n,D,T]);vp((()=>{!1===u&&j.current.isPositioned&&(j.current.isPositioned=!1,p((e=>({...e,isPositioned:!1}))))}),[u]);const P=a.useRef(!1);vp((()=>(P.current=!0,()=>{P.current=!1})),[]),vp((()=>{if(w&&(E.current=w),N&&(S.current=N),w&&N){if(C.current)return C.current(w,N,A);A()}}),[w,N,A,C,k]);const I=a.useMemo((()=>({reference:E,floating:S,setReference:x,setFloating:_})),[x,_]),R=a.useMemo((()=>({reference:w,floating:N})),[w,N]),M=a.useMemo((()=>{const e={position:n,left:0,top:0};if(!R.floating)return e;const t=xp(R.floating,h.x),r=xp(R.floating,h.y);return c?{...e,transform:"translate("+t+"px, "+r+"px)",...bp(R.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:r}}),[n,c,R.floating,h.x,h.y]);return a.useMemo((()=>({...h,update:A,refs:I,elements:R,floatingStyles:M})),[h,A,I,R,M])}({...e,elements:{...o,...c&&{reference:c}}}),f=a.useCallback((e=>{const t=gh(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),getClientRects:()=>e.getClientRects(),contextElement:e}:e;d(t),m.refs.setReference(t)}),[m.refs]),g=a.useCallback((e=>{(gh(e)||null===e)&&(h.current=e,l(e)),(gh(m.refs.reference.current)||null===m.refs.reference.current||null!==e&&!gh(e))&&m.refs.setReference(e)}),[m.refs]),v=a.useMemo((()=>({...m.refs,setReference:g,setPositionReference:f,domReference:h})),[m.refs,g,f]),y=a.useMemo((()=>({...m.elements,domReference:u})),[m.elements,u]),b=a.useMemo((()=>({...m,...r,refs:v,elements:y,nodeId:t})),[m,v,y,t,r]);return ch((()=>{r.dataRef.current.floatingContext=b;const e=null==p?void 0:p.nodesRef.current.find((e=>e.id===t));e&&(e.context=b)})),a.useMemo((()=>({...m,context:b,refs:v,elements:y})),[m,v,y,b])}var Vp=function(e,t){return Vp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Vp(e,t)};function Hp(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Vp(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var qp=function(){return qp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},qp.apply(this,arguments)};function Yp(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}"function"===typeof SuppressedError&&SuppressedError;var Jp,Qp=function(e){var t=e.showTimeSelectOnly,n=void 0!==t&&t,r=e.showTime,o=void 0!==r&&r,s=e.className,i=e.children,l=n?"Choose Time":"Choose Date".concat(o?" and Time":"");return a.createElement("div",{className:s,role:"dialog","aria-label":l,"aria-modal":"true"},i)},Kp=function(e){var t=e.children,n=e.onClickOutside,r=e.className,o=e.containerRef,s=e.style,i=function(e,t){var n=(0,a.useRef)(null),r=(0,a.useRef)(e);r.current=e;var o=(0,a.useCallback)((function(e){var a,o=e.composed&&e.composedPath&&e.composedPath().find((function(e){return e instanceof Node}))||e.target;n.current&&!n.current.contains(o)&&(t&&o instanceof HTMLElement&&o.classList.contains(t)||null===(a=r.current)||void 0===a||a.call(r,e))}),[t]);return(0,a.useEffect)((function(){return document.addEventListener("mousedown",o),function(){document.removeEventListener("mousedown",o)}}),[o]),n}(n,e.ignoreClass);return a.createElement("div",{className:r,style:s,ref:function(e){i.current=e,o&&(o.current=e)}},t)};function Gp(){return"undefined"!==typeof window?window:globalThis}!function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"}(Jp||(Jp={}));function Xp(e){if(null==e)return new Date;var t="string"===typeof e?tc(e):ec(e);return em(t)?t:new Date}function Zp(e,t,n,r,a){void 0===a&&(a=Xp());for(var o=bm(n)||bm(ym()),s=0,i=Array.isArray(t)?t:[t];s<i.length;s++){var l=i[s],c=zd(e,l,a,{locale:o,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});if(em(c)&&(!r||e===tm(c,l,n)))return c}return null}function em(e,t){return Ud(e)&&!Wd(e,new Date("1/1/1800"))}function tm(e,t,n){if("en"===n)return hu(e,t,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=n?bm(n):void 0;return n&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(n,'"].')),hu(e,t,{locale:r=r||bm(ym()),useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function nm(e,t){var n=t.dateFormat,r=t.locale,a=Array.isArray(n)&&n.length>0?n[0]:n;return e&&tm(e,a,r)||""}function rm(e,t){var n=t.hour,r=void 0===n?0:n,a=t.minute,o=void 0===a?0:a,s=t.second;return mu(fu(gu(e,void 0===s?0:s),o),r)}function am(e){return Hd(e)}function om(e,t,n){return gd(e,{locale:bm(t||ym()),weekStartsOn:n})}function sm(e){return vu(e)}function im(e){return Yd(e)}function lm(e){return yu(e)}function cm(){return Hd(Xp())}function dm(e){return bu(e)}function um(e){return _u(e)}function hm(e,t){return e&&t?wu(e,t):!e&&!t}function pm(e,t){return e&&t?Nu(e,t):!e&&!t}function mm(e,t){return e&&t?Eu(e,t):!e&&!t}function fm(e,t){return e&&t?Su(e,t):!e&&!t}function gm(e,t){return e&&t?ju(e,t):!e&&!t}function vm(e,t,n){var r,a=Hd(t),o=bu(n);try{r=ku(e,{start:a,end:o})}catch(s){r=!1}return r}function ym(){return Gp().__localeId__}function bm(e){if("string"===typeof e){var t=Gp();return t.__localeData__?t.__localeData__[e]:void 0}return e}function xm(e,t){return tm(Du(Xp(),e),"LLLL",t)}function _m(e,t){return tm(Du(Xp(),e),"LLL",t)}function wm(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,o=n.excludeDates,s=n.excludeDateIntervals,i=n.includeDates,l=n.includeDateIntervals,c=n.filterDate;return Am(e,{minDate:r,maxDate:a})||o&&o.some((function(t){return t instanceof Date?fm(e,t):fm(e,t.date)}))||s&&s.some((function(t){var n=t.start,r=t.end;return ku(e,{start:n,end:r})}))||i&&!i.some((function(t){return fm(e,t)}))||l&&!l.some((function(t){var n=t.start,r=t.end;return ku(e,{start:n,end:r})}))||c&&!c(Xp(e))||!1}function Nm(e,t){var n=void 0===t?{}:t,r=n.excludeDates,a=n.excludeDateIntervals;return a&&a.length>0?a.some((function(t){var n=t.start,r=t.end;return ku(e,{start:n,end:r})})):r&&r.some((function(t){var n;return t instanceof Date?fm(e,t):fm(e,null!==(n=t.date)&&void 0!==n?n:new Date)}))||!1}function Em(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,o=n.excludeDates,s=n.includeDates,i=n.filterDate;return Am(e,{minDate:r?vu(r):void 0,maxDate:a?_u(a):void 0})||(null===o||void 0===o?void 0:o.some((function(t){return pm(e,t instanceof Date?t:t.date)})))||s&&!s.some((function(t){return pm(e,t)}))||i&&!i(Xp(e))||!1}function Sm(e,t,n,r){var a=Au(e),o=Pu(e),s=Au(t),i=Pu(t),l=Au(r);return a===s&&a===l?o<=n&&n<=i:a<s&&(l===a&&o<=n||l===s&&i>=n||l<s&&l>a)}function jm(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,o=n.excludeDates,s=n.includeDates;return Am(e,{minDate:r,maxDate:a})||o&&o.some((function(t){return pm(t instanceof Date?t:t.date,e)}))||s&&!s.some((function(t){return pm(t,e)}))||!1}function km(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,o=n.excludeDates,s=n.includeDates,i=n.filterDate;return Am(e,{minDate:r,maxDate:a})||(null===o||void 0===o?void 0:o.some((function(t){return mm(e,t instanceof Date?t:t.date)})))||s&&!s.some((function(t){return mm(e,t)}))||i&&!i(Xp(e))||!1}function Cm(e,t,n){if(!t||!n)return!1;if(!Ud(t)||!Ud(n))return!1;var r=Au(t),a=Au(n);return r<=e&&a>=e}function Dm(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,o=n.excludeDates,s=n.includeDates,i=n.filterDate,l=new Date(e,0,1);return Am(l,{minDate:r?Yd(r):void 0,maxDate:a?Iu(a):void 0})||(null===o||void 0===o?void 0:o.some((function(e){return hm(l,e instanceof Date?e:e.date)})))||s&&!s.some((function(e){return hm(l,e)}))||i&&!i(Xp(l))||!1}function Tm(e,t,n,r){var a=Au(e),o=Ru(e),s=Au(t),i=Ru(t),l=Au(r);return a===s&&a===l?o<=n&&n<=i:a<s&&(l===a&&o<=n||l===s&&i>=n||l<s&&l>a)}function Am(e,t){var n,r=void 0===t?{}:t,a=r.minDate,o=r.maxDate;return null!==(n=a&&qd(e,a)<0||o&&qd(e,o)>0)&&void 0!==n&&n}function Pm(e,t){return t.some((function(t){return Mu(t)===Mu(e)&&Ou(t)===Ou(e)&&Lu(t)===Lu(e)}))}function Im(e,t){var n=void 0===t?{}:t,r=n.excludeTimes,a=n.includeTimes,o=n.filterTime;return r&&Pm(e,r)||a&&!Pm(e,a)||o&&!o(e)||!1}function Rm(e,t){var n=t.minTime,r=t.maxTime;if(!n||!r)throw new Error("Both minTime and maxTime props required");var a=Xp();a=gu(a=fu(a=mu(a,Mu(e)),Ou(e)),Lu(e));var o=Xp();o=gu(o=fu(o=mu(o,Mu(n)),Ou(n)),Lu(n));var s,i=Xp();i=gu(i=fu(i=mu(i,Mu(r)),Ou(r)),Lu(r));try{s=!ku(a,{start:o,end:i})}catch(l){s=!1}return s}function Mm(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,o=Fu(e,1);return r&&zu(r,o)>0||a&&a.every((function(e){return zu(e,o)>0}))||!1}function Om(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,o=$u(e,1);return r&&zu(o,r)>0||a&&a.every((function(e){return zu(o,e)>0}))||!1}function Lm(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,o=Hu(e,1);return r&&qu(r,o)>0||a&&a.every((function(e){return qu(e,o)>0}))||!1}function $m(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,o=Vu(e,1);return r&&qu(o,r)>0||a&&a.every((function(e){return qu(o,e)>0}))||!1}function Fm(e){var t=e.minDate,n=e.includeDates;return n&&t?Yu(n.filter((function(e){return qd(e,t)>=0}))):n?Yu(n):t}function zm(e){var t=e.maxDate,n=e.includeDates;return n&&t?Ju(n.filter((function(e){return qd(e,t)<=0}))):n?Ju(n):t}function Bm(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var s=e[a];if(Bd(s)){var i=tm(s,"MM.dd.yyyy");(p=r.get(i)||[]).includes(t)||(p.push(t),r.set(i,p))}else if("object"===typeof s){var l=null!==(n=Object.keys(s)[0])&&void 0!==n?n:"",c=s[l];if("string"===typeof l&&Array.isArray(c))for(var d=0,u=c.length;d<u;d++){var h=c[d];if(h){var p;i=tm(h,"MM.dd.yyyy");(p=r.get(i)||[]).includes(l)||(p.push(l),r.set(i,p))}}}}return r}function Um(e,t){void 0===e&&(e=[]),void 0===t&&(t="react-datepicker__day--holidays");var n=new Map;return e.forEach((function(e){var r=e.date,a=e.holidayName;if(Bd(r)){var o=tm(r,"MM.dd.yyyy"),s=n.get(o)||{className:"",holidayNames:[]};if(!("className"in s)||s.className!==t||(i=s.holidayNames,l=[a],i.length!==l.length||!i.every((function(e,t){return e===l[t]})))){var i,l;s.className=t;var c=s.holidayNames;s.holidayNames=c?Yp(Yp([],c,!0),[a],!1):[a],n.set(o,s)}}})),n}function Wm(e,t,n,r,a){for(var o=a.length,s=[],i=0;i<o;i++){var l=e,c=a[i];c&&(l=Xu(l=Gu(l=Ku(l,Mu(c)),Ou(c)),Lu(c)));var d=Gu(e,(n+1)*r);Zu(l,t)&&Wd(l,d)&&void 0!=c&&s.push(c)}return s}function Vm(e){return e<10?"0".concat(e):"".concat(e)}function Hm(e,t){void 0===t&&(t=12);var n=Math.ceil(Au(e)/t)*t;return{startPeriod:n-(t-1),endPeriod:n}}function qm(e){var t=e.getSeconds(),n=e.getMilliseconds();return ec(e.getTime()-1e3*t-n)}function Ym(e){if(!Bd(e))throw new Error("Invalid date");var t=new Date(e);return t.setHours(0,0,0,0),t}function Jm(e,t){if(!Bd(e)||!Bd(t))throw new Error("Invalid date received");return Wd(Ym(e),Ym(t))}function Qm(e){return e.key===Jp.Space}var Km,Gm=function(e){function t(t){var n=e.call(this,t)||this;return n.inputRef=a.createRef(),n.onTimeChange=function(e){var t,r;n.setState({time:e});var a=n.props.date,o=a instanceof Date&&!isNaN(+a)?a:new Date;if(null===e||void 0===e?void 0:e.includes(":")){var s=e.split(":"),i=s[0],l=s[1];o.setHours(Number(i)),o.setMinutes(Number(l))}null===(r=(t=n.props).onChange)||void 0===r||r.call(t,o)},n.renderTimeInput=function(){var e=n.state.time,t=n.props,r=t.date,o=t.timeString,s=t.customTimeInput;return s?(0,a.cloneElement)(s,{date:r,value:e,onChange:n.onTimeChange}):a.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var e;null===(e=n.inputRef.current)||void 0===e||e.focus()},required:!0,value:e,onChange:function(e){n.onTimeChange(e.target.value||o)}})},n.state={time:n.props.timeString},n}return Hp(t,e),t.getDerivedStateFromProps=function(e,t){return e.timeString!==t.time?{time:e.timeString}:null},t.prototype.render=function(){return a.createElement("div",{className:"react-datepicker__input-time-container"},a.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),a.createElement("div",{className:"react-datepicker-time__input-container"},a.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},t}(a.Component),Xm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dayEl=(0,a.createRef)(),t.handleClick=function(e){!t.isDisabled()&&t.props.onClick&&t.props.onClick(e)},t.handleMouseEnter=function(e){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(e)},t.handleOnKeyDown=function(e){var n,r;e.key===Jp.Space&&(e.preventDefault(),e.key=Jp.Enter),null===(r=(n=t.props).handleOnKeyDown)||void 0===r||r.call(n,e)},t.isSameDay=function(e){return fm(t.props.day,e)},t.isKeyboardSelected=function(){var e;if(t.props.disabledKeyboardNavigation)return!1;var n=t.props.selectsMultiple?null===(e=t.props.selectedDates)||void 0===e?void 0:e.some((function(e){return t.isSameDayOrWeek(e)})):t.isSameDayOrWeek(t.props.selected),r=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!n&&t.isSameDayOrWeek(t.props.preSelection)&&!r},t.isDisabled=function(e){return void 0===e&&(e=t.props.day),wm(e,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Nm(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return fm(t.props.day,om(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(e){return t.props.showWeekPicker&&fm(e,om(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(e){return t.isSameDay(e)||t.isSameWeek(e)},t.getHighLightedClass=function(){var e=t.props,n=e.day,r=e.highlightDates;if(!r)return!1;var a=tm(n,"MM.dd.yyyy");return r.get(a)},t.getHolidaysClass=function(){var e,n=t.props,r=n.day,a=n.holidays;if(!a)return[void 0];var o=tm(r,"MM.dd.yyyy");return a.has(o)?[null===(e=a.get(o))||void 0===e?void 0:e.className]:[void 0]},t.isInRange=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&vm(n,r,a)},t.isInSelectingRange=function(){var e,n=t.props,r=n.day,a=n.selectsStart,o=n.selectsEnd,s=n.selectsRange,i=n.selectsDisabledDaysInRange,l=n.startDate,c=n.endDate,d=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;return!(!(a||o||s)||!d||!i&&t.isDisabled())&&(a&&c&&(Wd(d,c)||gm(d,c))?vm(r,d,c):(o&&l&&!c&&(Zu(d,l)||gm(d,l))||!(!s||!l||c||!Zu(d,l)&&!gm(d,l)))&&vm(r,l,d))},t.isSelectingRangeStart=function(){var e;if(!t.isInSelectingRange())return!1;var n=t.props,r=n.day,a=n.startDate,o=n.selectsStart,s=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;return fm(r,o?s:a)},t.isSelectingRangeEnd=function(){var e;if(!t.isInSelectingRange())return!1;var n=t.props,r=n.day,a=n.endDate,o=n.selectsEnd,s=n.selectsRange,i=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;return fm(r,o||s?i:a)},t.isRangeStart=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&fm(r,n)},t.isRangeEnd=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&fm(a,n)},t.isWeekend=function(){var e=eh(t.props.day);return 0===e||6===e},t.isAfterMonth=function(){return void 0!==t.props.month&&(t.props.month+1)%12===Pu(t.props.day)},t.isBeforeMonth=function(){return void 0!==t.props.month&&(Pu(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Xp())},t.isSelected=function(){var e;return t.props.selectsMultiple?null===(e=t.props.selectedDates)||void 0===e?void 0:e.some((function(e){return t.isSameDayOrWeek(e)})):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(e){var n;return Jl("react-datepicker__day",t.props.dayClassName?t.props.dayClassName(e):void 0,"react-datepicker__day--"+tm(t.props.day,"ddd",n),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var e=t.props,n=e.day,r=e.ariaLabelPrefixWhenEnabled,a=void 0===r?"Choose":r,o=e.ariaLabelPrefixWhenDisabled,s=void 0===o?"Not available":o,i=t.isDisabled()||t.isExcluded()?s:a;return"".concat(i," ").concat(tm(n,"PPPP",t.props.locale))},t.getTitle=function(){var e=t.props,n=e.day,r=e.holidays,a=void 0===r?new Map:r,o=e.excludeDates,s=tm(n,"MM.dd.yyyy"),i=[];return a.has(s)&&i.push.apply(i,a.get(s).holidayNames),t.isExcluded()&&i.push(null===o||void 0===o?void 0:o.filter((function(e){return e instanceof Date?fm(e,n):fm(null===e||void 0===e?void 0:e.date,n)})).map((function(e){if(!(e instanceof Date))return null===e||void 0===e?void 0:e.message}))),i.join(", ")},t.getTabIndex=function(){var e=t.props.selected,n=t.props.preSelection;return(!t.props.showWeekPicker||!t.props.showWeekNumber&&t.isStartOfWeek())&&(t.isKeyboardSelected()||t.isSameDay(e)&&fm(n,e))?0:-1},t.handleFocusDay=function(){var e;t.shouldFocusDay()&&(null===(e=t.dayEl.current)||void 0===e||e.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(th(t.props.day),t.props.day):th(t.props.day)},t.render=function(){return a.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),""!==t.getTitle()&&a.createElement("span",{className:"overlay"},t.getTitle()))},t}return Hp(t,e),t.prototype.componentDidMount=function(){this.handleFocusDay()},t.prototype.componentDidUpdate=function(){this.handleFocusDay()},t.prototype.shouldFocusDay=function(){var e=!1;return 0===this.getTabIndex()&&this.isSameDay(this.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(e=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(e=!1),this.isDayActiveElement()&&(e=!0),this.isDuplicateDay()&&(e=!1)),e},t.prototype.isDayActiveElement=function(){var e,t,n;return(null===(t=null===(e=this.props.containerRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.contains(document.activeElement))&&(null===(n=document.activeElement)||void 0===n?void 0:n.classList.contains("react-datepicker__day"))},t.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},t}(a.Component),Zm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.weekNumberEl=(0,a.createRef)(),t.handleClick=function(e){t.props.onClick&&t.props.onClick(e)},t.handleOnKeyDown=function(e){var n,r;e.key===Jp.Space&&(e.preventDefault(),e.key=Jp.Enter),null===(r=(n=t.props).handleOnKeyDown)||void 0===r||r.call(n,e)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!fm(t.props.date,t.props.selected)&&fm(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||fm(t.props.date,t.props.selected)&&fm(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(e){var n=!1;0===t.getTabIndex()&&!(null===e||void 0===e?void 0:e.isInputFocused)&&fm(t.props.date,t.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(n=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(n=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(n=!0)),n&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Hp(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},t.prototype.componentDidUpdate=function(e){this.handleFocusWeekNumber(e)},t.prototype.render=function(){var e=this.props,n=e.weekNumber,r=e.isWeekDisabled,o=e.ariaLabelPrefix,s=void 0===o?t.defaultProps.ariaLabelPrefix:o,i=e.onClick,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!i&&!r,"react-datepicker__week-number--selected":!!i&&fm(this.props.date,this.props.selected)};return a.createElement("div",{ref:this.weekNumberEl,className:Jl(l),"aria-label":"".concat(s," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},n)},t}(a.Component),ef=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.isDisabled=function(e){return wm(e,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,excludeDateIntervals:n.props.excludeDateIntervals,includeDateIntervals:n.props.includeDateIntervals,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.handleDayClick=function(e,t){n.props.onDayClick&&n.props.onDayClick(e,t)},n.handleDayMouseEnter=function(e){n.props.onDayMouseEnter&&n.props.onDayMouseEnter(e)},n.handleWeekClick=function(e,r,a){for(var o,s,i,l=new Date(e),c=0;c<7;c++){var d=new Date(e);if(d.setDate(d.getDate()+c),!n.isDisabled(d)){l=d;break}}"function"===typeof n.props.onWeekSelect&&n.props.onWeekSelect(l,r,a),n.props.showWeekPicker&&n.handleDayClick(l,a),(null!==(o=n.props.shouldCloseOnSelect)&&void 0!==o?o:t.defaultProps.shouldCloseOnSelect)&&(null===(i=(s=n.props).setOpen)||void 0===i||i.call(s,!1))},n.formatWeekNumber=function(e){return n.props.formatWeekNumber?n.props.formatWeekNumber(e):function(e){return Ed(e)}(e)},n.isWeekDisabled=function(){for(var e=n.startOfWeek(),t=Cd(e,6),r=new Date(e);r<=t;){if(!n.isDisabled(r))return!1;r=Cd(r,1)}return!0},n.renderDays=function(){var e=n.startOfWeek(),r=[],o=n.formatWeekNumber(e);if(n.props.showWeekNumber){var s=n.props.onWeekSelect||n.props.showWeekPicker?n.handleWeekClick.bind(n,e,o):void 0;r.push(a.createElement(Zm,qp({key:"W"},t.defaultProps,n.props,{weekNumber:o,isWeekDisabled:n.isWeekDisabled(),date:e,onClick:s})))}return r.concat([0,1,2,3,4,5,6].map((function(r){var o=Cd(e,r);return a.createElement(Xm,qp({},t.defaultProps,n.props,{ariaLabelPrefixWhenEnabled:n.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:n.props.disabledDayAriaLabelPrefix,key:o.valueOf(),day:o,onClick:n.handleDayClick.bind(n,o),onMouseEnter:n.handleDayMouseEnter.bind(n,o)}))})))},n.startOfWeek=function(){return om(n.props.day,n.props.locale,n.props.calendarStartDay)},n.isKeyboardSelected=function(){return!n.props.disabledKeyboardNavigation&&!fm(n.startOfWeek(),n.props.selected)&&fm(n.startOfWeek(),n.props.preSelection)},n}return Hp(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e={"react-datepicker__week":!0,"react-datepicker__week--selected":fm(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return a.createElement("div",{className:Jl(e)},this.renderDays())},t}(a.Component),tf="two_columns",nf="three_columns",rf="four_columns",af=((Km={})[tf]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},Km[nf]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},Km[rf]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},Km);function of(e,t){return e?rf:t?tf:nf}var sf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MONTH_REFS=Yp([],Array(12),!0).map((function(){return(0,a.createRef)()})),t.QUARTER_REFS=Yp([],Array(4),!0).map((function(){return(0,a.createRef)()})),t.isDisabled=function(e){return wm(e,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(e){return Nm(e,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(e,n){var r,a;null===(a=(r=t.props).onDayClick)||void 0===a||a.call(r,e,n,t.props.orderInDisplay)},t.handleDayMouseEnter=function(e){var n,r;null===(r=(n=t.props).onDayMouseEnter)||void 0===r||r.call(n,e)},t.handleMouseLeave=function(){var e,n;null===(n=(e=t.props).onMouseLeave)||void 0===n||n.call(e)},t.isRangeStartMonth=function(e){var n=t.props,r=n.day,a=n.startDate,o=n.endDate;return!(!a||!o)&&pm(Du(r,e),a)},t.isRangeStartQuarter=function(e){var n=t.props,r=n.day,a=n.startDate,o=n.endDate;return!(!a||!o)&&mm(Tu(r,e),a)},t.isRangeEndMonth=function(e){var n=t.props,r=n.day,a=n.startDate,o=n.endDate;return!(!a||!o)&&pm(Du(r,e),o)},t.isRangeEndQuarter=function(e){var n=t.props,r=n.day,a=n.startDate,o=n.endDate;return!(!a||!o)&&mm(Tu(r,e),o)},t.isInSelectingRangeMonth=function(e){var n,r=t.props,a=r.day,o=r.selectsStart,s=r.selectsEnd,i=r.selectsRange,l=r.startDate,c=r.endDate,d=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return!(!(o||s||i)||!d)&&(o&&c?Sm(d,c,e,a):(s&&l||!(!i||!l||c))&&Sm(l,d,e,a))},t.isSelectingMonthRangeStart=function(e){var n;if(!t.isInSelectingRangeMonth(e))return!1;var r=t.props,a=r.day,o=r.startDate,s=r.selectsStart,i=Du(a,e),l=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return pm(i,s?l:o)},t.isSelectingMonthRangeEnd=function(e){var n;if(!t.isInSelectingRangeMonth(e))return!1;var r=t.props,a=r.day,o=r.endDate,s=r.selectsEnd,i=r.selectsRange,l=Du(a,e),c=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return pm(l,s||i?c:o)},t.isInSelectingRangeQuarter=function(e){var n,r=t.props,a=r.day,o=r.selectsStart,s=r.selectsEnd,i=r.selectsRange,l=r.startDate,c=r.endDate,d=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return!(!(o||s||i)||!d)&&(o&&c?Tm(d,c,e,a):(s&&l||!(!i||!l||c))&&Tm(l,d,e,a))},t.isWeekInMonth=function(e){var n=t.props.day,r=Cd(e,6);return pm(e,n)||pm(r,n)},t.isCurrentMonth=function(e,t){return Au(e)===Au(Xp())&&t===Pu(Xp())},t.isCurrentQuarter=function(e,t){return Au(e)===Au(Xp())&&t===Ru(Xp())},t.isSelectedMonth=function(e,t,n){return Pu(n)===t&&Au(e)===Au(n)},t.isSelectMonthInList=function(e,n,r){return r.some((function(r){return t.isSelectedMonth(e,n,r)}))},t.isSelectedQuarter=function(e,t,n){return Ru(e)===t&&Au(e)===Au(n)},t.renderWeeks=function(){for(var e=[],n=t.props.fixedHeight,r=0,o=!1,s=om(sm(t.props.day),t.props.locale,t.props.calendarStartDay),i=t.props.selected?function(e){return t.props.showWeekPicker?om(e,t.props.locale,t.props.calendarStartDay):t.props.selected}(t.props.selected):void 0,l=t.props.preSelection?function(e){return t.props.showWeekPicker?om(e,t.props.locale,t.props.calendarStartDay):t.props.preSelection}(t.props.preSelection):void 0;e.push(a.createElement(ef,qp({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:r,day:s,month:Pu(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:i,preSelection:l,showWeekNumber:t.props.showWeekNumbers}))),!o;){r++,s=nh(s,1);var c=n&&r>=6,d=!n&&!t.isWeekInMonth(s);if(c||d){if(!t.props.peekNextMonth)break;o=!0}}return e},t.onMonthClick=function(e,n){var r=t.isMonthDisabledForLabelDate(n),a=r.isDisabled,o=r.labelDate;a||t.handleDayClick(sm(o),e)},t.onMonthMouseEnter=function(e){var n=t.isMonthDisabledForLabelDate(e),r=n.isDisabled,a=n.labelDate;r||t.handleDayMouseEnter(sm(a))},t.handleMonthNavigation=function(e,n){var r,a,o,s;null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,n),null===(s=null===(o=t.MONTH_REFS[e])||void 0===o?void 0:o.current)||void 0===s||s.focus()},t.handleKeyboardNavigation=function(e,n,r){var a,o=t.props,s=o.selected,i=o.preSelection,l=o.setPreSelection,c=o.minDate,d=o.maxDate,u=o.showFourColumnMonthYearPicker,h=o.showTwoColumnMonthYearPicker;if(i){var p=of(u,h),m=t.getVerticalOffset(p),f=null===(a=af[p])||void 0===a?void 0:a.grid,g=function(e,t,n){var r,a,o=t,s=n;switch(e){case Jp.ArrowRight:o=$u(t,1),s=11===n?0:n+1;break;case Jp.ArrowLeft:o=Fu(t,1),s=0===n?11:n-1;break;case Jp.ArrowUp:o=Fu(t,m),s=(null===(r=null===f||void 0===f?void 0:f[0])||void 0===r?void 0:r.includes(n))?n+12-m:n-m;break;case Jp.ArrowDown:o=$u(t,m),s=(null===(a=null===f||void 0===f?void 0:f[f.length-1])||void 0===a?void 0:a.includes(n))?n-12+m:n+m}return{newCalculatedDate:o,newCalculatedMonth:s}};if(n!==Jp.Enter){var v=function(e,n,r){for(var a=e,o=!1,s=0,i=g(a,n,r),l=i.newCalculatedDate,u=i.newCalculatedMonth;!o;){if(s>=40){l=n,u=r;break}var h;if(c&&l<c)a=Jp.ArrowRight,l=(h=g(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;if(d&&l>d)a=Jp.ArrowLeft,l=(h=g(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;if(jm(l,t.props))l=(h=g(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;else o=!0;s++}return{newCalculatedDate:l,newCalculatedMonth:u}}(n,i,r),y=v.newCalculatedDate,b=v.newCalculatedMonth;switch(n){case Jp.ArrowRight:case Jp.ArrowLeft:case Jp.ArrowUp:case Jp.ArrowDown:t.handleMonthNavigation(b,y)}}else t.isMonthDisabled(r)||(t.onMonthClick(e,r),null===l||void 0===l||l(s))}},t.getVerticalOffset=function(e){var t,n;return null!==(n=null===(t=af[e])||void 0===t?void 0:t.verticalNavigationOffset)&&void 0!==n?n:0},t.onMonthKeyDown=function(e,n){var r=t.props,a=r.disabledKeyboardNavigation,o=r.handleOnMonthKeyDown,s=e.key;s!==Jp.Tab&&e.preventDefault(),a||t.handleKeyboardNavigation(e,s,n),o&&o(e)},t.onQuarterClick=function(e,n){var r=Tu(t.props.day,n);km(r,t.props)||t.handleDayClick(lm(r),e)},t.onQuarterMouseEnter=function(e){var n=Tu(t.props.day,e);km(n,t.props)||t.handleDayMouseEnter(lm(n))},t.handleQuarterNavigation=function(e,n){var r,a,o,s;t.isDisabled(n)||t.isExcluded(n)||(null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,n),null===(s=null===(o=t.QUARTER_REFS[e-1])||void 0===o?void 0:o.current)||void 0===s||s.focus())},t.onQuarterKeyDown=function(e,n){var r,a,o=e.key;if(!t.props.disabledKeyboardNavigation)switch(o){case Jp.Enter:t.onQuarterClick(e,n),null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,t.props.selected);break;case Jp.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(4===n?1:n+1,Bu(t.props.preSelection,1));break;case Jp.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(1===n?4:n-1,Uu(t.props.preSelection,1))}},t.isMonthDisabledForLabelDate=function(e){var n,r=t.props,a=r.day,o=r.minDate,s=r.maxDate,i=r.excludeDates,l=r.includeDates,c=Du(a,e);return{isDisabled:null!==(n=(o||s||i||l)&&Em(c,t.props))&&void 0!==n&&n,labelDate:c}},t.isMonthDisabled=function(e){return t.isMonthDisabledForLabelDate(e).isDisabled},t.getMonthClassNames=function(e){var n=t.props,r=n.day,a=n.startDate,o=n.endDate,s=n.preSelection,i=n.monthClassName,l=i?i(Du(r,e)):void 0,c=t.getSelection();return Jl("react-datepicker__month-text","react-datepicker__month-".concat(e),l,{"react-datepicker__month-text--disabled":t.isMonthDisabled(e),"react-datepicker__month-text--selected":c?t.isSelectMonthInList(r,e,c):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&s&&t.isSelectedMonth(r,e,s)&&!t.isMonthDisabled(e),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(e),"react-datepicker__month-text--in-range":a&&o?Sm(a,o,e,r):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(e),"react-datepicker__month-text--range-end":t.isRangeEndMonth(e),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(e),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(e),"react-datepicker__month-text--today":t.isCurrentMonth(r,e)})},t.getTabIndex=function(e){if(null==t.props.preSelection)return"-1";var n=Pu(t.props.preSelection),r=t.isMonthDisabledForLabelDate(n).isDisabled;return e!==n||r||t.props.disabledKeyboardNavigation?"-1":"0"},t.getQuarterTabIndex=function(e){if(null==t.props.preSelection)return"-1";var n=Ru(t.props.preSelection),r=km(t.props.day,t.props);return e!==n||r||t.props.disabledKeyboardNavigation?"-1":"0"},t.getAriaLabel=function(e){var n=t.props,r=n.chooseDayAriaLabelPrefix,a=void 0===r?"Choose":r,o=n.disabledDayAriaLabelPrefix,s=void 0===o?"Not available":o,i=n.day,l=n.locale,c=Du(i,e),d=t.isDisabled(c)||t.isExcluded(c)?s:a;return"".concat(d," ").concat(tm(c,"MMMM yyyy",l))},t.getQuarterClassNames=function(e){var n=t.props,r=n.day,a=n.startDate,o=n.endDate,s=n.selected,i=n.minDate,l=n.maxDate,c=n.excludeDates,d=n.includeDates,u=n.filterDate,h=n.preSelection,p=n.disabledKeyboardNavigation,m=(i||l||c||d||u)&&km(Tu(r,e),t.props);return Jl("react-datepicker__quarter-text","react-datepicker__quarter-".concat(e),{"react-datepicker__quarter-text--disabled":m,"react-datepicker__quarter-text--selected":s?t.isSelectedQuarter(r,e,s):void 0,"react-datepicker__quarter-text--keyboard-selected":!p&&h&&t.isSelectedQuarter(r,e,h)&&!m,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(e),"react-datepicker__quarter-text--in-range":a&&o?Tm(a,o,e,r):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(e),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(e),"react-datepicker__quarter-text--today":t.isCurrentQuarter(r,e)})},t.getMonthContent=function(e){var n=t.props,r=n.showFullMonthYearPicker,a=n.renderMonthContent,o=n.locale,s=n.day,i=_m(e,o),l=xm(e,o);return a?a(e,i,l,s):r?l:i},t.getQuarterContent=function(e){var n,r=t.props,a=r.renderQuarterContent,o=function(e,t){return tm(Tu(Xp(),e),"QQQ",t)}(e,r.locale);return null!==(n=null===a||void 0===a?void 0:a(e,o))&&void 0!==n?n:o},t.renderMonths=function(){var e,n=t.props,r=n.showTwoColumnMonthYearPicker,o=n.showFourColumnMonthYearPicker,s=n.day,i=n.selected,l=null===(e=af[of(o,r)])||void 0===e?void 0:e.grid;return null===l||void 0===l?void 0:l.map((function(e,n){return a.createElement("div",{className:"react-datepicker__month-wrapper",key:n},e.map((function(e,n){return a.createElement("div",{ref:t.MONTH_REFS[e],key:n,onClick:function(n){t.onMonthClick(n,e)},onKeyDown:function(n){Qm(n)&&(n.preventDefault(),n.key=Jp.Enter),t.onMonthKeyDown(n,e)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(e)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(e)}:void 0,tabIndex:Number(t.getTabIndex(e)),className:t.getMonthClassNames(e),"aria-disabled":t.isMonthDisabled(e),role:"option","aria-label":t.getAriaLabel(e),"aria-current":t.isCurrentMonth(s,e)?"date":void 0,"aria-selected":i?t.isSelectedMonth(s,e,i):void 0},t.getMonthContent(e))})))}))},t.renderQuarters=function(){var e=t.props,n=e.day,r=e.selected;return a.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map((function(e,o){return a.createElement("div",{key:o,ref:t.QUARTER_REFS[o],role:"option",onClick:function(n){t.onQuarterClick(n,e)},onKeyDown:function(n){t.onQuarterKeyDown(n,e)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(e)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(e)}:void 0,className:t.getQuarterClassNames(e),"aria-selected":r?t.isSelectedQuarter(n,e,r):void 0,tabIndex:Number(t.getQuarterTabIndex(e)),"aria-current":t.isCurrentQuarter(n,e)?"date":void 0},t.getQuarterContent(e))})))},t.getClassNames=function(){var e=t.props,n=e.selectingDate,r=e.selectsStart,a=e.selectsEnd;return Jl("react-datepicker__month",{"react-datepicker__month--selecting-range":n&&(r||a)},{"react-datepicker__monthPicker":e.showMonthYearPicker},{"react-datepicker__quarterPicker":e.showQuarterYearPicker},{"react-datepicker__weekPicker":e.showWeekPicker})},t}return Hp(t,e),t.prototype.getSelection=function(){var e=this.props,t=e.selected,n=e.selectedDates;return e.selectsMultiple?n:t?[t]:void 0},t.prototype.render=function(){var e=this.props,t=e.showMonthYearPicker,n=e.showQuarterYearPicker,r=e.day,o=e.ariaLabelPrefix,s=void 0===o?"Month ":o,i=s?s.trim()+" ":"";return a.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(i).concat(tm(r,"MMMM, yyyy",this.props.locale)),role:"listbox"},t?this.renderMonths():n?this.renderQuarters():this.renderWeeks())},t}(a.Component),lf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(e){return t.props.month===e},t.renderOptions=function(){return t.props.monthNames.map((function(e,n){return a.createElement("div",{className:t.isSelectedMonth(n)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:e,onClick:t.onChange.bind(t,n),"aria-selected":t.isSelectedMonth(n)?"true":void 0},t.isSelectedMonth(n)?a.createElement("span",{className:"react-datepicker__month-option--selected"},"\u2713"):"",e)}))},t.onChange=function(e){return t.props.onChange(e)},t.handleClickOutside=function(){return t.props.onCancel()},t}return Hp(t,e),t.prototype.render=function(){return a.createElement(Kp,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},t}(a.Component),cf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(e){return e.map((function(e,t){return a.createElement("option",{key:e,value:t},e)}))},t.renderSelectMode=function(e){return a.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(e){return t.onChange(parseInt(e.target.value))}},t.renderSelectOptions(e))},t.renderReadView=function(e,n){return a.createElement("div",{key:"read",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},a.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),a.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},n[t.props.month]))},t.renderDropdown=function(e){return a.createElement(lf,qp({key:"dropdown"},t.props,{monthNames:e,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(e){var n=t.state.dropdownVisible,r=[t.renderReadView(!n,e)];return n&&r.unshift(t.renderDropdown(e)),r},t.onChange=function(e){t.toggleDropdown(),e!==t.props.month&&t.props.onChange(e)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return Hp(t,e),t.prototype.render=function(){var e,t=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(e){return _m(e,t.props.locale)}:function(e){return xm(e,t.props.locale)});switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode(n);break;case"select":e=this.renderSelectMode(n)}return a.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(a.Component);function df(e,t){for(var n=[],r=sm(e),a=sm(t);!Zu(r,a);)n.push(Xp(r)),r=$u(r,1);return n}var uf=function(e){function t(t){var n=e.call(this,t)||this;return n.renderOptions=function(){return n.state.monthYearsList.map((function(e){var t=rh(e),r=hm(n.props.date,e)&&pm(n.props.date,e);return a.createElement("div",{className:r?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:t,onClick:n.onChange.bind(n,t),"aria-selected":r?"true":void 0},r?a.createElement("span",{className:"react-datepicker__month-year-option--selected"},"\u2713"):"",tm(e,n.props.dateFormat,n.props.locale))}))},n.onChange=function(e){return n.props.onChange(e)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:df(n.props.minDate,n.props.maxDate)},n}return Hp(t,e),t.prototype.render=function(){var e=Jl({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return a.createElement(Kp,{className:e,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(a.Component),hf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var e=sm(t.props.minDate),n=sm(t.props.maxDate),r=[];!Zu(e,n);){var o=rh(e);r.push(a.createElement("option",{key:o,value:o},tm(e,t.props.dateFormat,t.props.locale))),e=$u(e,1)}return r},t.onSelectChange=function(e){t.onChange(parseInt(e.target.value))},t.renderSelectMode=function(){return a.createElement("select",{value:rh(sm(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(e){var n=tm(t.props.date,t.props.dateFormat,t.props.locale);return a.createElement("div",{key:"read",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},a.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),a.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},n))},t.renderDropdown=function(){return a.createElement(uf,qp({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var e=t.state.dropdownVisible,n=[t.renderReadView(!e)];return e&&n.unshift(t.renderDropdown()),n},t.onChange=function(e){t.toggleDropdown();var n=Xp(e);hm(t.props.date,n)&&pm(t.props.date,n)||t.props.onChange(n)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return Hp(t,e),t.prototype.render=function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return a.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(a.Component),pf=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={height:null},n.scrollToTheSelectedTime=function(){requestAnimationFrame((function(){var e,r,a;n.list&&(n.list.scrollTop=null!==(a=n.centerLi&&t.calcCenterPosition(n.props.monthRef?n.props.monthRef.clientHeight-(null!==(r=null===(e=n.header)||void 0===e?void 0:e.clientHeight)&&void 0!==r?r:0):n.list.clientHeight,n.centerLi))&&void 0!==a?a:0)}))},n.handleClick=function(e){var t,r;(n.props.minTime||n.props.maxTime)&&Rm(e,n.props)||(n.props.excludeTimes||n.props.includeTimes||n.props.filterTime)&&Im(e,n.props)||null===(r=(t=n.props).onChange)||void 0===r||r.call(t,e)},n.isSelectedTime=function(e){return n.props.selected&&(t=n.props.selected,r=e,qm(t).getTime()===qm(r).getTime());var t,r},n.isDisabledTime=function(e){return(n.props.minTime||n.props.maxTime)&&Rm(e,n.props)||(n.props.excludeTimes||n.props.includeTimes||n.props.filterTime)&&Im(e,n.props)},n.liClasses=function(e){var r,a=["react-datepicker__time-list-item",n.props.timeClassName?n.props.timeClassName(e):void 0];return n.isSelectedTime(e)&&a.push("react-datepicker__time-list-item--selected"),n.isDisabledTime(e)&&a.push("react-datepicker__time-list-item--disabled"),n.props.injectTimes&&(3600*Mu(e)+60*Ou(e)+Lu(e))%(60*(null!==(r=n.props.intervals)&&void 0!==r?r:t.defaultProps.intervals))!==0&&a.push("react-datepicker__time-list-item--injected"),a.join(" ")},n.handleOnKeyDown=function(e,t){var r,a;e.key===Jp.Space&&(e.preventDefault(),e.key=Jp.Enter),(e.key===Jp.ArrowUp||e.key===Jp.ArrowLeft)&&e.target instanceof HTMLElement&&e.target.previousSibling&&(e.preventDefault(),e.target.previousSibling instanceof HTMLElement&&e.target.previousSibling.focus()),(e.key===Jp.ArrowDown||e.key===Jp.ArrowRight)&&e.target instanceof HTMLElement&&e.target.nextSibling&&(e.preventDefault(),e.target.nextSibling instanceof HTMLElement&&e.target.nextSibling.focus()),e.key===Jp.Enter&&n.handleClick(t),null===(a=(r=n.props).handleOnKeyDown)||void 0===a||a.call(r,e)},n.renderTimes=function(){for(var e,r=[],o="string"===typeof n.props.format?n.props.format:"p",s=null!==(e=n.props.intervals)&&void 0!==e?e:t.defaultProps.intervals,i=n.props.selected||n.props.openToDate||Xp(),l=am(i),c=n.props.injectTimes&&n.props.injectTimes.sort((function(e,t){return e.getTime()-t.getTime()})),d=60*function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+n-+t)/36e5)}(i),u=d/s,h=0;h<u;h++){var p=Gu(l,h*s);if(r.push(p),c){var m=Wm(l,p,h,s,c);r=r.concat(m)}}var f=r.reduce((function(e,t){return t.getTime()<=i.getTime()?t:e}),r[0]);return r.map((function(e){return a.createElement("li",{key:e.valueOf(),onClick:n.handleClick.bind(n,e),className:n.liClasses(e),ref:function(t){e===f&&(n.centerLi=t)},onKeyDown:function(t){n.handleOnKeyDown(t,e)},tabIndex:e===f?0:-1,role:"option","aria-selected":n.isSelectedTime(e)?"true":void 0,"aria-disabled":n.isDisabledTime(e)?"true":void 0},tm(e,o,n.props.locale))}))},n.renderTimeCaption=function(){return!1===n.props.showTimeCaption?a.createElement(a.Fragment,null):a.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(n.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(e){n.header=e}},a.createElement("div",{className:"react-datepicker-time__header"},n.props.timeCaption))},n}return Hp(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},t.prototype.componentWillUnmount=function(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect()},t.prototype.observeDatePickerHeightChanges=function(){var e=this,t=this.props.monthRef;this.updateContainerHeight(),t&&(this.resizeObserver=new ResizeObserver((function(){e.updateContainerHeight()})),this.resizeObserver.observe(t))},t.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},t.prototype.render=function(){var e,n=this,r=this.state.height;return a.createElement("div",{className:"react-datepicker__time-container ".concat((null!==(e=this.props.todayButton)&&void 0!==e?e:t.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),a.createElement("div",{className:"react-datepicker__time"},a.createElement("div",{className:"react-datepicker__time-box"},a.createElement("ul",{className:"react-datepicker__time-list",ref:function(e){n.list=e},style:r?{height:r}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},t.calcCenterPosition=function(e,t){return t.offsetTop-(e/2-t.clientHeight/2)},t}(a.Component),mf=function(e){function t(t){var n=e.call(this,t)||this;return n.YEAR_REFS=Yp([],Array(n.props.yearItemNumber),!0).map((function(){return(0,a.createRef)()})),n.isDisabled=function(e){return wm(e,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(e){return Nm(e,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var e;return null!==(e=n.props.selectingDate)&&void 0!==e?e:n.props.preSelection},n.updateFocusOnPaginate=function(e){window.requestAnimationFrame((function(){var t,r;null===(r=null===(t=n.YEAR_REFS[e])||void 0===t?void 0:t.current)||void 0===r||r.focus()}))},n.handleYearClick=function(e,t){n.props.onDayClick&&n.props.onDayClick(e,t)},n.handleYearNavigation=function(e,t){var r,a,o,s,i=n.props,l=i.date,c=i.yearItemNumber;if(void 0!==l&&void 0!==c){var d=Hm(l,c).startPeriod;n.isDisabled(t)||n.isExcluded(t)||(null===(a=(r=n.props).setPreSelection)||void 0===a||a.call(r,t),e-d<0?n.updateFocusOnPaginate(c-(d-e)):e-d>=c?n.updateFocusOnPaginate(Math.abs(c-(e-d))):null===(s=null===(o=n.YEAR_REFS[e-d])||void 0===o?void 0:o.current)||void 0===s||s.focus())}},n.isSameDay=function(e,t){return fm(e,t)},n.isCurrentYear=function(e){return e===Au(Xp())},n.isRangeStart=function(e){return n.props.startDate&&n.props.endDate&&hm(ah(Xp(),e),n.props.startDate)},n.isRangeEnd=function(e){return n.props.startDate&&n.props.endDate&&hm(ah(Xp(),e),n.props.endDate)},n.isInRange=function(e){return Cm(e,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(e){var t=n.props,r=t.selectsStart,a=t.selectsEnd,o=t.selectsRange,s=t.startDate,i=t.endDate;return!(!(r||a||o)||!n.selectingDate())&&(r&&i?Cm(e,n.selectingDate(),i):(a&&s||!(!o||!s||i))&&Cm(e,s,n.selectingDate()))},n.isSelectingRangeStart=function(e){var t;if(!n.isInSelectingRange(e))return!1;var r=n.props,a=r.startDate,o=r.selectsStart,s=ah(Xp(),e);return hm(s,o?null!==(t=n.selectingDate())&&void 0!==t?t:null:null!==a&&void 0!==a?a:null)},n.isSelectingRangeEnd=function(e){var t;if(!n.isInSelectingRange(e))return!1;var r=n.props,a=r.endDate,o=r.selectsEnd,s=r.selectsRange,i=ah(Xp(),e);return hm(i,o||s?null!==(t=n.selectingDate())&&void 0!==t?t:null:null!==a&&void 0!==a?a:null)},n.isKeyboardSelected=function(e){if(void 0!==n.props.date&&null!=n.props.selected&&null!=n.props.preSelection){var t=n.props,r=t.minDate,a=t.maxDate,o=t.excludeDates,s=t.includeDates,i=t.filterDate,l=im(ah(n.props.date,e)),c=(r||a||o||s||i)&&Dm(e,n.props);return!n.props.disabledKeyboardNavigation&&!n.props.inline&&!fm(l,im(n.props.selected))&&fm(l,im(n.props.preSelection))&&!c}},n.isSelectedYear=function(e){var t=n.props,r=t.selectsMultiple,a=t.selected,o=t.selectedDates;return r?null===o||void 0===o?void 0:o.some((function(t){return e===Au(t)})):!a||e===Au(a)},n.onYearClick=function(e,t){var r=n.props.date;void 0!==r&&n.handleYearClick(im(ah(r,t)),e)},n.onYearKeyDown=function(e,t){var r,a,o=e.key,s=n.props,i=s.date,l=s.yearItemNumber,c=s.handleOnKeyDown;if(o!==Jp.Tab&&e.preventDefault(),!n.props.disabledKeyboardNavigation)switch(o){case Jp.Enter:if(null==n.props.selected)break;n.onYearClick(e,t),null===(a=(r=n.props).setPreSelection)||void 0===a||a.call(r,n.props.selected);break;case Jp.ArrowRight:if(null==n.props.preSelection)break;n.handleYearNavigation(t+1,Vu(n.props.preSelection,1));break;case Jp.ArrowLeft:if(null==n.props.preSelection)break;n.handleYearNavigation(t-1,Hu(n.props.preSelection,1));break;case Jp.ArrowUp:if(void 0===i||void 0===l||null==n.props.preSelection)break;var d=Hm(i,l).startPeriod;if((p=t-(h=3))<d){var u=l%h;t>=d&&t<d+u?h=u:h+=u,p=t-h}n.handleYearNavigation(p,Hu(n.props.preSelection,h));break;case Jp.ArrowDown:if(void 0===i||void 0===l||null==n.props.preSelection)break;var h,p,m=Hm(i,l).endPeriod;if((p=t+(h=3))>m){u=l%h;t<=m&&t>m-u?h=u:h+=u,p=t+h}n.handleYearNavigation(p,Vu(n.props.preSelection,h))}c&&c(e)},n.getYearClassNames=function(e){var t=n.props,r=t.date,a=t.minDate,o=t.maxDate,s=t.excludeDates,i=t.includeDates,l=t.filterDate,c=t.yearClassName;return Jl("react-datepicker__year-text","react-datepicker__year-".concat(e),r?null===c||void 0===c?void 0:c(ah(r,e)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(e),"react-datepicker__year-text--disabled":(a||o||s||i||l)&&Dm(e,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(e),"react-datepicker__year-text--range-start":n.isRangeStart(e),"react-datepicker__year-text--range-end":n.isRangeEnd(e),"react-datepicker__year-text--in-range":n.isInRange(e),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(e),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(e),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(e),"react-datepicker__year-text--today":n.isCurrentYear(e)})},n.getYearTabIndex=function(e){if(n.props.disabledKeyboardNavigation||null==n.props.preSelection)return"-1";var t=Au(n.props.preSelection),r=Dm(e,n.props);return e!==t||r?"-1":"0"},n.getYearContent=function(e){return n.props.renderYearContent?n.props.renderYearContent(e):e},n}return Hp(t,e),t.prototype.render=function(){var e=this,t=[],n=this.props,r=n.date,o=n.yearItemNumber,s=n.onYearMouseEnter,i=n.onYearMouseLeave;if(void 0===r)return null;for(var l=Hm(r,o),c=l.startPeriod,d=l.endPeriod,u=function(n){t.push(a.createElement("div",{ref:h.YEAR_REFS[n-c],onClick:function(t){e.onYearClick(t,n)},onKeyDown:function(t){Qm(t)&&(t.preventDefault(),t.key=Jp.Enter),e.onYearKeyDown(t,n)},tabIndex:Number(h.getYearTabIndex(n)),className:h.getYearClassNames(n),onMouseEnter:h.props.usePointerEvent?void 0:function(e){return s(e,n)},onPointerEnter:h.props.usePointerEvent?function(e){return s(e,n)}:void 0,onMouseLeave:h.props.usePointerEvent?void 0:function(e){return i(e,n)},onPointerLeave:h.props.usePointerEvent?function(e){return i(e,n)}:void 0,key:n,"aria-current":h.isCurrentYear(n)?"date":void 0},h.getYearContent(n)))},h=this,p=c;p<=d;p++)u(p);return a.createElement("div",{className:"react-datepicker__year"},a.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},t))},t}(a.Component);function ff(e,t,n,r){for(var a=[],o=0;o<2*t+1;o++){var s=e+t-o,i=!0;n&&(i=Au(n)<=s),r&&i&&(i=Au(r)>=s),i&&a.push(s)}return a}var gf=function(e){function t(t){var n=e.call(this,t)||this;n.renderOptions=function(){var e=n.props.year,t=n.state.yearsList.map((function(t){return a.createElement("div",{className:e===t?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:t,onClick:n.onChange.bind(n,t),"aria-selected":e===t?"true":void 0},e===t?a.createElement("span",{className:"react-datepicker__year-option--selected"},"\u2713"):"",t)})),r=n.props.minDate?Au(n.props.minDate):null,o=n.props.maxDate?Au(n.props.maxDate):null;return o&&n.state.yearsList.find((function(e){return e===o}))||t.unshift(a.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},a.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),r&&n.state.yearsList.find((function(e){return e===r}))||t.push(a.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},a.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),t},n.onChange=function(e){n.props.onChange(e)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(e){var t=n.state.yearsList.map((function(t){return t+e}));n.setState({yearsList:t})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var r=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,s=r||(o?10:5);return n.state={yearsList:ff(n.props.year,s,n.props.minDate,n.props.maxDate)},n.dropdownRef=(0,a.createRef)(),n}return Hp(t,e),t.prototype.componentDidMount=function(){var e=this.dropdownRef.current;if(e){var t=e.children?Array.from(e.children):null,n=t?t.find((function(e){return e.ariaSelected})):null;e.scrollTop=n&&n instanceof HTMLElement?n.offsetTop+(n.clientHeight-e.clientHeight)/2:(e.scrollHeight-e.clientHeight)/2}},t.prototype.render=function(){var e=Jl({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return a.createElement(Kp,{className:e,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(a.Component),vf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var e=t.props.minDate?Au(t.props.minDate):1900,n=t.props.maxDate?Au(t.props.maxDate):2100,r=[],o=e;o<=n;o++)r.push(a.createElement("option",{key:o,value:o},o));return r},t.onSelectChange=function(e){t.onChange(parseInt(e.target.value))},t.renderSelectMode=function(){return a.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(e){return a.createElement("div",{key:"read",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(e){return t.toggleDropdown(e)}},a.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),a.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return a.createElement(gf,qp({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var e=t.state.dropdownVisible,n=[t.renderReadView(!e)];return e&&n.unshift(t.renderDropdown()),n},t.onChange=function(e){t.toggleDropdown(),e!==t.props.year&&t.props.onChange(e)},t.toggleDropdown=function(e){t.setState({dropdownVisible:!t.state.dropdownVisible},(function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,e)}))},t.handleYearChange=function(e,n){var r;null===(r=t.onSelect)||void 0===r||r.call(t,e,n),t.setOpen()},t.onSelect=function(e,n){var r,a;null===(a=(r=t.props).onSelect)||void 0===a||a.call(r,e,n)},t.setOpen=function(){var e,n;null===(n=(e=t.props).setOpen)||void 0===n||n.call(e,!0)},t}return Hp(t,e),t.prototype.render=function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return a.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(a.Component),yf=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],bf=function(e){function t(n){var r=e.call(this,n)||this;return r.monthContainer=void 0,r.handleClickOutside=function(e){r.props.onClickOutside(e)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(e){var t,n;(function(e){var t=(e.className||"").split(/\s+/);return yf.some((function(e){return t.indexOf(e)>=0}))})(e.target)&&(null===(n=(t=r.props).onDropdownFocus)||void 0===n||n.call(t,e))},r.getDateInView=function(){var e=r.props,t=e.preSelection,n=e.selected,a=e.openToDate,o=Fm(r.props),s=zm(r.props),i=Xp(),l=a||n||t;return l||(o&&Wd(i,o)?o:s&&Zu(i,s)?s:i)},r.increaseMonth=function(){r.setState((function(e){return{date:$u(e.date,1)}}),(function(){return r.handleMonthChange(r.state.date)}))},r.decreaseMonth=function(){r.setState((function(e){return{date:Fu(e.date,1)}}),(function(){return r.handleMonthChange(r.state.date)}))},r.handleDayClick=function(e,t,n){r.props.onSelect(e,t,n),r.props.setPreSelection&&r.props.setPreSelection(e)},r.handleDayMouseEnter=function(e){r.setState({selectingDate:e}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(e)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(e,t){r.setState({selectingDate:ah(Xp(),t)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(e,t)},r.handleYearMouseLeave=function(e,t){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(e,t)},r.handleYearChange=function(e){var t,n,a,o;null===(n=(t=r.props).onYearChange)||void 0===n||n.call(t,e),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(e),null===(o=(a=r.props).setOpen)||void 0===o||o.call(a,!0)),r.props.setPreSelection&&r.props.setPreSelection(e)},r.getEnabledPreSelectionDateForMonth=function(e){if(!wm(e,r.props))return e;for(var t=sm(e),n=oh(um(e),t),a=null,o=0;o<=n;o++){var s=Cd(t,o);if(!wm(s,r.props)){a=s;break}}return a},r.handleMonthChange=function(e){var t,n,a,o=null!==(t=r.getEnabledPreSelectionDateForMonth(e))&&void 0!==t?t:e;r.handleCustomMonthChange(o),r.props.adjustDateOnChange&&(r.props.onSelect(o),null===(a=(n=r.props).setOpen)||void 0===a||a.call(n,!0)),r.props.setPreSelection&&r.props.setPreSelection(o)},r.handleCustomMonthChange=function(e){var t,n;null===(n=(t=r.props).onMonthChange)||void 0===n||n.call(t,e),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(e){r.handleYearChange(e),r.handleMonthChange(e)},r.changeYear=function(e){r.setState((function(t){return{date:ah(t.date,Number(e))}}),(function(){return r.handleYearChange(r.state.date)}))},r.changeMonth=function(e){r.setState((function(t){return{date:Du(t.date,Number(e))}}),(function(){return r.handleMonthChange(r.state.date)}))},r.changeMonthYear=function(e){r.setState((function(t){return{date:ah(Du(t.date,Pu(e)),Au(e))}}),(function(){return r.handleMonthYearChange(r.state.date)}))},r.header=function(e){void 0===e&&(e=r.state.date);var t=om(e,r.props.locale,r.props.calendarStartDay),n=[];return r.props.showWeekNumbers&&n.push(a.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),n.concat([0,1,2,3,4,5,6].map((function(e){var n=Cd(t,e),o=r.formatWeekday(n,r.props.locale),s=r.props.weekDayClassName?r.props.weekDayClassName(n):void 0;return a.createElement("div",{key:e,"aria-label":tm(n,"EEEE",r.props.locale),className:Jl("react-datepicker__day-name",s)},o)})))},r.formatWeekday=function(e,t){return r.props.formatWeekDay?function(e,t,n){return t(tm(e,"EEEE",n))}(e,r.props.formatWeekDay,t):r.props.useWeekdaysShort?function(e,t){return tm(e,"EEE",t)}(e,t):function(e,t){return tm(e,"EEEEEE",t)}(e,t)},r.decreaseYear=function(){r.setState((function(e){var n;return{date:Hu(e.date,r.props.showYearPicker?null!==(n=r.props.yearItemNumber)&&void 0!==n?n:t.defaultProps.yearItemNumber:1)}}),(function(){return r.handleYearChange(r.state.date)}))},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var e,n,o;if(!r.props.renderCustomHeader){var s,i=null!==(e=r.props.monthsShown)&&void 0!==e?e:t.defaultProps.monthsShown,l=r.props.showPreviousMonths?i-1:0,c=null!==(n=r.props.monthSelectedIn)&&void 0!==n?n:l,d=Fu(r.state.date,c);switch(!0){case r.props.showMonthYearPicker:s=Lm(r.state.date,r.props);break;case r.props.showYearPicker:s=function(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.yearItemNumber,o=void 0===a?12:a,s=Hm(im(Hu(e,o)),o).endPeriod,i=r&&Au(r);return i&&i>s||!1}(r.state.date,r.props);break;case r.props.showQuarterYearPicker:s=function(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,o=Uu(Yd(e),1);return r&&Wu(r,o)>0||a&&a.every((function(e){return Wu(e,o)>0}))||!1}(r.state.date,r.props);break;default:s=Mm(d,r.props)}if(((null!==(o=r.props.forceShowMonthNavigation)&&void 0!==o?o:t.defaultProps.forceShowMonthNavigation)||r.props.showDisabledMonthNavigation||!s)&&!r.props.showTimeSelectOnly){var u=["react-datepicker__navigation","react-datepicker__navigation--previous"],h=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(h=r.decreaseYear),s&&r.props.showDisabledMonthNavigation&&(u.push("react-datepicker__navigation--previous--disabled"),h=void 0);var p=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,m=r.props,f=m.previousMonthButtonLabel,g=void 0===f?t.defaultProps.previousMonthButtonLabel:f,v=m.previousYearButtonLabel,y=void 0===v?t.defaultProps.previousYearButtonLabel:v,b=r.props,x=b.previousMonthAriaLabel,_=void 0===x?"string"===typeof g?g:"Previous Month":x,w=b.previousYearAriaLabel,N=void 0===w?"string"===typeof y?y:"Previous Year":w;return a.createElement("button",{type:"button",className:u.join(" "),onClick:h,onKeyDown:r.props.handleOnKeyDown,"aria-label":p?N:_},a.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"].join(" ")},p?y:g))}}},r.increaseYear=function(){r.setState((function(e){var n;return{date:Vu(e.date,r.props.showYearPicker?null!==(n=r.props.yearItemNumber)&&void 0!==n?n:t.defaultProps.yearItemNumber:1)}}),(function(){return r.handleYearChange(r.state.date)}))},r.renderNextButton=function(){var e;if(!r.props.renderCustomHeader){var n;switch(!0){case r.props.showMonthYearPicker:n=$m(r.state.date,r.props);break;case r.props.showYearPicker:n=function(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.yearItemNumber,o=void 0===a?12:a,s=Hm(Vu(e,o),o).startPeriod,i=r&&Au(r);return i&&i<s||!1}(r.state.date,r.props);break;case r.props.showQuarterYearPicker:n=function(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,o=Bu(Iu(e),1);return r&&Wu(o,r)>0||a&&a.every((function(e){return Wu(o,e)>0}))||!1}(r.state.date,r.props);break;default:n=Om(r.state.date,r.props)}if(((null!==(e=r.props.forceShowMonthNavigation)&&void 0!==e?e:t.defaultProps.forceShowMonthNavigation)||r.props.showDisabledMonthNavigation||!n)&&!r.props.showTimeSelectOnly){var o=["react-datepicker__navigation","react-datepicker__navigation--next"];r.props.showTimeSelect&&o.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&o.push("react-datepicker__navigation--next--with-today-button");var s=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(s=r.increaseYear),n&&r.props.showDisabledMonthNavigation&&(o.push("react-datepicker__navigation--next--disabled"),s=void 0);var i=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,l=r.props,c=l.nextMonthButtonLabel,d=void 0===c?t.defaultProps.nextMonthButtonLabel:c,u=l.nextYearButtonLabel,h=void 0===u?t.defaultProps.nextYearButtonLabel:u,p=r.props,m=p.nextMonthAriaLabel,f=void 0===m?"string"===typeof d?d:"Next Month":m,g=p.nextYearAriaLabel,v=void 0===g?"string"===typeof h?h:"Next Year":g;return a.createElement("button",{type:"button",className:o.join(" "),onClick:s,onKeyDown:r.props.handleOnKeyDown,"aria-label":i?v:f},a.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"].join(" ")},i?h:d))}}},r.renderCurrentMonth=function(e){void 0===e&&(e=r.state.date);var t=["react-datepicker__current-month"];return r.props.showYearDropdown&&t.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&t.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&t.push("react-datepicker__current-month--hasMonthYearDropdown"),a.createElement("h2",{className:t.join(" ")},tm(e,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(e){if(void 0===e&&(e=!1),r.props.showYearDropdown&&!e)return a.createElement(vf,qp({},t.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:Au(r.state.date)}))},r.renderMonthDropdown=function(e){if(void 0===e&&(e=!1),r.props.showMonthDropdown&&!e)return a.createElement(cf,qp({},t.defaultProps,r.props,{month:Pu(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(e){if(void 0===e&&(e=!1),r.props.showMonthYearDropdown&&!e)return a.createElement(hf,qp({},t.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(e){r.props.onSelect(cm(),e),r.props.setPreSelection&&r.props.setPreSelection(cm())},r.renderTodayButton=function(){if(r.props.todayButton&&!r.props.showTimeSelectOnly)return a.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(e){var t=e.monthDate,n=e.i;return a.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(t),a.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(0!==n),r.renderMonthYearDropdown(0!==n),r.renderYearDropdown(0!==n)),a.createElement("div",{className:"react-datepicker__day-names"},r.header(t)))},r.renderCustomHeader=function(e){var t,n,o=e.monthDate,s=e.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var i=Mm(r.state.date,r.props),l=Om(r.state.date,r.props),c=Lm(r.state.date,r.props),d=$m(r.state.date,r.props),u=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return a.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},null===(n=(t=r.props).renderCustomHeader)||void 0===n?void 0:n.call(t,qp(qp({},r.state),{customHeaderCount:s,monthDate:o,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:i,nextMonthButtonDisabled:l,prevYearButtonDisabled:c,nextYearButtonDisabled:d})),u&&a.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderYearHeader=function(e){var n=e.monthDate,o=r.props,s=o.showYearPicker,i=o.yearItemNumber,l=Hm(n,void 0===i?t.defaultProps.yearItemNumber:i),c=l.startPeriod,d=l.endPeriod;return a.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},s?"".concat(c," - ").concat(d):Au(n))},r.renderHeader=function(e){var t=e.monthDate,n=e.i,a={monthDate:t,i:void 0===n?0:n};switch(!0){case void 0!==r.props.renderCustomHeader:return r.renderCustomHeader(a);case r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker:return r.renderYearHeader(a);default:return r.renderDefaultHeader(a)}},r.renderMonths=function(){var e,n;if(!r.props.showTimeSelectOnly&&!r.props.showYearPicker){for(var o=[],s=null!==(e=r.props.monthsShown)&&void 0!==e?e:t.defaultProps.monthsShown,i=r.props.showPreviousMonths?s-1:0,l=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Vu(r.state.date,i):Fu(r.state.date,i),c=null!==(n=r.props.monthSelectedIn)&&void 0!==n?n:i,d=0;d<s;++d){var u=d-c+i,h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Vu(l,u):$u(l,u),p="month-".concat(d),m=d<s-1,f=d>0;o.push(a.createElement("div",{key:p,ref:function(e){r.monthContainer=null!==e&&void 0!==e?e:void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:h,i:d}),a.createElement(sf,qp({},t.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:h,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:d,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:m,monthShowsDuplicateDaysStart:f}))))}return o}},r.renderYears=function(){if(!r.props.showTimeSelectOnly)return r.props.showYearPicker?a.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),a.createElement(mf,qp({},t.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave}))):void 0},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return a.createElement(pf,qp({},t.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var e=r.props.selected?new Date(r.props.selected):void 0,n=e&&em(e)&&Boolean(r.props.selected)?"".concat(Vm(e.getHours()),":").concat(Vm(e.getMinutes())):"";if(r.props.showTimeInput)return a.createElement(Gm,qp({},t.defaultProps,r.props,{date:e,timeString:n,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var e,n,o=Hm(r.state.date,null!==(e=r.props.yearItemNumber)&&void 0!==e?e:t.defaultProps.yearItemNumber),s=o.startPeriod,i=o.endPeriod;return n=r.props.showYearPicker?"".concat(s," - ").concat(i):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Au(r.state.date):"".concat(xm(Pu(r.state.date),r.props.locale)," ").concat(Au(r.state.date)),a.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&n)},r.renderChildren=function(){if(r.props.children)return a.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=(0,a.createRef)(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Hp(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:12}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){var e=this;this.props.showTimeSelect&&(this.assignMonthContainer=void e.setState({monthContainer:e.monthContainer}))},t.prototype.componentDidUpdate=function(e){var t=this;if(!this.props.preSelection||fm(this.props.preSelection,e.preSelection)&&this.props.monthSelectedIn===e.monthSelectedIn)this.props.openToDate&&!fm(this.props.openToDate,e.openToDate)&&this.setState({date:this.props.openToDate});else{var n=!pm(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},(function(){return n&&t.handleCustomMonthChange(t.state.date)}))}},t.prototype.render=function(){var e=this.props.container||Qp;return a.createElement(Kp,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},a.createElement("div",{style:{display:"contents"},ref:this.containerRef},a.createElement(e,{className:Jl("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},t}(a.Component),xf=function(e){var t=e.icon,n=e.className,r=void 0===n?"":n,o=e.onClick,s="react-datepicker__calendar-icon";if("string"===typeof t)return a.createElement("i",{className:"".concat(s," ").concat(t," ").concat(r),"aria-hidden":"true",onClick:o});if(a.isValidElement(t)){var i=t;return a.cloneElement(i,{className:"".concat(i.props.className||""," ").concat(s," ").concat(r),onClick:function(e){"function"===typeof i.props.onClick&&i.props.onClick(e),"function"===typeof o&&o(e)}})}return a.createElement("svg",{className:"".concat(s," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:o},a.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},_f=function(e){function t(t){var n=e.call(this,t)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return Hp(t,e),t.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},t.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},t.prototype.render=function(){return i.createPortal(this.props.children,this.el)},t}(a.Component),wf=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&-1!==e.tabIndex},Nf=function(e){function t(t){var n=e.call(this,t)||this;return n.getTabChildren=function(){var e;return Array.prototype.slice.call(null===(e=n.tabLoopRef.current)||void 0===e?void 0:e.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(wf)},n.handleFocusStart=function(){var e=n.getTabChildren();e&&e.length>1&&e[e.length-1].focus()},n.handleFocusEnd=function(){var e=n.getTabChildren();e&&e.length>1&&e[0].focus()},n.tabLoopRef=(0,a.createRef)(),n}return Hp(t,e),t.prototype.render=function(){var e;return(null!==(e=this.props.enableTabLoop)&&void 0!==e?e:t.defaultProps.enableTabLoop)?a.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},a.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,a.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},t.defaultProps={enableTabLoop:!0},t}(a.Component);var Ef,Sf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Hp(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this.props,n=e.className,r=e.wrapperClassName,o=e.hidePopper,s=void 0===o?t.defaultProps.hidePopper:o,i=e.popperComponent,l=e.targetComponent,c=e.enableTabLoop,d=e.popperOnKeyDown,u=e.portalId,h=e.portalHost,p=e.popperProps,m=e.showArrow,f=void 0;if(!s){var g=Jl("react-datepicker-popper",n);f=a.createElement(Nf,{enableTabLoop:c},a.createElement("div",{ref:p.refs.setFloating,style:p.floatingStyles,className:g,"data-placement":p.placement,onKeyDown:d},i,m&&a.createElement(Op,{ref:p.arrowRef,context:p.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(f=(0,a.createElement)(this.props.popperContainer,{},f)),u&&!s&&(f=a.createElement(_f,{portalId:u,portalHost:h},f));var v=Jl("react-datepicker-wrapper",r);return a.createElement(a.Fragment,null,a.createElement("div",{ref:p.refs.setReference,className:v},l),f)},t}(a.Component),jf=(Ef=Sf,function(e){var t,n,r,o="boolean"!==typeof e.hidePopper||e.hidePopper,s=(0,a.useRef)(null),i=Wp(qp({open:!o,whileElementsMounted:hp,placement:e.popperPlacement,middleware:Yp([(n={padding:15},{...mp(n),options:[n,r]}),Np(10),Ep({element:s})],null!==(t=e.popperModifiers)&&void 0!==t?t:[],!0)},e.popperProps)),l=qp(qp({},e),{hidePopper:o,popperProps:qp(qp({},i),{arrowRef:s})});return a.createElement(Ef,qp({},l))}),kf="react-datepicker-ignore-onclickoutside";var Cf="Date input not valid.",Df=function(e){function t(n){var r=e.call(this,n)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Xp()},r.modifyHolidays=function(){var e;return null===(e=r.props.holidays)||void 0===e?void 0:e.reduce((function(e,t){var n=new Date(t.date);return em(n)?Yp(Yp([],e,!0),[qp(qp({},t),{date:n})],!1):e}),[])},r.calcInitialState=function(){var e,t=r.getPreSelection(),n=Fm(r.props),a=zm(r.props),o=n&&Wd(t,am(n))?n:a&&Zu(t,dm(a))?a:t;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:null!==(e=r.props.selectsRange?r.props.startDate:r.props.selected)&&void 0!==e?e:o,highlightDates:Bm(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(qp(qp({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(qp(qp({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){"hidden"===document.visibilityState&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var e,t;null===(t=null===(e=r.input)||void 0===e?void 0:e.focus)||void 0===t||t.call(e,{preventScroll:!0})},r.setBlur=function(){var e,t;null===(t=null===(e=r.input)||void 0===e?void 0:e.blur)||void 0===t||t.call(e),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame((function(){r.setBlur()}))},r.setOpen=function(e,t){void 0===t&&(t=!1),r.setState({open:e,preSelection:e&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:Af},(function(){e||r.setState((function(e){return{focused:!!t&&e.focused}}),(function(){!t&&r.deferBlur(),r.setState({inputValue:null})}))}))},r.inputOk=function(){return Bd(r.state.preSelection)},r.isCalendarOpen=function(){return void 0===r.props.open?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(e){var t,n,a=r.state.wasHidden,o=!a||r.state.open;a&&r.resetHiddenStatus(),r.state.preventFocus||(null===(n=(t=r.props).onFocus)||void 0===n||n.call(t,e),!o||r.props.preventOpenOnFocus||r.props.readOnly||r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},(function(){r.preventFocusTimeout=setTimeout((function(){r.setFocus(),r.setState({preventFocus:!1})}))}))},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout((function(){return r.setFocus()}),1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(e){var t,n;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&(null===(n=(t=r.props).onBlur)||void 0===n||n.call(t,e)),r.state.open&&!1===r.props.open&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(e){var t,n;r.props.inline||r.setOpen(!1),null===(n=(t=r.props).onClickOutside)||void 0===n||n.call(t,e),r.props.withPortal&&e.preventDefault()},r.handleChange=function(){for(var e,n,a,o,s,i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];var c=i[0];if(!r.props.onChangeRaw||(r.props.onChangeRaw.apply(r,i),c&&"function"===typeof c.isDefaultPrevented&&!c.isDefaultPrevented())){r.setState({inputValue:(null===c||void 0===c?void 0:c.target)instanceof HTMLInputElement?c.target.value:null,lastPreSelectChange:Tf});var d=r.props,u=d.selectsRange,h=d.startDate,p=d.endDate,m=null!==(e=r.props.dateFormat)&&void 0!==e?e:t.defaultProps.dateFormat,f=null!==(n=r.props.strictParsing)&&void 0!==n?n:t.defaultProps.strictParsing,g=(null===c||void 0===c?void 0:c.target)instanceof HTMLInputElement?c.target.value:"";if(u){var v=g.split("-",2).map((function(e){return e.trim()})),y=v[0],b=v[1],x=Zp(null!==y&&void 0!==y?y:"",m,r.props.locale,f),_=Zp(null!==b&&void 0!==b?b:"",m,r.props.locale,f),w=(null===h||void 0===h?void 0:h.getTime())!==(null===x||void 0===x?void 0:x.getTime()),N=(null===p||void 0===p?void 0:p.getTime())!==(null===_||void 0===_?void 0:_.getTime());if(!w&&!N)return;if(x&&wm(x,r.props))return;if(_&&wm(_,r.props))return;null===(o=(a=r.props).onChange)||void 0===o||o.call(a,[x,_],c)}else{var E=Zp(g,m,r.props.locale,f,null!==(s=r.props.selected)&&void 0!==s?s:void 0);!E&&g||r.setSelected(E,c,!0)}}},r.handleSelect=function(e,t,n){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(t),r.setSelected(e,t,!1,n),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(e);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var a=r.props,o=a.startDate,s=a.endDate;!o||s||!r.props.swapRange&&Jm(e,o)||r.setOpen(!1)}},r.setSelected=function(e,t,n,a){var o,s,i=e;if(r.props.showYearPicker){if(null!==i&&Dm(Au(i),r.props))return}else if(r.props.showMonthYearPicker){if(null!==i&&Em(i,r.props))return}else if(null!==i&&wm(i,r.props))return;var l=r.props,c=l.onChange,d=l.selectsRange,u=l.startDate,h=l.endDate,p=l.selectsMultiple,m=l.selectedDates,f=l.minTime,g=l.swapRange;if(!gm(r.props.selected,i)||r.props.allowSameDay||d||p)if(null!==i&&(!r.props.selected||n&&(r.props.showTimeSelect||r.props.showTimeSelectOnly||r.props.showTimeInput)||(i=rm(i,{hour:Mu(r.props.selected),minute:Ou(r.props.selected),second:Lu(r.props.selected)})),n||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly||f&&(i=rm(i,{hour:f.getHours(),minute:f.getMinutes(),second:f.getSeconds()})),r.props.inline||r.setState({preSelection:i}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:a})),d){var v=u&&!h,y=u&&h;!u&&!h?null===c||void 0===c||c([i,null],t):v&&(null===i?null===c||void 0===c||c([null,null],t):Jm(i,u)?g?null===c||void 0===c||c([i,u],t):null===c||void 0===c||c([i,null],t):null===c||void 0===c||c([u,i],t)),y&&(null===c||void 0===c||c([i,null],t))}else if(p){if(null!==i)if(null===m||void 0===m?void 0:m.length)if(m.some((function(e){return fm(e,i)}))){var b=m.filter((function(e){return!fm(e,i)}));null===c||void 0===c||c(b,t)}else null===c||void 0===c||c(Yp(Yp([],m,!0),[i],!1),t);else null===c||void 0===c||c([i],t)}else null===c||void 0===c||c(i,t);n||(null===(s=(o=r.props).onSelect)||void 0===s||s.call(o,i,t),r.setState({inputValue:null}))},r.setPreSelection=function(e){var t=Bd(r.props.minDate),n=Bd(r.props.maxDate),a=!0;if(e){var o=am(e);if(t&&n)a=vm(e,r.props.minDate,r.props.maxDate);else if(t){var s=am(r.props.minDate);a=Zu(e,s)||gm(o,s)}else if(n){var i=dm(r.props.maxDate);a=Wd(e,i)||gm(o,i)}}a&&r.setState({preSelection:e})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(e){var t,n;if(!r.props.selectsRange&&!r.props.selectsMultiple){var a=r.props.selected?r.props.selected:r.getPreSelection(),o=r.props.selected?e:rm(a,{hour:Mu(e),minute:Ou(e)});r.setState({preSelection:o}),null===(n=(t=r.props).onChange)||void 0===n||n.call(t,o),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var e,t;r.props.disabled||r.props.readOnly||r.setOpen(!0),null===(t=(e=r.props).onInputClick)||void 0===t||t.call(e)},r.onInputKeyDown=function(e){var t,n,a,o,s,i;null===(n=(t=r.props).onKeyDown)||void 0===n||n.call(t,e);var l=e.key;if(r.state.open||r.props.inline||r.props.preventOpenOnFocus){if(r.state.open){if(l===Jp.ArrowDown||l===Jp.ArrowUp){e.preventDefault();var c=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',d=(null===(o=r.calendar)||void 0===o?void 0:o.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(c);return void(d instanceof HTMLElement&&d.focus({preventScroll:!0}))}var u=Xp(r.state.preSelection);l===Jp.Enter?(e.preventDefault(),e.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===Af?(r.handleSelect(u,e),!r.props.shouldCloseOnSelect&&r.setPreSelection(u)):r.setOpen(!1)):l===Jp.Escape?(e.preventDefault(),e.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):l===Jp.Tab&&r.setOpen(!1),r.inputOk()||null===(i=(s=r.props).onInputError)||void 0===i||i.call(s,{code:1,msg:Cf})}}else l!==Jp.ArrowDown&&l!==Jp.ArrowUp&&l!==Jp.Enter||null===(a=r.onInputClick)||void 0===a||a.call(r)},r.onPortalKeyDown=function(e){e.key===Jp.Escape&&(e.preventDefault(),r.setState({preventFocus:!0},(function(){r.setOpen(!1),setTimeout((function(){r.setFocus(),r.setState({preventFocus:!1})}))})))},r.onDayKeyDown=function(e){var t,n,a,o,s,i,l=r.props,c=l.minDate,d=l.maxDate,u=l.disabledKeyboardNavigation,h=l.showWeekPicker,p=l.shouldCloseOnSelect,m=l.locale,f=l.calendarStartDay,g=l.adjustDateOnChange,v=l.inline;if(null===(n=(t=r.props).onKeyDown)||void 0===n||n.call(t,e),!u){var y=e.key,b=e.shiftKey,x=Xp(r.state.preSelection),_=function(e,t){var n=t;switch(e){case Jp.ArrowRight:n=h?nh(t,1):Cd(t,1);break;case Jp.ArrowLeft:n=h?ih(t,1):lh(t,1);break;case Jp.ArrowUp:n=ih(t,1);break;case Jp.ArrowDown:n=nh(t,1);break;case Jp.PageUp:n=b?Hu(t,1):Fu(t,1);break;case Jp.PageDown:n=b?Vu(t,1):$u(t,1);break;case Jp.Home:n=om(t,m,f);break;case Jp.End:n=function(e){return xu(e)}(t)}return n};if(y===Jp.Enter)return e.preventDefault(),r.handleSelect(x,e),void(!p&&r.setPreSelection(x));if(y===Jp.Escape)return e.preventDefault(),r.setOpen(!1),void(r.inputOk()||null===(o=(a=r.props).onInputError)||void 0===o||o.call(a,{code:1,msg:Cf}));var w=null;switch(y){case Jp.ArrowLeft:case Jp.ArrowRight:case Jp.ArrowUp:case Jp.ArrowDown:case Jp.PageUp:case Jp.PageDown:case Jp.Home:case Jp.End:w=function(e,t){for(var n=e,a=!1,o=0,s=_(e,t);!a;){if(o>=40){s=t;break}c&&s<c&&(n=Jp.ArrowRight,s=wm(c,r.props)?_(n,s):c),d&&s>d&&(n=Jp.ArrowLeft,s=wm(d,r.props)?_(n,s):d),wm(s,r.props)?(n!==Jp.PageUp&&n!==Jp.Home||(n=Jp.ArrowRight),n!==Jp.PageDown&&n!==Jp.End||(n=Jp.ArrowLeft),s=_(n,s)):a=!0,o++}return s}(y,x)}if(w){if(e.preventDefault(),r.setState({lastPreSelectChange:Af}),g&&r.setSelected(w),r.setPreSelection(w),v){var N=Pu(x),E=Pu(w),S=Au(x),j=Au(w);N!==E||S!==j?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}else null===(i=(s=r.props).onInputError)||void 0===i||i.call(s,{code:1,msg:Cf})}},r.onPopperKeyDown=function(e){e.key===Jp.Escape&&(e.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(e){e&&e.preventDefault&&e.preventDefault(),r.sendFocusBackToInput();var t=r.props,n=t.selectsRange,a=t.onChange;n?null===a||void 0===a||a([null,null],e):null===a||void 0===a||a(null,e),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(e){"boolean"===typeof r.props.closeOnScroll&&r.props.closeOnScroll?e.target!==document&&e.target!==document.documentElement&&e.target!==document.body||r.setOpen(!1):"function"===typeof r.props.closeOnScroll&&r.props.closeOnScroll(e)&&r.setOpen(!1)},r.renderCalendar=function(){var e,n;return r.props.inline||r.isCalendarOpen()?a.createElement(bf,qp({showMonthYearDropdown:void 0,ref:function(e){r.calendar=e}},r.props,r.state,{setOpen:r.setOpen,dateFormat:null!==(e=r.props.dateFormatCalendar)&&void 0!==e?e:t.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:Um(r.modifyHolidays()),outsideClickIgnoreClass:kf,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:null!==(n=r.props.dropdownMode)&&void 0!==n?n:t.defaultProps.dropdownMode}),r.props.children):null},r.renderAriaLiveRegion=function(){var e,n=r.props,o=n.dateFormat,s=void 0===o?t.defaultProps.dateFormat:o,i=n.locale,l=r.props.showTimeInput||r.props.showTimeSelect?"PPPPp":"PPPP";return e=r.props.selectsRange?"Selected start date: ".concat(nm(r.props.startDate,{dateFormat:l,locale:i}),". ").concat(r.props.endDate?"End date: "+nm(r.props.endDate,{dateFormat:l,locale:i}):""):r.props.showTimeSelectOnly?"Selected time: ".concat(nm(r.props.selected,{dateFormat:s,locale:i})):r.props.showYearPicker?"Selected year: ".concat(nm(r.props.selected,{dateFormat:"yyyy",locale:i})):r.props.showMonthYearPicker?"Selected month: ".concat(nm(r.props.selected,{dateFormat:"MMMM yyyy",locale:i})):r.props.showQuarterYearPicker?"Selected quarter: ".concat(nm(r.props.selected,{dateFormat:"yyyy, QQQ",locale:i})):"Selected date: ".concat(nm(r.props.selected,{dateFormat:l,locale:i})),a.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},e)},r.renderDateInput=function(){var e,n,o,s=Jl(r.props.className,((e={})[kf]=r.state.open,e)),i=r.props.customInput||a.createElement("input",{type:"text"}),l=r.props.customInputRef||"ref",c=r.props,d=c.dateFormat,u=void 0===d?t.defaultProps.dateFormat:d,h=c.locale,p="string"===typeof r.props.value?r.props.value:"string"===typeof r.state.inputValue?r.state.inputValue:r.props.selectsRange?function(e,t,n){if(!e)return"";var r=nm(e,n),a=t?nm(t,n):"";return"".concat(r," - ").concat(a)}(r.props.startDate,r.props.endDate,{dateFormat:u,locale:h}):r.props.selectsMultiple?function(e,t){if(!(null===e||void 0===e?void 0:e.length))return"";var n=e[0]?nm(e[0],t):"";if(1===e.length)return n;if(2===e.length&&e[1]){var r=nm(e[1],t);return"".concat(n,", ").concat(r)}var a=e.length-1;return"".concat(n," (+").concat(a,")")}(null!==(o=r.props.selectedDates)&&void 0!==o?o:[],{dateFormat:u,locale:h}):nm(r.props.selected,{dateFormat:u,locale:h});return(0,a.cloneElement)(i,((n={})[l]=function(e){r.input=e},n.value=p,n.onBlur=r.handleBlur,n.onChange=r.handleChange,n.onClick=r.onInputClick,n.onFocus=r.handleFocus,n.onKeyDown=r.onInputKeyDown,n.id=r.props.id,n.name=r.props.name,n.form=r.props.form,n.autoFocus=r.props.autoFocus,n.placeholder=r.props.placeholderText,n.disabled=r.props.disabled,n.autoComplete=r.props.autoComplete,n.className=Jl(i.props.className,s),n.title=r.props.title,n.readOnly=r.props.readOnly,n.required=r.props.required,n.tabIndex=r.props.tabIndex,n["aria-describedby"]=r.props.ariaDescribedBy,n["aria-invalid"]=r.props.ariaInvalid,n["aria-labelledby"]=r.props.ariaLabelledBy,n["aria-required"]=r.props.ariaRequired,n))},r.renderClearButton=function(){var e=r.props,t=e.isClearable,n=e.disabled,o=e.selected,s=e.startDate,i=e.endDate,l=e.clearButtonTitle,c=e.clearButtonClassName,d=void 0===c?"":c,u=e.ariaLabelClose,h=void 0===u?"Close":u,p=e.selectedDates;return t&&(null!=o||null!=s||null!=i||(null===p||void 0===p?void 0:p.length))?a.createElement("button",{type:"button",className:Jl("react-datepicker__close-icon",d,{"react-datepicker__close-icon--disabled":n}),disabled:n,"aria-label":h,onClick:r.onClearClick,title:l,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Hp(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:12,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.componentDidUpdate=function(e,t){var n,r,a,o,s,i;e.inline&&(s=e.selected,i=this.props.selected,s&&i?Pu(s)!==Pu(i)||Au(s)!==Au(i):s!==i)&&this.setPreSelection(this.props.selected),void 0!==this.state.monthSelectedIn&&e.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),e.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:Bm(this.props.highlightDates)}),t.focused||gm(e.selected,this.props.selected)||this.setState({inputValue:null}),t.open!==this.state.open&&(!1===t.open&&!0===this.state.open&&(null===(r=(n=this.props).onCalendarOpen)||void 0===r||r.call(n)),!0===t.open&&!1===this.state.open&&(null===(o=(a=this.props).onCalendarClose)||void 0===o||o.call(a)))},t.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.renderInputContainer=function(){var e=this.props,t=e.showIcon,n=e.icon,r=e.calendarIconClassname,o=e.calendarIconClassName,s=e.toggleCalendarOnIconClick,i=this.state.open;return r&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),a.createElement("div",{className:"react-datepicker__input-container".concat(t?" react-datepicker__view-calendar-icon":"")},t&&a.createElement(xf,qp({icon:n,className:Jl(o,!o&&r,i&&"react-datepicker-ignore-onclickoutside")},s?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},t.prototype.render=function(){var e=this.renderCalendar();if(this.props.inline)return e;if(this.props.withPortal){var t=this.state.open?a.createElement(Nf,{enableTabLoop:this.props.enableTabLoop},a.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},e)):null;return this.state.open&&this.props.portalId&&(t=a.createElement(_f,qp({portalId:this.props.portalId},this.props),t)),a.createElement("div",null,this.renderInputContainer(),t)}return a.createElement(jf,qp({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:e,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},t}(a.Component),Tf="input",Af="navigate";const Pf={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 d\xeda",other:"{{count}} d\xedas"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 a\xf1o",other:"alrededor de {{count}} a\xf1os"},xYears:{one:"1 a\xf1o",other:"{{count}} a\xf1os"},overXYears:{one:"m\xe1s de 1 a\xf1o",other:"m\xe1s de {{count}} a\xf1os"},almostXYears:{one:"casi 1 a\xf1o",other:"casi {{count}} a\xf1os"}},If={date:uc({formats:{full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},defaultWidth:"full"}),time:uc({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:uc({formats:{full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Rf={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'ma\xf1ana a la' p",nextWeek:"eeee 'a la' p",other:"P"},Mf={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'ma\xf1ana a las' p",nextWeek:"eeee 'a las' p",other:"P"},Of={ordinalNumber:(e,t)=>Number(e)+"\xba",era:mc({values:{narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despu\xe9s de cristo"]},defaultWidth:"wide"}),quarter:mc({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1\xba trimestre","2\xba trimestre","3\xba trimestre","4\xba trimestre"]},defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:mc({values:{narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},defaultWidth:"wide"}),day:mc({values:{narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s\xe1"],abbreviated:["dom","lun","mar","mi\xe9","jue","vie","s\xe1b"],wide:["domingo","lunes","martes","mi\xe9rcoles","jueves","viernes","s\xe1bado"]},defaultWidth:"wide"}),dayPeriod:mc({values:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"ma\xf1ana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"ma\xf1ana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"ma\xf1ana",afternoon:"tarde",evening:"tarde",night:"noche"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la ma\xf1ana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la ma\xf1ana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la ma\xf1ana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},defaultFormattingWidth:"wide"})},Lf={ordinalNumber:vc({matchPattern:/^(\d+)(\xba)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:gc({matchPatterns:{narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u\xfa]n|despu[e\xe9]s de cristo|era com[u\xfa]n)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u\xfa]n)/i,/^(despu[e\xe9]s de cristo|era com[u\xfa]n)/i]},defaultParseWidth:"any"}),quarter:gc({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](\xba)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:gc({matchPatterns:{narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},defaultParseWidth:"any"}),day:gc({matchPatterns:{narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[\xe1a])/i,abbreviated:/^(dom|lun|mar|mi[\xe9e]|jue|vie|s[\xe1a]b)/i,wide:/^(domingo|lunes|martes|mi[\xe9e]rcoles|jueves|viernes|s[\xe1a]bado)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:gc({matchPatterns:{narrow:/^(a|p|mn|md|(de la|a las) (ma\xf1ana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (ma\xf1ana|tarde|noche))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/ma\xf1ana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},defaultParseWidth:"any"})},$f={code:"es",formatDistance:(e,t,n)=>{let r;const a=Pf[e];return r="string"===typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"en "+r:"hace "+r:r},formatLong:If,formatRelative:(e,t,n,r)=>1!==t.getHours()?Mf[e]:Rf[e],localize:Of,match:Lf,options:{weekStartsOn:1,firstWeekContainsDate:1}},Ff=e=>{let{onChange:t,initialOption:n="all"}=e;const[r,o]=(0,a.useState)(n),[s,i]=(0,a.useState)({startDate:null,endDate:null}),[l,c]=(0,a.useState)(!1),d=(0,a.useRef)(null);(0,a.useEffect)((()=>{function e(e){d.current&&!d.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const u=(0,a.useCallback)((e=>{const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case"today":return{startDate:n,endDate:n};case"thisWeek":{const e=t.getDay(),n=t.getDate()-e+(0===e?-6:1),r=new Date(t);r.setDate(n),r.setHours(0,0,0,0);const a=new Date(r);return a.setDate(r.getDate()+6),a.setHours(23,59,59,999),{startDate:r,endDate:a}}case"thisMonth":{const e=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()+1,0);return n.setHours(23,59,59,999),{startDate:e,endDate:n}}case"thisYear":{const e=new Date(t.getFullYear(),0,1),n=new Date(t.getFullYear(),11,31);return n.setHours(23,59,59,999),{startDate:e,endDate:n}}case"custom":return s;default:return{startDate:null,endDate:null}}}),[s]);(0,a.useEffect)((()=>{if("custom"!==r){const e=u(r);t(e)}else"custom"===r&&s.startDate&&s.endDate&&t(s)}),[r,t,u,s]);const h=e=>e?e.toLocaleDateString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit"}):"",p=e=>{if(console.log("DateRangeFilter: Option clicked:",e),o(e),"custom"!==e){const n=u(e);console.log("DateRangeFilter: Generated range for option",e,":",n),t(n),c(!1)}};return(0,$e.jsxs)("div",{className:"relative",ref:d,children:[(0,$e.jsxs)("button",{className:"flex items-center gap-2 btn btn-outline cursor-pointer",onClick:()=>c(!l),type:"button",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 9v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"})}),(0,$e.jsx)("span",{children:(()=>{switch(r){case"all":return"Todo el tiempo";case"today":return"Hoy";case"thisWeek":return"Esta semana";case"thisMonth":return"Este mes";case"thisYear":return"Este a\xf1o";case"custom":return s.startDate&&s.endDate?`${h(s.startDate)} - ${h(s.endDate)}`:"Rango personalizado";default:return"Seleccionar rango"}})()})]}),l&&(0,$e.jsxs)("div",{className:"absolute top-full left-0 mt-1 p-2 shadow bg-base-100 rounded-box z-50 w-full md:w-80 border border-gray-200",children:[(0,$e.jsxs)("ul",{className:"space-y-1",children:[(0,$e.jsx)("li",{children:(0,$e.jsx)("button",{className:"w-full text-left p-2 rounded hover:bg-gray-100 "+("all"===r?"bg-primary text-white hover:bg-primary-focus":""),onClick:()=>p("all"),type:"button",children:"Todo el tiempo"})}),(0,$e.jsx)("li",{children:(0,$e.jsx)("button",{className:"w-full text-left p-2 rounded hover:bg-gray-100 "+("today"===r?"bg-primary text-white hover:bg-primary-focus":""),onClick:()=>p("today"),type:"button",children:"Hoy"})}),(0,$e.jsx)("li",{children:(0,$e.jsx)("button",{className:"w-full text-left p-2 rounded hover:bg-gray-100 "+("thisWeek"===r?"bg-primary text-white hover:bg-primary-focus":""),onClick:()=>p("thisWeek"),type:"button",children:"Esta semana"})}),(0,$e.jsx)("li",{children:(0,$e.jsx)("button",{className:"w-full text-left p-2 rounded hover:bg-gray-100 "+("thisMonth"===r?"bg-primary text-white hover:bg-primary-focus":""),onClick:()=>p("thisMonth"),type:"button",children:"Este mes"})}),(0,$e.jsx)("li",{children:(0,$e.jsx)("button",{className:"w-full text-left p-2 rounded hover:bg-gray-100 "+("thisYear"===r?"bg-primary text-white hover:bg-primary-focus":""),onClick:()=>p("thisYear"),type:"button",children:"Este a\xf1o"})}),(0,$e.jsx)("li",{children:(0,$e.jsx)("button",{className:"w-full text-left p-2 rounded hover:bg-gray-100 "+("custom"===r?"bg-primary text-white hover:bg-primary-focus":""),onClick:()=>p("custom"),type:"button",children:"Rango personalizado"})})]}),"custom"===r&&(0,$e.jsx)("div",{className:"mt-3 p-2 border rounded",children:(0,$e.jsx)(Df,{selected:s.startDate,onChange:e=>{const[n,r]=e,a={startDate:n,endDate:r};i(a),n&&r&&(t(a),c(!1))},startDate:s.startDate,endDate:s.endDate,selectsRange:!0,inline:!0,locale:$f,monthsShown:1,dateFormat:"dd/MM/yyyy",fixedHeight:!0,className:"w-full"})})]})]})},zf=e=>{let{value:t,onChange:n,className:r=""}=e;return(0,$e.jsx)("div",{className:`flex rounded-lg overflow-hidden shadow-sm border border-gray-200 ${r}`,children:[{value:"day",label:"D\xeda"},{value:"week",label:"Semana"},{value:"month",label:"Mes"},{value:"year",label:"A\xf1o"}].map((e=>(0,$e.jsx)("button",{className:"px-3 py-1 text-sm font-medium "+(t===e.value?"bg-primary text-white":"bg-white text-gray-600 hover:bg-gray-100"),onClick:()=>n(e.value),"aria-pressed":t===e.value,children:e.label},e.value)))})},Bf="applications",Uf=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"applications",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(console.log("---------------------------------------------"),console.log(`EXECUTING QUERY TYPE: ${e} on table ${t}`),console.log("WITH FILTERS:",n),console.log("---------------------------------------------"),"applications"!==t.toLowerCase()){console.log(`Table is not applications, executing regular query for ${t}`);const{data:e,error:n}=await tt.ND.from(t).select("*");return n?(console.error("Error executing query:",n),[]):e||[]}let a,o=tt.ND.from("applications");if("COUNT"===e)a=o.select("*",{count:"exact",head:!0});else if("COUNT_DISTINCT_CLIENTS"===e)a=o.select("client_id",{count:"exact"}).limit(1e3);else if("COUNT_DISTINCT_COMPANIES"===e)a=o.select("company_id",{count:"exact"}).limit(1e3);else if("GROUP_BY_STATUS"===e){let e="status";n.advisorId&&!n.companyId?(e="advisor_status",console.log("Consulta por GROUP_BY_STATUS usando campo advisor_status")):!n.advisorId&&n.companyId?(e="company_status",console.log("Consulta por GROUP_BY_STATUS usando campo company_status")):(e="global_status",console.log("Consulta por GROUP_BY_STATUS usando campo global_status (default)")),a=o.select(`${e}`),console.log("Asegurando que no se use cach\xe9 para consulta GROUP_BY_STATUS")}else a="GROUP_BY_MONTH"===e?o.select("created_at"):"AMOUNT_RANGES"===e?o.select("amount"):"RECENT"===e?o.select("*"):"ATTENTION_NEEDED"===e?o.select("*").not("status","in",'("rejected","completed")').lt("updated_at",new Date(Date.now()-1728e5).toISOString()):o.select("*");if(!1!==n.applicationTypeFilter&&(a=a.eq("application_type","selected_plans"),console.log("\u2705 Applied MANDATORY application_type = selected_plans filter")),n.advisorId?(a=a.eq("assigned_to",n.advisorId),console.log(`\u2705 Applied advisor filter: assigned_to = ${n.advisorId}`)):console.warn("\u26a0\ufe0f NO ADVISOR FILTER APPLIED - this might return applications from all advisors"),n.companyId?(a=a.eq("company_id",n.companyId),console.log(`\u2705 Applied company filter: company_id = ${n.companyId}`)):console.warn("\u26a0\ufe0f NO COMPANY FILTER APPLIED - this might return applications from all companies"),n.startDate&&""!==n.startDate.trim()){const e=new Date(n.startDate);if(isNaN(e.getTime()))console.warn(`\u26a0\ufe0f Invalid start date format: ${n.startDate}`);else{const t=e.toISOString().split("T")[0];a=a.gte("created_at",t),console.log(`\u2705 Applied start date filter: created_at >= ${t}`)}}if(n.endDate&&""!==n.endDate.trim()){const e=new Date(n.endDate);if(isNaN(e.getTime()))console.warn(`\u26a0\ufe0f Invalid end date format: ${n.endDate}`);else{e.setHours(23,59,59,999);const t=e.toISOString();a=a.lte("created_at",t),console.log(`\u2705 Applied end date filter: created_at <= ${t}`)}}n.status&&(a=a.eq("status",n.status),console.log(`Applied status filter: status = ${n.status}`)),void 0!==n.approvedByAdvisor&&(a=a.eq("approved_by_advisor",n.approvedByAdvisor),console.log(`Applied approved_by_advisor filter: ${n.approvedByAdvisor}`)),n.orderBy&&(a=a.order(n.orderBy.column,{ascending:n.orderBy.ascending}),console.log(`Applied ordering by ${n.orderBy.column} ${n.orderBy.ascending?"ASC":"DESC"}`)),n.limit&&(a=a.limit(n.limit),console.log(`Applied limit: ${n.limit}`));const{data:s,error:i,count:l}=await a;if(i)return console.error("Error executing Supabase query:",i),[];var r;if(console.log(`Query returned ${(null===s||void 0===s?void 0:s.length)||0} results. Count: ${l||"N/A"}`),s&&s.length>0&&s.forEach((e=>{void 0!==e.credito_solicitado&&null!==e.credito_solicitado?e.amount=parseFloat(e.credito_solicitado):"string"===typeof e.amount&&(e.amount=parseFloat(e.amount))})),"COUNT"===e||"COUNT_DISTINCT_CLIENTS"===e||"COUNT_DISTINCT_COMPANIES"===e)return[{total:null!==(r=null!==l&&void 0!==l?l:null===s||void 0===s?void 0:s.length)&&void 0!==r?r:0}];if("GROUP_BY_STATUS"===e){let e="status";e=n.advisorId&&!n.companyId?"advisor_status":!n.advisorId&&n.companyId?"company_status":"global_status";const t={};return null===s||void 0===s||s.forEach((n=>{const r=n[e]||"unknown";t[r]=(t[r]||0)+1})),console.log(`GROUP_BY_STATUS usando campo ${e} - resultados:`,t),Object.entries(t).map((e=>{let[t,n]=e;return{status:t,count:n}}))}if("GROUP_BY_MONTH"===e){const e={},t={};(new Date).toISOString().split("T")[0];null===s||void 0===s||s.forEach((n=>{const r=new Date(n.created_at),a=r.toISOString().substring(0,7);e[a]=(e[a]||0)+1;const o=r.toISOString().split("T")[0];t[o]=(t[o]||0)+1}));const n=Object.entries(e).map((e=>{let[n,r]=e;return{month:n,count:r,daily:Object.entries(t).filter((e=>{let[t]=e;return t.startsWith(n)})).map((e=>{let[t,n]=e;return{date:t,count:n}}))}})).sort(((e,t)=>e.month.localeCompare(t.month)));return console.log(`Month distribution results (${n.length} months):`,n),n}if("AMOUNT_RANGES"===e){const e={"0-10000":0,"10001-25000":0,"25001-50000":0,"50001-75000":0,"75001-100000":0};if(console.log(`Processing AMOUNT_RANGES with ${(null===s||void 0===s?void 0:s.length)||0} items`),!s||0===s.length)return console.log("No data returned for AMOUNT_RANGES query"),Object.entries(e).map((e=>{let[t,n]=e;return{range:t,count:n}}));s&&s.length>0&&console.log("AMOUNT_RANGES sample data:",{first:s[0],hasAmountField:"amount"in s[0],amountValue:s[0].amount,amountType:typeof s[0].amount}),null===s||void 0===s||s.forEach((t=>{const n=Number(t.amount)||0;n<=1e4?e["0-10000"]++:n<=25e3?e["10001-25000"]++:n<=5e4?e["25001-50000"]++:n<=75e3?e["50001-75000"]++:n<=1e5&&e["75001-100000"]++})),console.log("AMOUNT_RANGES distribution after processing:",e);const t=Object.entries(e).filter((e=>{let[t,n]=e;return n>0})).map((e=>{let[t,n]=e;return{range:t,count:n}}));return console.log(`AMOUNT_RANGES final result (${t.length} ranges):`,t),t}return s||[]}catch(a){return console.error("Error in executeQuery:",a),"COUNT"===e||"COUNT_DISTINCT_CLIENTS"===e||"COUNT_DISTINCT_COMPANIES"===e?[{total:0}]:[]}},Wf=e=>{const t=e.toLowerCase(),n=Object.keys(wt).find((e=>wt[e].toLowerCase()===t));return n?Nt[wt[n]]:e},Vf=e=>{const t=e.toLowerCase(),n=Object.keys(wt).find((e=>wt[e].toLowerCase()===t));if(!n)return"ghost";return Et[wt[n]]||"ghost"},Hf=()=>{const e=ne(),{user:t}=We(),[n,r]=(0,a.useState)(!0),[o,s]=(0,a.useState)(null),[i,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)("all"),[p,m]=(0,a.useState)({startDate:"",endDate:"",advisorId:"",companyId:""}),[f,g]=(0,a.useState)(0),[v,y]=(0,a.useState)("week"),b=e=>(console.log("Checking if stats is AdvisorStats"),e&&"advisorId"in e&&"string"===typeof e.advisorId&&"conversionRate"in e),x=(0,a.useCallback)((async()=>{try{if(r(!0),console.log("Loading dashboard stats..."),console.log("Current user:",t),!t)return console.log("No user found, returning early"),void r(!1);let h=null;const m={startDate:p.startDate||void 0,endDate:p.endDate||void 0,advisorId:p.advisorId||void 0,companyId:p.companyId||void 0};if(t.role===Me)m.advisorId=t.id,console.log("Applied advisor filter for advisor role:",t.id);else if(t.role===Oe){if(!t.entityId)return console.error("Company admin user has no entityId (company_id)"),l("Error: Administrador de empresa sin ID de empresa"),void r(!1);m.companyId=t.entityId,console.log("Applied company filter for company admin role:",t.entityId)}if(console.log("Using query filters:",m),t.role===Re)console.log("Loading stats for SUPERADMIN"),h=await(async e=>{try{var t,n,r;console.log("====================================================="),console.log("GENERAL DASHBOARD STATS"),console.log("====================================================="),console.log("Filters applied:",JSON.stringify(e,null,2)),console.log("Fetching total applications...");const a=await Uf("COUNT","applications",e),o=parseInt(String(null===(t=a[0])||void 0===t?void 0:t.total)||"0");console.log(`Total applications: ${o}`),console.log("Fetching applications by status...");const s=await Uf("GROUP_BY_STATUS","applications",e),i={};s.forEach((e=>{i[e.status]=e.count}));const l=i.pending||i.Solicitud||i.new||0,c=i.approved||0,d=i.por_dispersar||0,u=i.completed||0,h=i.rejected||0,p=c+d+u;console.log("Fetching applications by month...");const m=await Uf("GROUP_BY_MONTH","applications",e);console.log("Fetching recent applications...");const f=await Uf("RECENT","applications",{...e,orderBy:{column:"created_at",ascending:!1},limit:10});console.log("Fetching unique clients...");const g=await Uf("COUNT_DISTINCT_CLIENTS","applications",e),v=parseInt(String(null===(n=g[0])||void 0===n?void 0:n.total)||"0");console.log("Fetching unique companies...");const y=await Uf("COUNT_DISTINCT_COMPANIES","applications",e),b=parseInt(String(null===(r=y[0])||void 0===r?void 0:r.total)||"0");console.log("Fetching amount ranges...");const x=await Uf("AMOUNT_RANGES","applications",e);console.log("Calculating total and average amounts for approved applications...");const _=await Uf("RECENT","applications",{...e,limit:1e3});let w=0,N=0;_.forEach((e=>{const t=(e.status||"").toLowerCase();if(("approved"===t||"por_dispersar"===t||"completed"===t)&&e.amount){const t="number"===typeof e.amount?e.amount:parseFloat(e.amount);isNaN(t)||(w+=t,N++)}}));const E=N>0?w/N:0;console.log(`Total amount for approved applications: ${w}`),console.log(`Average amount for approved applications: ${E}`);const S=s.map((e=>{const t=e.status.toLowerCase();let n=e.status;return t.includes("pend")||"solicitud"===t||"new"===t||"nuevo"===t?n="Nuevo":t.includes("review")||t.includes("revis")?n="En Revisi\xf3n":t.includes("aprob")||t.includes("aprov")||t.includes("approv")?n="Aprobado":t.includes("recha")||t.includes("reject")?n="Rechazado":t.includes("comple")?n="Completado":t.includes("dispers")&&(n="Por Dispersar"),{status:n,count:e.count}})),j=o>0?N/o*100:0;console.log("Fetching applications needing attention...");const k=await Uf("ATTENTION_NEEDED","applications",e),C=(null===k||void 0===k?void 0:k.length)||0;return{totalApplications:o,pendingApplications:l,approvedApplications:p,rejectedApplications:h,applicationsByStatus:s,applicationsByStatusChart:S,applicationsByMonth:m,recentApplications:f,totalClients:v,totalCompanies:b,totalAmount:w,avgAmount:E,conversionRate:j,amountRanges:x,attentionNeededCount:C}}catch(i){throw console.error("Error getting general dashboard stats:",i),i}})(m);else if(t.role===Me){var e,n,a;if(console.log("Loading stats for ADVISOR with ID:",t.id),!t.id)return console.error("Advisor user has no ID"),l("Error: Asesor sin ID"),void r(!1);h=await(async(e,t)=>{try{var n;if(console.log("====================================================="),console.log(`ADVISOR DASHBOARD STATS - Advisor ID: ${e}`),console.log("====================================================="),console.log("Filters:",JSON.stringify(t,null,2)),console.log("Advisor ID check:",{advisorId:e,type:typeof e,hasValue:!!e}),!e)throw console.error("ERROR: No advisor ID provided to getAdvisorStats"),new Error("Advisor ID is required for advisor stats");const r={advisorId:e,...t};console.log(`SQL base filter with advisor: ${e} and company: ${t.companyId||"none"}`),console.log("Fetching total applications...");const a=await Uf("COUNT","applications",r),o=parseInt(String(null===(n=a[0])||void 0===n?void 0:n.total)||"0");console.log(`Total applications for advisor ${e}: ${o}`),console.log("Fetching applications by status...");const s=await Uf("GROUP_BY_STATUS","applications",r),i={},l=[];s&&Array.isArray(s)&&s.forEach((e=>{if(!e)return;const t=e.status||"unknown";let n=0;"number"===typeof e.count?n=e.count:"string"===typeof e.count?n=parseInt(e.count,10)||0:e.count&&(n=parseInt(String(e.count),10)||0),i[t]=n,l.push({status:t,count:n})}));const c=i.approved||0,d=i.rejected||0,u=i.pending||i.Solicitud||i.new||0,h=c+(i.por_dispersar||0)+(i.completed||0);console.log("Calculating total and average amounts for approved applications...");const p=await Uf("RECENT","applications",{...r,limit:1e3});let m=0,f=0;p.forEach((e=>{const t=(e.status||"").toLowerCase();if(("approved"===t||"por_dispersar"===t||"completed"===t)&&e.amount){const t="number"===typeof e.amount?e.amount:parseFloat(e.amount);isNaN(t)||(m+=t,f++)}}));const g=f>0?m/f:0;console.log(`Total amount for approved applications: ${m}`),console.log(`Average amount for approved applications: ${g}`),console.log("Fetching recent applications...");const v=await Uf("RECENT","applications",{...r,orderBy:{column:"created_at",ascending:!1},limit:10});console.log("Fetching applications by month...");const y=await Uf("GROUP_BY_MONTH","applications",r);console.log("Calculating total unique clients for advisor...");const{data:b,error:x,count:_}=await tt.ND.from("applications").select("client_id",{count:"exact"}).eq("assigned_to",e).not("client_id","is",null);x&&console.error("Error counting unique clients for advisor:",x);const w=new Set;null===b||void 0===b||b.forEach((e=>{e.client_id&&w.add(e.client_id)}));const N=w.size;console.log(`Total unique clients for advisor ${e}: ${N}`),await Uf("COUNT_DISTINCT_COMPANIES","applications",r);const E=o>0?f/o*100:0;console.log("Fetching amount ranges for advisor...");const S={...t,status:void 0},j=await Uf("AMOUNT_RANGES","applications",S);console.log("Amount ranges query result for advisor:",JSON.stringify(j,null,2));let k=j;Array.isArray(j)&&0!==j.length||(console.log("No amount ranges data returned for advisor, creating default distribution"),k=[{range:"0-10000",count:0},{range:"10001-25000",count:0},{range:"25001-50000",count:0},{range:"50001-75000",count:0},{range:"75001-100000",count:0}]);const C=l.map((e=>{const t=e.status.toLowerCase();let n=e.status;return t.includes("pend")||"solicitud"===t||"new"===t||"nuevo"===t?n="Nuevo":t.includes("review")||t.includes("revis")?n="En Revisi\xf3n":t.includes("aprob")||t.includes("aprov")||t.includes("approv")?n="Aprobado":t.includes("recha")||t.includes("reject")?n="Rechazado":t.includes("comple")?n="Completado":t.includes("dispers")&&(n="Por Dispersar"),{status:n,count:e.count}}));console.log("Fetching applications needing attention for advisor...");const D=await Uf("ATTENTION_NEEDED","applications",r),T=(null===D||void 0===D?void 0:D.length)||0,A={applicationId:"",advisorId:e,totalApplications:o,pendingApplications:u,approvedApplications:h,rejectedApplications:d,totalAmount:m,avgAmount:g,applicationsByStatus:l,applicationsByStatusChart:C,applicationsByMonth:y,recentApplications:v,totalClients:N,conversionRate:E,amountRanges:k,attentionNeededCount:T};return console.log("Successfully compiled advisor dashboard stats"),A}catch(i){throw console.error("Error getting advisor stats:",i),i}})(t.id,m),console.log("ADVISOR stats loaded:",{totalApplications:null===(e=h)||void 0===e?void 0:e.totalApplications,approvedApplications:null===(n=h)||void 0===n?void 0:n.approvedApplications,applicationsByStatus:null===(a=h)||void 0===a?void 0:a.applicationsByStatus})}else if(t.role===Oe){var o,c,d;if(console.log("Loading stats for COMPANY_ADMIN with entity ID:",t.entityId),!t.entityId)return console.error("Company admin user has no entityId (company_id) - already checked above"),void r(!1);h=await(async(e,t)=>{try{var n,r;if(console.log("====================================================="),console.log(`COMPANY DASHBOARD STATS - Company ID: ${e}`),console.log("====================================================="),console.log("Filters:",JSON.stringify(t,null,2)),!e)throw console.error("ERROR: No company ID provided to getCompanyDashboardStats"),new Error("Company ID is required for company dashboard stats");const s={companyId:e,...t};console.log(`Company filter applied: ${e}`),console.log("Fetching total applications...");const i=await Uf("COUNT","applications",s),l=parseInt(String(null===(n=i[0])||void 0===n?void 0:n.total)||"0");console.log(`Total applications for company ${e}: ${l}`),console.log("Fetching applications by status...");const c=await Uf("GROUP_BY_STATUS","applications",s),d={};c.forEach((e=>{d[e.status]=e.count}));const u=d.pending||d.Solicitud||d.new||0,h=d.approved||0,p=d.por_dispersar||0,m=d.completed||0,f=d.rejected||0,g=h+p+m;console.log("Fetching applications by month...");const v=await Uf("GROUP_BY_MONTH","applications",s);console.log("Fetching recent applications...");const y=await Uf("RECENT","applications",{...s,orderBy:{column:"created_at",ascending:!1},limit:10});console.log("Fetching total users affiliated with this company...");const{data:b,error:x,count:_}=await tt.ND.from("users").select("*",{count:"exact",head:!0}).eq("company_id",e);x&&console.error("Error fetching users count:",x);const w=_||0;console.log(`Total users (clients) affiliated with company ${e}: ${w}`),console.log("Calculating total and average amounts for approved applications...");const N=await Uf("RECENT","applications",{...s,limit:1e3});let E=0,S=0;N.forEach((e=>{const t=(e.status||"").toLowerCase();if(("approved"===t||"por_dispersar"===t||"completed"===t)&&e.amount){const t="number"===typeof e.amount?e.amount:parseFloat(e.amount);isNaN(t)||(E+=t,S++)}}));const j=S>0?E/S:0;console.log(`Total amount for approved applications: ${E}`),console.log(`Average amount for approved applications: ${j}`),console.log("Fetching amount ranges..."),console.log("Using query filters for AMOUNT_RANGES:",JSON.stringify(s,null,2));const k={...s,status:void 0},C=await Uf("AMOUNT_RANGES","applications",k);console.log("Amount ranges query result:",JSON.stringify(C,null,2));let D=C;Array.isArray(C)&&0!==C.length||(console.log("No amount ranges data returned, creating default distribution"),D=[{range:"0-10000",count:0},{range:"10001-25000",count:0},{range:"25001-50000",count:0},{range:"50001-75000",count:0},{range:"75001-100000",count:0}]);const T=c.map((e=>{const t=e.status.toLowerCase();let n=e.status;return t.includes("pend")||"solicitud"===t||"new"===t||"nuevo"===t?n="Nuevo":t.includes("review")||t.includes("revis")?n="En Revisi\xf3n":t.includes("aprob")||t.includes("aprov")||t.includes("approv")?n="Aprobado":t.includes("recha")||t.includes("reject")?n="Rechazado":t.includes("comple")?n="Completado":t.includes("dispers")&&(n="Por Dispersar"),{status:n,count:e.count}}));console.log("Fetching advisors count...");const A=await Uf("COUNT","advisors",{companyId:e}),P=parseInt(String(null===(r=A[0])||void 0===r?void 0:r.total)||"0");console.log("Calculating average approval time...");const I=`\n      SELECT AVG(\n        EXTRACT(EPOCH FROM (approval_date_company - created_at)) / 86400\n      ) as avg_days\n      FROM ${Bf} \n      WHERE company_id = '${e}'\n      AND approval_date_company IS NOT NULL\n      ${t.startDate?`AND created_at >= '${t.startDate}'`:""}\n      ${t.endDate?`AND created_at <= '${t.endDate}'`:""}\n      AND application_type = 'selected_plans'\n    `,R=await tt.ND.rpc("execute_sql",{query:I});let M=0;var a,o;R.error?console.error("Error calculating average approval time:",R.error):(M=parseFloat((null===(a=R.data)||void 0===a||null===(o=a[0])||void 0===o?void 0:o.avg_days)||"0"),console.log(`Average approval time: ${M} days`)),console.log("Fetching applications needing attention for company...");const O=await Uf("ATTENTION_NEEDED","applications",s),L=(null===O||void 0===O?void 0:O.length)||0,$={totalApplications:l,pendingApplications:u,approvedApplications:g,rejectedApplications:f,totalAmount:E,avgAmount:j,applicationsByStatus:c,applicationsByStatusChart:T,applicationsByMonth:v,recentApplications:y,totalClients:w,totalAdvisors:P,avgApprovalTime:M,advisorPerformance:[],companyId:e,amountRanges:D,attentionNeededCount:L};return console.log("Successfully compiled company dashboard stats"),console.log("Amount ranges in result:",JSON.stringify($.amountRanges,null,2)),$}catch(i){throw console.error("Error getting company dashboard stats:",i),i}})(t.entityId,m),console.log("COMPANY_ADMIN stats loaded:",{totalApplications:null===(o=h)||void 0===o?void 0:o.totalApplications,approvedApplications:null===(c=h)||void 0===c?void 0:c.approvedApplications,applicationsByStatus:null===(d=h)||void 0===d?void 0:d.applicationsByStatus})}console.log("Received dashboard stats:",h),h&&"applicationsByStatus"in h&&console.log("Applications by status:",h.applicationsByStatus),h&&"applicationsByMonth"in h&&console.log("Applications by month:",h.applicationsByMonth),h&&console.log("Verification - Dashboard total stats:",{totalApplications:h.totalApplications,byStatus:h.applicationsByStatus?Array.isArray(h.applicationsByStatus)?h.applicationsByStatus.reduce(((e,t)=>e+t.count),0):Object.values(h.applicationsByStatus).reduce(((e,t)=>e+t),0):0});try{if((t.role===Me||t.role===Oe)&&t.id){console.log("Fetching pending approvals for user:",t.id,"isCompanyAdmin:",t.role===Oe);const e=await(async(e,t)=>{try{var n;let r="";r=t?`\n        SELECT COUNT(*) as pending_count\n        FROM ${Bf}\n        WHERE company_id = '${e}'\n        AND approved_by_company = false\n      `:`\n        SELECT COUNT(*) as pending_count\n        FROM ${Bf}\n        WHERE assigned_to = '${e}'\n        AND approved_by_advisor = false\n      `;const a=await Uf(r),o=parseInt((null===(n=a[0])||void 0===n?void 0:n.pending_count)||"0"),s=`\n      SELECT *\n      FROM ${Bf}\n      WHERE ${t?"company_id":"assigned_to"} = '${e}'\n      AND ${t?"approved_by_company = false":"approved_by_advisor = false"}\n    `;return{totalPending:o,pendingApplications:(await Uf(s)).map((e=>({...e,approval_date_company:e.approval_date_company?new Date(e.approval_date_company).toISOString():null,approval_date_advisor:e.approval_date_advisor?new Date(e.approval_date_advisor).toISOString():null})))}}catch(i){throw console.error("Error al obtener estad\xedsticas de aprobaciones pendientes:",i),i}})(t.role===Oe&&t.entityId||t.id,t.role===Oe);console.log("Pending approvals data:",e),g(e.totalPending)}}catch(u){console.error("Error fetching pending approvals:",u)}s(h)}catch(i){console.error("Error loading dashboard stats:",i),l("Error al cargar las estad\xedsticas del dashboard")}finally{r(!1)}}),[t,p]);(0,a.useEffect)((()=>{x(),console.log("Refreshing stats with dateRangeOption:",u)}),[t,p,x,u]),(0,a.useEffect)((()=>{const e=()=>{"visible"===document.visibilityState&&(console.log("Dashboard visible, recargando estad\xedsticas..."),x())};document.addEventListener("visibilitychange",e);const t=setInterval((()=>{console.log("Refresco peri\xf3dico del dashboard..."),x()}),12e4);return()=>{document.removeEventListener("visibilitychange",e),clearInterval(t)}}),[x]);const _=e=>_t[e]||e;(0,a.useEffect)((()=>{o&&console.log("Dashboard rendering with stats:",{totalApplications:o.totalApplications,pendingApplications:o.pendingApplications,approvedApplications:o.approvedApplications,rejectedApplications:o.rejectedApplications,applicationsByStatus:o.applicationsByStatus,applicationsByStatusType:Array.isArray(o.applicationsByStatus)?"array":typeof o.applicationsByStatus})}),[o]);const w=()=>{e("/applications")};return n?(console.log("Dashboard is in loading state"),(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"flex justify-center items-center h-full p-8",children:(0,$e.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})})})})):i?(console.log("Dashboard has error:",i),(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"p-8",children:(0,$e.jsx)("div",{className:"alert alert-error",children:(0,$e.jsx)("span",{children:i})})})})):o?(b(o)&&console.log("Rendering advisor dashboard with data:",{totalApplications:o.totalApplications,approvedApplications:o.approvedApplications,applicationsByStatus:o.applicationsByStatus}),(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6 space-y-6",children:[(0,$e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[(0,$e.jsxs)("div",{className:"flex items-center",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Dashboard"}),(0,$e.jsx)("div",{className:"badge badge-primary ml-3 mb-6",children:"Solo Planes Seleccionados"})]}),(0,$e.jsx)("div",{className:"mb-6 w-full sm:w-auto",children:(0,$e.jsx)(Ff,{onChange:e=>{console.log("Date range changed:",e),console.log("Current user role:",null===t||void 0===t?void 0:t.role);const n=e.startDate?e.startDate.toISOString().split("T")[0]:"",r=e.endDate?e.endDate.toISOString().split("T")[0]:"";console.log("Converting to date strings:",{startDate:n,endDate:r,currentStartDate:p.startDate,currentEndDate:p.endDate});let a="all";if(e.startDate||e.endDate){if(e.startDate&&e.endDate){const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59),o=t.getDay(),s=t.getDate()-o+(0===o?-6:1),i=new Date(t);i.setDate(s),i.setHours(0,0,0,0);const l=new Date(i);l.setDate(i.getDate()+6),l.setHours(23,59,59,999);const c=new Date(t.getFullYear(),t.getMonth(),1),d=new Date(t.getFullYear(),t.getMonth()+1,0,23,59,59),u=new Date(t.getFullYear(),0,1),h=new Date(t.getFullYear(),11,31,23,59,59),p=e.startDate.getTime(),m=e.endDate.getTime();console.log("Date comparisons:",{startTime:p,endTime:m,todayStart:n.getTime(),todayEnd:r.getTime(),weekStart:i.getTime(),weekEnd:l.getTime(),monthStart:c.getTime(),monthEnd:d.getTime(),yearStart:u.getTime(),yearEnd:h.getTime()}),p===n.getTime()&&m===r.getTime()?(console.log('Setting date option to "today"'),a="today"):p===i.getTime()&&m===l.getTime()?(console.log('Setting date option to "thisWeek"'),a="thisWeek"):p===c.getTime()&&m===d.getTime()?(console.log('Setting date option to "thisMonth"'),a="thisMonth"):p===u.getTime()&&m===h.getTime()?(console.log('Setting date option to "thisYear"'),a="thisYear"):(console.log('Setting date option to "custom"'),a="custom")}}else console.log('Setting date option to "all"'),a="all";console.log("Updating dateRangeOption from",u,"to",a),h(a),n!==p.startDate||r!==p.endDate?(console.log("Date range differs from current filters, updating..."),m((e=>({...e,startDate:n,endDate:r})))):console.log("Date range is the same as current filters, but still updating dateRangeOption")},initialOption:u})})]}),c&&(0,$e.jsx)("div",{className:"alert alert-warning mb-4",children:(0,$e.jsx)("span",{children:"Algunos datos no pudieron cargarse completamente. Se muestran datos parciales o de ejemplo."})}),i&&(0,$e.jsx)("div",{className:"alert alert-error mb-4",children:(0,$e.jsx)("span",{children:i})}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[(0,$e.jsx)(Mt,{title:"Total de Solicitudes",value:(null===o||void 0===o?void 0:o.totalApplications)||0,icon:(0,$e.jsx)(ut,{className:"h-5 w-5"}),color:"blue"}),(0,$e.jsx)(Mt,{title:"Solicitudes Aprobadas",value:(null===o||void 0===o?void 0:o.approvedApplications)||0,previousValue:0,icon:(0,$e.jsx)(pt,{className:"h-5 w-5"}),color:"green"}),(0,$e.jsx)(Mt,{title:"Monto Aprobado Promedio",value:(null===o||void 0===o?void 0:o.avgAmount)||0,formatValue:e=>St("string"===typeof e?parseFloat(e)||0:e||0),icon:(0,$e.jsx)(ft,{className:"h-5 w-5"}),color:"indigo"}),b(o)?(0,$e.jsx)(Mt,{title:"Tasa de Conversi\xf3n",value:Number((null===o||void 0===o?void 0:o.conversionRate)||0),isPercentage:!0,formatValue:e=>("string"===typeof e?parseFloat(e):e).toFixed(2),icon:(0,$e.jsx)(vt,{className:"h-5 w-5"}),color:"purple"}):(0,$e.jsx)(Mt,{title:"Total de Empleados",value:Number((null===o||void 0===o?void 0:o.totalClients)||0),icon:(0,$e.jsx)(vt,{className:"h-5 w-5"}),color:"purple"}),(0,$e.jsx)(Mt,{title:"Requieren Atenci\xf3n",value:(null===o||void 0===o?void 0:o.attentionNeededCount)||0,icon:(0,$e.jsx)(bt,{className:"h-5 w-5"}),color:"red",tooltip:"Solicitudes sin cambios en 48+ horas",onClick:w,children:(0,$e.jsx)("div",{className:"mt-3 flex justify-center",children:(0,$e.jsx)("button",{className:"btn btn-sm btn-error text-white",onClick:e=>{e.stopPropagation(),w()},children:"Ver Solicitudes"})})})]}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[(0,$e.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,$e.jsxs)("h2",{className:"card-title text-lg font-semibold",children:["day"===v&&"Solicitudes por D\xeda","week"===v&&"Solicitudes por Semana","month"===v&&"Solicitudes por Mes","year"===v&&"Solicitudes por A\xf1o"]}),(0,$e.jsx)(zf,{value:v,onChange:y,className:"ml-auto"})]}),o.applicationsByMonth&&(0,$e.jsx)(Vl,{data:Array.isArray(o.applicationsByMonth)?o.applicationsByMonth.map((e=>({month:String(e.month||""),count:Number(e.count||0),daily:Array.isArray(e.daily)?e.daily:void 0}))):[],height:300,title:"",timePeriod:v})]})}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Distribuci\xf3n por Estado"}),(0,$e.jsx)(Wl,{data:b(o)&&o.applicationsByStatusChart?o.applicationsByStatusChart:(j=o.applicationsByStatus,(e=>Array.isArray(e)&&e.length>0&&"status"in e[0]&&"count"in e[0])(j)?j:j&&"object"===typeof j&&!Array.isArray(j)?Object.entries(j).map((e=>{let[t,n]=e;return{status:t,count:"number"===typeof n?n:0}})):[]),height:300,title:"",preserveOriginalStatuses:!0})]})})]}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-4",children:[(0,$e.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Distribuci\xf3n por Monto"}),(console.log("Dashboard - amountRanges:",null===o||void 0===o?void 0:o.amountRanges),console.log("Dashboard - amountRanges type:",Array.isArray(null===o||void 0===o?void 0:o.amountRanges)?"Array":typeof(null===o||void 0===o?void 0:o.amountRanges)),console.log("Dashboard - amountRanges conditions:",{exists:!(null===o||void 0===o||!o.amountRanges),isArray:Array.isArray(null===o||void 0===o?void 0:o.amountRanges),length:null===o||void 0===o||null===(E=o.amountRanges)||void 0===E?void 0:E.length,validLength:((null===o||void 0===o||null===(S=o.amountRanges)||void 0===S?void 0:S.length)||0)>0,userRole:null===t||void 0===t?void 0:t.role}),null),o&&o.amountRanges&&Array.isArray(o.amountRanges)&&o.amountRanges.length>0?(0,$e.jsx)(Hl,{data:o.amountRanges,height:300,title:""}):(0,$e.jsx)("div",{className:"flex items-center justify-center h-[300px] bg-base-200 rounded-lg",children:(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})})]})}),(null===t||void 0===t?void 0:t.role)===Re&&(0,$e.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Rendimiento de Asesores"}),(e=>e&&"object"===typeof e&&"amountRanges"in e&&Array.isArray(e.amountRanges)&&e.amountRanges.length>0&&"mockAdvisorPerformance"in e)(o)&&o.mockAdvisorPerformance&&o.mockAdvisorPerformance.length>0&&(0,$e.jsx)(ql,{data:o.mockAdvisorPerformance,height:300,title:"",maxBars:8})]})}),(b(o)||(N=o,console.log("Checking if stats is CompanyStats"),N&&"companyId"in N&&"string"===typeof N.companyId&&"totalAdvisors"in N&&"avgApprovalTime"in N))&&(0,$e.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Resumen de Solicitudes"}),o.applicationsByStatusChart&&o.applicationsByStatusChart.length>0?(0,$e.jsx)($e.Fragment,{children:(0,$e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{status:"Nuevo",color:"amber-400",key:"pending"},{status:"En Revisi\xf3n",color:"sky-400",key:"in_review"},{status:"Aprobado",color:"green-400",key:"approved"},{status:"Por Dispersar",color:"purple-400",key:"por_dispersar"},{status:"Completado",color:"emerald-700",key:"completed"},{status:"Rechazado",color:"rose-600",key:"rejected"}].map((e=>{let t=0;if(o.applicationsByStatus&&Array.isArray(o.applicationsByStatus))switch(e.key){case"pending":t=o.applicationsByStatus.filter((e=>"pending"===e.status.toLowerCase()||"new"===e.status.toLowerCase()||"solicitud"===e.status.toLowerCase()||"nuevo"===e.status.toLowerCase())).reduce(((e,t)=>e+t.count),0);break;case"in_review":t=o.applicationsByStatus.filter((e=>"in_review"===e.status.toLowerCase()||e.status.toLowerCase().includes("revis"))).reduce(((e,t)=>e+t.count),0);break;case"approved":t=o.applicationsByStatus.filter((e=>"approved"===e.status.toLowerCase())).reduce(((e,t)=>e+t.count),0);break;case"por_dispersar":t=o.applicationsByStatus.filter((e=>"por_dispersar"===e.status.toLowerCase())).reduce(((e,t)=>e+t.count),0);break;case"completed":t=o.applicationsByStatus.filter((e=>"completed"===e.status.toLowerCase())).reduce(((e,t)=>e+t.count),0);break;case"rejected":t=o.applicationsByStatus.filter((e=>"rejected"===e.status.toLowerCase()||e.status.toLowerCase().includes("recha"))).reduce(((e,t)=>e+t.count),0)}return 0===t&&("pending"===e.key?t=o.pendingApplications||0:"rejected"===e.key&&(t=o.rejectedApplications||0)),(0,$e.jsxs)("div",{className:"stat px-4 py-2",children:[(0,$e.jsx)("div",{className:"stat-title",children:e.status}),"pending"===e.key&&(0,$e.jsx)("div",{className:"stat-value text-amber-400",children:t}),"in_review"===e.key&&(0,$e.jsx)("div",{className:"stat-value text-sky-400",children:t}),"approved"===e.key&&(0,$e.jsx)("div",{className:"stat-value text-green-400",children:t}),"por_dispersar"===e.key&&(0,$e.jsx)("div",{className:"stat-value text-purple-400",children:t}),"completed"===e.key&&(0,$e.jsx)("div",{className:"stat-value text-emerald-700",children:t}),"rejected"===e.key&&(0,$e.jsx)("div",{className:"stat-value text-rose-600",children:t})]},e.status)}))})}):(0,$e.jsxs)("div",{className:"stats stats-vertical shadow",children:[(0,$e.jsxs)("div",{className:"stat",children:[(0,$e.jsx)("div",{className:"stat-title",children:"Nuevo"}),(0,$e.jsx)("div",{className:"stat-value text-amber-400",children:o.pendingApplications})]}),(0,$e.jsxs)("div",{className:"stat",children:[(0,$e.jsx)("div",{className:"stat-title",children:"Aprobado"}),(0,$e.jsx)("div",{className:"stat-value text-green-400",children:Array.isArray(o.applicationsByStatus)?o.applicationsByStatus.filter((e=>"approved"===e.status.toLowerCase())).reduce(((e,t)=>e+t.count),0):0})]}),(0,$e.jsxs)("div",{className:"stat",children:[(0,$e.jsx)("div",{className:"stat-title",children:"Rechazado"}),(0,$e.jsx)("div",{className:"stat-value text-rose-600",children:o.rejectedApplications})]}),(0,$e.jsxs)("div",{className:"stat",children:[(0,$e.jsx)("div",{className:"stat-title",children:"Por Dispersar"}),(0,$e.jsx)("div",{className:"stat-value text-purple-400",children:Array.isArray(o.applicationsByStatus)?o.applicationsByStatus.filter((e=>"por_dispersar"===e.status.toLowerCase())).reduce(((e,t)=>e+t.count),0):0})]}),(0,$e.jsxs)("div",{className:"stat",children:[(0,$e.jsx)("div",{className:"stat-title",children:"Completado"}),(0,$e.jsx)("div",{className:"stat-value text-emerald-700",children:Array.isArray(o.applicationsByStatus)?o.applicationsByStatus.filter((e=>"completed"===e.status.toLowerCase())).reduce(((e,t)=>e+t.count),0):0})]})]})]})})]}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-md mt-6",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Solicitudes Recientes"}),(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table table-zebra w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{children:"Cliente"}),(0,$e.jsx)("th",{children:"Empresa"}),(0,$e.jsx)("th",{children:"Tipo"}),(0,$e.jsx)("th",{children:"Monto"}),(0,$e.jsx)("th",{children:"Estado"}),(0,$e.jsx)("th",{children:"Fecha y Hora"})]})}),(0,$e.jsx)("tbody",{children:o.recentApplications&&o.recentApplications.length>0?o.recentApplications.map(((t,n)=>(0,$e.jsxs)("tr",{className:"hover cursor-pointer",onClick:()=>e(`/applications/${t.id}`),children:[(0,$e.jsx)("td",{children:String(t.client_name||"N/A")}),(0,$e.jsx)("td",{children:String(t.company_name||"N/A")}),(0,$e.jsx)("td",{children:"selected_plans"===t.application_type&&t.product_type?_(t.product_type):_(t.application_type)}),(0,$e.jsx)("td",{children:St(Number(t.amount||0))}),(0,$e.jsx)("td",{children:(0,$e.jsx)("span",{className:`badge badge-${Vf(String(t.status||""))}`,children:Wf(String(t.status||"N/A"))})}),(0,$e.jsx)("td",{children:t.created_at?jt(String(t.created_at)):"N/A"})]},n))):(0,$e.jsx)("tr",{children:(0,$e.jsx)("td",{colSpan:6,className:"text-center",children:"No hay solicitudes recientes"})})})]})})]})}),p.startDate&&p.endDate&&(0,$e.jsx)("div",{className:"alert alert-info mt-4",children:(0,$e.jsxs)("div",{className:"flex items-center",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-current shrink-0 w-6 h-6",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsxs)("span",{children:["Mostrando datos desde ",p.startDate," hasta ",p.endDate]})]})})]})})):(console.log("Dashboard has no stats data"),(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"p-8",children:(0,$e.jsx)("div",{className:"alert alert-info",children:(0,$e.jsx)("span",{children:"No hay datos disponibles para mostrar en el dashboard."})})})}));var N,E,S,j};var qf=n(129),Yf=n(296);const Jf=new Map;let Qf=!0,Kf=0;const Gf=async(e,t,n,r)=>{if(!e)throw new Error("Table name is required for Supabase query execution");try{let o=[];if("select"===t){let t=tt.ND.from(e).select("*");n&&Object.keys(n).length>0&&Object.entries(n).forEach((e=>{let[n,r]=e;t=t.eq(n,r)}));const{data:r,error:a}=await t;if(a)throw a;o=r||[]}else if("insert"===t)try{return console.log("Attempting to execute INSERT query via MCP server..."),o=await Xf(r),console.log("MCP server INSERT successful:",o),o}catch(a){console.error("MCP server error for INSERT query, falling back to Supabase client:",a);const t=r.match(/\(([^)]+)\)\s+VALUES/i),n=r.match(/VALUES\s*\(([^)]+)\)/i);if(!t||!n)throw console.error("Could not parse INSERT query:",r),new Error("Could not parse INSERT query for Supabase client execution");{const r=t[1].split(",").map((e=>e.trim())),a=n[1],s=[];let i="",l=!1;for(let e=0;e<a.length;e++){const t=a[e];"'"!==t||0!==e&&"\\"===a[e-1]?","!==t||l?i+=t:(s.push(i.trim()),i=""):(l=!l,i+=t)}i.trim()&&s.push(i.trim());const c={};r.forEach(((t,n)=>{if(n<s.length){let r=s[n];r.startsWith("'")&&r.endsWith("'")?r=r.substring(1,r.length-1):"NULL"===r.toUpperCase()?r=null:"true"===r.toLowerCase()?r=!0:"false"===r.toLowerCase()?r=!1:isNaN(Number(r))||""===r||(r=Number(r)),"applications"===e&&"product_price"===t.trim()?console.log("Skipping product_price field for applications table as it doesn't exist in schema"):"applications"===e&&"status"===t.trim()?c[t]="solicitud":"applications"===e&&"application_type"===t.trim()?c[t]="selected_plans":c[t]=r}})),console.log("Inserting data directly with Supabase client:",c);const{data:d,error:u}=await tt.ND.from(e).insert([c]).select();if(u)throw console.error("Supabase insert error:",u),u;console.log("Supabase insert successful:",d),o=d||[]}}else if("update"===t||"delete"===t){console.log(`Executing ${t.toUpperCase()} query via MCP server...`);try{o=await Xf(r),console.log(`MCP server ${t.toUpperCase()} successful:`,o)}catch(a){throw console.error(`MCP server error for ${t.toUpperCase()} query:`,a),a}}else try{o=await Xf(r)}catch(a){throw console.error("MCP server error for query:",a),a}return o}catch(o){throw console.error("Supabase query execution error:",o),o}},Xf=async e=>{try{const t=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e}),signal:AbortSignal.timeout(1e4)});if(!t.ok)throw console.error(`MCP server error: ${t.status} ${t.statusText}`),404===t.status&&console.error("MCP server returned 404. Make sure the server is running on port 3100"),new Error(`MCP server responded with status: ${t.status}`);const n=await t.json();return console.log("MCP server response:",n),n.data||[]}catch(t){if(console.error("MCP server connection error:",t),e.toLowerCase().startsWith("insert")){console.warn("Creating fallback response for INSERT query");return[{id:crypto.randomUUID?crypto.randomUUID():Date.now().toString(36)+Math.random().toString(36).substring(2),created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}]}throw t}},Zf=async()=>{const e=Date.now();if(!Qf&&e-Kf>3e4){console.log("Attempting to reconnect to Supabase..."),Kf=e;try{const{data:e,error:t}=await tt.ND.from("applications").select("count(*)",{count:"exact"}).limit(1);return t?(console.error("Supabase reconnection failed:",t),Qf=!1,!1):(console.log("Successfully reconnected to Supabase"),Qf=!0,!0)}catch(t){return console.error("Supabase reconnection error:",t),Qf=!1,!1}}return Qf},eg=async e=>{console.log("Original SQL query:",e),Qf||await Zf();try{const{table:n,type:r,conditions:a}=(e=>{let t="",n="";const r={};try{const a=e.trim(),o=a.toLowerCase();if(o.startsWith("select")){n="select";const e=o.match(/from\s+([a-z0-9_"]+)/i);e&&e[1]&&(t=e[1].replace(/"/g,""));const a=o.match(/where\s+(.+?)(?:order by|group by|limit|$)/i);if(a&&a[1]){a[1].trim().split(/\s+and\s+/i).forEach((e=>{const t=e.match(/([a-z0-9_]+)\s*=\s*['"]?([^'"\s]+)['"]?/i);t&&t.length>=3&&(r[t[1]]=t[2].replace(/['"]/g,""))}))}}else if(o.startsWith("insert")){n="insert";const e=a.match(/INTO\s+([a-zA-Z0-9_"]+)/i);e&&e[1]&&(t=e[1].replace(/"/g,""))}else if(o.startsWith("update")){n="update";const e=a.match(/UPDATE\s+([a-zA-Z0-9_"]+)/i);e&&e[1]&&(t=e[1].replace(/"/g,""));const s=o.match(/where\s+(.+?)(?:returning|$)/i);if(s&&s[1]){s[1].trim().split(/\s+and\s+/i).forEach((e=>{const t=e.match(/([a-z0-9_]+)\s*=\s*['"]?([^'"\s]+)['"]?/i);t&&t.length>=3&&(r[t[1]]=t[2].replace(/['"]/g,""))}))}}else if(o.startsWith("delete")){n="delete";const e=o.match(/from\s+([a-z0-9_"]+)/i);e&&e[1]&&(t=e[1].replace(/"/g,""))}else{n="other";const e=o.match(/(?:from|into|update|join)\s+([a-z0-9_"]+)/i);e&&e[1]&&(t=e[1].replace(/"/g,""))}}catch(Yv){console.error("Error parsing SQL query:",Yv)}return{table:t,type:n,conditions:r}})(e);if(!n)throw console.error("Could not determine table from query:",e),new Error("Invalid query: Could not determine table");if(console.log("Extracted table name:",`'${n}'`),"applications"===n&&e.includes("approved_by_advisor")&&e.includes("WHERE id =")){const o=e.match(/WHERE id = '([^']+)'/);if(o&&o[1]){const s=o[1];try{const t=await Gf(n,r,a,e);return t&&t.length>0&&(Jf.set(s,t[0]),console.log(`Updated approval cache for ${s}`)),t}catch(t){if(Jf.has(s))return console.log(`Using cached approval data for ${s} due to connection error`),[Jf.get(s)];throw t}}}const o=await Gf(n,r,a,e);return Qf=!0,o}catch(t){Qf=!1,console.error("Error in executeQuery:",t),console.log("Using fallback query execution for:",e);try{const t=await Xf(e);return console.log("MCP server query successful"),t}catch(n){if(console.error("MCP server query failed:",n),e.includes("SELECT")&&e.includes("approved_by_advisor")&&e.includes("approved_by_company"))return console.warn("Both Supabase and MCP failed for approval status query. Returning default values."),[{approved_by_advisor:!1,approved_by_company:!1,approval_date_advisor:null,approval_date_company:null}];if(e.toLowerCase().startsWith("insert"))return console.warn("Both Supabase and MCP failed for INSERT query. Generating fallback response."),[{id:crypto.randomUUID?crypto.randomUUID():Date.now().toString(36)+Math.random().toString(36).substring(2),created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}];throw n}}};var tg;setTimeout((()=>{Zf()}),1e3);var ng=new Uint8Array(16);function rg(){if(!tg&&!(tg="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tg(ng)}const ag=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const og=function(e){return"string"===typeof e&&ag.test(e)};for(var sg=[],ig=0;ig<256;++ig)sg.push((ig+256).toString(16).substr(1));const lg=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(sg[e[t+0]]+sg[e[t+1]]+sg[e[t+2]]+sg[e[t+3]]+"-"+sg[e[t+4]]+sg[e[t+5]]+"-"+sg[e[t+6]]+sg[e[t+7]]+"-"+sg[e[t+8]]+sg[e[t+9]]+"-"+sg[e[t+10]]+sg[e[t+11]]+sg[e[t+12]]+sg[e[t+13]]+sg[e[t+14]]+sg[e[t+15]]).toLowerCase();if(!og(n))throw TypeError("Stringified UUID is invalid");return n};const cg=function(e,t,n){var r=(e=e||{}).random||(e.rng||rg)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return lg(r)};let dg=qf.C.APPLICATION_HISTORY;dg||(dg="application_history");const ug=async(e,t)=>{try{console.log("getApplications called with filters:",e);let n=Yf.ND.from(qf.C.APPLICATIONS).select("*");if(null!==t&&void 0!==t&&t.advisor_id&&(n=n.eq("assigned_to",t.advisor_id)),null!==t&&void 0!==t&&t.company_id&&(n=n.eq("company_id",t.company_id)),e&&(e.status&&"all"!==e.status&&(n=n.eq("status",e.status)),e.application_type&&(console.log(`Applying application_type filter: ${e.application_type}`),n=n.eq("application_type",e.application_type)),e.advisor_id&&(n=n.eq("assigned_to",e.advisor_id)),e.company_id&&(n=n.eq("company_id",e.company_id)),e.dateFrom&&(n=n.gte("created_at",e.dateFrom)),e.dateTo&&(n=n.lte("created_at",e.dateTo)),e.amountMin&&(n=n.gte("credito_solicitado",e.amountMin)),e.amountMax&&(n=n.lte("credito_solicitado",e.amountMax)),e.searchQuery)){const t=e.searchQuery.toLowerCase();n=n.or(`client_name.ilike.%${t}%,client_email.ilike.%${t}%,company_name.ilike.%${t}%`)}n=n.order("created_at",{ascending:!1});const{data:r,error:a}=await n;if(a)return console.error("Error fetching applications:",a),[];if(!r||!Array.isArray(r)||0===r.length)return[];console.log(`Retrieved ${r.length} applications from database`);const o=new Set(r.map((e=>e.application_type)));if(console.log("DB application types:",Array.from(o)),null!==e&&void 0!==e&&e.application_type){const t=r.filter((t=>t.application_type===e.application_type));console.log(`After DB query: ${t.length} of ${r.length} apps match type '${e.application_type}'`)}return r.map((e=>{const t=hg(e.status),n=e.advisor_status?hg(e.advisor_status):t,r=e.company_status?hg(e.company_status):t,a=e.global_status?hg(e.global_status):t;return{id:e.id,client_id:e.client_id||"",company_id:e.company_id||"",assigned_to:e.assigned_to||"",application_type:e.application_type||"",source_id:e.source_id||"",status:t,advisor_status:n,company_status:r,global_status:a,created_at:e.created_at,updated_at:e.updated_at,client_name:e.client_name,client_email:e.client_email,company_name:e.company_name,advisor_name:"",approved_by_advisor:e.approved_by_advisor||!1,approved_by_company:e.approved_by_company||!1,rejected_by_advisor:e.rejected_by_advisor||!1,rejected_by_company:e.rejected_by_company||!1,approval_date_advisor:e.approval_date_advisor,approval_date_company:e.approval_date_company,client_phone:e.client_phone,client_address:e.client_address,dni:e.dni,amount:e.credito_solicitado?parseFloat(e.credito_solicitado):e.amount?parseFloat(e.amount):0,term:e.term?parseInt(e.term):void 0,interest_rate:e.interest_rate?parseFloat(e.interest_rate):void 0,monthly_payment:e.monthly_payment?parseFloat(e.monthly_payment):void 0,financing_type:e.financing_type||null,product_url:e.product_url||null,product_title:e.product_title||null,product_image:e.product_image||null,product_price:e.product_price?parseFloat(e.product_price.toString()):void 0,credito_solicitado:e.credito_solicitado?parseFloat(e.credito_solicitado):void 0,payment_frequency:e.payment_frequency||null}}))}catch(n){return console.error("Error fetching applications:",n),[]}},hg=e=>{if(!e)return console.log("Estado vac\xedo o nulo, mapeando a NEW"),wt.NEW;const t=e.toLowerCase().trim();if("solicitud"===t||"pending"===t)return console.log(`Mapeando estado "${e}" a "new"`),wt.NEW;const n=Object.values(wt).find((e=>e.toLowerCase()===t));if(n)return n;const r={solicitud:wt.NEW,pendiente:wt.NEW,pending:wt.NEW,"en revisi\xf3n":wt.IN_REVIEW,"revisi\xf3n":wt.IN_REVIEW,aprobado:wt.APPROVED,rechazado:wt.REJECTED,"por dispersar":wt.POR_DISPERSAR,completado:wt.COMPLETED,cancelado:wt.CANCELLED,expirado:wt.EXPIRED};return console.log(`Mapeando estado desde BD: "${e}" -> "${r[t]||wt.NEW}"`),r[t]||wt.NEW},pg=async(e,t)=>{console.log(`[getApplicationById] Fetching application with ID: ${e}`);let r=`SELECT * FROM ${qf.C.APPLICATIONS} WHERE id = '${e}'`;t&&(t.advisor_id&&(r+=` AND assigned_to = '${t.advisor_id}'`),t.company_id&&(r+=` AND company_id = '${t.company_id}'`));try{const e=await eg(r);if(e&&e.length>0){const t=e[0],r=t.client_id;if(t.client_id){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t.client_id)){const{checkClientExistsById:e}=n(358);try{const n=await e(t.client_id);if(!n&&t.source_id){console.log(`[getApplicationById] Cliente con ID ${t.client_id} no encontrado, verificando source_id: ${t.source_id}`);await e(t.source_id)?(console.log(`[getApplicationById] source_id ${t.source_id} es v\xe1lido, us\xe1ndolo como respaldo`),t.client_id=t.source_id):console.log("[getApplicationById] Ni client_id ni source_id son v\xe1lidos. Manteniendo client_id original.")}else console.log(`[getApplicationById] Cliente con ID ${t.client_id} ${n?"existe":"no existe"}`)}catch(a){console.error(`[getApplicationById] Error verificando cliente: ${a}`)}}else console.log(`[getApplicationById] ID de cliente ${t.client_id} tiene formato no v\xe1lido`),t.source_id&&(console.log(`[getApplicationById] Usando source_id ${t.source_id} como respaldo`),t.client_id=t.source_id)}return r!==t.client_id&&console.log(`[getApplicationById] client_id cambiado de ${r} a ${t.client_id}`),t}throw new Error("Application not found")}catch(o){throw console.error(`Error fetching application with ID ${e}:`,o),o}},mg=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.05,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.16;if(e<=0||n<=0)return 0;console.log("Calculando pago mensual con los siguientes par\xe1metros:"),console.log(`- Monto solicitado: ${e}`),console.log(`- Tasa anual: ${100*t}%`),console.log(`- Plazo (meses): ${n}`),console.log(`- Comisi\xf3n: ${100*r}%`),console.log(`- IVA: ${100*a}%`);const o=r>0?e/(1-r):e;console.log(`- Monto expandido (incluye comisi\xf3n): ${o.toFixed(2)}`);const s=t*(1+a),i=s/12;if(console.log(`- Tasa anual con IVA: ${(100*s).toFixed(4)}%`),console.log(`- Tasa mensual efectiva: ${(100*i).toFixed(4)}%`),0===t)return Math.round(o/n*100)/100;const l=o*(i*Math.pow(1+i,n)/(Math.pow(1+i,n)-1));console.log(`- Pago mensual calculado: ${l.toFixed(2)}`);const c=l*n;console.log(`- Total a pagar: ${c.toFixed(2)}`);const d=o-e;return console.log(`- Comisi\xf3n en pesos: ${d.toFixed(2)}`),Math.round(100*l)/100},fg=async(e,t,n,r,a)=>{try{console.log(`Registrando cambio de ${t} a ${n} en el historial para aplicaci\xf3n ${e}`);const{error:o}=await Yf.ND.from(dg).insert({application_id:e,status:n,comment:r||`Estado ${t} cambiado a ${n}`,created_by:a||null});o?console.error(`Error al registrar historial para aplicaci\xf3n ${e}:`,o):console.log(`Historial registrado correctamente para la aplicaci\xf3n ${e}`)}catch(o){console.error(`Error en logStatusChange para aplicaci\xf3n ${e}:`,o)}},gg=async(e,t,n,r,a)=>{try{console.log(`Actualizando ${n} a ${t} para aplicaci\xf3n ${e}`);const{data:s,error:i}=await Yf.ND.from("applications").select("*").eq("id",e).single();if(i)throw console.error(`Error obteniendo solicitud ${e}:`,i),new Error(`Error al obtener solicitud: ${i.message}`);const l={[n]:t,updated_at:(new Date).toISOString()};if("global_status"!==n&&(l.global_status=t,console.log(`Tambi\xe9n actualizando global_status a ${t}`)),t===wt.REJECTED)if(console.log("Solicitud rechazada, actualizando todos los estados a REJECTED"),l.status=wt.REJECTED,l.global_status=wt.REJECTED,l.advisor_status=wt.REJECTED,l.company_status=wt.REJECTED,"advisor_status"===n)l.rejected_by_advisor=!0,l.rejected_by_company=!1,l.approved_by_advisor=!1,console.log("Marcando como rechazado \xdaNICAMENTE por el asesor (advisor_status)");else if("company_status"===n)l.rejected_by_company=!0,l.rejected_by_advisor=!1,l.approved_by_company=!1,console.log("Marcando como rechazado \xdaNICAMENTE por la empresa (company_status)");else try{const{data:e}=await Yf.ND.from("users").select("role").eq("id",a).single();if("advisor"===(null===e||void 0===e?void 0:e.role))l.rejected_by_advisor=!0,l.rejected_by_company=!1,l.approved_by_advisor=!1,console.log("Marcando como rechazado \xdaNICAMENTE por asesor basado en el rol expl\xedcito");else if("company_admin"===(null===e||void 0===e?void 0:e.role))l.rejected_by_company=!0,l.rejected_by_advisor=!1,l.approved_by_company=!1,console.log("Marcando como rechazado \xdaNICAMENTE por empresa basado en el rol expl\xedcito");else if(s.approved_by_advisor&&!s.approved_by_company)l.rejected_by_company=!0,l.rejected_by_advisor=!1,l.approved_by_company=!1,console.log("Rechazo por admin - \xdaNICAMENTE por empresa (basado en aprobaciones previas)");else if(s.approved_by_company&&!s.approved_by_advisor)l.rejected_by_advisor=!0,l.rejected_by_company=!1,l.approved_by_advisor=!1,console.log("Rechazo por admin - \xdaNICAMENTE por asesor (basado en aprobaciones previas)");else{const e=(null===r||void 0===r?void 0:r.toLowerCase())||"";e.includes("asesor")||e.includes("advisor")?(l.rejected_by_advisor=!0,l.rejected_by_company=!1,l.approved_by_advisor=!1,console.log("Marcando como rechazado \xdaNICAMENTE por asesor basado en el comentario")):e.includes("empresa")||e.includes("company")?(l.rejected_by_company=!0,l.rejected_by_advisor=!1,l.approved_by_company=!1,console.log("Marcando como rechazado \xdaNICAMENTE por empresa basado en el comentario")):s.advisor_status===wt.REJECTED?(l.rejected_by_advisor=!0,l.rejected_by_company=!1,l.approved_by_advisor=!1,console.log("Marcando como rechazado \xdaNICAMENTE por asesor basado en estado previo")):s.company_status===wt.REJECTED?(l.rejected_by_company=!0,l.rejected_by_advisor=!1,l.approved_by_company=!1,console.log("Marcando como rechazado \xdaNICAMENTE por empresa basado en estado previo")):(l.rejected_by_company=!0,l.rejected_by_advisor=!1,l.approved_by_company=!1,console.log("Marcando como rechazado \xdaNICAMENTE por empresa (decisi\xf3n por defecto en ambig\xfcedad)"))}}catch(o){console.error("Error al determinar el rol del usuario que rechaza:",o),l.rejected_by_company=!0,l.rejected_by_advisor=!1,l.approved_by_company=!1,console.log("ERROR: Marcando como rechazado \xdaNICAMENTE por empresa tras error de consulta")}if(t===wt.APPROVED&&("advisor_status"===n?(l.approved_by_advisor=!0,l.approval_date_advisor=(new Date).toISOString(),l.rejected_by_advisor=!1,l.status=wt.APPROVED,l.global_status=wt.APPROVED,console.log("Ambos aprobaron, permaneciendo en APPROVED (firma pendiente)")):"company_status"===n&&(l.approved_by_company=!0,l.approval_date_company=(new Date).toISOString(),l.rejected_by_company=!1,l.status=wt.APPROVED,l.global_status=wt.APPROVED,console.log("Ambos aprobaron, permaneciendo en APPROVED (firma pendiente)"))),t===wt.POR_DISPERSAR){const e=!0===s.approved_by_advisor&&!0===s.approved_by_company,t=s.status===wt.APPROVED||s[n]===wt.APPROVED;if(!e&&!t)throw console.error("No se puede mover a POR_DISPERSAR sin ambas aprobaciones o desde APPROVED"),new Error("La solicitud no puede moverse a Por Dispersar. Requiere aprobaci\xf3n de asesor y empresa.");l.status=wt.POR_DISPERSAR,l.global_status=wt.POR_DISPERSAR,l.advisor_status=wt.POR_DISPERSAR,l.company_status=wt.POR_DISPERSAR,console.log("Moviendo manualmente a POR_DISPERSAR y actualizando todos los estados")}const{error:c}=await Yf.ND.from("applications").update(l).eq("id",e);if(c)throw console.error("Error updating application status:",c),new Error(`Error updating application status: ${c.message}`);await fg(e,n,t,r,a),l.status===wt.POR_DISPERSAR&&t!==wt.POR_DISPERSAR&&await fg(e,"status",wt.POR_DISPERSAR,"Movido autom\xe1ticamente a Por Dispersar porque ambas partes aprobaron",a),console.log(`Estado de aplicaci\xf3n ${e} actualizado correctamente a ${t}`)}catch(s){throw console.error("Error in updateApplicationStatusField:",s),s}},vg=e=>{let{applications:t,onStatusChange:n,statusField:r="status",applicationTypeFilter:o,attentionNeededOnly:s=!1}=e;const[i,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),[p,m]=(0,a.useState)(null),[f,g]=(0,a.useState)([]),[v,y]=(0,a.useState)(!0),[b,x]=(0,a.useState)(null),_=(0,a.useRef)(null),[w,N]=((0,a.useRef)(!1),(0,a.useState)({})),{isAdvisor:E,isCompanyAdmin:S}=Qe(),{user:j}=We();(0,a.useEffect)((()=>{(async()=>{y(!0);try{const e=new Set(t.map((e=>e.application_type)));console.log("Available application types:",Array.from(e)),console.log("Current filter type:",o),console.log("Number of applications before filtering:",t.length),console.log("Financing types:",t.map((e=>({id:e.id,type:e.application_type,financing:e.financing_type}))));const n=t.filter((e=>"selected_plans"===e.application_type));console.log(`Filtered to ${n.length} 'selected_plans' applications`);let a=n.map((e=>{const t=e[r]||e.status;return console.log(`App ${e.id} financing_type:`,e.financing_type),{id:e.id,status:t,advisor_status:e.advisor_status||e.status,company_status:e.company_status||e.status,global_status:e.global_status||e.status,client_name:e.client_name||"Cliente sin nombre",company_name:e.company_name,amount:e.amount||0,application_type:e.application_type,financing_type:e.financing_type||null,updated_at:e.updated_at||null,approvalStatus:{approvedByAdvisor:e.approved_by_advisor,approvedByCompany:e.approved_by_company,isFullyApproved:e.approved_by_advisor&&e.approved_by_company,rejectedByAdvisor:e.rejected_by_advisor,rejectedByCompany:e.rejected_by_company}}}));if(console.log("Mapped applications with rejection flags:"),a.forEach((e=>{var t,n;"rejected"===e.status&&console.log(`Rejected app ${e.id}:`,{rejectedByAdvisor:null===(t=e.approvalStatus)||void 0===t?void 0:t.rejectedByAdvisor,rejectedByCompany:null===(n=e.approvalStatus)||void 0===n?void 0:n.rejectedByCompany})})),o&&"all"!==o){console.log(`Filtering initial applications by type: ${o}`);const e=a.length;a=a.filter((e=>e.application_type===o)),console.log(`Filtered from ${e} to ${a.length} applications with type ${o}`)}g(a)}catch(b){console.error("Error setting up applications:",b),l("Error al cargar las aplicaciones")}finally{y(!1)}})()}),[t,r,o]);const k=e=>{let t=f.filter((t=>t.status===e));return t=t.filter((e=>"selected_plans"===e.application_type)),t},C=e=>{let t=k(e);return o&&"all"!==o&&(t=t.filter((e=>e.application_type===o))),s&&(t=t.filter((e=>B(e)))),w[e]?t:t.slice(0,5)},D=e=>{N((t=>({...t,[e]:!t[e]})))},T=(e,t)=>{_.current=e.currentTarget,e.currentTarget.classList.add("card-moving"),e.dataTransfer.setData("application/id",t.id),e.dataTransfer.effectAllowed="move";try{const t=e.currentTarget.cloneNode(!0);t.style.position="absolute",t.style.top="-1000px",t.style.opacity="0.8",t.style.transform="scale(0.8)",t.style.width=`${e.currentTarget.offsetWidth}px`,document.body.appendChild(t),e.dataTransfer.setDragImage(t,20,20),setTimeout((()=>{t.parentNode&&document.body.removeChild(t)}),100)}catch(b){console.warn("Failed to create custom drag image:",b)}},A=e=>{_.current&&_.current.classList.remove("card-moving");document.querySelectorAll(".column-content").forEach((e=>e.classList.remove("drag-over"))),_.current=null},P=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move",e.currentTarget.classList.add("drag-over")},I=e=>{e.currentTarget.classList.remove("drag-over")},R=async(e,t)=>{if(e.preventDefault(),e.currentTarget.classList.remove("drag-over"),!_.current)return void console.warn("Nothing is being dragged");const a=e.dataTransfer.getData("application/id"),o=f.find((e=>e.id===a));if(o){if(o.status!==t&&null===p)if(((e,t,n)=>{if(e===t)return!1;if(t===wt.POR_DISPERSAR){var a,o;const t=!0===(null===(a=n.approvalStatus)||void 0===a?void 0:a.approvedByAdvisor)&&!0===(null===(o=n.approvalStatus)||void 0===o?void 0:o.approvedByCompany);if(e!==wt.APPROVED&&!t)return console.log("Blocking move to POR_DISPERSAR - both advisor and company must approve first"),!1;if(e===wt.APPROVED)return console.log("Allowing move from APPROVED to POR_DISPERSAR"),!0}if("advisor_status"===r){if(e===wt.NEW)return t===wt.IN_REVIEW||t===wt.APPROVED||t===wt.REJECTED;if(e===wt.IN_REVIEW)return t===wt.NEW||t===wt.APPROVED||t===wt.REJECTED;if(e===wt.APPROVED)return t===wt.IN_REVIEW||t===wt.POR_DISPERSAR||t===wt.REJECTED;if(e===wt.POR_DISPERSAR)return t===wt.IN_REVIEW||t===wt.COMPLETED||t===wt.REJECTED;if(e===wt.REJECTED)return t===wt.NEW||t===wt.IN_REVIEW||t===wt.APPROVED}else if("company_status"===r){if(e===wt.NEW)return t===wt.IN_REVIEW||t===wt.APPROVED||t===wt.REJECTED;if(e===wt.IN_REVIEW)return t===wt.NEW||t===wt.APPROVED||t===wt.REJECTED;if(e===wt.APPROVED)return t===wt.IN_REVIEW||t===wt.POR_DISPERSAR||t===wt.REJECTED;if(e===wt.REJECTED)return t===wt.NEW||t===wt.IN_REVIEW||t===wt.APPROVED}else if("global_status"===r){if(e===wt.NEW)return t===wt.IN_REVIEW||t===wt.APPROVED||t===wt.REJECTED;var s,i;if(e===wt.IN_REVIEW)return t===wt.NEW||(t===wt.APPROVED?!0===(null===(s=n.approvalStatus)||void 0===s?void 0:s.approvedByAdvisor)&&!0===(null===(i=n.approvalStatus)||void 0===i?void 0:i.approvedByCompany):t===wt.REJECTED);if(e===wt.APPROVED)return t===wt.IN_REVIEW||t===wt.POR_DISPERSAR||t===wt.REJECTED;if(e===wt.POR_DISPERSAR)return t===wt.APPROVED||t===wt.COMPLETED||t===wt.IN_REVIEW||t===wt.REJECTED;if(e===wt.COMPLETED)return!1;if(e===wt.REJECTED)return t===wt.NEW||t===wt.IN_REVIEW||t===wt.APPROVED}else{if(e===wt.NEW)return t===wt.IN_REVIEW||t===wt.APPROVED||t===wt.REJECTED;var l,c,d,u;if(e===wt.IN_REVIEW)return t===wt.NEW||(t===wt.APPROVED?E()?!0===(null===(l=n.approvalStatus)||void 0===l?void 0:l.approvedByAdvisor):S()?!0===(null===(c=n.approvalStatus)||void 0===c?void 0:c.approvedByCompany):!0===(null===(d=n.approvalStatus)||void 0===d?void 0:d.approvedByAdvisor)&&!0===(null===(u=n.approvalStatus)||void 0===u?void 0:u.approvedByCompany):t===wt.REJECTED);if(e===wt.APPROVED)return t===wt.IN_REVIEW||t===wt.POR_DISPERSAR||t===wt.REJECTED;if(e===wt.POR_DISPERSAR)return!(!E()||t!==wt.IN_REVIEW)||!(!E()||t!==wt.REJECTED)||!(!E()||t!==wt.COMPLETED)||!(!S()||t!==wt.REJECTED)||!(!S()||t!==wt.IN_REVIEW)||t===wt.APPROVED||t===wt.COMPLETED;if(e===wt.COMPLETED)return!1;if(e===wt.REJECTED)return t===wt.NEW||t===wt.IN_REVIEW||t===wt.APPROVED}return!0})(o.status,t,o)){if(!n)return d("No tienes permisos para cambiar el estado de las solicitudes"),void setTimeout((()=>d(null)),3e3);m(a),g((e=>e.map((e=>e.id===a?{...e,isMoving:!0}:e))));try{const e={id:o.id};"advisor_status"===r?e.advisor_status=t:"company_status"===r?e.company_status=t:"global_status"===r?e.global_status=t:e.status=t,console.log(`Actualizando ${r} a ${t} para aplicaci\xf3n ${o.id}. Payload:`,e),await n(e,t,r),g((e=>e.map((e=>{if(e.id===a){const a={...e,isMoving:!1};if(t===wt.REJECTED){var n;if(a.status=wt.REJECTED,a.advisor_status=wt.REJECTED,a.company_status=wt.REJECTED,a.global_status=wt.REJECTED,"advisor_status"===r)a.approvalStatus={...a.approvalStatus,rejectedByAdvisor:!0,rejectedByCompany:!1,approvedByAdvisor:!1,approvedByCompany:(null===(n=a.approvalStatus)||void 0===n?void 0:n.approvedByCompany)||!1,isFullyApproved:!1},console.log(`Aplicaci\xf3n ${e.id} - Actualizada localmente como rechazada \xdaNICAMENTE por asesor`);else if("company_status"===r){var o;a.approvalStatus={...a.approvalStatus,rejectedByCompany:!0,rejectedByAdvisor:!1,approvedByCompany:!1,approvedByAdvisor:(null===(o=a.approvalStatus)||void 0===o?void 0:o.approvedByAdvisor)||!1,isFullyApproved:!1},console.log(`Aplicaci\xf3n ${e.id} - Actualizada localmente como rechazada \xdaNICAMENTE por empresa`)}else{const t=E(),n=S();var s;if(t)a.approvalStatus={...a.approvalStatus,rejectedByAdvisor:!0,rejectedByCompany:!1,approvedByAdvisor:!1,approvedByCompany:(null===(s=a.approvalStatus)||void 0===s?void 0:s.approvedByCompany)||!1,isFullyApproved:!1},console.log(`Aplicaci\xf3n ${e.id} - Actualizada localmente como rechazada \xdaNICAMENTE por asesor (basado en rol)`);else if(n){var i;a.approvalStatus={...a.approvalStatus,rejectedByCompany:!0,rejectedByAdvisor:!1,approvedByCompany:!1,approvedByAdvisor:(null===(i=a.approvalStatus)||void 0===i?void 0:i.approvedByAdvisor)||!1,isFullyApproved:!1},console.log(`Aplicaci\xf3n ${e.id} - Actualizada localmente como rechazada \xdaNICAMENTE por empresa (basado en rol)`)}else{var l,c,d,u;null===(l=e.approvalStatus)||void 0===l||!l.approvedByAdvisor||null!==(c=e.approvalStatus)&&void 0!==c&&c.approvedByCompany?null===(d=e.approvalStatus)||void 0===d||!d.approvedByCompany||null!==(u=e.approvalStatus)&&void 0!==u&&u.approvedByAdvisor?(a.approvalStatus={...a.approvalStatus,rejectedByCompany:!0,rejectedByAdvisor:!1,approvedByCompany:!1,approvedByAdvisor:!1,isFullyApproved:!1},console.log(`Aplicaci\xf3n ${e.id} - Marcada como rechazada \xdaNICAMENTE por empresa por defecto`)):(a.approvalStatus={...a.approvalStatus,rejectedByAdvisor:!0,rejectedByCompany:!1,approvedByAdvisor:!1,approvedByCompany:!0,isFullyApproved:!1},console.log(`Aplicaci\xf3n ${e.id} - Inferida como rechazada \xdaNICAMENTE por asesor (basado en aprobaci\xf3n previa)`)):(a.approvalStatus={...a.approvalStatus,rejectedByCompany:!0,rejectedByAdvisor:!1,approvedByCompany:!1,approvedByAdvisor:!0,isFullyApproved:!1},console.log(`Aplicaci\xf3n ${e.id} - Inferida como rechazada \xdaNICAMENTE por empresa (basado en aprobaci\xf3n previa)`))}}console.log("Estado local tras rechazo actualizado:",a)}else{var h;if("advisor_status"===r){if(a.advisor_status=t,a.status=t,e.status===wt.NEW&&t===wt.APPROVED)a.approvalStatus={...e.approvalStatus,approvedByAdvisor:!0,isFullyApproved:!0===(null===(h=e.approvalStatus)||void 0===h?void 0:h.approvedByCompany),rejectedByAdvisor:!1}}else if("company_status"===r){var p;if(a.company_status=t,a.status=t,e.status===wt.NEW&&t===wt.APPROVED)a.approvalStatus={...e.approvalStatus,approvedByCompany:!0,isFullyApproved:!0===(null===(p=e.approvalStatus)||void 0===p?void 0:p.approvedByAdvisor),rejectedByCompany:!1}}else if("global_status"===r)a.global_status=t,a.status=t,e.status===wt.NEW&&t===wt.APPROVED&&(a.approvalStatus={...e.approvalStatus,approvedByAdvisor:!0,approvedByCompany:!0,isFullyApproved:!0,rejectedByAdvisor:!1,rejectedByCompany:!1});else{var m;if(a.status=t,e.status===wt.NEW&&t===wt.APPROVED)if(E())a.approvalStatus={...e.approvalStatus,approvedByAdvisor:!0,isFullyApproved:!0===(null===(m=e.approvalStatus)||void 0===m?void 0:m.approvedByCompany),rejectedByAdvisor:!1};else if(S()){var f;a.approvalStatus={...e.approvalStatus,approvedByCompany:!0,isFullyApproved:!0===(null===(f=e.approvalStatus)||void 0===f?void 0:f.approvedByAdvisor),rejectedByCompany:!1}}else a.approvalStatus={...e.approvalStatus,approvedByAdvisor:!0,approvedByCompany:!0,isFullyApproved:!0,rejectedByAdvisor:!1,rejectedByCompany:!1}}}return a}return e})))),t===wt.REJECTED?"advisor_status"===r||E()?h("Solicitud rechazada por el asesor"):"company_status"===r||S()?h("Solicitud rechazada por la empresa"):h("Solicitud rechazada"):h(`Solicitud movida a "${Nt[t]}"`),setTimeout((()=>{h(null)}),3e3)}catch(b){console.error("Error updating application status:",b),l(`Error al actualizar el estado: ${b instanceof Error?b.message:"Error desconocido"}`),setTimeout((()=>l(null)),5e3)}finally{m(null)}}else if(o.status===wt.IN_REVIEW&&t===wt.APPROVED){var s,i;if(!E()||null!==(s=o.approvalStatus)&&void 0!==s&&s.approvedByAdvisor)if(!S()||null!==(i=o.approvalStatus)&&void 0!==i&&i.approvedByCompany){var c,u;const e=[];null!==(c=o.approvalStatus)&&void 0!==c&&c.approvedByAdvisor||e.push("del asesor"),null!==(u=o.approvalStatus)&&void 0!==u&&u.approvedByCompany||e.push("de la empresa"),d(`No se puede aprobar esta solicitud. Falta aprobaci\xf3n ${e.join(" y ")}.`)}else d("No puedes aprobar esta solicitud. Debes aprobarla primero desde la p\xe1gina de detalle.");else d("No puedes aprobar esta solicitud. Debes aprobarla primero desde la p\xe1gina de detalle.");setTimeout((()=>d(null)),5e3)}else if(t===wt.POR_DISPERSAR){var v,y;if(!0===(null===(v=o.approvalStatus)||void 0===v?void 0:v.approvedByAdvisor)&&!0===(null===(y=o.approvalStatus)||void 0===y?void 0:y.approvedByCompany)||o.status===wt.APPROVED)l(`No se permite cambiar el estado de "${Nt[o.status]}" a "${Nt[t]}". Revise las condiciones.`);else{var x,w;const e=[];null!==(x=o.approvalStatus)&&void 0!==x&&x.approvedByAdvisor||e.push("del asesor"),null!==(w=o.approvalStatus)&&void 0!==w&&w.approvedByCompany||e.push("de la empresa"),l(`Para mover a "Por Dispersar" se requiere aprobaci\xf3n ${e.join(" y ")}, o estar en estado "Aprobado".`)}setTimeout((()=>l(null)),5e3)}else l(`No se permite cambiar el estado de "${Nt[o.status]}" a "${Nt[t]}"`),setTimeout((()=>l(null)),5e3)}else console.error("Application not found:",a)},M=e=>{if(e.isMoving)return"card-moving";switch("advisor_status"===r?e.advisor_status:"company_status"===r?e.company_status:"global_status"===r?e.global_status:e.status){case wt.NEW:return"bg-white border-l-yellow-400";case wt.IN_REVIEW:return"bg-white border-l-blue-400";case wt.APPROVED:return"bg-white border-l-green-400";case wt.REJECTED:return"bg-white border-l-red-400";case wt.POR_DISPERSAR:return"bg-white border-l-purple-400";case wt.COMPLETED:return"bg-white border-l-slate-400";default:return"bg-white"}},O=e=>!e.isMoving&&!p,L=e=>p?"Procesando otra aplicaci\xf3n, espere un momento":e.isMoving?"Actualizando estado...":O(e)?"Arrastre para cambiar el estado":"Esta aplicaci\xf3n no puede ser movida",$=e=>O(e)?"kanban-card-draggable":"kanban-card-locked",F=e=>{var t,n,a,o,s,i,l,c;let d="bg-yellow-500",u="bg-yellow-500",h="Pendiente",p="Pendiente",m=!1,f="";console.log(`Rendering approval indicators for app ${e.id}`,{status:e.status,approvalStatus:e.approvalStatus,advisor_status:e.advisor_status,company_status:e.company_status,rejectedByAdvisor:null===(t=e.approvalStatus)||void 0===t?void 0:t.rejectedByAdvisor,rejectedByCompany:null===(n=e.approvalStatus)||void 0===n?void 0:n.rejectedByCompany});const g=e.status===wt.REJECTED;var v;(null!==(a=e.approvalStatus)&&void 0!==a&&a.rejectedByAdvisor?(d="bg-red-500",h="Rechazado",g&&(m=!0,f="Asesor",console.log(`App ${e.id} - Mostrando rechazo por ASESOR (flag expl\xedcito)`))):null!==(o=e.approvalStatus)&&void 0!==o&&o.approvedByAdvisor&&(d="bg-green-500",h="Aprobado"),null!==(s=e.approvalStatus)&&void 0!==s&&s.rejectedByCompany)?(u="bg-red-500",p="Rechazado",!g||null!==(v=e.approvalStatus)&&void 0!==v&&v.rejectedByAdvisor||(m=!0,f="Empresa",console.log(`App ${e.id} - Mostrando rechazo por EMPRESA (flag expl\xedcito)`))):null!==(i=e.approvalStatus)&&void 0!==i&&i.approvedByCompany&&(u="bg-green-500",p="Aprobado");return g&&!m&&(console.log(`App ${e.id} - Estado REJECTED pero sin flags expl\xedcitos, intentando inferir`),e.advisor_status===wt.REJECTED&&e.company_status!==wt.REJECTED?(d="bg-red-500",h="Rechazado",m=!0,f="Asesor",console.log(`App ${e.id} - Inferido rechazo por ASESOR (basado en estados)`)):e.company_status===wt.REJECTED&&e.advisor_status!==wt.REJECTED?(u="bg-red-500",p="Rechazado",m=!0,f="Empresa",console.log(`App ${e.id} - Inferido rechazo por EMPRESA (basado en estados)`)):e.advisor_status===wt.REJECTED&&e.company_status===wt.REJECTED?(d="bg-red-500",u="bg-red-500",h="Rechazado",p="Rechazado","advisor_status"===r?(m=!0,f="Asesor",console.log(`App ${e.id} - Vista de asesor, mostrando rechazo por ASESOR`)):"company_status"===r?(m=!0,f="Empresa",console.log(`App ${e.id} - Vista de empresa, mostrando rechazo por EMPRESA`)):(m=!0,f="Sistema",console.log(`App ${e.id} - Sin informaci\xf3n clara, mostrando rechazo gen\xe9rico`))):(m=!0,f="Sistema",console.log(`App ${e.id} - No hay informaci\xf3n clara, mostrando rechazo gen\xe9rico`))),(0,$e.jsxs)("div",{className:"flex flex-col gap-1 mb-2",children:[e.status===wt.APPROVED&&(null===(l=e.approvalStatus)||void 0===l?void 0:l.approvedByAdvisor)&&(null===(c=e.approvalStatus)||void 0===c?void 0:c.approvedByCompany)&&(0,$e.jsx)("div",{className:"flex items-center",children:(0,$e.jsx)("div",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-blue-500 text-white",children:"Firma Pendiente"})}),m&&e.status===wt.REJECTED&&(0,$e.jsx)("div",{className:"flex items-center",children:(0,$e.jsxs)("div",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-red-500 text-white",children:["Rechazado por ",f]})}),(0,$e.jsxs)("div",{className:"flex items-center",children:[(0,$e.jsxs)("div",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ${d} text-white mr-1`,children:["Asesor: ",h]}),(0,$e.jsxs)("div",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ${u} text-white`,children:["Empresa: ",p]})]})]})},z=(e,t)=>{const n=_t[e]||e;if("selected_plans"===e&&t){const e="producto"===t?"Financiamiento de Producto":"personal"===t?"Cr\xe9dito Personal":t,n="producto"===t?"bg-indigo-100 text-indigo-800":"personal"===t?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800";return(0,$e.jsx)("span",{className:`application-tag ${n}`,children:e})}switch(e){case"selected_plans":return(0,$e.jsx)("span",{className:"application-tag bg-blue-100 text-blue-800",children:n});case"cash_requests":return(0,$e.jsx)("span",{className:"application-tag bg-green-100 text-green-800",children:n});case"product_simulations":return(0,$e.jsx)("span",{className:"application-tag bg-orange-100 text-orange-800",children:n});case"AUTO_LOAN":return(0,$e.jsx)("span",{className:"application-tag bg-purple-100 text-purple-800",children:n});case"CAR_BACKED_LOAN":return(0,$e.jsx)("span",{className:"application-tag bg-indigo-100 text-indigo-800",children:n});case"PERSONAL_LOAN":return(0,$e.jsx)("span",{className:"application-tag bg-pink-100 text-pink-800",children:n});case"CASH_ADVANCE":return(0,$e.jsx)("span",{className:"application-tag bg-yellow-100 text-yellow-800",children:n});default:return(0,$e.jsx)("span",{className:"application-tag bg-gray-100 text-gray-800",children:n||e})}},B=e=>{if(e.status===wt.REJECTED||e.status===wt.COMPLETED)return!1;if(!e.updated_at)return!1;const t=new Date(e.updated_at).getTime();return((new Date).getTime()-t)/36e5>=48};return(0,$e.jsxs)("div",{className:"kanban-board-container bg-base-100 p-2 applications-kanban",children:[(0,$e.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n    .custom-scrollbar::-webkit-scrollbar {\n      width: 8px;\n      height: 8px;\n    }\n    \n    .custom-scrollbar::-webkit-scrollbar-track {\n      background: #f1f1f1;\n      border-radius: 10px;\n    }\n    \n    .custom-scrollbar::-webkit-scrollbar-thumb {\n      background: #888;\n      border-radius: 10px;\n    }\n    \n    .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n      background: #555;\n    }\n    \n    .kanban-card {\n      transition: transform 0.2s ease-in-out, opacity 0.2s ease-in-out, box-shadow 0.3s ease-in-out, border-color 0.3s ease;\n      touch-action: none;\n      user-select: none;\n      will-change: transform, opacity;\n    }\n    \n    .kanban-card-draggable {\n      cursor: grab !important;\n      position: relative;\n    }\n    \n    .kanban-card-draggable:hover {\n      transform: translateY(-4px);\n      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15);\n      border-color: #a855f7;\n      z-index: 10;\n    }\n    \n    .kanban-card-draggable:active {\n      cursor: grabbing !important;\n    }\n    \n    .kanban-card-locked {\n      position: relative;\n      cursor: not-allowed !important;\n      opacity: 0.8;\n    }\n    \n    .card-moving {\n      opacity: 0.7;\n      background-color: #f9fafb;\n    }\n    \n    .drag-over {\n      background-color: #f3f4f6;\n    }\n    \n    @keyframes processingPulse {\n      0% { box-shadow: 0 0 0 0 rgba(168, 85, 247, 0.4); }\n      70% { box-shadow: 0 0 0 10px rgba(168, 85, 247, 0); }\n      100% { box-shadow: 0 0 0 0 rgba(168, 85, 247, 0); }\n    }\n    \n    .processing {\n      animation: processingPulse 1.5s infinite;\n    }\n\n    .application-tag {\n      display: inline-block;\n      font-size: 0.7rem;\n      padding: 0.15rem 0.4rem;\n      border-radius: 0.25rem;\n      font-weight: 500;\n    }\n\n    .approval-indicators {\n      display: flex;\n      margin-top: 0.5rem;\n      margin-bottom: 0.5rem;\n      gap: 0.5rem;\n    }\n    \n    .approval-indicator {\n      display: flex;\n      align-items: center;\n      gap: 0.25rem;\n    }\n    \n    .approval-indicator-dot {\n      width: 14px;\n      height: 14px;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border: 1px solid #e2e8f0;\n      transition: all 0.2s ease;\n    }\n    \n    .approval-indicator-dot.approved {\n      background-color: #22c55e;\n      border-color: #16a34a;\n      box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);\n    }\n    \n    .approval-indicator-dot.pending {\n      background-color: #d1d5db;\n      border-color: #9ca3af;\n    }\n    \n    .approval-indicator-label {\n      font-size: 0.75rem;\n      font-weight: 500;\n    }\n    \n    .approval-indicator-label.approved {\n      color: #16a34a;\n    }\n    \n    .approval-indicator-label.pending {\n      color: #6b7280;\n    }\n\n    .tag-product {\n      background-color: #e0f2fe;\n      color: #0369a1;\n    }\n\n    .tag-cash {\n      background-color: #dcfce7;\n      color: #15803d;\n    }\n\n    .tag-selected {\n      background-color: #f3e8ff;\n      color: #7e22ce;\n    }\n\n    .column-header {\n      font-weight: 600;\n      padding: 0.75rem;\n      border-radius: 0.5rem;\n      margin-bottom: 1rem;\n    }\n\n    .column-count {\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      width: 1.5rem;\n      height: 1.5rem;\n      border-radius: 9999px;\n      font-size: 0.75rem;\n      font-weight: 600;\n      background-color: white;\n      color: #4b5563;\n      margin-left: 0.5rem;\n    }\n  "}}),i&&(0,$e.jsxs)("div",{className:"alert alert-error shadow-lg mb-4 mx-2",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:i})]}),(0,$e.jsx)("div",{className:"flex-none",children:(0,$e.jsx)("button",{onClick:()=>l(null),className:"btn btn-sm btn-ghost",children:"Cerrar"})})]}),c&&(0,$e.jsxs)("div",{className:"alert alert-warning shadow-lg mb-4 mx-2",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,$e.jsx)("span",{children:c})]}),(0,$e.jsx)("div",{className:"flex-none",children:(0,$e.jsx)("button",{onClick:()=>d(null),className:"btn btn-sm btn-ghost",children:"Cerrar"})})]}),u&&(0,$e.jsxs)("div",{className:"alert alert-success shadow-lg mb-4 mx-2",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:u})]}),(0,$e.jsx)("div",{className:"flex-none",children:(0,$e.jsx)("button",{onClick:()=>h(null),className:"btn btn-sm btn-ghost",children:"Cerrar"})})]}),v?(0,$e.jsxs)("div",{className:"flex items-center justify-center h-24",children:[(0,$e.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),(0,$e.jsx)("span",{className:"ml-2 text-gray-600",children:"Cargando aplicaciones..."})]}):b?(0,$e.jsx)("div",{className:"alert alert-error shadow-lg mb-4",children:(0,$e.jsxs)("div",{children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsxs)("span",{children:["Error: ",b]})]})}):(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[(0,$e.jsxs)("div",{className:"kanban-column bg-base-200 rounded-lg p-4 h-full",children:[(0,$e.jsx)("div",{className:"column-header mb-4",children:(0,$e.jsxs)("h3",{className:"text-lg font-bold flex items-center",children:[(0,$e.jsx)("span",{className:"w-3 h-3 rounded-full bg-yellow-400 mr-2"}),Nt[wt.NEW]," (",k(wt.NEW).length,")"]})}),(0,$e.jsxs)("div",{className:"column-content overflow-y-auto custom-scrollbar p-1 rounded-md",onDragOver:P,onDragLeave:I,onDrop:e=>R(e,wt.NEW),children:[C(wt.NEW).map((e=>(0,$e.jsxs)("div",{className:`kanban-card ${M(e)} p-4 rounded-md shadow-md mb-3 border-l-4 ${$(e)} ${p===e.id?"processing":""}`,draggable:O(e),onDragStart:O(e)?t=>T(t,e):void 0,onDragEnd:A,title:L(e),children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,$e.jsx)("div",{className:"flex items-center",children:(0,$e.jsx)("h4",{className:"font-semibold text-gray-800",children:e.client_name||"Cliente sin nombre"})}),(0,$e.jsxs)("div",{className:"flex items-center",children:[z(e.application_type,e.financing_type),B(e)&&(0,$e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 ml-2 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,$e.jsx)("title",{children:"Requiere atenci\xf3n: Sin cambios en 48+ horas"}),(0,$e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})]})]})]}),(0,$e.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.company_name&&(0,$e.jsx)("p",{children:e.company_name})}),(0,$e.jsx)("div",{className:"text-sm font-medium text-gray-900 mb-1",children:St(e.amount)}),(0,$e.jsxs)("div",{className:"flex flex-col mt-2 pt-2 border-t border-gray-100",children:[F(e),(0,$e.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,$e.jsxs)("span",{className:"text-xs text-gray-500",children:["ID: ",e.id.substring(0,5),"..."]}),(0,$e.jsx)(Te,{to:`/applications/${e.id}`,className:"btn btn-xs btn-primary",children:"VER DETALLE"})]})]})]},e.id))),k(wt.NEW).length>5&&!w[wt.NEW]&&(0,$e.jsxs)("button",{onClick:()=>D(wt.NEW),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:["Ver ",k(wt.NEW).length-5," m\xe1s"]}),w[wt.NEW]&&(0,$e.jsx)("button",{onClick:()=>D(wt.NEW),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:"Ver menos"}),0===k(wt.NEW).length&&(0,$e.jsx)("div",{className:"text-center py-4 text-gray-500 italic",children:"No hay solicitudes"})]})]}),(0,$e.jsxs)("div",{className:"kanban-column bg-base-200 rounded-lg p-4 h-full",children:[(0,$e.jsx)("div",{className:"column-header mb-4",children:(0,$e.jsxs)("h3",{className:"text-lg font-bold flex items-center",children:[(0,$e.jsx)("span",{className:"w-3 h-3 rounded-full bg-blue-400 mr-2"}),Nt[wt.IN_REVIEW]," (",k(wt.IN_REVIEW).length,")"]})}),(0,$e.jsxs)("div",{className:"column-content overflow-y-auto custom-scrollbar p-1 rounded-md",onDragOver:P,onDragLeave:I,onDrop:e=>R(e,wt.IN_REVIEW),children:[C(wt.IN_REVIEW).map((e=>(0,$e.jsxs)("div",{className:`kanban-card ${M(e)} p-4 rounded-md shadow-md mb-3 border-l-4 ${$(e)} ${p===e.id?"processing":""}`,draggable:O(e),onDragStart:O(e)?t=>T(t,e):void 0,onDragEnd:A,title:L(e),children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,$e.jsx)("div",{className:"flex items-center",children:(0,$e.jsx)("h4",{className:"font-semibold text-gray-800",children:e.client_name||"Cliente sin nombre"})}),(0,$e.jsxs)("div",{className:"flex items-center",children:[z(e.application_type,e.financing_type),B(e)&&(0,$e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 ml-2 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,$e.jsx)("title",{children:"Requiere atenci\xf3n: Sin cambios en 48+ horas"}),(0,$e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})]})]})]}),(0,$e.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.company_name&&(0,$e.jsx)("p",{children:e.company_name})}),(0,$e.jsx)("div",{className:"text-sm font-medium text-gray-900 mb-1",children:St(e.amount)}),(0,$e.jsxs)("div",{className:"flex flex-col mt-2 pt-2 border-t border-gray-100",children:[F(e),(0,$e.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,$e.jsxs)("span",{className:"text-xs text-gray-500",children:["ID: ",e.id.substring(0,5),"..."]}),(0,$e.jsx)(Te,{to:`/applications/${e.id}`,className:"btn btn-xs btn-primary",children:"VER DETALLE"})]})]})]},e.id))),k(wt.IN_REVIEW).length>5&&!w[wt.IN_REVIEW]&&(0,$e.jsxs)("button",{onClick:()=>D(wt.IN_REVIEW),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:["Ver ",k(wt.IN_REVIEW).length-5," m\xe1s"]}),w[wt.IN_REVIEW]&&(0,$e.jsx)("button",{onClick:()=>D(wt.IN_REVIEW),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:"Ver menos"}),0===k(wt.IN_REVIEW).length&&(0,$e.jsx)("div",{className:"text-center py-4 text-gray-500 italic",children:"No hay solicitudes"})]})]}),(0,$e.jsxs)("div",{className:"kanban-column bg-base-200 rounded-lg p-4 h-full",children:[(0,$e.jsx)("div",{className:"column-header mb-4",children:(0,$e.jsxs)("h3",{className:"text-lg font-bold flex items-center",children:[(0,$e.jsx)("span",{className:"w-3 h-3 rounded-full bg-green-400 mr-2"}),Nt[wt.APPROVED]," (",k(wt.APPROVED).length,")"]})}),(0,$e.jsxs)("div",{className:"column-content overflow-y-auto custom-scrollbar p-1 rounded-md",onDragOver:P,onDragLeave:I,onDrop:e=>R(e,wt.APPROVED),children:[C(wt.APPROVED).map((e=>(0,$e.jsxs)("div",{className:`kanban-card ${M(e)} p-4 rounded-md shadow-md mb-3 border-l-4 ${$(e)} ${p===e.id?"processing":""}`,draggable:O(e),onDragStart:O(e)?t=>T(t,e):void 0,onDragEnd:A,title:L(e),children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,$e.jsx)("div",{className:"flex items-center",children:(0,$e.jsx)("h4",{className:"font-semibold text-gray-800",children:e.client_name||"Cliente sin nombre"})}),(0,$e.jsxs)("div",{className:"flex items-center",children:[z(e.application_type,e.financing_type),B(e)&&(0,$e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 ml-2 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,$e.jsx)("title",{children:"Requiere atenci\xf3n: Sin cambios en 48+ horas"}),(0,$e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})]})]})]}),(0,$e.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.company_name&&(0,$e.jsx)("p",{children:e.company_name})}),(0,$e.jsx)("div",{className:"text-sm font-medium text-gray-900 mb-1",children:St(e.amount)}),(0,$e.jsxs)("div",{className:"flex flex-col mt-2 pt-2 border-t border-gray-100",children:[F(e),(0,$e.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,$e.jsxs)("span",{className:"text-xs text-gray-500",children:["ID: ",e.id.substring(0,5),"..."]}),(0,$e.jsx)(Te,{to:`/applications/${e.id}`,className:"btn btn-xs btn-primary",children:"VER DETALLE"})]})]})]},e.id))),k(wt.APPROVED).length>5&&!w[wt.APPROVED]&&(0,$e.jsxs)("button",{onClick:()=>D(wt.APPROVED),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:["Ver ",k(wt.APPROVED).length-5," m\xe1s"]}),w[wt.APPROVED]&&(0,$e.jsx)("button",{onClick:()=>D(wt.APPROVED),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:"Ver menos"}),0===k(wt.APPROVED).length&&(0,$e.jsx)("div",{className:"text-center py-4 text-gray-500 italic",children:"No hay solicitudes"})]})]}),(0,$e.jsxs)("div",{className:"kanban-column bg-base-200 rounded-lg p-4 h-full",children:[(0,$e.jsx)("div",{className:"column-header mb-4",children:(0,$e.jsxs)("h3",{className:"text-lg font-bold flex items-center",children:[(0,$e.jsx)("span",{className:"w-3 h-3 rounded-full bg-purple-400 mr-2"}),Nt[wt.POR_DISPERSAR]," (",k(wt.POR_DISPERSAR).length,")"]})}),(0,$e.jsxs)("div",{className:"column-content overflow-y-auto custom-scrollbar p-1 rounded-md",onDragOver:P,onDragLeave:I,onDrop:e=>R(e,wt.POR_DISPERSAR),children:[C(wt.POR_DISPERSAR).map((e=>(0,$e.jsxs)("div",{className:`kanban-card ${M(e)} p-4 rounded-md shadow-md mb-3 border-l-4 ${$(e)} ${p===e.id?"processing":""}`,draggable:O(e),onDragStart:O(e)?t=>T(t,e):void 0,onDragEnd:A,title:L(e),children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,$e.jsx)("div",{className:"flex items-center",children:(0,$e.jsx)("h4",{className:"font-semibold text-gray-800",children:e.client_name||"Cliente sin nombre"})}),(0,$e.jsxs)("div",{className:"flex items-center",children:[z(e.application_type,e.financing_type),B(e)&&(0,$e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 ml-2 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,$e.jsx)("title",{children:"Requiere atenci\xf3n: Sin cambios en 48+ horas"}),(0,$e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})]})]})]}),(0,$e.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.company_name&&(0,$e.jsx)("p",{children:e.company_name})}),(0,$e.jsx)("div",{className:"text-sm font-medium text-gray-900 mb-1",children:St(e.amount)}),(0,$e.jsxs)("div",{className:"flex flex-col mt-2 pt-2 border-t border-gray-100",children:[F(e),(0,$e.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,$e.jsxs)("span",{className:"text-xs text-gray-500",children:["ID: ",e.id.substring(0,5),"..."]}),(0,$e.jsx)(Te,{to:`/applications/${e.id}`,className:"btn btn-xs btn-primary",children:"VER DETALLE"})]})]})]},e.id))),k(wt.POR_DISPERSAR).length>5&&!w[wt.POR_DISPERSAR]&&(0,$e.jsxs)("button",{onClick:()=>D(wt.POR_DISPERSAR),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:["Ver ",k(wt.POR_DISPERSAR).length-5," m\xe1s"]}),w[wt.POR_DISPERSAR]&&(0,$e.jsx)("button",{onClick:()=>D(wt.POR_DISPERSAR),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:"Ver menos"}),0===k(wt.POR_DISPERSAR).length&&(0,$e.jsx)("div",{className:"text-center py-4 text-gray-500 italic",children:"No hay solicitudes"})]})]}),(0,$e.jsxs)("div",{className:"kanban-column bg-base-200 rounded-lg p-4 h-full",children:[(0,$e.jsx)("div",{className:"column-header mb-4",children:(0,$e.jsxs)("h3",{className:"text-lg font-bold flex items-center",children:[(0,$e.jsx)("span",{className:"w-3 h-3 rounded-full bg-slate-400 mr-2"}),Nt[wt.COMPLETED]," (",k(wt.COMPLETED).length,")"]})}),(0,$e.jsxs)("div",{className:"column-content overflow-y-auto custom-scrollbar p-1 rounded-md",onDragOver:P,onDragLeave:I,onDrop:e=>R(e,wt.COMPLETED),children:[C(wt.COMPLETED).map((e=>(0,$e.jsxs)("div",{className:`kanban-card ${M(e)} p-4 rounded-md shadow-md mb-3 border-l-4 ${$(e)} ${p===e.id?"processing":""}`,draggable:O(e),onDragStart:O(e)?t=>T(t,e):void 0,onDragEnd:A,title:L(e),children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,$e.jsx)("div",{className:"flex items-center",children:(0,$e.jsx)("h4",{className:"font-semibold text-gray-800",children:e.client_name||"Cliente sin nombre"})}),(0,$e.jsxs)("div",{className:"flex items-center",children:[z(e.application_type,e.financing_type),B(e)&&(0,$e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 ml-2 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,$e.jsx)("title",{children:"Requiere atenci\xf3n: Sin cambios en 48+ horas"}),(0,$e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})]})]})]}),(0,$e.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.company_name&&(0,$e.jsx)("p",{children:e.company_name})}),(0,$e.jsx)("div",{className:"text-sm font-medium text-gray-900 mb-1",children:St(e.amount)}),(0,$e.jsxs)("div",{className:"flex flex-col mt-2 pt-2 border-t border-gray-100",children:[F(e),(0,$e.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,$e.jsxs)("span",{className:"text-xs text-gray-500",children:["ID: ",e.id.substring(0,5),"..."]}),(0,$e.jsx)(Te,{to:`/applications/${e.id}`,className:"btn btn-xs btn-primary",children:"VER DETALLE"})]})]})]},e.id))),k(wt.COMPLETED).length>5&&!w[wt.COMPLETED]&&(0,$e.jsxs)("button",{onClick:()=>D(wt.COMPLETED),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:["Ver ",k(wt.COMPLETED).length-5," m\xe1s"]}),w[wt.COMPLETED]&&(0,$e.jsx)("button",{onClick:()=>D(wt.COMPLETED),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:"Ver menos"}),0===k(wt.COMPLETED).length&&(0,$e.jsx)("div",{className:"text-center py-4 text-gray-500 italic",children:"No hay solicitudes"})]})]}),(0,$e.jsxs)("div",{className:"kanban-column bg-base-200 rounded-lg p-4 h-full",children:[(0,$e.jsx)("div",{className:"column-header mb-4",children:(0,$e.jsxs)("h3",{className:"text-lg font-bold flex items-center",children:[(0,$e.jsx)("span",{className:"w-3 h-3 rounded-full bg-red-400 mr-2"}),Nt[wt.REJECTED]," (",k(wt.REJECTED).length,")"]})}),(0,$e.jsxs)("div",{className:"column-content overflow-y-auto custom-scrollbar p-1 rounded-md",onDragOver:P,onDragLeave:I,onDrop:e=>R(e,wt.REJECTED),children:[C(wt.REJECTED).map((e=>(0,$e.jsxs)("div",{className:`kanban-card ${M(e)} p-4 rounded-md shadow-md mb-3 border-l-4 ${$(e)} ${p===e.id?"processing":""}`,draggable:O(e),onDragStart:O(e)?t=>T(t,e):void 0,onDragEnd:A,title:L(e),children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,$e.jsx)("div",{className:"flex items-center",children:(0,$e.jsx)("h4",{className:"font-semibold text-gray-800",children:e.client_name||"Cliente sin nombre"})}),(0,$e.jsxs)("div",{className:"flex items-center",children:[z(e.application_type,e.financing_type),B(e)&&(0,$e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 ml-2 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,$e.jsx)("title",{children:"Requiere atenci\xf3n: Sin cambios en 48+ horas"}),(0,$e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})]})]})]}),(0,$e.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.company_name&&(0,$e.jsx)("p",{children:e.company_name})}),(0,$e.jsx)("div",{className:"text-sm font-medium text-gray-900 mb-1",children:St(e.amount)}),(0,$e.jsxs)("div",{className:"flex flex-col mt-2 pt-2 border-t border-gray-100",children:[F(e),(0,$e.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,$e.jsxs)("span",{className:"text-xs text-gray-500",children:["ID: ",e.id.substring(0,5),"..."]}),(0,$e.jsx)(Te,{to:`/applications/${e.id}`,className:"btn btn-xs btn-primary",children:"VER DETALLE"})]})]})]},e.id))),k(wt.REJECTED).length>5&&!w[wt.REJECTED]&&(0,$e.jsxs)("button",{onClick:()=>D(wt.REJECTED),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:["Ver ",k(wt.REJECTED).length-5," m\xe1s"]}),w[wt.REJECTED]&&(0,$e.jsx)("button",{onClick:()=>D(wt.REJECTED),className:"w-full py-2 text-sm text-primary hover:text-primary-focus hover:bg-base-200 rounded-md text-center transition-colors",children:"Ver menos"}),0===k(wt.REJECTED).length&&(0,$e.jsx)("div",{className:"text-center py-4 text-gray-500 italic",children:"No hay solicitudes"})]})]})]})]})},yg=e=>{let{applications:t,onRefresh:n}=e;const{user:r}=We();return(0,$e.jsx)(vg,{applications:t,onStatusChange:async(e,t,a)=>{if(null===r||void 0===r||!r.id)throw new Error("Usuario no autenticado");try{await gg(e.id,t,"advisor_status",`Estado cambiado a ${t} por asesor`,r.id),n&&n()}catch(o){throw console.error("Error updating advisor status:",o),o}},statusField:"advisor_status"})},bg=e=>{let{applications:t,onRefresh:n}=e;const{user:r}=We();return(0,$e.jsx)(vg,{applications:t,onStatusChange:async(e,t,a)=>{if(null===r||void 0===r||!r.id)throw new Error("Usuario no autenticado");try{await gg(e.id,t,"company_status",`Estado cambiado a ${t} por administrador de empresa`,r.id),n&&n()}catch(o){throw console.error("Error updating company status:",o),o}},statusField:"company_status"})},xg=()=>{const{userCan:e}=Qe(),{user:t}=We(),{getEntityFilter:n,shouldFilterByEntity:r,isAdvisor:o,isCompanyAdmin:s}=Qe(),i=ne(),[l,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(!0),[h,p]=(0,a.useState)(""),[m,f]=(0,a.useState)("all"),[g,v]=(0,a.useState)("selected_plans"),[y,b]=(0,a.useState)(""),[x,_]=(0,a.useState)(""),[w,N]=(0,a.useState)(""),[E,S]=(0,a.useState)(""),[j,k]=(0,a.useState)(!1),[C,D]=(0,a.useState)(null),[T,A]=(0,a.useState)("kanban"),[P,I]=(0,a.useState)("created_at"),[R,M]=(0,a.useState)("desc"),O=(0,a.useCallback)((async()=>{u(!0),D(null);try{const e=r()?n():null,t={status:"all"!==m?m:void 0,searchQuery:h||void 0,application_type:"selected_plans",dateFrom:y||void 0,dateTo:x||void 0,amountMin:w?parseFloat(w):void 0,amountMax:E?parseFloat(E):void 0};console.log("Aplicando filtros:",JSON.stringify(t,null,2));const a=await ug(t,e);if(console.log(`Solicitudes recuperadas: ${a.length}`),a.length>0){console.log("Tipos de solicitudes:",new Set(a.map((e=>e.application_type))));const e=a.filter((e=>"selected_plans"!==e.application_type));e.length>0&&(console.warn(`ADVERTENCIA: Se encontraron ${e.length} solicitudes que no son de tipo 'selected_plans':`),console.warn(e.map((e=>({id:e.id,type:e.application_type})))))}c(a)}catch(C){console.error("Error fetching applications:",C),D("Error al cargar las solicitudes: "+(C.message||"Error desconocido"))}finally{u(!1)}}),[h,m,g,y,x,w,E,r,n]);(0,a.useEffect)((()=>{O()}),[O]);const L=e=>{e===P?M("asc"===R?"desc":"asc"):(I(e),M("asc"))},$=e=>_t[e]||e;return e(He.VIEW_APPLICATIONS)?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"applications-page-container",children:[(0,$e.jsx)("div",{className:"flex-shrink-0",children:(0,$e.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h1",{className:"text-3xl font-bold",children:"Solicitudes de Cr\xe9dito"}),(0,$e.jsx)("p",{className:"text-gray-500",children:"Gestiona todas las solicitudes en un solo lugar."})]}),e(He.CREATE_APPLICATION)&&(0,$e.jsx)(Te,{to:"/new-application",className:"btn btn-primary mt-4 md:mt-0",children:"+ Nueva Solicitud"})]})}),(0,$e.jsxs)("div",{className:"kanban-content-wrapper",children:[(0,$e.jsx)("div",{children:(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,$e.jsx)("div",{className:"form-control w-full max-w-sm",children:(0,$e.jsx)("input",{type:"text",placeholder:"Buscar por nombre, email o tel\xe9fono",className:"input input-bordered w-full",value:h,onChange:e=>p(e.target.value)})}),(0,$e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,$e.jsx)("button",{className:"btn btn-ghost btn-sm",onClick:O,children:"Actualizar"}),(0,$e.jsxs)("button",{className:"btn btn-ghost btn-sm",onClick:()=>{k(!j)},children:[(0,$e.jsx)("i",{className:"fas fa-filter mr-2"}),"Mostrar Filtros"]}),(0,$e.jsxs)("div",{className:"tabs tabs-boxed",children:[(0,$e.jsx)("a",{className:"tab tab-sm "+("kanban"===T?"tab-active":""),onClick:()=>A("kanban"),children:"Kanban"}),(0,$e.jsx)("a",{className:"tab tab-sm "+("list"===T?"tab-active":""),onClick:()=>A("list"),children:"Lista"})]})]})]})}),(0,$e.jsx)("div",{className:"kanban-board-area",children:"kanban"===T?d?(0,$e.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,$e.jsx)("div",{className:"loader animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):C?(0,$e.jsx)("div",{className:"alert alert-error",children:(0,$e.jsxs)("div",{className:"flex-1",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mx-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,$e.jsx)("label",{children:C})]})}):o()?(0,$e.jsx)(yg,{applications:l,onRefresh:O}):s()?(0,$e.jsx)(bg,{applications:l,onRefresh:O}):(0,$e.jsx)(vg,{applications:l,statusField:"global_status",onStatusChange:async(e,t)=>{await O()}}):d?(0,$e.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,$e.jsx)("div",{className:"loader animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):C?(0,$e.jsx)("div",{className:"alert alert-error",children:(0,$e.jsxs)("div",{className:"flex-1",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mx-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,$e.jsx)("label",{children:C})]})}):0===l.length?(0,$e.jsxs)("div",{className:"text-center py-12",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,$e.jsx)("h3",{className:"mt-4 text-xl font-medium text-gray-600",children:"No se encontraron solicitudes"}),(0,$e.jsx)("p",{className:"mt-2 text-gray-500",children:"Intenta cambiar los filtros de b\xfasqueda"})]}):(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table table-zebra w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{onClick:()=>L("client_name"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Cliente","client_name"===P&&(0,$e.jsx)("span",{className:"ml-2 text-primary",children:"asc"===R?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>L("company_name"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Empresa","company_name"===P&&(0,$e.jsx)("span",{className:"ml-2 text-primary",children:"asc"===R?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>L("application_type"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Tipo","application_type"===P&&(0,$e.jsx)("span",{className:"ml-2 text-primary",children:"asc"===R?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>L("amount"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Monto","amount"===P&&(0,$e.jsx)("span",{className:"ml-2 text-primary",children:"asc"===R?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>L("status"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Estado","status"===P&&(0,$e.jsx)("span",{className:"ml-2 text-primary",children:"asc"===R?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>L("created_at"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Fecha y Hora","created_at"===P&&(0,$e.jsx)("span",{className:"ml-2 text-primary",children:"asc"===R?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{className:"text-center",children:"Detalle"})]})}),(0,$e.jsx)("tbody",{children:[...l].sort(((e,t)=>{let n=e[P],r=t[P];return null!==n&&void 0!==n||(n=""),null!==r&&void 0!==r||(r=""),"number"!==typeof n&&(n=String(n).toLowerCase()),"number"!==typeof r&&(r=String(r).toLowerCase()),"asc"===R?n>r?1:n<r?-1:0:n<r?1:n>r?-1:0})).map((e=>{return(0,$e.jsxs)("tr",{className:"hover cursor-pointer",onClick:()=>i(`/applications/${e.id}`),children:[(0,$e.jsx)("td",{children:e.client_name||"N/A"}),(0,$e.jsx)("td",{children:e.company_name||"N/A"}),(0,$e.jsx)("td",{children:(0,$e.jsx)("span",{className:`badge ${"producto"===e.financing_type?"badge-primary":"personal"===e.financing_type?"badge-secondary":"badge-primary"} badge-outline`,children:"producto"===e.financing_type?"Financiamiento de Producto":"personal"===e.financing_type?"Cr\xe9dito Personal":"selected_plans"===e.application_type&&e.product_type?$(e.product_type):$(e.application_type)})}),(0,$e.jsx)("td",{children:(t=Number(e.amount||0),St(t))}),(0,$e.jsx)("td",{children:(0,$e.jsx)("span",{className:"badge badge-"+(e.status===wt.APPROVED?"success":e.status===wt.REJECTED?"error":e.status===wt.NEW?"warning":e.status===wt.IN_REVIEW?"info":e.status===wt.COMPLETED?"success":e.status===wt.POR_DISPERSAR?"warning":"ghost"),children:Nt[e.status]||e.status})}),(0,$e.jsx)("td",{children:e.created_at?jt(e.created_at):"N/A"}),(0,$e.jsx)("td",{className:"text-center",children:(0,$e.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:t=>{t.stopPropagation(),i(`/applications/${e.id}`)},title:`Ver detalles de la solicitud ${e.id}`,children:[e.id.substring(0,5),"..."]})})]},e.id);var t}))})]})})})]})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,$e.jsxs)("div",{className:"text-center",children:[(0,$e.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,$e.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},_g=e=>{let{type:t,message:n,onClose:r,autoClose:o=!1,autoCloseTime:s=5e3,className:i=""}=e;const[l,c]=(0,a.useState)(!0);(0,a.useEffect)((()=>{if(o&&l){const e=setTimeout((()=>{d()}),s);return()=>clearTimeout(e)}}),[o,s,l]);const d=()=>{c(!1),r&&r()};if(!l)return null;const u=n instanceof Error?n.message:"object"===typeof n?JSON.stringify(n):String(n);return(0,$e.jsxs)("div",{className:`alert ${(()=>{switch(t){case"error":return"alert-error";case"success":return"alert-success";case"info":default:return"alert-info";case"warning":return"alert-warning"}})()} ${i}`,children:[(()=>{switch(t){case"error":return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"success":return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"info":return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});default:return null}})(),(0,$e.jsx)("span",{children:u}),r&&(0,$e.jsx)("button",{onClick:d,className:"btn btn-sm btn-ghost","aria-label":"Cerrar",children:"\u2715"})]})};var wg=n(768);const Ng=()=>{const{userCan:e,isAdvisor:t,isCompanyAdmin:n,isAdmin:r}=Qe(),{user:o}=We(),{getEntityFilter:s,shouldFilterByEntity:i}=Qe(),l=ee(),[c,d]=(0,a.useState)([]),[u,h]=(0,a.useState)(!0),[p,m]=(0,a.useState)(null),[f,g]=(0,a.useState)(null),v=a.useRef(!1),[y,b]=(a.useRef({}),(0,a.useState)(!1)),[x,_]=(0,a.useState)(""),[w,N]=(0,a.useState)("all"),[E,S]=(0,a.useState)("selected_plans"),[j,k]=(0,a.useState)(""),[C,D]=(0,a.useState)(""),[T,A]=(0,a.useState)(""),[P,I]=(0,a.useState)(""),[R,M]=(0,a.useState)(!1),O=(0,a.useCallback)((()=>t()?"advisor_status":n()?"company_status":r()?"global_status":"status"),[t,n,r]),L=O(),$=(0,a.useCallback)((async()=>{try{h(!0),m(null);const e="attention_needed"===new URLSearchParams(l.search).get("filter");b(e);const t=i()?s():null,n={status:"all"!==w?w:void 0,searchQuery:x||void 0,application_type:"selected_plans",dateFrom:j||void 0,dateTo:C||void 0,amountMin:T?parseFloat(T):void 0,amountMax:P?parseFloat(P):void 0};console.log("Applying filters:",JSON.stringify(n,null,2)),console.log("Type filter value:",E),console.log("Attention needed filter:",e);const r=await ug(n,t);console.log(`Applications retrieved: ${r.length}`);const a=new Set(r.map((e=>e.application_type)));if(console.log("Retrieved application types:",Array.from(a)),n.application_type){const e=r.filter((e=>e.application_type===n.application_type)).length;console.log(`Expected ${e} applications with type '${n.application_type}', got ${r.length}`)}const o=[...r].sort(((e,t)=>{const n=new Date(e.created_at),r=new Date(t.created_at);return n.getTime()-r.getTime()}));d(o),v.current=!1}catch(p){console.error("Error fetching applications:",p),m("Error al cargar las solicitudes: "+(p.message||"Error desconocido"))}finally{h(!1)}}),[i,s,x,w,E,j,C,T,P,l.search]);(0,a.useEffect)((()=>{$();const e=setInterval((()=>{v.current&&$()}),5e3);return()=>clearInterval(e)}),[$]);const F=(e,t,n)=>{d((r=>r.map((r=>{if(r.id===e.id){const e={...r};return"advisor_status"===t?(e.advisor_status=n,e.status=n):"company_status"===t?(e.company_status=n,e.status=n):"global_status"===t?(e.global_status=n,e.status=n):e.status=n,e}return r}))))};return e(He.VIEW_APPLICATIONS)?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"flex flex-col h-full",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold",children:"Tablero de Solicitudes"}),(0,$e.jsxs)("div",{className:"flex gap-2",children:[y&&(0,$e.jsxs)("div",{className:"badge badge-warning gap-1",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Mostrando s\xf3lo solicitudes que requieren atenci\xf3n"]}),e(He.CREATE_APPLICATION)&&(0,$e.jsx)(Te,{to:"/applications/new",className:"btn btn-sm btn-primary",children:"Nueva Solicitud"})]})]}),p&&(0,$e.jsx)(_g,{type:"error",message:p}),f&&(0,$e.jsx)(_g,{type:"success",message:f}),u?(0,$e.jsx)("div",{className:"flex justify-center items-center p-8 h-full",children:(0,$e.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})})}):(0,$e.jsx)("div",{className:"flex-grow overflow-auto",children:(0,$e.jsx)(vg,{applications:c,onStatusChange:async(e,a)=>{const o=c.find((t=>t.id===e));if(!o)return void console.error("No se encontr\xf3 la aplicaci\xf3n");const s="advisor_status"===O()?o.advisor_status:"company_status"===O()?o.company_status:"global_status"===O()?o.global_status:o.status;if(a===wt.REJECTED)try{console.log(`Rejecting application as ${O()}`);let a=!1,i=!1;t()?(a=!0,i=!1):n()?(a=!1,i=!0):r()&&(a="advisor_status"===O(),i="company_status"===O()),console.log(`Rejecting with flags - advisor: ${a}, company: ${i}`);const l=`\n          UPDATE applications \n          SET \n            status = '${wt.REJECTED}', \n            ${a?`advisor_status = '${wt.REJECTED}',`:""}\n            ${i?`company_status = '${wt.REJECTED}',`:""}\n            ${r()&&"global_status"===O()?`global_status = '${wt.REJECTED}',`:""}\n            rejected_by_advisor = ${a||o.rejected_by_advisor?"TRUE":"FALSE"},\n            rejected_by_company = ${i||o.rejected_by_company?"TRUE":"FALSE"},\n            previous_status = '${s}',\n            previous_advisor_status = '${a?s:o.previous_advisor_status||""}',\n            previous_company_status = '${i?s:o.previous_company_status||""}',\n            previous_global_status = '${r()&&"global_status"===O()?s:o.previous_global_status||""}'\n          WHERE id = '${e}'\n        `;return console.log(`Executing update query with rejection flags - advisor: ${a}, company: ${i}`),await Yf.ND.rpc("execute_sql",{query_text:l}),F(o,O(),wt.REJECTED),wg.oR.success("La solicitud ha sido rechazada correctamente."),v.current=!0,void $()}catch(p){return console.error("Error al actualizar el estado de la solicitud:",p.message),void wg.oR.error("Error al actualizar el estado de la solicitud")}if(s===wt.REJECTED&&a!==wt.REJECTED)try{const t=o.previous_status||wt.NEW,n=o.previous_advisor_status||wt.NEW,r=o.previous_company_status||wt.NEW,a=`\n          UPDATE applications \n          SET \n            status = '${t}', \n            advisor_status = '${n}', \n            company_status = '${r}', \n            global_status = '${o.previous_global_status||wt.NEW}',\n            rejected_by_advisor = FALSE,\n            rejected_by_company = FALSE\n          WHERE id = '${e}'\n        `;return await Yf.ND.rpc("execute_sql",{query_text:a}),F(o,O(),t),wg.oR.success("La solicitud ha sido reactivada correctamente."),void(v.current&&$())}catch(p){return console.error("Error al reactivar la solicitud:",p.message),void wg.oR.error("Error al reactivar la solicitud")}try{console.log(`Actualizando estado de ${O()} a ${a} para solicitud ${e}`);const t=`\n        UPDATE applications \n        SET \n          ${O()} = '${a}',\n          status = '${a}'\n        WHERE id = '${e}'\n      `;await Yf.ND.rpc("execute_sql",{query_text:t}),F(o,O(),a),wg.oR.success("El estado de la solicitud ha sido actualizado correctamente."),v.current=!0,$()}catch(p){console.error("Error al actualizar el estado de la solicitud:",p.message),wg.oR.error("Error al actualizar el estado de la solicitud")}},statusField:L,applicationTypeFilter:"selected_plans",attentionNeededOnly:y})})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,$e.jsxs)("div",{className:"text-center",children:[(0,$e.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,$e.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})};var Eg=n(358);const Sg=e=>{let{clientId:t,clientName:n,applicationId:r,className:o="",useSync:s=!1}=e;const i=ne(),[l,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[m,f]=(0,a.useState)(null);(0,a.useEffect)((()=>{if(!t)return u("No client ID provided"),void p(!1);let e=!0;return(async()=>{try{let n;c(!0),u(null),console.log(`[ClientProfileButton] Fetching client data: ${t}`),n=s?await(0,Eg.getClientWithSync)(t):await(0,Eg.getClientFromAnySource)(t),e&&(n?(f(n),p(!0),console.log(`[ClientProfileButton] Client ${t} found`)):(p(!1),console.log(`[ClientProfileButton] Client ${t} not found, will create on click`)))}catch(n){console.error(`[ClientProfileButton] Error checking client: ${n}`),e&&(u("Failed to check client status"),p(!1))}finally{e&&c(!1)}})(),()=>{e=!1}}),[t,s,n]);return(0,$e.jsxs)("div",{className:`relative ${o}`,children:[(0,$e.jsx)(lt,{variant:d?"error":"primary",isLoading:l,isDisabled:l,onClick:async()=>{if(t)try{c(!0),u(null);const e=await(0,Eg.getCanonicalClientId)(t);console.log(`[ClientProfileButton] Resolved canonical ID: ${t} -> ${e}`);const a=e||t;if(s){return await(0,Eg.getClientWithSync)(a)?(i(`/clients/${a}`,{state:{fromApplication:!!r,applicationId:r,autoCreated:!1}}),void c(!1)):(u("Unable to create or find client profile"),void c(!1))}if(!1===h){console.log(`[ClientProfileButton] Creating missing client: ${a}`);const e=await(0,Eg.createMissingClient)(a,n);if(!e)return u("Unable to create client profile"),void c(!1);console.log(`[ClientProfileButton] Successfully created client: ${e.id}`)}i(`/clients/${a}`,{state:{fromApplication:!!r,applicationId:r,autoCreated:!1===h,originalClientId:e!==t?t:void 0}})}catch(e){console.error(`[ClientProfileButton] Error navigating to client: ${e}`),u("Failed to navigate to client profile"),c(!1)}else console.error("[ClientProfileButton] Cannot navigate: No client ID")},className:"w-full",children:l?"Checking...":d?"Error":!1===h?"Create & View Client":"View Client Profile"}),d&&(0,$e.jsx)("div",{className:"text-red-500 text-xs mt-1",children:d})]})};var jg=n(287),kg={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Cg=a.createContext&&a.createContext(kg),Dg=function(){return Dg=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Dg.apply(this,arguments)},Tg=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function Ag(e){return e&&e.map((function(e,t){return a.createElement(e.tag,Dg({key:t},e.attr),Ag(e.child))}))}function Pg(e){return function(t){return a.createElement(Ig,Dg({attr:Dg({},e.attr)},t),Ag(e.child))}}function Ig(e){var t=function(t){var n,r=e.attr,o=e.size,s=e.title,i=Tg(e,["attr","size","title"]),l=o||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),a.createElement("svg",Dg({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,i,{className:n,style:Dg(Dg({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&a.createElement("title",null,s),e.children)};return void 0!==Cg?a.createElement(Cg.Consumer,null,(function(e){return t(e)})):t(kg)}function Rg(e){return Pg({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"}}]})(e)}function Mg(e){return Pg({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"7 10 12 15 17 10"}},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"}}]})(e)}function Og(e){return Pg({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}},{tag:"polyline",attr:{points:"13 2 13 9 20 9"}}]})(e)}function Lg(e){return Pg({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"}}]})(e)}function $g(e){return Pg({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"17 8 12 3 7 8"}},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"}}]})(e)}function Fg(e){return Pg({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(e)}const zg=e=>{let{categories:t,onDocumentAdded:n,onDocumentRemoved:r,existingDocuments:o,clientId:s,existingServerDocuments:i=[]}=e;const[l,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[h,p]=(0,a.useState)(null),[m,f]=(0,a.useState)(!1),[g,v]=(0,a.useState)(null),[y,b]=(0,a.useState)(!1),x=(0,a.useRef)(null);(0,a.useEffect)((()=>(console.log("DocumentUploader montado con clientId:",s),console.log("Documentos existentes en sesi\xf3n:",o),console.log("Documentos existentes en servidor:",i),()=>{h&&p(null)})),[s,o,i]);const _=e=>{const n=t.find((t=>t.value===e));return n?n.label:e},w=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},N=e=>{try{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?f(!0):"dragleave"===e.type&&f(!1)}catch(t){console.error("Error en evento de arrastre:",t),f(!1),v("Hubo un problema al procesar el evento de arrastre")}};return(0,$e.jsxs)("div",{className:"space-y-6",children:[(0,$e.jsx)("div",{className:"card bg-base-100 border border-gray-200",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h3",{className:"card-title text-base mb-4",children:"Agregar Documento"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Categor\xeda"})}),(0,$e.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"select select-bordered w-full "+(g&&!l?"select-error":""),children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar categor\xeda"}),t.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Nombre del Documento"})}),(0,$e.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"input input-bordered w-full "+(g&&!d?"input-error":""),placeholder:"Ingresa un nombre descriptivo"})]})]}),(0,$e.jsxs)("div",{className:"mt-4 border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors "+(m?"border-primary bg-primary/10":h?"border-success bg-success/10":"border-gray-300 hover:border-primary hover:bg-primary/5"),onClick:()=>{x.current&&x.current.click()},onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:e=>{try{if(e.preventDefault(),e.stopPropagation(),f(!1),e.dataTransfer.files&&e.dataTransfer.files[0]){if(p(e.dataTransfer.files[0]),!d){const t=e.dataTransfer.files[0].name.split(".")[0];u(t)}v(null)}}catch(t){console.error("Error al soltar el archivo:",t),v("Hubo un problema al procesar el archivo soltado")}},children:[(0,$e.jsx)("input",{ref:x,type:"file",className:"hidden",onChange:e=>{try{if(e.target&&e.target.files&&e.target.files.length>0){const n=e.target.files[0];if(!n)return void v("El archivo seleccionado no es v\xe1lido");if(n.size>10485760)return void v("El archivo es demasiado grande. El tama\xf1o m\xe1ximo es 10MB");if(p(n),!d)try{const e=n.name.split(".")[0];u(e)}catch(t){console.error("Error extracting filename:",t),u(`Documento-${(new Date).toISOString().substring(0,10)}`)}v(null)}}catch(t){console.error("Error al seleccionar el archivo:",t),v("Hubo un problema al procesar el archivo seleccionado")}},accept:"*/*"}),h?(0,$e.jsxs)("div",{className:"flex flex-col items-center",children:[(0,$e.jsx)(Rg,{className:"w-10 h-10 text-success mb-2"}),(0,$e.jsx)("p",{className:"font-semibold",children:h.name}),(0,$e.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:w(h.size)})]}):(0,$e.jsxs)("div",{className:"flex flex-col items-center",children:[(0,$e.jsx)($g,{className:"w-10 h-10 text-gray-400 mb-2"}),(0,$e.jsx)("p",{className:"font-semibold",children:"Arrastra archivos aqu\xed o haz clic para seleccionar"}),(0,$e.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Se acepta cualquier formato de archivo"})]})]}),g&&(0,$e.jsxs)("div",{className:"alert alert-error mt-4",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:g})]}),!s&&(0,$e.jsxs)("div",{className:"alert alert-info mt-4",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:"Los documentos se guardar\xe1n temporalmente y se asociar\xe1n al cliente cuando complete el registro."})]}),(0,$e.jsx)("div",{className:"card-actions justify-end mt-4",children:(0,$e.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:()=>{if(!y)try{if(b(!0),!l)return v("Selecciona una categor\xeda para el documento"),void b(!1);if(!d||!d.trim())return v("Ingresa un nombre para el documento"),void b(!1);if(!h)return v("Selecciona un archivo para subir"),void b(!1);s||console.log("Advertencia: clientId no est\xe1 definido, el documento se guardar\xe1 pero solo se asociar\xe1 al guardar el cliente");const e={file:h,category:l,name:d.trim()};n(e),setTimeout((()=>{c(""),u(""),p(null),v(null),x.current&&(x.current.value=""),b(!1)}),100)}catch(e){console.error("Error al procesar el documento:",e),v("Hubo un problema al agregar el documento. Por favor, intente de nuevo."),b(!1)}},disabled:!h||!l||!d,children:[(0,$e.jsx)(Lg,{className:"mr-2"}),"Agregar Documento"]})})]})}),(o.length>0||i.length>0)&&(0,$e.jsx)("div",{className:"card bg-base-100 border border-gray-200",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsxs)("h3",{className:"card-title text-base mb-4",children:["Documentos (",o.length+i.length,")"]}),(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{children:"Nombre"}),(0,$e.jsx)("th",{children:"Categor\xeda"}),(0,$e.jsx)("th",{children:"Tama\xf1o"}),(0,$e.jsx)("th",{children:"Acciones"})]})}),(0,$e.jsxs)("tbody",{children:[i.map(((e,t)=>(0,$e.jsxs)("tr",{className:"bg-gray-50",children:[(0,$e.jsxs)("td",{className:"flex items-center gap-2",children:[(0,$e.jsx)(Og,{className:"text-green-500"}),e.name,(0,$e.jsx)("span",{className:"badge badge-sm badge-success",children:"Guardado"})]}),(0,$e.jsx)("td",{children:_(e.category)}),(0,$e.jsx)("td",{children:"-"}),(0,$e.jsx)("td",{children:(0,$e.jsxs)("span",{className:"text-xs text-green-600",children:[(0,$e.jsx)(Rg,{})," En servidor"]})})]},`server-${e.id}`))),o.map(((e,t)=>(0,$e.jsxs)("tr",{children:[(0,$e.jsxs)("td",{className:"flex items-center gap-2",children:[(0,$e.jsx)(Og,{}),e.name,(0,$e.jsx)("span",{className:"badge badge-sm badge-warning",children:"Pendiente"})]}),(0,$e.jsx)("td",{children:_(e.category)}),(0,$e.jsx)("td",{children:w(e.file.size)}),(0,$e.jsx)("td",{children:(0,$e.jsx)("button",{type:"button",onClick:()=>r(t),className:"btn btn-sm btn-ghost text-error",children:(0,$e.jsx)(Fg,{})})})]},`session-${t}`)))]})]})})]})})]})},Bg={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ydnygntfkrleiseuciwq.supabase.co",REACT_APP_SUPABASE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczOTk5MjQwNiwiZXhwIjoyMDU1NTY4NDA2fQ.TwhEGW9DK4DTQQRquT6Z9UW8T8UjLX-hp9uKdRjWAhs"}.NEXT_PUBLIC_SUPABASE_URL||"https://ydnygntfkrleiseuciwq.supabase.co",Ug={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ydnygntfkrleiseuciwq.supabase.co",REACT_APP_SUPABASE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczOTk5MjQwNiwiZXhwIjoyMDU1NTY4NDA2fQ.TwhEGW9DK4DTQQRquT6Z9UW8T8UjLX-hp9uKdRjWAhs"}.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk5OTI0MDYsImV4cCI6MjA1NTU2ODQwNn0.B-dH2Kptzz1oyM4ynno_GjlvjpxL-HbNKC_st4bgf0A",Wg="supabase.auth.token",Vg=(()=>{if(!Bg||!Ug)return console.error("Supabase URL or Anon Key is missing!"),(0,Ie.UU)("https://ydnygntfkrleiseuciwq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk5OTI0MDYsImV4cCI6MjA1NTU2ODQwNn0.B-dH2Kptzz1oyM4ynno_GjlvjpxL-HbNKC_st4bgf0A",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:Wg},global:{headers:{"x-application-name":"CRM"}}});const e={auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:Wg},global:{headers:{"x-application-name":"CRM"}}};return(0,Ie.UU)(Bg,Ug,e)})();const Hg=["PENDIENTE DE ENVIO","ENVIADO","FIRMADO","CANCELADO"],qg={"PENDIENTE DE ENVIO":"badge-neutral",ENVIADO:"badge-info",FIRMADO:"badge-success",CANCELADO:"badge-error"},Yg={"PENDIENTE DE ENVIO":"\u23f3",ENVIADO:"\ud83d\udce4",FIRMADO:"\u2705",CANCELADO:"\u274c"},Jg=e=>{let{applicationId:t,initialEnvelopeId:n="",initialSentTo:r="",initialStatus:o="PENDIENTE DE ENVIO",clientEmail:s="",onSaved:i,sandbox:l=!1}=e;const[c,d]=(0,a.useState)(n||""),[u,h]=(0,a.useState)(r||s||""),[p,m]=(0,a.useState)(o||"PENDIENTE DE ENVIO"),[f,g]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[b,x]=(0,a.useState)(!1),[_,w]=(0,a.useState)(!1),N=Boolean(n||r||o);(0,a.useEffect)((()=>{x(N),w(!N)}),[N]);const E=c?function(e){return`${arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"https://demo.docusign.net":"https://apps.docusign.com"}/send/documents/details/${encodeURIComponent(e)}`}(c,l):null;return(0,$e.jsxs)("div",{className:"border rounded-lg bg-base-100 mt-4 overflow-hidden",children:[(0,$e.jsx)("div",{className:"bg-base-200 px-4 py-3 border-b",children:(0,$e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:"\ud83d\udcc4 Documentos para Firma Digital (DocuSign)"}),b&&!_&&(0,$e.jsx)("button",{onClick:()=>{w(!0),y(null)},className:"btn btn-sm btn-ghost",children:"\u270f\ufe0f Editar"})]})}),(0,$e.jsx)("div",{className:"p-4",children:b&&!_?(0,$e.jsxs)("div",{className:"space-y-4",children:[(0,$e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,$e.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Estado:"}),(0,$e.jsxs)("div",{className:`badge ${qg[p]} gap-2`,children:[(0,$e.jsx)("span",{children:Yg[p]}),p]})]}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"bg-base-200 p-3 rounded-lg",children:[(0,$e.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Envelope ID"}),(0,$e.jsx)("p",{className:"font-mono text-sm break-all",children:c})]}),(0,$e.jsxs)("div",{className:"bg-base-200 p-3 rounded-lg",children:[(0,$e.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Enviado a"}),(0,$e.jsx)("p",{className:"text-sm",children:u})]})]}),E&&(0,$e.jsx)("div",{className:"flex justify-center",children:(0,$e.jsx)("a",{href:E,target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary btn-sm gap-2",children:"\ud83d\udd17 Ver en DocuSign"})})]}):(0,$e.jsxs)("div",{className:"space-y-4",children:[(0,$e.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[(0,$e.jsxs)("div",{className:"flex flex-col",children:[(0,$e.jsx)("label",{className:"text-sm font-medium mb-1",children:"Envelope ID *"}),(0,$e.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),className:"input input-sm input-bordered",placeholder:"60aafb0b-684d-467c-b03e-c114ab1334d8"})]}),(0,$e.jsxs)("div",{className:"flex flex-col",children:[(0,$e.jsx)("label",{className:"text-sm font-medium mb-1",children:"Enviado a *"}),(0,$e.jsx)("input",{type:"email",value:u,onChange:e=>h(e.target.value),className:"input input-sm input-bordered",placeholder:"cliente@example.com"})]}),(0,$e.jsxs)("div",{className:"flex flex-col",children:[(0,$e.jsx)("label",{className:"text-sm font-medium mb-1",children:"Estado"}),(0,$e.jsx)("select",{value:p,onChange:e=>m(e.target.value),className:"select select-sm select-bordered",children:Hg.map((e=>(0,$e.jsxs)("option",{value:e,children:[Yg[e]," ",e]},e)))})]})]}),v&&(0,$e.jsx)("div",{className:"alert alert-error alert-sm",children:(0,$e.jsx)("span",{children:v})}),(0,$e.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[b&&(0,$e.jsx)("button",{onClick:()=>{d(n||""),h(r||s||""),m(o||"PENDIENTE DE ENVIO"),w(!1),y(null)},className:"btn btn-sm btn-ghost",disabled:f,children:"Cancelar"}),(0,$e.jsx)("button",{className:"btn btn-sm btn-primary "+(f?"loading":""),onClick:async()=>{if(c.trim()?u.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)?(y(null),1):(y("Correo inv\xe1lido"),0):(y("El correo destino es requerido"),0):(y("Envelope ID es requerido"),0))try{g(!0);const{error:e}=await Vg.from("applications").update({docusign_envelope_id:c.trim(),docusign_sent_to:u.trim(),docusign_manual_status:p,updated_at:(new Date).toISOString()}).eq("id",t);if(e)throw e;x(!0),w(!1),i&&i({envelopeId:c.trim(),sentTo:u.trim(),status:p})}catch(e){console.error("Error saving DocuSign fields:",e),y(e.message||"Error al guardar")}finally{g(!1)}},disabled:f,children:f?"Guardando...":"Guardar"})]})]})})]})},Qg=e=>{switch((e||"").toLowerCase()){case"advisor":return"Asesor";case"company_admin":case"empresa":return"Empresa";default:return"Usuario"}},Kg=e=>{let{applicationId:t}=e;const{user:n}=We(),{userCan:r,isAdvisor:o,isCompanyAdmin:s}=Qe(),[i,l]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(null),[p,m]=(0,a.useState)(""),[f,g]=(0,a.useState)(!1),v=Boolean(n)&&(o()||s()),y=async()=>{try{d(!0);const e=await(async(e,t)=>{if(t){let n=`\n      SELECT id FROM ${qf.C.APPLICATIONS} \n      WHERE id = '${e}'\n    `;t.advisor_id&&(n+=` AND assigned_to = '${t.advisor_id}'`),t.company_id&&(n+=` AND company_id = '${t.company_id}'`);const r=await eg(n);if(!r||0===r.length)throw new Error("Application not found or you do not have permission to view its comments")}try{const{data:t,error:n}=await Yf.ND.from("v_comments_users").select("*").eq("application_id",e).order("created_at",{ascending:!1});if(n)throw n;return t||[]}catch(u){throw console.error(`Error fetching comments for application ${e}:`,u),u}})(t);l(e||[])}catch(e){h((null===e||void 0===e?void 0:e.message)||"Error al cargar comentarios")}finally{d(!1)}};(0,a.useEffect)((()=>{y()}),[t]);return(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl mt-6",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg mb-4",children:"Comentarios"}),c?(0,$e.jsx)("div",{className:"flex justify-center py-4",children:(0,$e.jsx)("span",{className:"loading loading-spinner"})}):u?(0,$e.jsx)("div",{className:"alert alert-error",children:(0,$e.jsx)("span",{children:u})}):0===i.length?(0,$e.jsx)("p",{className:"text-gray-500",children:"A\xfan no hay comentarios."}):(0,$e.jsx)("ul",{className:"space-y-3 max-h-60 overflow-y-auto pr-2",children:i.map((e=>(0,$e.jsxs)("li",{className:"border rounded-lg p-3 bg-base-200",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,$e.jsx)("span",{className:"font-semibold text-sm",children:e.user_name||"Usuario"}),(0,$e.jsx)("span",{className:"badge badge-outline badge-xs ml-2 text-xs",children:Qg(e.user_role)}),(0,$e.jsx)("span",{className:"text-xs text-gray-500",children:jt(e.created_at)})]}),(0,$e.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.text})]},e.id)))}),v&&(0,$e.jsxs)("div",{className:"mt-4",children:[(0,$e.jsx)("textarea",{className:"textarea textarea-bordered w-full",rows:3,placeholder:"Escribe un comentario...",value:p,onChange:e=>m(e.target.value)}),(0,$e.jsx)("button",{className:"btn btn-primary btn-sm mt-2",onClick:async()=>{if(p.trim())try{g(!0),await(async(e,t,n,r)=>{if(r){let t=`\n      SELECT id FROM ${qf.C.APPLICATIONS} \n      WHERE id = '${e}'\n    `;r.advisor_id&&(t+=` AND assigned_to = '${r.advisor_id}'`),r.company_id&&(t+=` AND company_id = '${r.company_id}'`);const n=await eg(t);if(!n||0===n.length)throw new Error("Application not found or you do not have permission to comment on it")}try{const{data:r,error:a}=await Yf.ND.from(qf.C.COMMENTS).insert({application_id:e,user_id:t,text:n}).select().single();if(a)throw a;return r}catch(u){throw console.error(`Error adding comment to application ${e}:`,u),u}})(t,n.id,p.trim()),m(""),await y()}catch(e){h((null===e||void 0===e?void 0:e.message)||"Error al guardar")}finally{g(!1)}},disabled:f||!p.trim(),children:f?"Guardando...":"Agregar comentario"})]})]})})},Gg=e=>{switch(e){case"approved":return"badge-success";case"rejected":return"badge-error";case"pending":case"in_review":return"badge-warning";case"cancelled":default:return"badge-secondary";case"completed":return"badge-primary";case"solicitud":case"new":return"badge-info";case"por_dispersar":return"badge-accent"}},Xg=e=>!!e&&("producto"===e.financing_type||!!(e.product_url||e.product_title||e.product_image)),Zg=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!e||0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB","TB"][t]},ev=e=>{var t,n;let{document:r,onClose:o}=e;const[s,i]=(0,a.useState)(!0),[l,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[h,p]=(0,a.useState)(!1);(0,a.useEffect)((()=>((async()=>{try{var e;if(i(!0),c(null),p(!1),u(null),!r.file_path)throw new Error("El documento no tiene una ruta de archivo v\xe1lida");const a=null===(e=r.file_path.split(".").pop())||void 0===e?void 0:e.toLowerCase();console.log(`[DocViewer] Loading document. Extension: ${a}, Original file_type: ${r.file_type}, Path: ${r.file_path}`);const o=a&&["jpg","jpeg","png","gif","webp","bmp","svg"].includes(a),s="pdf"===a,l=(0,tt.X3)();let d=null;if(o){console.log("[DocViewer] Document is an image. Attempting direct download and blob URL creation.");const{data:e,error:n}=await l.storage.from("client-documents").download(r.file_path);if(n||!e)throw console.error("[DocViewer] Error downloading image data:",n),new Error(`Error al descargar los datos de la imagen: ${(null===n||void 0===n?void 0:n.message)||"Error desconocido"}`);console.log(`[DocViewer] Image data downloaded successfully: ${e.size} bytes`);const o=a&&{png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",svg:"image/svg+xml"}[a]||"application/octet-stream";let s;try{const t=await e.arrayBuffer(),n=new Uint8Array(t);let r=0;const a=[137,80,78,71],i=[255,216,255],l=(e,t)=>e.every(((e,r)=>n[t+r]===e));for(let e=0;e<n.length-4;e++)if(l(a,e)||l(i,e)){r=e;break}if(r>0){console.log(`[DocViewer] Detected binary header at index ${r}. Stripping multipart preamble.`);const e=n.slice(r);s=new Blob([e],{type:o})}else s=new Blob([n],{type:o})}catch(t){console.error("[DocViewer] Error sanitizing image data, falling back to original blob",t),s=new Blob([e],{type:o})}d=URL.createObjectURL(s),console.log(`[DocViewer] Sanitized Blob URL for image created: ${d.substring(0,50)}...`)}else if(s){console.log("[DocViewer] Document is a PDF. Downloading for sanitation.");const{data:e,error:t}=await l.storage.from("client-documents").download(r.file_path);if(t||!e)throw console.error("[DocViewer] Error downloading PDF data:",t),new Error(`Error al descargar los datos del PDF: ${(null===t||void 0===t?void 0:t.message)||"Error desconocido"}`);let a;console.log(`[DocViewer] PDF data downloaded successfully: ${e.size} bytes`);try{const t=await e.arrayBuffer(),n=new Uint8Array(t);let r=0;const o=[37,80,68,70,45],s=e=>o.every(((t,r)=>n[e+r]===t));for(let e=0;e<n.length-5;e++)if(s(e)){r=e;break}if(r>0){console.log(`[DocViewer] Detected PDF header at index ${r}. Stripping multipart preamble.`);const e=n.slice(r);a=new Blob([e],{type:"application/pdf"})}else a=new Blob([n],{type:"application/pdf"})}catch(n){console.error("[DocViewer] Error sanitizing PDF, using original data",n),a=new Blob([e],{type:"application/pdf"})}d=URL.createObjectURL(a),console.log(`[DocViewer] Sanitized Blob URL for PDF created: ${d.substring(0,50)}...`)}else{console.log("[DocViewer] Document is other type. Trying public URL for download purposes.");const{data:e}=await l.storage.from("client-documents").getPublicUrl(r.file_path);if(null!==e&&void 0!==e&&e.publicUrl)d=e.publicUrl,console.log(`[DocViewer] Public URL for other file type: ${d}`);else{console.log("[DocViewer] Public URL for other type not available. Downloading for blob URL (for download attribute).");const{data:e,error:t}=await l.storage.from("client-documents").download(r.file_path);if(t||!e)throw console.error("[DocViewer] Error downloading other file data:",t),new Error(`Error al descargar el archivo: ${(null===t||void 0===t?void 0:t.message)||"Error desconocido"}`);const n=r.file_type||"application/octet-stream",a=new Blob([e],{type:n});d=URL.createObjectURL(a),console.log(`[DocViewer] Blob URL for other file type created: ${d.substring(0,50)}...`)}}u(d)}catch(a){console.error("[DocViewer] General error in loadDocument:",a),c(a instanceof Error?a.message:"Error al cargar el documento")}finally{i(!1)}})(),()=>{d&&d.startsWith("blob:")&&(URL.revokeObjectURL(d),console.log("[DocViewer] Blob URL revoked:",d.substring(0,50)))})),[r.id,r.file_path]);const m=null===(t=r.file_path)||void 0===t||null===(n=t.split(".").pop())||void 0===n?void 0:n.toLowerCase(),f=m&&["jpg","jpeg","png","gif","webp","bmp","svg"].includes(m),g="pdf"===m,v=()=>{if(!d)return;const e=window.document.createElement("a");e.href=d,e.download=r.file_name||"documento",f&&d.startsWith("http"),window.document.body.appendChild(e),e.click(),window.document.body.removeChild(e),console.log(`[DocViewer] Download initiated for: ${r.file_name}, URL: ${d.substring(0,50)}`)};return console.log(`[DocViewer] Rendering. URL: ${d?d.substring(0,50):"null"}, ImageError: ${h}, Loading: ${s}, Error: ${l}`),(0,$e.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,$e.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-4xl flex flex-col h-[90vh]",children:[(0,$e.jsxs)("div",{className:"p-4 border-b flex justify-between items-center",children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold",children:r.file_name||"Documento"}),(0,$e.jsxs)("div",{className:"flex gap-2",children:[(0,$e.jsx)("button",{className:"btn btn-sm btn-outline",onClick:v,disabled:!d||s,children:"Descargar"}),(0,$e.jsx)("button",{className:"btn btn-sm btn-circle",onClick:o,children:"\u2715"})]})]}),(0,$e.jsx)("div",{className:"flex-1 overflow-auto p-4 bg-gray-100",children:s?(0,$e.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"}),(0,$e.jsx)("p",{className:"mt-4 text-gray-600",children:"Cargando documento..."})]}):l?(0,$e.jsxs)("div",{className:"flex flex-col items-center justify-center h-full bg-red-50 rounded-lg p-6",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,$e.jsx)("h3",{className:"text-lg font-medium text-red-800 mt-4",children:"Error al Cargar Documento"}),(0,$e.jsx)("p",{className:"text-red-600 mt-2 text-center",children:l}),d&&(0,$e.jsx)("button",{className:"btn btn-sm btn-outline btn-error mt-4",onClick:v,children:"Intentar Descargar"})]}):(0,$e.jsx)($e.Fragment,{children:f&&d&&!h?(0,$e.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-800 rounded",children:(0,$e.jsx)("img",{src:d,alt:r.file_name||"Imagen",className:"max-w-full max-h-full object-contain",onError:e=>{console.error(`[DocViewer] Error loading image in <img> tag. SRC: ${e.currentTarget.src.substring(0,100)}...`),p(!0),c("No se pudo mostrar la imagen. Intente descargarla.")}})}):f&&h?(0,$e.jsxs)("div",{className:"flex flex-col items-center justify-center h-full bg-yellow-50 rounded-lg p-6",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-yellow-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,$e.jsx)("h3",{className:"text-lg font-medium text-yellow-800 mt-4",children:"Error al Visualizar la Imagen"}),(0,$e.jsx)("p",{className:"text-yellow-600 mt-2 text-center",children:"No se pudo mostrar la imagen directamente."}),(0,$e.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,$e.jsx)("button",{className:"btn btn-sm btn-warning",onClick:v,children:"Descargar Imagen"}),d&&d.startsWith("http")&&(0,$e.jsx)("a",{className:"btn btn-sm btn-outline",href:d,target:"_blank",rel:"noopener noreferrer",children:"Abrir URL Directa"})]})]}):g&&d?(0,$e.jsx)("iframe",{src:d,className:"w-full h-full border-0",title:r.file_name||"PDF"}):d?(0,$e.jsxs)("div",{className:"flex flex-col items-center justify-center h-full bg-gray-50 rounded-lg p-6",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,$e.jsx)("h3",{className:"text-lg font-medium text-gray-800 mt-4",children:"Documento No Previsualizable"}),(0,$e.jsx)("p",{className:"text-gray-600 mt-2 text-center",children:"Este tipo de documento no se puede mostrar aqu\xed."}),(0,$e.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,$e.jsx)("button",{className:"btn btn-sm btn-primary",onClick:v,children:"Descargar Documento"}),d&&d.startsWith("http")&&(0,$e.jsx)("a",{className:"btn btn-sm btn-outline",href:d,target:"_blank",rel:"noopener noreferrer",children:"Abrir URL Directa"})]})]}):(0,$e.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,$e.jsx)("p",{className:"text-gray-600",children:"No se pudo generar una vista previa del documento."}),r.file_path&&(0,$e.jsx)("a",{href:`https://ydnygntfkrleiseuciwq.supabase.co/storage/v1/object/public/client-documents/${r.file_path}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline mt-2",children:"Intentar Abrir Directo (Supabase)"})]})})})]})})},tv=()=>{console.log("React at start",a);const{id:e}=re(),t=ne(),{user:n}=We(),{addNotification:r,showPopup:o}=at(),[s,i]=(0,a.useState)(null),[l,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[m,f]=(0,a.useState)(!1),[g,v]=(0,a.useState)(null),{shouldFilterByEntity:y,getEntityFilter:b,userCan:x,isAdvisor:_,isCompanyAdmin:w}=Qe(),[N,E]=(0,a.useState)([]),[S,j]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),[D,T]=(0,a.useState)(1),[A,P]=(0,a.useState)(!1),[I,R]=(0,a.useState)("all"),[M,O]=(0,a.useState)([]),[L,$]=(0,a.useState)("all"),[F,z]=(0,a.useState)([]),[B,U]=(0,a.useState)(!1),[W,V]=(0,a.useState)(null),[H,q]=(0,a.useState)(!1),[Y,J]=(0,a.useState)(!1),[Q,K]=(0,a.useState)(null),[G,X]=(0,a.useState)(null),[Z,ee]=(0,a.useState)(0),te=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(e)try{j(!0),C(null);const n=y()?b():null;console.log(`[ApplicationDetail] Loading history page ${t} for application ${e}`);const r=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;if(console.log(`[getApplicationHistory] Fetching history for application: ${e}, page: ${n}, limit: ${r}`),t){let n=`\n      SELECT id FROM ${qf.C.APPLICATIONS} \n      WHERE id = '${e}'\n    `;t.advisor_id&&(n+=` AND assigned_to = '${t.advisor_id}'`),t.company_id&&(n+=` AND company_id = '${t.company_id}'`);try{const r=await eg(n);if(!r||0===r.length)throw console.log(`[getApplicationHistory] No permission to view application ${e} with filter:`,t),new Error("Application not found or you do not have permission to view it")}catch(d){throw console.error("[getApplicationHistory] Error checking permission:",d),d}}const a=`\n    SELECT h.*, u.id as user_id, u.name as user_name, u.email as user_email, u.role as user_role\n    FROM ${dg} h\n    LEFT JOIN users u ON h.created_by = u.id\n    WHERE h.application_id = '${e}'\n    ORDER BY h.created_at DESC\n    LIMIT ${r} OFFSET ${(n-1)*r}\n  `;try{const t=await eg(a);return console.log(`[getApplicationHistory] Found ${t.length} history items for application ${e}`),t.filter((t=>t.application_id===e))}catch(d){throw console.error("[getApplicationHistory] Error fetching history:",d),d}}(e,n,t,10);if(r&&Array.isArray(r)){console.log(`[ApplicationDetail] Loaded ${r.length} history items for application ${e}`);const n=[...r].sort(((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()));E(1===t?n:[...N,...n]),P(10===r.length),T(t)}else 1===t&&E([]),P(!1)}catch(n){console.error("Error loading application history:",n),C(n instanceof Error?n.message:"Error al cargar el historial de la solicitud")}finally{j(!1)}};(0,a.useEffect)((()=>{if(N.length>0){let e=[...N];"status"===I?e=e.filter((e=>e.comment.toLowerCase().includes("estado cambiado")||e.comment.toLowerCase().includes("cambio de estado"))):"approval"===I&&(e=e.filter((e=>e.comment.toLowerCase().includes("aprob")||"approved"===e.status.toLowerCase()||e.comment.toLowerCase().includes("por dispersar")))),"all"!==L&&(e=e.filter((e=>{var t,n;const r=(null===(t=e.user_role)||void 0===t?void 0:t.toLowerCase())||"",a=(null===(n=e.comment)||void 0===n?void 0:n.toLowerCase())||"";return"advisor"===L?r.includes("advisor")||r.includes("asesor")||a.includes("por asesor"):"company"===L?r.includes("company")||r.includes("empresa")||a.includes("por empresa")||a.includes("por administrador de empresa"):"admin"===L&&(r.includes("admin")&&!r.includes("company")||a.includes("por administrador"))}))),O(e)}else O([])}),[N,I,L]);const ae=async()=>{if(e)try{U(!0),V(null);const t=await(0,jg.hx)(e);t&&Array.isArray(t)?(console.log(`[ApplicationDetail] Loaded ${t.length} documents for application ${e}`),z(t)):z([])}catch(t){console.error("Error loading application documents:",t),V(t instanceof Error?t.message:"Error al cargar los documentos de la solicitud")}finally{U(!1)}},oe=async()=>{try{c(!0),u(null);if(!e||!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e))throw new Error("ID de solicitud inv\xe1lido");const t=y()?b():null,r=await pg(e,t);console.log(`[ApplicationDetail] Client ID for application ${e}:`,{client_id:r.client_id,hasClientId:!!r.client_id,client_name:r.client_name}),i(r);const a=await(async(e,t)=>{try{let n=Yf.ND.from(qf.C.APPLICATIONS).select("\n        approved_by_advisor, \n        approved_by_company, \n        approval_date_advisor, \n        approval_date_company,\n        status,\n        advisor_status,\n        company_status,\n        global_status\n      ").eq("id",e);t&&(t.advisor_id&&(n=n.eq("assigned_to",t.advisor_id)),t.company_id&&(n=n.eq("company_id",t.company_id)));const{data:r,error:a}=await n.single();if(a)return void console.error(`Error obteniendo estado de aprobaci\xf3n para ${e}:`,a);if(!r)return void console.warn(`Solicitud ${e} no encontrada para obtener estado de aprobaci\xf3n`);const o=!0===r.approved_by_advisor&&!0===r.approved_by_company;return{approvedByAdvisor:!0===r.approved_by_advisor,approvedByCompany:!0===r.approved_by_company,approvalDateAdvisor:r.approval_date_advisor,approvalDateCompany:r.approval_date_company,isFullyApproved:o,status:r.status,advisorStatus:r.advisor_status,companyStatus:r.company_status,globalStatus:r.global_status}}catch(d){return void console.error(`[getApprovalStatus] Error al obtener el estado de aprobaci\xf3n para ${e}:`,d)}})(e,t);p(a||{approvedByAdvisor:!0===(n=r).approved_by_advisor,approvedByCompany:!0===n.approved_by_company,approvalDateAdvisor:n.approval_date_advisor,approvalDateCompany:n.approval_date_company,isFullyApproved:!0===n.approved_by_advisor&&!0===n.approved_by_company,advisorStatus:n.advisor_status,companyStatus:n.company_status,globalStatus:n.global_status||n.status}),await te(),await ae()}catch(r){console.error("Error al cargar la solicitud:",r),u(r instanceof Error?r.message:"Error al cargar los datos de la solicitud"),o({title:"Solicitud no encontrada",message:"No se pudo encontrar la solicitud especificada. Es posible que haya sido eliminada o que no tengas permisos para verla.",type:nt.ERROR,playSound:!0,soundType:"alert"}),setTimeout((()=>{t("/applications")}),3e3)}finally{c(!1)}var n};(0,a.useEffect)((()=>{oe()}),[e,o,t]);const se=async t=>{if(e&&n&&s)try{f(!0),u(null);const r=y()?b():null,a=Nt[t]||t;if(w()&&t===wt.IN_REVIEW&&null!==h&&void 0!==h&&h.approvedByCompany){console.log("Quitando aprobaci\xf3n de empresa antes de cambiar el estado");const t=`\n          UPDATE ${qf.C.APPLICATIONS}\n          SET approved_by_company = false, \n              approval_date_company = NULL,\n              status = '${wt.IN_REVIEW}'\n          WHERE id = '${e}' AND company_id = '${null===r||void 0===r?void 0:r.company_id}'\n          RETURNING *\n        `;try{const e=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})}),n=await e.json();if(console.log("Resultado de quitar aprobaci\xf3n:",n),n.error)throw new Error(`Error al quitar aprobaci\xf3n: ${n.error}`);return console.log("\u2705 Aprobaci\xf3n de empresa removida correctamente"),await oe(),v(`Aprobaci\xf3n de empresa removida y solicitud actualizada a "${a}"`),setTimeout((()=>v(null)),3e3),void f(!1)}catch(d){console.error("Error al quitar aprobaci\xf3n:",d)}}await(async(e,t,n,r,a)=>{console.log(`[updateApplicationStatus] Updating status for application ${e} to ${t}`,{entityFilter:a});try{let o=Yf.ND.from(qf.C.APPLICATIONS).select("status, assigned_to, company_id, advisor_name, company_name").eq("id",e);a&&(a.advisor_id&&(o=o.eq("assigned_to",a.advisor_id)),a.company_id&&(o=o.eq("company_id",a.company_id)));const{data:s,error:i}=await o;if(i)throw console.error(`[updateApplicationStatus] Error fetching application ${e}:`,i),new Error(`Error fetching application: ${i.message}`);if(!s||0===s.length)throw console.error(`[updateApplicationStatus] Application not found or permission denied: ${e}`,{entityFilter:a}),new Error("Application not found or you do not have permission to update it");const l=s[0].status;console.log(`[updateApplicationStatus] Current status: ${l}, New status: ${t}`);const c={status:t,status_previous:l};"completed"===t&&(c.dispersal_date=(new Date).toISOString());let d=Yf.ND.from(qf.C.APPLICATIONS).update(c).eq("id",e);a&&(a.advisor_id&&(d=d.eq("assigned_to",a.advisor_id)),a.company_id&&(d=d.eq("company_id",a.company_id)));const{data:u,error:h}=await d.select();if(h)throw console.error(`[updateApplicationStatus] Error updating application ${e}:`,h),new Error(`Error updating application: ${h.message}`);if(!u||0===u.length)throw console.error(`[updateApplicationStatus] Application not found or permission denied during update: ${e}`),new Error("Application not found or you do not have permission to update it");let p=Yf.ND.from("users").select("id, name, email, role").eq("id",r);const{data:m,error:f}=await p;let g="Usuario desconocido",v="Sin rol";!f&&m&&m.length>0&&(g=m[0].name||"Usuario desconocido",v=m[0].role||"Sin rol");let y="usuario";v.toLowerCase().includes("advisor")||v.toLowerCase().includes("asesor")?y="asesor":(v.toLowerCase().includes("company")||v.toLowerCase().includes("empresa"))&&(y="administrador de empresa");let b="";if(l!==t){const e=Nt[l]||l,r=Nt[t]||t;b=n.includes("Cambio de estado")?`Estado cambiado a ${t} por ${y}`:`${n} (Estado cambiado: ${e} \u2192 ${r} por ${g})`}else b=n;try{const n={application_id:e,status:t,comment:b,created_by:r||null,old_status:l,user_type:y},{error:a}=await Yf.ND.from(dg).insert([n]);a?console.error(`Error recording status history for application ${e}:`,a):console.log(`Successfully recorded status history for application ${e}`)}catch(k){console.error(`Error recording status history for application ${e}:`,k)}return console.log(`[updateApplicationStatus] Successfully updated status: ${l} \u2192 ${t}`),u[0]}catch(d){throw console.error(`[updateApplicationStatus] Error updating status of application ${e}:`,d),d}})(e,t,`Cambio de estado a ${a} desde vista detalle`,n.id,r),await oe(),v(`Solicitud actualizada correctamente a "${a}"`),setTimeout((()=>v(null)),3e3)}catch(d){console.error("Error updating application status:",d),u(`Error al actualizar el estado: ${d.message||"Error desconocido"}`)}finally{f(!1)}},ie=e=>e.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),le=((null===h||void 0===h?void 0:h.approvedByAdvisor)&&(null===h||void 0===h||h.approvedByCompany),e=>{const t="w-4 h-4 rounded-full ring-4 ring-white dark:ring-gray-900";switch(e.toLowerCase()){case"new":case"solicitud":return`${t} bg-blue-500`;case"in_review":return`${t} bg-purple-500`;case"approved":return`${t} bg-green-500`;case"rejected":return`${t} bg-red-500`;case"por_dispersar":return`${t} bg-accent`;case"completed":return`${t} bg-primary`;case"cancelled":return`${t} bg-gray-500`;default:return`${t} bg-gray-400`}});return x(He.VIEW_APPLICATIONS)?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold",children:"Detalle de Solicitud"}),(0,$e.jsxs)("div",{className:"space-x-2",children:[(0,$e.jsx)(Te,{to:"/applications",className:"btn btn-ghost",children:"Volver"}),s&&x(He.EDIT_APPLICATION)&&(0,$e.jsx)(Te,{to:`/applications/${e}/edit`,className:"btn btn-primary",children:"Editar"})]})]}),d&&(0,$e.jsx)(_g,{type:"error",message:d,onClose:()=>u(null),className:"mb-6"}),g&&(0,$e.jsx)(_g,{type:"success",message:g,onClose:()=>v(null),className:"mb-6"}),l?(0,$e.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})}):s?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl col-span-2",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Informaci\xf3n de la Solicitud"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"ID de Solicitud"}),(0,$e.jsx)("p",{className:"font-medium",children:s.id})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Fecha de Creaci\xf3n"}),(0,$e.jsx)("p",{className:"font-medium",children:jt(s.created_at)})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Tipo de Solicitud"}),(0,$e.jsxs)("p",{className:"font-medium",children:[(()=>{const e=s.application_type;return e?"selected_plans"===e?"Planes Seleccionados":"product_simulations"===e?"Simulaci\xf3n de Producto":"cash_requests"===e?"Solicitud de Efectivo":"auto_loan"===e?"Cr\xe9dito Automotriz":"car_backed_loan"===e?"Cr\xe9dito con Garant\xeda Automotriz":"personal_loan"===e?"Pr\xe9stamo Personal":"cash_advance"===e?"Adelanto de Efectivo":e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "):"No especificado"})(),Xg(s)&&(0,$e.jsx)("span",{className:"badge badge-primary ml-2 text-xs",children:"Producto"})]})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Estado"}),(0,$e.jsx)("p",{children:(0,$e.jsx)("span",{className:`badge ${Gg(s.status)}`,children:Nt[s.status]||s.status})})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Monto Solicitado"}),(0,$e.jsx)("p",{className:"font-medium",children:ie(s.credito_solicitado||s.amount||0)})]}),s.term&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Plazo"}),(0,$e.jsxs)("p",{className:"font-medium",children:[s.term," ",(e=>{if(!e)return"";const t=e.toLowerCase();switch(t){case"monthly":return"meses";case"biweekly":case"quincenal":case"fortnightly":return"quincenas";case"weekly":return"semanas";default:return t}})(s.payment_frequency)||"periodos"]})]}),s.interest_rate&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Tasa de Inter\xe9s"}),(0,$e.jsxs)("p",{className:"font-medium",children:[s.interest_rate,"%"]})]}),s.monthly_payment&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Pago Mensual"}),(0,$e.jsx)("p",{className:"font-medium",children:ie(s.monthly_payment)})]}),s.financing_type&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Tipo de Financiamiento"}),(0,$e.jsx)("p",{className:"font-medium flex items-center",children:"producto"===s.financing_type?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"Financiamiento de Producto"]}):"personal"===s.financing_type?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1 text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z"})}),"Cr\xe9dito Personal"]}):s.financing_type})]}),s.product_type&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Tipo de Producto"}),(0,$e.jsx)("p",{className:"font-medium",children:(e=>{if(!e)return"N/A";const t=e.toLowerCase(),n={selected_plans:"Cr\xe9dito a Plazos",product_simulations:"Simulaci\xf3n",auto_loan:"Cr\xe9dito Auto",car_backed_loan:"Cr\xe9dito con Garant\xeda",personal_loan:"Pr\xe9stamo Personal",cash_advance:"Adelanto de Efectivo"};for(const[r,a]of Object.entries(n))if(t.includes(r)||r.includes(t))return a;return e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")})(s.product_type)})]}),s.dispersal_date&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Fecha de Dispersi\xf3n"}),(0,$e.jsx)("p",{className:"font-medium",children:jt(s.dispersal_date)})]})]}),Xg(s)&&(0,$e.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,$e.jsxs)("h3",{className:"font-semibold mb-4 flex items-center",children:[(0,$e.jsx)("span",{children:"Detalles del Producto"}),"producto"===s.financing_type&&(0,$e.jsx)("span",{className:"badge badge-primary ml-2 text-xs",children:"Financiamiento de Producto"})]}),"producto"===s.financing_type?s.product_title||s.product_url||s.product_image?(0,$e.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[s.product_image?(0,$e.jsx)("div",{className:"w-full md:w-1/3",children:(0,$e.jsx)("img",{src:s.product_image,alt:s.product_title||"Producto",className:"rounded-lg object-cover w-full h-40",onError:e=>{e.target.src="https://via.placeholder.com/150?text=Sin+Imagen"}})}):(0,$e.jsx)("div",{className:"w-full md:w-1/3",children:(0,$e.jsx)("div",{className:"bg-gray-200 rounded-lg w-full h-40 flex items-center justify-center text-gray-500",children:"Sin imagen disponible"})}),(0,$e.jsxs)("div",{className:"w-full md:w-2/3",children:[s.product_title?(0,$e.jsx)("p",{className:"font-medium text-lg mb-2",children:s.product_title}):(0,$e.jsx)("p",{className:"text-gray-500 text-lg mb-2",children:"T\xedtulo del producto no disponible"}),s.product_url?(0,$e.jsxs)("a",{href:s.product_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline text-sm flex items-center",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Ver producto en sitio web"]}):(0,$e.jsx)("p",{className:"text-gray-500 text-sm",children:"URL del producto no disponible"}),(0,$e.jsxs)("div",{className:"mt-4",children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Monto del Financiamiento"}),(0,$e.jsx)("p",{className:"font-medium",children:ie(s.amount||0)})]})]})]}):(0,$e.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,$e.jsxs)("div",{className:"flex items-start",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-500 mr-2 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-blue-800 font-medium",children:"Informaci\xf3n del producto no disponible"}),(0,$e.jsx)("p",{className:"text-blue-600 text-sm mt-1",children:"Esta solicitud est\xe1 marcada como financiamiento de producto pero no contiene datos espec\xedficos del producto."})]})]}),(0,$e.jsxs)("div",{className:"mt-4",children:[(0,$e.jsx)("p",{className:"text-sm text-gray-700",children:"Monto del Financiamiento"}),(0,$e.jsx)("p",{className:"font-medium text-lg",children:ie(s.amount||0)})]})]}):(0,$e.jsx)("div",{className:"p-4 bg-gray-100 rounded-lg text-center",children:(0,$e.jsx)("p",{className:"text-gray-500",children:"No aplica - Esta solicitud no es de financiamiento de producto"})})]}),h&&(0,$e.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,$e.jsx)("h3",{className:"font-semibold mb-4",children:"Estado de Aprobaci\xf3n"}),h.isFullyApproved&&(0,$e.jsxs)("div",{className:"mb-4 p-3 bg-success text-white rounded-lg",children:[(0,$e.jsxs)("div",{className:"flex items-center",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,$e.jsx)("span",{className:"font-medium",children:"Solicitud completamente aprobada"})]}),(0,$e.jsx)("p",{className:"text-sm mt-1",children:"Esta solicitud ha sido aprobada tanto por el asesor como por la empresa"})]}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,$e.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,$e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,$e.jsx)("p",{className:"font-medium",children:"Estado Asesor"}),h.approvedByAdvisor?(0,$e.jsx)("span",{className:"badge badge-success",children:"Aprobado"}):(0,$e.jsx)("span",{className:"badge badge-warning",children:"Pendiente"})]}),s&&s.advisor_status&&(0,$e.jsxs)("div",{className:"flex items-center mt-2",children:[(0,$e.jsx)("p",{className:"text-xs text-gray-500 mr-2",children:"Estado en vista de Asesor:"}),(0,$e.jsx)("span",{className:`badge badge-sm ${Gg(s.advisor_status)}`,children:Nt[s.advisor_status]||s.advisor_status})]}),h.approvalDateAdvisor&&(0,$e.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Fecha de aprobaci\xf3n: ",jt(h.approvalDateAdvisor)]})]}),(0,$e.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,$e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,$e.jsx)("p",{className:"font-medium",children:"Estado Empresa"}),h.approvedByCompany?(0,$e.jsx)("span",{className:"badge badge-success",children:"Aprobado"}):(0,$e.jsx)("span",{className:"badge badge-warning",children:"Pendiente"})]}),s&&s.company_status&&(0,$e.jsxs)("div",{className:"flex items-center mt-2",children:[(0,$e.jsx)("p",{className:"text-xs text-gray-500 mr-2",children:"Estado en vista de Empresa:"}),(0,$e.jsx)("span",{className:`badge badge-sm ${Gg(s.company_status)}`,children:Nt[s.company_status]||s.company_status})]}),h.approvalDateCompany&&(0,$e.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Fecha de aprobaci\xf3n: ",jt(h.approvalDateCompany)]})]})]}),s&&s.global_status&&(0,$e.jsxs)("div",{className:"border rounded-lg p-3 mt-2",children:[(0,$e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,$e.jsx)("p",{className:"font-medium",children:"Estado Global del Proceso"}),(0,$e.jsx)("span",{className:`badge ${Gg(s.global_status)}`,children:Nt[s.global_status]||s.global_status})]}),(0,$e.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Este es el estado consolidado que refleja el progreso global de la solicitud en el sistema."})]}),s&&(w()||_())&&x(He.VIEW_REPORTS)&&(0,$e.jsx)("div",{className:"mt-4 pt-4 border-t border-dashed",children:(0,$e.jsxs)("div",{className:"bg-base-300 p-3 rounded-lg",children:[(0,$e.jsx)("h4",{className:"text-sm font-bold mb-2",children:"Debug: Todos los estados (Solo administradores)"}),(0,$e.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("span",{className:"font-bold",children:"Estado Principal:"})," ",s.status]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("span",{className:"font-bold",children:"Estado Asesor:"})," ",s.advisor_status||"No definido"]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("span",{className:"font-bold",children:"Estado Empresa:"})," ",s.company_status||"No definido"]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("span",{className:"font-bold",children:"Estado Global:"})," ",s.global_status||"No definido"]})]})]})})]})]})}),(0,$e.jsxs)("div",{className:"card bg-base-100 shadow-md p-4 mb-4",children:[s&&h&&(_()&&!h.approvedByAdvisor||w()&&x(He.CHANGE_APPLICATION_STATUS))&&(0,$e.jsxs)("div",{className:"flex justify-center space-x-3 mb-4 pb-3 border-b",children:[s&&h&&_()&&!h.approvedByAdvisor&&x(He.CHANGE_APPLICATION_STATUS)&&(0,$e.jsx)("button",{onClick:async()=>{if(e&&n&&s)try{f(!0),u(null);const t=y()?b():null;await(async(e,t,n,r)=>{if(null===r||void 0===r||!r.advisor_id)throw new Error("Solo los asesores pueden realizar esta acci\xf3n");try{console.log(`Aprobando solicitud ${e} por asesor ${n}...`);const{data:r,error:a}=await Yf.ND.from(qf.C.APPLICATIONS).select("*").eq("id",e).eq("assigned_to",n).single();if(a)throw console.error(`Error obteniendo solicitud ${e}:`,a),new Error(`Error al obtener solicitud: ${a.message}`);if(!r)throw new Error("Solicitud no encontrada o no tienes permisos para aprobarla");const o={approved_by_advisor:!0,approval_date_advisor:(new Date).toISOString(),advisor_status:wt.APPROVED,updated_at:(new Date).toISOString()};!0===r.approved_by_advisor&&(o.status=wt.APPROVED,o.global_status=wt.APPROVED,console.log("Ambos aprobaron, manteniendo estado APPROVED (sin mover a POR_DISPERSAR)"));const{data:s,error:i}=await Yf.ND.from(qf.C.APPLICATIONS).update(o).eq("id",e).eq("assigned_to",n).select("*");if(i)throw console.error(`Error aprobando solicitud ${e} por asesor:`,i),new Error(`Error al aprobar solicitud: ${i.message}`);if(!s||0===s.length)throw new Error("Solicitud no encontrada o no tienes permisos para aprobarla");console.log(`Solicitud ${e} aprobada exitosamente por asesor ${n}`);const{error:l}=await Yf.ND.from(dg).insert({application_id:e,status:wt.APPROVED,comment:t||"Solicitud aprobada por asesor",created_by:n||null});return l?console.error("Error al registrar historial de aprobaci\xf3n:",l):console.log(`Historial registrado para la solicitud ${e}`),s[0]}catch(d){throw console.error(`Error aprobando solicitud ${e} por asesor:`,d),d}})(e,"Solicitud aprobada por el asesor",n.id,t);await oe(),null!==h&&void 0!==h&&h.approvedByCompany?v("\xa1Aprobaci\xf3n completa! La solicitud ha sido aprobada por ambas partes."):v("Solicitud aprobada correctamente como asesor"),setTimeout((()=>v(null)),3e3)}catch(d){console.error("Error approving as advisor:",d),u(`Error al aprobar: ${d.message||"Error desconocido"}`)}finally{f(!1)}},disabled:m,className:"btn btn-primary",children:m?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs mr-1"}),"Procesando..."]}):"Aprobar como Asesor"}),s&&h&&w()&&x(He.CHANGE_APPLICATION_STATUS)&&!h.approvedByCompany&&(0,$e.jsx)("button",{onClick:async()=>{if(e&&n&&s)try{f(!0),u(null);const t=y()?b():null;if(null===t||void 0===t||!t.company_id)throw new Error("No tienes una empresa asociada para realizar esta aprobaci\xf3n");await(async(e,t,n,r,a)=>{if(null===a||void 0===a||!a.company_id||a.company_id!==r)throw new Error("Solo los administradores de la empresa pueden realizar esta acci\xf3n");try{const{data:a,error:o}=await Yf.ND.from(qf.C.APPLICATIONS).select("*").eq("id",e).eq("company_id",r).single();if(o)throw console.error(`Error obteniendo solicitud ${e}:`,o),new Error(`Error al obtener solicitud: ${o.message}`);if(!a)throw new Error("Solicitud no encontrada o no tienes permisos para aprobarla");const s={approved_by_company:!0,approval_date_company:(new Date).toISOString(),company_status:wt.APPROVED,updated_at:(new Date).toISOString()};!0===a.approved_by_advisor&&(s.status=wt.APPROVED,s.global_status=wt.APPROVED,console.log("Ambos aprobaron, manteniendo estado APPROVED (sin mover a POR_DISPERSAR)"));const{data:i,error:l}=await Yf.ND.from(qf.C.APPLICATIONS).update(s).eq("id",e).eq("company_id",r).select("*");if(l)throw console.error(`Error aprobando solicitud ${e} por empresa:`,l),new Error(`Error al aprobar solicitud: ${l.message}`);if(!i||0===i.length)throw new Error("Solicitud no encontrada o no tienes permisos para aprobarla");const{error:c}=await Yf.ND.from(dg).insert({application_id:e,status:wt.APPROVED,comment:t||"Solicitud aprobada por empresa",created_by:n||null});return c&&console.error("Error al registrar historial de aprobaci\xf3n:",c),i[0]}catch(d){throw console.error(`Error aprobando solicitud ${e} por empresa:`,d),d}})(e,"Solicitud aprobada por la empresa",n.id,t.company_id,t);await oe(),null!==h&&void 0!==h&&h.approvedByAdvisor?v("\xa1Aprobaci\xf3n completa! La solicitud ha sido aprobada por ambas partes."):v("Solicitud aprobada correctamente como empresa"),setTimeout((()=>v(null)),3e3)}catch(d){console.error("Error approving as company:",d),u(`Error al aprobar: ${d.message||"Error desconocido"}`)}finally{f(!1)}},disabled:m,className:"btn btn-primary",children:m?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs mr-1"}),"Procesando..."]}):"Aprobar como Empresa"}),s&&h&&w()&&x(He.CHANGE_APPLICATION_STATUS)&&h.approvedByCompany&&(0,$e.jsx)("button",{onClick:async()=>{if(e&&n&&s)try{f(!0),u(null);const t=y()?b():null;if(null===t||void 0===t||!t.company_id)throw new Error("No tienes una empresa asociada para realizar esta acci\xf3n");await(async(e,t,n,r,a)=>{if(null===a||void 0===a||!a.company_id||a.company_id!==r)throw new Error("Solo los administradores de la empresa pueden realizar esta acci\xf3n");try{const{data:a,error:o}=await Yf.ND.from(qf.C.APPLICATIONS).select("*").eq("id",e).eq("company_id",r).single();if(o)throw console.error(`Error obteniendo solicitud ${e}:`,o),new Error(`Error al obtener solicitud: ${o.message}`);if(!a)throw new Error("Solicitud no encontrada o no tienes permisos para cancelar la aprobaci\xf3n");const s={approved_by_company:!1,approval_date_company:null,company_status:wt.IN_REVIEW,updated_at:(new Date).toISOString()};!0===a.approved_by_advisor&&(s.status=wt.APPROVED,s.global_status=wt.APPROVED);const{data:i,error:l}=await Yf.ND.from(qf.C.APPLICATIONS).update(s).eq("id",e).eq("company_id",r).select("*");if(l)throw console.error(`Error cancelando aprobaci\xf3n de solicitud ${e} por empresa:`,l),new Error(`Error al cancelar aprobaci\xf3n: ${l.message}`);if(!i||0===i.length)throw new Error("Solicitud no encontrada o no tienes permisos para cancelar la aprobaci\xf3n");const{error:c}=await Yf.ND.from(dg).insert({application_id:e,status:wt.IN_REVIEW,comment:t||"Aprobaci\xf3n de empresa cancelada",created_by:n||null});return c&&console.error("Error al registrar historial de cancelaci\xf3n de aprobaci\xf3n:",c),i[0]}catch(d){throw console.error(`Error cancelando aprobaci\xf3n de solicitud ${e} por empresa:`,d),d}})(e,"Aprobaci\xf3n cancelada por la empresa",n.id,t.company_id,t),await oe(),v("Aprobaci\xf3n de empresa cancelada correctamente"),setTimeout((()=>v(null)),3e3)}catch(d){console.error("Error canceling approval:",d),u(`Error al cancelar aprobaci\xf3n: ${d.message||"Error desconocido"}`)}finally{f(!1)}},disabled:m,className:"btn btn-outline btn-error",children:m?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs mr-1"}),"Procesando..."]}):"Cancelar Aprobaci\xf3n"})]}),(0,$e.jsx)("div",{children:(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informaci\xf3n del Cliente"})}),(0,$e.jsxs)("div",{className:"mb-4",children:[(0,$e.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,$e.jsx)("div",{className:"text-sm text-gray-500",children:"Nombre:"}),(0,$e.jsx)("div",{className:"font-semibold",children:s.client_name||"No disponible"})]}),(0,$e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,$e.jsx)("div",{className:"text-sm text-gray-500",children:"Email:"}),(0,$e.jsx)("div",{children:s.client_email||"No disponible"})]}),(0,$e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,$e.jsx)("div",{className:"text-sm text-gray-500",children:"Tel\xe9fono:"}),(0,$e.jsx)("div",{children:s.client_phone||"No disponible"})]})]}),(0,$e.jsx)("div",{className:"mt-4",children:(0,$e.jsx)(Sg,{clientId:s.client_id,clientName:s.client_name,applicationId:s.id,useSync:!0,className:"mt-2"})})]})]}),(s.company_id||s.company_name)&&(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Informaci\xf3n de la Empresa"}),(0,$e.jsxs)("div",{className:"space-y-4",children:[s.company_name&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Nombre de la Empresa"}),(0,$e.jsx)("p",{className:"font-medium",children:s.company_name})]}),s.company_id&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"ID de la Empresa"}),(0,$e.jsx)("p",{className:"font-medium",children:s.company_id})]}),x(He.VIEW_COMPANIES)&&(0,$e.jsx)("div",{className:"pt-2 mt-2 border-t",children:(0,$e.jsx)(Te,{to:`/companies/${s.company_id}`,className:"btn btn-sm btn-outline btn-primary w-full",children:"Ver Detalles de la Empresa"})})]})]})}),s.assigned_to&&(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Asesor Asignado"}),(0,$e.jsxs)("div",{className:"space-y-4",children:[s.advisor_name&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"Nombre del Asesor"}),(0,$e.jsx)("p",{className:"font-medium",children:s.advisor_name})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:"ID del Asesor"}),(0,$e.jsx)("p",{className:"font-medium",children:s.assigned_to})]}),x(He.VIEW_ADVISORS)&&(0,$e.jsx)("div",{className:"pt-2 mt-2 border-t",children:(0,$e.jsx)(Te,{to:`/advisors/${s.assigned_to}`,className:"btn btn-sm btn-outline btn-primary w-full",children:"Ver Perfil del Asesor"})})]})]})})]}),(0,$e.jsx)("div",{className:"mt-8",children:(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsxs)("h2",{className:"card-title text-lg mb-4 border-b pb-2 flex justify-between items-center",children:[(0,$e.jsxs)("span",{children:["Documentos de la Solicitud",F.length>0&&(0,$e.jsxs)("span",{className:"text-sm font-normal badge badge-outline ml-2",children:[F.length," ",1===F.length?"documento":"documentos"]})]}),x(He.UPLOAD_DOCUMENTS)&&(0,$e.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>q(!0),children:"Subir Documento"})]}),B?(0,$e.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})}):W?(0,$e.jsx)("div",{className:"p-4 bg-error text-white text-center rounded-lg",children:(0,$e.jsx)("p",{children:W})}):0===F.length?(0,$e.jsx)("div",{className:"p-4 bg-base-200 text-center rounded-lg",children:(0,$e.jsx)("p",{children:"No hay documentos disponibles para esta solicitud."})}):(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{children:"Nombre"}),(0,$e.jsx)("th",{children:"Categor\xeda"}),(0,$e.jsx)("th",{children:"Tama\xf1o"}),(0,$e.jsx)("th",{children:"Fecha"}),(0,$e.jsx)("th",{children:"Acciones"})]})}),(0,$e.jsx)("tbody",{children:F.map((e=>(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("td",{children:e.file_name}),(0,$e.jsx)("td",{children:e.category||"Sin categor\xeda"}),(0,$e.jsx)("td",{children:Zg(e.file_size)}),(0,$e.jsx)("td",{children:jt(e.created_at)}),(0,$e.jsx)("td",{children:(0,$e.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>X(e),children:"Ver"})})]},e.id)))})]})})]})})}),s&&x(He.UPLOAD_DOCUMENTS)&&(0,$e.jsx)("div",{className:"mt-8",children:(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsx)("div",{className:"card-body",children:s&&(0,$e.jsx)(Jg,{applicationId:s.id,initialEnvelopeId:s.docusign_envelope_id,initialSentTo:s.docusign_sent_to,initialStatus:s.docusign_manual_status,clientEmail:s.client_email,sandbox:!1,onSaved:()=>{r({title:"DocuSign",message:"Datos de DocuSign guardados correctamente",type:nt.SUCCESS})}})})})}),(0,$e.jsx)("div",{className:"mt-8",children:(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsxs)("div",{className:"flex items-center justify-between border-b pb-2 mb-4",children:[(0,$e.jsxs)("h2",{className:"card-title text-lg",children:["Historial de la Solicitud",M.length>0&&(0,$e.jsxs)("span",{className:"text-sm font-normal badge badge-outline ml-2",children:[M.length," ",1===M.length?"entrada":"entradas"]})]}),N.length>0&&(0,$e.jsxs)("div",{className:"flex gap-2",children:[(0,$e.jsxs)("select",{className:"select select-sm select-bordered w-auto",value:I,onChange:e=>R(e.target.value),children:[(0,$e.jsx)("option",{value:"all",children:"Todos los eventos"}),(0,$e.jsx)("option",{value:"status",children:"Cambios de estado"}),(0,$e.jsx)("option",{value:"approval",children:"Aprobaciones"})]}),(0,$e.jsxs)("select",{className:"select select-sm select-bordered w-auto",value:L,onChange:e=>$(e.target.value),children:[(0,$e.jsx)("option",{value:"all",children:"Todos los usuarios"}),(0,$e.jsx)("option",{value:"advisor",children:"Asesores"}),(0,$e.jsx)("option",{value:"company",children:"Empresa"}),(0,$e.jsx)("option",{value:"admin",children:"Admin"})]})]})]}),S&&1===D?(0,$e.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})}):k?(0,$e.jsx)("div",{className:"p-4 bg-error text-white text-center rounded-lg",children:(0,$e.jsx)("p",{children:k})}):0===M.length?(0,$e.jsx)("div",{className:"p-4 bg-base-200 text-center rounded-lg",children:(0,$e.jsx)("p",{children:"No hay historial disponible para esta solicitud espec\xedfica."})}):(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("ol",{className:"relative border-s border-gray-200 dark:border-gray-700 ms-3 mt-4",children:M.map(((t,n)=>{let r="Sistema",a="badge-ghost";if(t.user_role){const e=t.user_role.toLowerCase();e.includes("advisor")||e.includes("asesor")?(r="Asesor",a="badge-info"):e.includes("company")||e.includes("empresa")?(r="Empresa",a="badge-secondary"):e.includes("admin")&&(r="Admin",a="badge-accent")}else if(t.comment){const e=t.comment.toLowerCase();e.includes("por asesor")?(r="Asesor",a="badge-info"):e.includes("por empresa")||e.includes("por administrador de empresa")?(r="Empresa",a="badge-secondary"):e.includes("por admin")&&(r="Admin",a="badge-accent")}return(0,$e.jsxs)("li",{className:"mb-4 ms-6",children:[(0,$e.jsx)("span",{className:le(t.status)}),(0,$e.jsxs)("div",{className:"bg-base-200 rounded-lg shadow-sm p-3",children:[(0,$e.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,$e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,$e.jsxs)("div",{className:"flex flex-col",children:[(0,$e.jsx)("div",{className:"flex items-center gap-2",children:(0,$e.jsx)("span",{className:"text-sm font-medium",children:t.user_name||"Sistema"})}),t.user_email&&(0,$e.jsx)("span",{className:"text-xs text-gray-500",children:t.user_email})]}),(0,$e.jsx)("span",{className:`badge ${Gg(t.status)} ml-2`,children:Nt[t.status]||t.status})]}),(0,$e.jsxs)("div",{className:"flex flex-col items-end",children:[(0,$e.jsx)("time",{className:"text-xs text-gray-500",children:jt(t.created_at)}),(0,$e.jsx)("span",{className:`badge badge-sm ${a} mt-1`,children:r})]})]}),(0,$e.jsx)("p",{className:"text-sm mt-1",children:t.comment})]})]},t.id||`history-${e}-${n}`)}))}),A&&(0,$e.jsx)("div",{className:"text-center mt-4",children:(0,$e.jsx)("button",{className:"btn btn-outline btn-sm",onClick:()=>{A&&!S&&te(D+1)},disabled:S,children:S?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs"}),"Cargando..."]}):"Cargar m\xe1s historial"})})]})]})})}),s&&(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl mt-6",children:(0,$e.jsx)("div",{className:"card-body",children:(0,$e.jsx)(Kg,{applicationId:s.id})})})]}):(0,$e.jsx)("div",{className:"text-center p-10",children:(0,$e.jsx)("h3",{className:"text-xl text-gray-500",children:"No se encontr\xf3 la solicitud"})}),s&&h&&(0,$e.jsxs)($e.Fragment,{children:[s.status===wt.APPROVED&&_()&&h.approvedByAdvisor&&h.approvedByCompany&&(0,$e.jsxs)("div",{className:"mt-4 p-4 bg-base-200 rounded-lg",children:[(0,$e.jsx)("h3",{className:"font-medium mb-2",children:"Acciones disponibles"}),(0,$e.jsx)("div",{className:"flex flex-col space-y-2",children:(0,$e.jsx)("button",{onClick:()=>se(wt.POR_DISPERSAR),className:"btn btn-accent",disabled:m,children:m?(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs"}):"Marcar como Por Dispersar"})})]}),s.status===wt.POR_DISPERSAR&&_()&&(0,$e.jsxs)("div",{className:"mt-4 p-4 bg-base-200 rounded-lg",children:[(0,$e.jsx)("h3",{className:"font-medium mb-2",children:"Acciones disponibles"}),(0,$e.jsx)("div",{className:"flex flex-col space-y-2",children:(0,$e.jsx)("button",{onClick:async()=>{if(e&&n&&s)try{f(!0),u(null);const t=y()?b():null;await(async(e,t,n,r)=>{if(null===r||void 0===r||!r.advisor_id)throw new Error("Solo los asesores pueden realizar esta acci\xf3n");try{console.log(`Marcando solicitud ${e} como dispersada por asesor ${n}...`);const{data:r,error:a}=await Yf.ND.from(qf.C.APPLICATIONS).select("*").eq("id",e).eq("assigned_to",n).single();if(a)throw console.error(`Error obteniendo solicitud ${e}:`,a),new Error(`Error al obtener solicitud: ${a.message}`);if(!r)throw new Error("Solicitud no encontrada o no tienes permisos para marcarla como dispersada");if(r.status!==wt.POR_DISPERSAR)throw new Error("Solo las solicitudes que est\xe1n Por Dispersar pueden ser marcadas como dispersadas");const o={status:wt.COMPLETED,global_status:wt.COMPLETED,advisor_status:wt.COMPLETED,company_status:wt.COMPLETED,dispersal_date:(new Date).toISOString(),updated_at:(new Date).toISOString()},{data:s,error:i}=await Yf.ND.from(qf.C.APPLICATIONS).update(o).eq("id",e).eq("assigned_to",n).select("*");if(i)throw console.error(`Error marcando solicitud ${e} como dispersada:`,i),new Error(`Error al marcar solicitud como dispersada: ${i.message}`);if(!s||0===s.length)throw new Error("Solicitud no encontrada o no tienes permisos para marcarla como dispersada");console.log(`Solicitud ${e} marcada exitosamente como dispersada por asesor ${n}`);const{error:l}=await Yf.ND.from(dg).insert({application_id:e,status:wt.COMPLETED,comment:t||"Solicitud marcada como dispersada",created_by:n||null});return l?console.error("Error al registrar historial de dispersi\xf3n:",l):console.log(`Historial registrado para la solicitud ${e}`),s[0]}catch(d){throw console.error(`Error marcando solicitud ${e} como dispersada:`,d),d}})(e,"Solicitud marcada como dispersada",n.id,t),await oe(),v("Solicitud marcada como dispersada correctamente"),setTimeout((()=>v(null)),3e3)}catch(d){console.error("Error marking as dispersed:",d),u(`Error al marcar como dispersada: ${d.message||"Error desconocido"}`)}finally{f(!1)}},className:"btn btn-primary",disabled:m,children:m?(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs"}):"Marcar como Dispersado"})})]})]}),H&&(0,$e.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,$e.jsx)("div",{className:"bg-white rounded-lg w-full max-w-2xl",children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold",children:"Subir Documento"}),(0,$e.jsx)("button",{className:"btn btn-sm btn-circle",onClick:()=>q(!1),children:"\u2715"})]}),W&&(0,$e.jsx)("div",{className:"alert alert-error mb-4",children:(0,$e.jsx)("p",{children:W})}),(0,$e.jsx)("div",{className:"mb-4",children:(0,$e.jsx)(zg,{categories:[{value:"identificacion",label:"Identificaci\xf3n"},{value:"comprobante_ingresos",label:"Comprobante de Ingresos"},{value:"comprobante_domicilio",label:"Comprobante de Domicilio"},{value:"estado_cuenta",label:"Estado de Cuenta"},{value:"contrato",label:"Contrato"},{value:"otros",label:"Otros Documentos"}],onDocumentAdded:e=>{K(e),V(null)},onDocumentRemoved:()=>K(null),existingDocuments:Q?[Q]:[],clientId:null===s||void 0===s?void 0:s.client_id,existingServerDocuments:[]})}),(0,$e.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,$e.jsx)("button",{className:"btn btn-outline",onClick:()=>q(!1),children:"Cancelar"}),(0,$e.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(e&&n&&Q&&Q.file)try{var t;J(!0),V(null);const r=Q.file,a=(null===(t=r.name.split(".").pop())||void 0===t?void 0:t.toLowerCase())||"";let o=r.type;if(!o||"application/octet-stream"===o){const e={pdf:"application/pdf",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",webp:"image/webp",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",txt:"text/plain",csv:"text/csv"};o=a in e?e[a]:"application/octet-stream"}console.log(`Subiendo documento: ${r.name}, tipo: ${o}, tama\xf1o: ${Zg(r.size)}`);const i=await(0,jg.XX)({file:r,userId:n.id,documentName:Q.name||r.name,category:Q.category,application_id:e,client_id:null===s||void 0===s?void 0:s.client_id,contentType:o});K(null),v(`Documento "${i.file_name}" subido exitosamente`),q(!1),await ae()}catch(d){console.error("Error al subir documento:",d),V(d instanceof Error?d.message:"Error al subir el documento")}finally{J(!1)}else V("Informaci\xf3n incompleta para subir el documento")},disabled:!Q||Y,children:Y?(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs mr-1"}),"Subiendo..."]}):"Subir Documento"})]})]})})}),G&&(0,$e.jsx)(ev,{document:G,onClose:()=>X(null)})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,$e.jsxs)("div",{className:"text-center",children:[(0,$e.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,$e.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},nv=qf.C.COMPANIES,rv=(qf.C.COMPANY_ADMINS,async e=>{const{data:t,error:n}=await tt.ND.from(nv).select("*").eq("id",e).single();if(n)throw console.error(`Error fetching company with ID ${e}:`,n),n;return t}),av={client_name:"",client_email:"",client_phone:"",client_address:"",dni:"",amount:void 0,term:12,interest_rate:45,monthly_payment:void 0,financing_type:"personal",product_url:"",product_price:void 0,application_type:"selected_plans",status:wt.NEW,company_id:"",company_name:"",assigned_to:"",client_id:""},ov=()=>{const{id:e}=re(),t=ne(),{userCan:n}=Qe(),{user:r}=We(),{shouldFilterByEntity:o,getEntityFilter:s}=Qe(),{addNotification:i,showPopup:l}=at(),c=ee(),d=a.useRef(null),u=!!e,[h,p]=(0,a.useState)(av),[m,f]=(0,a.useState)(u),[g,v]=(0,a.useState)(!1),[y,b]=(0,a.useState)(null),[x,_]=(0,a.useState)(null),[w,N]=(0,a.useState)(""),[E,S]=(0,a.useState)([]),[j,k]=(0,a.useState)(!1),[C,D]=(0,a.useState)(!1),[T,A]=(0,a.useState)(!1),[P,I]=(0,a.useState)(""),[R,M]=(0,a.useState)([]),[O,L]=(0,a.useState)(""),[$,F]=(0,a.useState)([]),[z,B]=(0,a.useState)(!1),[U,W]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=setTimeout((()=>{const e=w.trim();e&&e!==P&&I(e)}),500);return()=>clearTimeout(e)}),[w,P]),(0,a.useEffect)((()=>{P&&H(P)}),[P]),(0,a.useEffect)((()=>{if(u&&e){const t=async()=>{try{f(!0),b(null);const t=o()?s():null,n=await pg(e,t);p({client_name:n.client_name||"",client_email:n.client_email||"",client_phone:n.client_phone||"",client_address:n.client_address||"",dni:n.dni||"",amount:n.amount||void 0,term:n.term||void 0,interest_rate:n.interest_rate||void 0,monthly_payment:n.monthly_payment||void 0,financing_type:"producto"===n.financing_type?"producto":"personal",product_url:n.product_url||"",product_price:n.product_price||void 0,application_type:n.application_type||"selected_plans",status:n.status,company_id:n.company_id||"",company_name:n.company_name||"",assigned_to:n.assigned_to||"",client_id:n.client_id||""}),n.client_id&&A(!0)}catch(y){console.error("Error fetching application:",y),b(`Error al cargar la solicitud: ${y.message||"Error desconocido"}`)}finally{f(!1)}};t()}else if(!u&&r){const e=o()?s():null;e&&(e.advisor_id&&p((t=>({...t,assigned_to:e.advisor_id}))),e.company_id&&p((t=>({...t,company_id:e.company_id}))));new URLSearchParams(c.search).get("client")||D(!0)}}),[e,u,r,o,s,c.search]),(0,a.useEffect)((()=>{const e=new URLSearchParams(c.search).get("client");!u&&e&&(async()=>{try{f(!0);const t=await(0,Eg.getClientById)(e);if(t){let e=0,n="",r=.05;if(t.company_id){const a=await rv(t.company_id);a&&(e=a.interest_rate||0,n=a.name||"",r=void 0!==a.commission_rate?a.commission_rate:.05,console.log(`Using company commission rate from URL param: ${100*r}%`))}p((r=>({...r,client_name:t.name||"",client_email:t.email||"",client_phone:t.phone||"",client_address:t.address||"",company_id:t.company_id||"",company_name:n,assigned_to:t.advisor_id||r.assigned_to,interest_rate:e,monthly_payment:void 0,client_id:t.id||""}))),A(!0),D(!1)}}catch(y){console.error("Error fetching client data:",y),b(`Error al cargar los datos del cliente: ${y.message||"Error desconocido"}`)}finally{f(!1)}})()}),[c.search,u]),(0,a.useEffect)((()=>{if(!u){const{amount:e,term:t,interest_rate:n,company_id:r,financing_type:a}=h;if(void 0!==e&&void 0!==t&&t>0){const a=async()=>{let a=.05;try{if(r){const e=await rv(r);e&&void 0!==e.commission_rate&&(a=e.commission_rate,console.log(`Using company commission rate: ${100*a}%`))}const o=mg(e||0,(n||0)/100,t||0,a,.16);o!==h.monthly_payment&&p((e=>({...e,monthly_payment:o})))}catch(y){console.error("Error retrieving company rates:",y)}};a()}else void 0!==h.monthly_payment&&p((e=>({...e,monthly_payment:void 0})))}}),[h.amount,h.term,h.interest_rate,h.company_id,h.financing_type,u]),(0,a.useEffect)((()=>{!u&&r&&V()}),[r,u]);const V=async()=>{try{B(!0);const e=o()?s():null;let t=tt.ND.from("companies").select("id, name");null!==e&&void 0!==e&&e.advisor_id&&(t=t.eq("advisor_id",e.advisor_id));const{data:n,error:r}=await t;if(r)return void console.error("Error loading advisor companies",r);n&&M(n.map((e=>({id:e.id,name:e.name}))))}catch(e){console.error("Error loading companies",e)}finally{B(!1)}},H=async e=>{const t=e||w.trim();if(t)try{k(!0),b(null);const e=o()?s():null,n={searchQuery:t};null!==e&&void 0!==e&&e.advisor_id&&(n.advisor_id=e.advisor_id),null!==e&&void 0!==e&&e.company_id&&(n.company_id=e.company_id),O&&(n.company_id=O),console.log("Searching clients with filters:",n);const r=await(0,Eg.getClients)(n);console.log("Search results:",r),r&&r.clients&&r.clients.length>0?S(r.clients.map((e=>({id:e.id,name:e.name||"Sin nombre",email:e.email||"Sin email",phone:e.phone||"Sin tel\xe9fono",company_name:e.company_name})))):S([])}catch(y){console.error("Error searching clients:",y),b("Error al buscar clientes. Por favor intente nuevamente.")}finally{k(!1)}else S([])},q=async e=>{try{f(!0);const t=await(0,Eg.getClientById)(e.id);if(t){let n=0,r="",a=.05,o=.16;if(t.company_id){const e=await rv(t.company_id);e&&(n=e.interest_rate||0,r=e.name||"",a=void 0!==e.commission_rate?e.commission_rate:.05,console.log(`Using company commission rate: ${100*a}%`))}p((a=>({...a,client_name:t.name||"",client_email:t.email||"",client_phone:t.phone||"",client_address:t.address||"",company_id:t.company_id||"",company_name:r,interest_rate:n,assigned_to:t.advisor_id||a.assigned_to,client_id:e.id}))),A(!0);const{amount:s,term:i}=h;if(void 0!==s&&void 0!==i&&i>0){const e=mg(s,n/100,i,a,o);p((t=>({...t,monthly_payment:e})))}D(!1)}}catch(y){console.error("Error selecting client:",y),b(`Error al seleccionar cliente: ${y.message||"Error desconocido"}`)}finally{f(!1)}},Y=e=>{const{name:t,value:n,type:r}=e.target;if("financing_type"===t){const e=n;let t="selected_plans";return"producto"===e?t=xt.PRODUCT_SIMULATIONS:"personal"===e&&(t=xt.PERSONAL_LOAN),void p((n=>({...n,financing_type:e,application_type:t})))}if("product_price"!==t)p("number"===r?""===n?e=>({...e,[t]:void 0}):e=>({...e,[t]:parseFloat(n)}):e=>({...e,[t]:n}));else{if(""===n)return void p((e=>({...e,product_price:void 0,amount:void 0})));const e=parseFloat(n),t=Math.round(e/.95*100)/100;p((n=>({...n,product_price:e,amount:t})))}};return(0,a.useEffect)((()=>{C&&d.current&&d.current.focus()}),[C]),n(u?He.EDIT_APPLICATION:He.CREATE_APPLICATION)?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold",children:u?"Editar Solicitud":"Nueva Solicitud"}),(0,$e.jsx)(Te,{to:u?`/applications/${e}`:"/applications",className:"btn btn-ghost",children:"Cancelar"})]}),y&&(0,$e.jsx)(_g,{type:"error",message:y,onClose:()=>b(null),className:"mb-6"}),x&&(0,$e.jsx)(_g,{type:"success",message:x,onClose:()=>_(null),className:"mb-6"}),!u&&C&&(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl mb-6",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Seleccionar Cliente"}),(0,$e.jsxs)("div",{className:"form-control mb-4",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text font-medium",children:"Buscar por nombre, email o tel\xe9fono"})}),(0,$e.jsxs)("div",{className:"input-group",children:[(0,$e.jsx)("input",{type:"text",placeholder:"Buscar cliente",className:"input input-bordered w-full",value:w,onChange:e=>N(e.target.value),onKeyDown:e=>"Enter"===e.key&&H(),ref:d}),(0,$e.jsx)("button",{className:"btn btn-primary",onClick:()=>H(),disabled:j,children:j?(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs"}):(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]}),(0,$e.jsxs)("div",{className:"form-control mb-6",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text font-medium",children:"Filtrar por empresa"})}),(0,$e.jsxs)("select",{className:"select select-bordered w-full",value:O,onChange:e=>(async e=>{if(L(e),e)try{W(!0);const t={company_id:e},n=o()?s():null;null!==n&&void 0!==n&&n.advisor_id&&(t.advisor_id=n.advisor_id);const r=await(0,Eg.getClients)(t);F(r.clients.map((e=>({id:e.id,name:e.name||"Sin nombre",email:e.email||"Sin email",phone:e.phone||"Sin tel\xe9fono",company_name:e.company_name}))))}catch(t){console.error("Error loading clients for company",t)}finally{W(!1)}else F([])})(e.target.value),disabled:z,children:[(0,$e.jsx)("option",{value:"",children:"Todas las empresas"}),R.map((e=>(0,$e.jsx)("option",{value:e.id,children:e.name},e.id)))]}),z&&(0,$e.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-xs mr-2"}),(0,$e.jsx)("span",{className:"text-sm text-gray-500",children:"Cargando empresas..."})]})]}),E.length>0?(0,$e.jsxs)("div",{className:"mb-6",children:[(0,$e.jsx)("h3",{className:"font-medium mb-2",children:"Resultados de b\xfasqueda"}),(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{children:"Nombre"}),(0,$e.jsx)("th",{children:"Email"}),(0,$e.jsx)("th",{children:"Tel\xe9fono"}),(0,$e.jsx)("th",{children:"Empresa"}),(0,$e.jsx)("th",{children:"Acciones"})]})}),(0,$e.jsx)("tbody",{children:E.map((e=>(0,$e.jsxs)("tr",{className:"hover",children:[(0,$e.jsx)("td",{children:e.name}),(0,$e.jsx)("td",{children:e.email}),(0,$e.jsx)("td",{children:e.phone}),(0,$e.jsx)("td",{children:e.company_name||"No asignada"}),(0,$e.jsx)("td",{children:(0,$e.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>q(e),children:"Seleccionar"})})]},e.id)))})]})})]}):w&&!j?(0,$e.jsxs)("div",{className:"alert alert-info mb-6",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-current flex-shrink-0 w-6 h-6",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:"No se encontraron clientes con ese criterio de b\xfasqueda."})]}):null,O&&$.length>0?(0,$e.jsxs)("div",{className:"mb-6",children:[(0,$e.jsx)("h3",{className:"font-medium mb-2",children:"Clientes de esta empresa"}),(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{children:"Nombre"}),(0,$e.jsx)("th",{children:"Email"}),(0,$e.jsx)("th",{children:"Tel\xe9fono"}),(0,$e.jsx)("th",{children:"Acciones"})]})}),(0,$e.jsx)("tbody",{children:$.map((e=>(0,$e.jsxs)("tr",{className:"hover",children:[(0,$e.jsx)("td",{children:e.name}),(0,$e.jsx)("td",{children:e.email}),(0,$e.jsx)("td",{children:e.phone}),(0,$e.jsx)("td",{children:(0,$e.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>q(e),children:"Seleccionar"})})]},e.id)))})]})})]}):O&&!U?(0,$e.jsxs)("div",{className:"alert alert-info mb-6",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-current flex-shrink-0 w-6 h-6",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:"Esta empresa no tiene clientes asignados."})]}):U?(0,$e.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,$e.jsx)("span",{className:"loading loading-spinner loading-md"}),(0,$e.jsx)("span",{className:"ml-2",children:"Cargando clientes..."})]}):null,(0,$e.jsx)("div",{className:"divider",children:"O"}),(0,$e.jsx)("div",{className:"text-center",children:(0,$e.jsx)("button",{className:"btn btn-outline",onClick:()=>{A(!0),D(!1)},children:"Continuar sin seleccionar cliente"})})]})}),m?(0,$e.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})}):(T||u)&&(0,$e.jsxs)("form",{onSubmit:async e=>{var n;if(e.preventDefault(),null!==(n=h.client_name)&&void 0!==n&&n.trim())if("personal"!==h.financing_type||h.amount)if("producto"!==h.financing_type||h.product_price){b(null),v(!0);try{o()&&s();const e={client_name:h.client_name,client_email:h.client_email||"",client_phone:h.client_phone||"",client_address:h.client_address||"",dni:h.dni||"",amount:h.amount||0,term:h.term||12,interest_rate:h.interest_rate||45,monthly_payment:h.monthly_payment||0,financing_type:h.financing_type,product_url:h.product_url||"",product_price:h.product_price,application_type:"selected_plans",status:wt.SOLICITUD,company_id:h.company_id,company_name:h.company_name,assigned_to:h.assigned_to,client_id:h.client_id||"",source_id:h.client_id||cg(),approved_by_advisor:!1,approved_by_company:!1};console.log("Creating application with data:",e);const n=await(async e=>{try{var t;console.log("[createApplication] Creating new application:",e);let n=(null===(t=e.client_id)||void 0===t?void 0:t.trim())||void 0;n||(n=cg(),await Yf.ND.from("users").insert({id:n}),console.log(`[createApplication] Generated new user with id ${n}`));let r=n;const{data:a,error:o}=await Yf.ND.from("clients").select("id").eq("user_id",n).single();if(o&&"PGRST116"!==o.code)throw console.error("[createApplication] Error looking up client:",o),o;if(a)r=a.id,console.log(`[createApplication] Found existing client ${r} for user_id ${n}`);else{console.log(`[createApplication] Creating new client for user_id ${n}`),r=n;const{error:t}=await Yf.ND.from("clients").insert({id:r,user_id:n,name:e.client_name,email:e.client_email,phone:e.client_phone,address:e.client_address,company_id:e.company_id,advisor_id:e.assigned_to});if(t)throw console.error("[createApplication] Error creating new client:",t),t}e.client_id=r;const s=Object.fromEntries(Object.entries(e).filter((e=>{let[t,n]=e;return void 0!==n})).map((e=>{let[t,n]=e;return["amount","term","interest_rate","monthly_payment","product_price"].includes(t)&&void 0!==n?[t,"string"===typeof n?parseFloat(n):n]:["approved_by_advisor","approved_by_company","rejected_by_advisor","rejected_by_company"].includes(t)?[t,"string"===typeof n?"true"===n:Boolean(n)]:[t,n]})));s.source_id&&""!==s.source_id||(s.source_id=cg());const{data:i,error:l}=await Yf.ND.from(qf.C.APPLICATIONS).insert([s]).select();if(l){console.error("[createApplication] Error creating application via Supabase client:",l),console.log("[createApplication] Falling back to SQL query method");const e=Object.keys(s).join(", "),t=Object.values(s).map((e=>null===e||void 0===e?"NULL":"string"===typeof e?`'${e.replace(/'/g,"''")}'`:"number"===typeof e?e:"boolean"===typeof e?e?"true":"false":"NULL")).join(", "),n=`\n    INSERT INTO ${qf.C.APPLICATIONS} (${e})\n    VALUES (${t})\n    RETURNING *\n  `,r=await eg(n);return console.log("[createApplication] SQL method returned:",r[0]),r[0]}return console.log("[createApplication] Successfully created application via Supabase client:",i),i[0]}catch(y){throw console.error("[createApplication] Error creating application:",y),y}})(e);n&&n.id&&(_(`Solicitud creada exitosamente con ID: ${n.id}`),t(`/applications/${n.id}`),p({client_name:"",client_email:"",client_phone:"",client_address:"",dni:"",amount:void 0,term:12,interest_rate:45,monthly_payment:void 0,financing_type:"personal",product_url:"",product_price:void 0,application_type:"selected_plans",status:wt.SOLICITUD,company_id:"",company_name:"",assigned_to:(null===r||void 0===r?void 0:r.id)||"",client_id:void 0}))}catch(y){console.error("Error saving application:",y),b(`Error al guardar la solicitud: ${y.message}`)}finally{v(!1)}}else b("El precio del producto es requerido");else b("El monto del pr\xe9stamo es requerido");else b("El nombre del cliente es requerido")},className:"space-y-6",children:[(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center border-b pb-2 mb-4",children:[(0,$e.jsx)("h2",{className:"card-title text-lg",children:"Informaci\xf3n del Cliente"}),!u&&T&&(0,$e.jsx)("button",{type:"button",className:"btn btn-sm btn-outline",onClick:()=>{p((e=>({...e,client_name:"",client_email:"",client_phone:"",client_address:"",client_id:""}))),A(!1),D(!0)},children:"Cambiar Cliente"})]}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Nombre Completo*"})}),(0,$e.jsx)("input",{type:"text",name:"client_name",value:h.client_name,onChange:Y,className:"input input-bordered",required:!0})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Email*"})}),(0,$e.jsx)("input",{type:"email",name:"client_email",value:h.client_email,onChange:Y,className:"input input-bordered",required:!0})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tel\xe9fono*"})}),(0,$e.jsx)("input",{type:"tel",name:"client_phone",value:h.client_phone,onChange:Y,className:"input input-bordered",required:!0})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"DNI / Identificaci\xf3n"})}),(0,$e.jsx)("input",{type:"text",name:"dni",value:h.dni,onChange:Y,className:"input input-bordered"})]}),(0,$e.jsxs)("div",{className:"form-control md:col-span-2",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Direcci\xf3n"})}),(0,$e.jsx)("input",{type:"text",name:"client_address",value:h.client_address,onChange:Y,className:"input input-bordered"})]})]})]})}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Informaci\xf3n del Cr\xe9dito"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tipo de Financiamiento*"})}),(0,$e.jsxs)("select",{name:"financing_type",value:h.financing_type,onChange:Y,className:"select select-bordered",required:!0,children:[(0,$e.jsx)("option",{value:"producto",children:"Financiamiento de Producto"}),(0,$e.jsx)("option",{value:"personal",children:"Cr\xe9dito Personal"})]})]}),"producto"===h.financing_type&&(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Precio del Producto*"})}),(0,$e.jsx)("input",{type:"number",name:"product_price",value:void 0===h.product_price?"":h.product_price,onChange:Y,className:"input input-bordered",min:"0",step:"0.01",required:!0})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsxs)("label",{className:"label",children:[(0,$e.jsxs)("span",{className:"label-text",children:["Monto","producto"===h.financing_type?" (Calculado autom\xe1ticamente)":"*"]}),"producto"===h.financing_type&&h.product_price&&h.product_price>0&&(0,$e.jsxs)("span",{className:"label-text-alt text-info",children:["Precio: $","number"===typeof h.product_price?h.product_price.toFixed(2):"0.00"," \xf7 0.95 = $","number"===typeof h.amount?h.amount.toFixed(2):"0.00"]})]}),(0,$e.jsx)("input",{type:"number",name:"amount",value:void 0===h.amount?"":h.amount,onChange:Y,className:"input input-bordered "+("producto"===h.financing_type?"bg-gray-100":""),min:"0",step:"0.01",required:!0,readOnly:"producto"===h.financing_type})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Plazo (meses)"})}),(0,$e.jsx)("input",{type:"number",name:"term",value:void 0===h.term?"":h.term,onChange:Y,className:"input input-bordered",min:"1"})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tasa de Inter\xe9s (%)"})}),(0,$e.jsx)("input",{type:"number",name:"interest_rate",value:void 0===h.interest_rate?"":h.interest_rate,onChange:Y,className:"input input-bordered",readOnly:!0,min:"0",step:"0.01"})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Pago Mensual"})}),(0,$e.jsx)("input",{type:"number",name:"monthly_payment",value:void 0===h.monthly_payment?"":h.monthly_payment,onChange:Y,className:"input input-bordered",min:"0",readOnly:!0})]})]})]})}),"producto"===h.financing_type&&(0,$e.jsxs)("div",{className:"form-control md:col-span-2",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"URL del Producto (Amazon/MercadoLibre)"})}),(0,$e.jsx)("input",{type:"url",name:"product_url",value:h.product_url||"",onChange:Y,className:"input input-bordered",placeholder:"https://www.amazon.com/...",required:!0})]}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Empresa y Asesor"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"ID de Empresa"})}),(0,$e.jsx)("input",{type:"text",name:"company_id",value:h.company_id,onChange:Y,className:"input input-bordered",readOnly:!0})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Nombre de Empresa"})}),(0,$e.jsx)("input",{type:"text",name:"company_name",value:h.company_name,onChange:Y,className:"input input-bordered",readOnly:!!h.company_id||o()})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"ID de Asesor Asignado"})}),(0,$e.jsx)("input",{type:"text",name:"assigned_to",value:h.assigned_to,onChange:Y,className:"input input-bordered",readOnly:o()})]})]})]})}),(0,$e.jsx)("div",{className:"flex justify-end",children:(0,$e.jsx)("button",{type:"submit",className:"btn btn-primary "+(g?"loading":""),disabled:g,children:u?"Actualizar Solicitud":"Crear Solicitud"})})]})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,$e.jsxs)("div",{className:"text-center",children:[(0,$e.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,$e.jsxs)("p",{className:"text-gray-500 mt-2",children:["No tienes permisos para ",u?"editar":"crear"," solicitudes."]})]})})})},sv=()=>{var e;const{userCan:t,isCompanyAdmin:n,isAdvisor:r}=Qe(),{user:o}=We(),[s,i]=(0,a.useState)([]),[l,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(null),[h,p]=(0,a.useState)(0),[m,f]=(0,a.useState)([]),[g,v]=(0,a.useState)("created_at"),[y,b]=(0,a.useState)("desc"),[x,_]=(0,a.useState)({searchQuery:"",page:0,pageSize:10});(0,a.useEffect)((()=>{console.log("\ud83d\udd04 useEffect [user] triggered with user:",null===o||void 0===o?void 0:o.role,null===o||void 0===o?void 0:o.entityId),o&&"ADVISOR"===o.role?(console.log("Setting strict advisor filter: advisor_id =",o.id),_((e=>({...e,advisor_id:o.id,company_id:void 0})))):o&&"COMPANY_ADMIN"===o.role&&(console.log("\ud83d\udd12 SECURITY: Setting company admin filter:",{company_id:o.entityId}),_((e=>({...e,company_id:o.entityId,advisor_id:void 0}))))}),[o]),(0,a.useEffect)((()=>{console.log("\ud83d\udd04 useEffect [loadCompanies] triggered with user:",null===o||void 0===o?void 0:o.role);const e=async()=>{try{let e=[];o&&"ADVISOR"===o.role?(console.log("Loading companies for advisor ID:",o.id),e=await(async e=>{try{console.log(`Fetching companies for advisor ID: ${e}`);const{data:t,error:n}=await tt.ND.from(nv).select("*").eq("advisor_id",e).order("name",{ascending:!0});if(n)throw console.error(`Error fetching companies for advisor ${e}:`,n),n;return console.log(`Found ${(null===t||void 0===t?void 0:t.length)||0} companies for advisor ${e}`),t}catch(t){return console.error("Error in getCompaniesForAdvisor:",t),[]}})(o.id),console.log("Companies for advisor:",e)):!o||"SUPERADMIN"!==o.role&&"COMPANY_ADMIN"!==o.role||(e=await(async e=>{let t=tt.ND.from(nv).select("*");e&&(e.advisor_id&&(t=t.eq("advisor_id",e.advisor_id)),e.status&&"all"!==e.status&&(t=t.eq("status",e.status)),e.searchQuery&&(t=t.or(`name.ilike.%${e.searchQuery}%,rfc.ilike.%${e.searchQuery}%,contact_name.ilike.%${e.searchQuery}%,contact_email.ilike.%${e.searchQuery}%`))),t=t.order("name",{ascending:!0});const{data:n,error:r}=await t;if(r)throw console.error("Error fetching companies:",r),r;return n})()),f(e)}catch(d){console.error("Error loading companies:",d)}};o&&e()}),[o]);const w=(0,a.useCallback)((async()=>{try{var e,t;if(c(!0),n()&&o&&o.entityId&&!x.company_id)return console.error("\ud83d\udea8 FRONTEND SECURITY VIOLATION: Company admin attempting to fetch clients without company filter"),console.error("\ud83d\udea8 User entityId:",o.entityId),console.error("\ud83d\udea8 Current filters:",x),void u("Error de seguridad: No se puede acceder a datos sin filtro de empresa");let a={...x};r()&&o&&!a.advisor_id&&(console.log("Adding missing advisor_id filter for advisor role"),a.advisor_id=o.id),n()&&o&&o.entityId&&!a.company_id&&(console.log("\ud83d\udd12 SECURITY: Adding missing company_id filter for company admin role"),a.company_id=o.entityId),n()&&o&&o.entityId&&(console.log("\ud83d\udd12 SECURITY: Enforcing company_id filter for company admin:",o.entityId),a.company_id=o.entityId),console.log("\ud83d\udd0d FINAL FILTERS BEING SENT TO API:",JSON.stringify(a,null,2)),console.log("\ud83d\udd0d USER ROLE:",null===o||void 0===o?void 0:o.role),console.log("\ud83d\udd0d USER ENTITY ID:",null===o||void 0===o?void 0:o.entityId),console.log("Fetching clients with filters:",a);const s=await(0,Eg.getClients)(a);i(s.clients||[]),p(s.totalCount||0),console.log(`\ud83d\udd0d SECURITY CHECK: Returned ${(null===(e=s.clients)||void 0===e?void 0:e.length)||0} clients for company admin with entityId: ${null===o||void 0===o?void 0:o.entityId}`),0!==(null===(t=s.clients)||void 0===t?void 0:t.length)&&s.clients||0!==s.totalCount&&s.totalCount?u(null):u("No se pudieron cargar los clientes. La tabla de clientes no existe en la base de datos.")}catch(a){console.error("Error fetching clients:",a),u("No se pudieron cargar los clientes. Por favor intente nuevamente.")}finally{c(!1)}}),[x,n,o,r]);(0,a.useEffect)((()=>{console.log("\ud83d\udd04 useEffect [fetchClients] triggered with filters:",x),n()&&o&&o.entityId&&!x.company_id?console.log("\u23f3 WAITING: Company admin filter not yet established, skipping fetch"):w()}),[x.page,x.pageSize,x.advisor_id,x.company_id,x.searchQuery,x.dateFrom,x.dateTo,w,n,o]),(0,a.useEffect)((()=>{const e=setTimeout((()=>{n()&&o&&o.entityId&&!x.company_id?console.log("\u23f3 WAITING: Company admin filter not yet established, skipping search fetch"):0!==x.page?_((e=>({...e,page:0}))):w()}),500);return()=>clearTimeout(e)}),[x.searchQuery,x.dateFrom,x.dateTo,x.page,w,n,o,_]);const N=e=>{const{name:t,value:n}=e.target;_((e=>({...e,[t]:n})))},E=e=>{e===g?b("asc"===y?"desc":"asc"):(v(e),b("asc"))},S=x.page*x.pageSize+1,j=Math.min(S+s.length-1,h||S+s.length-1),k=h?Math.ceil(h/x.pageSize):s.length===x.pageSize?x.page+2:x.page+1,C=m.length>0&&(r()||"SUPERADMIN"===(null===o||void 0===o?void 0:o.role)||n());return(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,$e.jsxs)("h1",{className:"text-2xl font-bold mb-4 md:mb-0",children:[n()?"Empleados":"Clientes",r()&&(0,$e.jsx)("span",{className:"text-sm font-normal ml-2 text-gray-500",children:"(Solo tus clientes asignados)"})]}),t(He.CREATE_CLIENT)&&(0,$e.jsxs)(Te,{to:"/clients/new",className:"btn btn-primary",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),n()?"Nuevo Empleado":"Nuevo Cliente"]})]}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl mb-6",children:(0,$e.jsxs)("div",{className:"card-body",children:[(0,$e.jsx)("h2",{className:"card-title text-lg mb-4",children:"Filtros"}),(0,$e.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Buscar"})}),(0,$e.jsxs)("div",{className:"input-group",children:[(0,$e.jsx)("input",{type:"text",placeholder:"Buscar por nombre, correo, tel\xe9fono, RFC o CURP...",className:"input input-bordered w-full",value:x.searchQuery,onChange:e=>{_((t=>({...t,searchQuery:e.target.value})))}}),(0,$e.jsx)("button",{className:"btn btn-square",onClick:()=>{_((e=>({...e})))},children:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]}),C&&m.length>0&&(0,$e.jsxs)("div",{className:"form-control w-full md:w-1/2",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Empresa"})}),n()?(0,$e.jsxs)("div",{className:"input input-bordered w-full bg-base-200 flex items-center",children:[(0,$e.jsx)("span",{className:"text-gray-700",children:(null===(e=m.find((e=>e.id===(null===o||void 0===o?void 0:o.entityId))))||void 0===e?void 0:e.name)||"Mi Empresa"}),(0,$e.jsx)("span",{className:"badge badge-primary ml-2 text-xs",children:"Solo mi empresa"})]}):(0,$e.jsxs)("select",{className:"select select-bordered w-full",value:x.company_id||"",onChange:e=>{const t=e.target.value||void 0;_((e=>({...e,company_id:t,...r()&&{advisor_id:null===o||void 0===o?void 0:o.id},page:0})))},children:[(0,$e.jsx)("option",{value:"",children:"Todas mis empresas"}),m.map((e=>(0,$e.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]}),(0,$e.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full md:w-1/2",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Fecha Desde"})}),(0,$e.jsx)("input",{type:"date",name:"dateFrom",className:"input input-bordered w-full",value:x.dateFrom||"",onChange:N})]}),(0,$e.jsxs)("div",{className:"form-control w-full md:w-1/2",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Fecha Hasta"})}),(0,$e.jsx)("input",{type:"date",name:"dateTo",className:"input input-bordered w-full",value:x.dateTo||"",onChange:N})]})]})]})}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsx)("div",{className:"card-body",children:l?(0,$e.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})}):d?(0,$e.jsxs)("div",{className:"alert alert-error",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:d})]}):0===s.length?(0,$e.jsxs)("div",{children:[(0,$e.jsx)("p",{className:"text-center py-8 text-gray-500",children:"No se encontraron clientes con los filtros aplicados."}),x.page>0&&(0,$e.jsxs)("div",{className:"alert alert-warning mt-4",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"font-bold",children:"No hay resultados en esta p\xe1gina"}),(0,$e.jsxs)("div",{className:"text-sm",children:["No se encontraron clientes en la p\xe1gina ",x.page+1,".",(0,$e.jsx)("button",{className:"btn btn-sm btn-outline ml-4",onClick:()=>_((e=>({...e,page:0}))),children:"Volver a la primera p\xe1gina"})]})]})]}),!x.searchQuery&&!x.dateFrom&&!x.dateTo&&(0,$e.jsxs)("div",{className:"alert alert-info mt-4",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-current flex-shrink-0 w-6 h-6",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"font-bold",children:n()?"No hay empleados registrados":"No hay clientes registrados"}),(0,$e.jsx)("div",{className:"text-sm",children:t(He.CREATE_CLIENT)?(0,$e.jsx)("span",{children:n()?'Puede crear un nuevo empleado utilizando el bot\xf3n "Nuevo Empleado" en la parte superior.':'Puede crear un nuevo cliente utilizando el bot\xf3n "Nuevo Cliente" en la parte superior.'}):(0,$e.jsx)("span",{children:n()?"Contacte al administrador para registrar empleados en el sistema.":"Contacte al administrador para registrar clientes en el sistema."})})]})]})]}):(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{onClick:()=>E("name"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Nombre","name"===g&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===y?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>E("email"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Correo","email"===g&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===y?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>E("phone"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Tel\xe9fono","phone"===g&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===y?"\u2191":"\u2193"})]})}),!n()&&(0,$e.jsx)("th",{onClick:()=>E("company_name"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Empresa","company_name"===g&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===y?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>E("rfc"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["RFC","rfc"===g&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===y?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>E("created_at"),className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Fecha Registro","created_at"===g&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===y?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{children:"Acciones"})]})}),(0,$e.jsx)("tbody",{children:(g?[...s].sort(((e,t)=>{let n=e[g],r=t[g];return null!==n&&void 0!==n||(n=""),null!==r&&void 0!==r||(r=""),"string"===typeof n&&(n=n.toLowerCase()),"string"===typeof r&&(r=r.toLowerCase()),"asc"===y?n>r?1:n<r?-1:0:n<r?1:n>r?-1:0})):s).map((e=>(0,$e.jsxs)("tr",{className:"hover",children:[(0,$e.jsx)("td",{children:e.name||[e.first_name,e.paternal_surname,e.maternal_surname].filter(Boolean).join(" ")}),(0,$e.jsx)("td",{children:e.email}),(0,$e.jsx)("td",{children:e.phone}),!n()&&(0,$e.jsx)("td",{children:e.company_name||"N/A"}),(0,$e.jsx)("td",{children:e.rfc||"-"}),(0,$e.jsx)("td",{children:new Date(e.created_at).toLocaleDateString()}),(0,$e.jsxs)("td",{className:"flex gap-2",children:[(0,$e.jsx)(Te,{to:`/clients/${e.id}`,className:"btn btn-sm btn-info",children:"Ver"}),t(He.EDIT_CLIENT)&&(0,$e.jsx)(Te,{to:`/clients/${e.id}/edit`,className:"btn btn-sm btn-secondary",children:"Editar"})]})]},e.id)))})]})}),(0,$e.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mt-6",children:[(0,$e.jsx)("div",{className:"mb-4 md:mb-0",children:(0,$e.jsxs)("span",{className:"text-sm text-gray-500",children:["Mostrando ",S," a ",j," de ",h," clientes"]})}),(0,$e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,$e.jsx)("div",{className:"form-control",children:(0,$e.jsxs)("select",{className:"select select-bordered select-sm",value:x.pageSize,onChange:e=>{const t=parseInt(e.target.value);_((e=>(console.log(`Changing page size from ${e.pageSize} to ${t}, resetting page to 0`),{...e,pageSize:t,page:0})))},children:[(0,$e.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,$e.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,$e.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,$e.jsx)("option",{value:100,children:"100 por p\xe1gina"})]})}),(0,$e.jsxs)("div",{className:"join",children:[(0,$e.jsx)("button",{className:"join-item btn btn-sm",onClick:()=>{x.page>0&&_((e=>({...e,page:e.page-1})))},disabled:0===x.page,children:"\xab"}),(0,$e.jsxs)("button",{className:"join-item btn btn-sm",children:["P\xe1gina ",x.page+1," de ",k]}),(0,$e.jsx)("button",{className:"join-item btn btn-sm",onClick:()=>{s.length>0&&s.length===x.pageSize&&_((e=>({...e,page:e.page+1})))},disabled:0===s.length||s.length<x.pageSize,children:"\xbb"})]})]})]})]})})})]})})},iv=[{value:"masculino",label:"Masculino"},{value:"femenino",label:"Femenino"},{value:"otro",label:"Otro"},{value:"prefiero_no_decir",label:"Prefiero no decir"}],lv=[{value:"soltero",label:"Soltero/a"},{value:"casado",label:"Casado/a"},{value:"divorciado",label:"Divorciado/a"},{value:"viudo",label:"Viudo/a"},{value:"union_libre",label:"Uni\xf3n Libre"}],cv=[{value:"empleado",label:"Empleado"},{value:"autonomo",label:"Aut\xf3nomo / Freelance"},{value:"empresario",label:"Empresario"},{value:"jubilado",label:"Jubilado"},{value:"desempleado",label:"Desempleado"},{value:"estudiante",label:"Estudiante"},{value:"otro",label:"Otro"}],dv=[{value:"semanal",label:"Semanal"},{value:"quincenal",label:"Quincenal"},{value:"mensual",label:"Mensual"},{value:"bimestral",label:"Bimestral"},{value:"trimestral",label:"Trimestral"},{value:"semestral",label:"Semestral"},{value:"anual",label:"Anual"},{value:"irregular",label:"Irregular"}],uv=[{value:"efectivo",label:"Efectivo"},{value:"transferencia",label:"Transferencia"},{value:"tarjeta",label:"Tarjeta de Cr\xe9dito/D\xe9bito"},{value:"cheque",label:"Cheque"},{value:"domiciliacion",label:"Domiciliaci\xf3n Bancaria"}],hv=[{value:"personal",label:"Gastos Personales"},{value:"negocio",label:"Negocio/Inversi\xf3n"},{value:"vivienda",label:"Vivienda"},{value:"auto",label:"Autom\xf3vil"},{value:"educacion",label:"Educaci\xf3n"},{value:"salud",label:"Salud"},{value:"deudas",label:"Consolidaci\xf3n de Deudas"},{value:"otro",label:"Otro"}],pv=[{value:"nomina",label:"N\xf3mina"},{value:"ahorro",label:"Ahorro"},{value:"cheques",label:"Cheques"},{value:"inversiones",label:"Inversiones"}],mv=[{value:"familiar",label:"Familiar"},{value:"amigo",label:"Amigo"},{value:"companero_trabajo",label:"Compa\xf1ero de Trabajo"},{value:"vecino",label:"Vecino"},{value:"otro",label:"Otro"}],fv=(e,t)=>{if(!t)return"-";const n=e.find((e=>e.value===t));return n?n.label:t},gv=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("es-MX",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(Yv){return e}},vv=e=>{switch(e){case"approved":return"badge-success";case"rejected":return"badge-error";case"pending":case"in_review":return"badge-warning";case"por_dispersar":return"badge-accent";case"completed":return"badge-primary";default:return"badge-info"}},yv=e=>{var t,n;let{document:r,onClose:o}=e;const[s,i]=(0,a.useState)(!0),[l,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[h,p]=(0,a.useState)(!1);(0,a.useEffect)((()=>((async()=>{try{var e;if(i(!0),c(null),p(!1),u(null),!r.file_path)throw new Error("El documento no tiene una ruta de archivo v\xe1lida");const a=null===(e=r.file_path.split(".").pop())||void 0===e?void 0:e.toLowerCase();console.log(`[DocViewer] Loading document. Extension: ${a}, Original file_type: ${r.file_type}, Path: ${r.file_path}`);const o=a&&["jpg","jpeg","png","gif","webp","bmp","svg"].includes(a),s="pdf"===a,l=(0,tt.X3)();let d=null;if(o){console.log("[DocViewer] Document is an image. Attempting direct download and blob URL creation.");const{data:e,error:n}=await l.storage.from("client-documents").download(r.file_path);if(n||!e)throw console.error("[DocViewer] Error downloading image data:",n),new Error(`Error al descargar los datos de la imagen: ${(null===n||void 0===n?void 0:n.message)||"Error desconocido"}`);console.log(`[DocViewer] Image data downloaded successfully: ${e.size} bytes`);const o=a&&{png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",svg:"image/svg+xml"}[a]||"application/octet-stream";let s;try{const t=await e.arrayBuffer(),n=new Uint8Array(t);let r=0;const a=[137,80,78,71],i=[255,216,255],l=(e,t)=>e.every(((e,r)=>n[t+r]===e));for(let e=0;e<n.length-4;e++)if(l(a,e)||l(i,e)){r=e;break}if(r>0){console.log(`[DocViewer] Detected binary header at index ${r}. Stripping multipart preamble.`);const e=n.slice(r);s=new Blob([e],{type:o})}else s=new Blob([n],{type:o})}catch(t){console.error("[DocViewer] Error sanitizing image data, falling back to original blob",t),s=new Blob([e],{type:o})}d=URL.createObjectURL(s),console.log(`[DocViewer] Sanitized Blob URL for image created: ${d.substring(0,50)}...`)}else if(s){console.log("[DocViewer] Document is a PDF. Downloading for sanitation.");const{data:e,error:t}=await l.storage.from("client-documents").download(r.file_path);if(t||!e)throw console.error("[DocViewer] Error downloading PDF data:",t),new Error(`Error al descargar los datos del PDF: ${(null===t||void 0===t?void 0:t.message)||"Error desconocido"}`);let a;console.log(`[DocViewer] PDF data downloaded successfully: ${e.size} bytes`);try{const t=await e.arrayBuffer(),n=new Uint8Array(t);let r=0;const o=[37,80,68,70,45],s=e=>o.every(((t,r)=>n[e+r]===t));for(let e=0;e<n.length-5;e++)if(s(e)){r=e;break}if(r>0){console.log(`[DocViewer] Detected PDF header at index ${r}. Stripping multipart preamble.`);const e=n.slice(r);a=new Blob([e],{type:"application/pdf"})}else a=new Blob([n],{type:"application/pdf"})}catch(n){console.error("[DocViewer] Error sanitizing PDF, using original data",n),a=new Blob([e],{type:"application/pdf"})}d=URL.createObjectURL(a),console.log(`[DocViewer] Sanitized Blob URL for PDF created: ${d.substring(0,50)}...`)}else{console.log("[DocViewer] Document is other type. Trying public URL for download purposes.");const{data:e}=await l.storage.from("client-documents").getPublicUrl(r.file_path);if(null!==e&&void 0!==e&&e.publicUrl)d=e.publicUrl,console.log(`[DocViewer] Public URL for other file type: ${d}`);else{console.log("[DocViewer] Public URL for other type not available. Downloading for blob URL (for download attribute).");const{data:e,error:t}=await l.storage.from("client-documents").download(r.file_path);if(t||!e)throw console.error("[DocViewer] Error downloading other file data:",t),new Error(`Error al descargar el archivo: ${(null===t||void 0===t?void 0:t.message)||"Error desconocido"}`);const n=r.file_type||"application/octet-stream",a=new Blob([e],{type:n});d=URL.createObjectURL(a),console.log(`[DocViewer] Blob URL for other file type created: ${d.substring(0,50)}...`)}}u(d)}catch(a){console.error("[DocViewer] General error in loadDocument:",a),c(a instanceof Error?a.message:"Error al cargar el documento")}finally{i(!1)}})(),()=>{d&&d.startsWith("blob:")&&(URL.revokeObjectURL(d),console.log("[DocViewer] Blob URL revoked:",d.substring(0,50)))})),[r.id,r.file_path]);const m=null===(t=r.file_path)||void 0===t||null===(n=t.split(".").pop())||void 0===n?void 0:n.toLowerCase(),f=m&&["jpg","jpeg","png","gif","webp","bmp","svg"].includes(m),g="pdf"===m,v=()=>{if(!d)return;const e=window.document.createElement("a");e.href=d,e.download=r.file_name||"documento",window.document.body.appendChild(e),e.click(),window.document.body.removeChild(e),console.log(`[DocViewer] Download initiated for: ${r.file_name}, URL: ${d.substring(0,50)}`)};return(0,$e.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:(0,$e.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,$e.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"}),(0,$e.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:(0,$e.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,$e.jsx)("div",{className:"sm:flex sm:items-start",children:(0,$e.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,$e.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:r.file_name}),(0,$e.jsxs)("div",{className:"flex gap-2",children:[(0,$e.jsx)("button",{onClick:v,className:"p-2 rounded-full hover:bg-gray-100",disabled:!d||"#"===d,title:"Descargar documento",children:(0,$e.jsx)(Mg,{className:"text-gray-600"})}),(0,$e.jsx)("button",{onClick:o,className:"p-2 rounded-full hover:bg-gray-100",title:"Cerrar",children:(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),(0,$e.jsx)("div",{className:"w-full",children:s?(0,$e.jsx)("div",{className:"flex justify-center items-center py-16",children:(0,$e.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-primary"})}):l?(0,$e.jsxs)("div",{className:"text-center py-16",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-red-500 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,$e.jsx)("p",{className:"text-gray-700",children:l}),(0,$e.jsx)("button",{onClick:v,className:"mt-4 px-4 py-2 bg-primary text-white rounded hover:bg-blue-700",disabled:!d||"#"===d,children:"Intentar descargar de todos modos"})]}):f&&d&&!h?(0,$e.jsx)("div",{className:"flex justify-center items-center overflow-auto max-h-[80vh]",children:(0,$e.jsx)("img",{src:d,alt:r.file_name||"Documento",className:"max-w-full h-auto object-contain",onError:e=>{console.error(`[DocViewer] Error loading image in <img> tag. SRC: ${e.currentTarget.src.substring(0,100)}...`),p(!0)}})}):g&&d?(0,$e.jsx)("div",{className:"w-full h-[80vh]",children:(0,$e.jsx)("iframe",{src:`${d}#toolbar=0`,className:"w-full h-full",title:r.file_name||"Documento PDF"})}):(0,$e.jsxs)("div",{className:"text-center py-16",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,$e.jsx)("p",{className:"text-gray-700 mb-4",children:"Este tipo de documento no se puede previsualizar."}),d&&"#"!==d&&(0,$e.jsx)("button",{onClick:v,className:"px-4 py-2 bg-primary text-white rounded hover:bg-blue-700",children:"Descargar documento"})]})})]})})})})]})})},bv=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},xv=()=>{const{id:e}=re(),t=ne(),{userCan:n}=(ee(),Qe()),[r,o]=(0,a.useState)(null),[s,i]=(0,a.useState)([]),[l,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(!0),[h,p]=(0,a.useState)(!0),[m,f]=(0,a.useState)(!0),[g,v]=(0,a.useState)(null),[y,b]=(0,a.useState)(null),[x,_]=(0,a.useState)(null),[w,N]=(0,a.useState)(null),[E,S]=(0,a.useState)("info"),[j,k]=(0,a.useState)("all"),[C,D]=(0,a.useState)("all"),[T,A]=(0,a.useState)("created_at"),[P,I]=(0,a.useState)("desc"),[R,M]=(0,a.useState)(null),O=(0,a.useMemo)((()=>{const e=new Set;return l.forEach((t=>{t.category&&e.add(t.category)})),Array.from(e)}),[l]);(0,a.useEffect)((()=>{L()}),[e]);const L=async()=>{if(!e)return v("No se proporcion\xf3 un ID de cliente v\xe1lido"),u(!1),void setTimeout((()=>{t("/clients")}),2e3);try{u(!0),p(!0),f(!0),v(null),N(null),console.log(`[ClientDetail] Fetching data for client ID: ${e}`);const s=await(0,Eg.getClientWithSync)(e);if(s){console.log(`[ClientDetail] Client found: ${s.id}`),o(s);try{const t=await(0,Eg.getClientApplications)(e);t&&t.length>0?(console.log(`[ClientDetail] Found ${t.length} applications for client`),i(t)):console.log("[ClientDetail] No applications found for client")}catch(n){console.error(`[ClientDetail] Error fetching applications: ${n}`),b(`Error al cargar las solicitudes: ${n}`)}finally{p(!1)}try{console.log(`[ClientDetail] Intentando cargar documentos para el cliente con ID: ${e}`);const t=await(0,jg.nj)(e);if(console.log("[ClientDetail] Respuesta de getAllClientDocuments:",JSON.stringify(t)),t&&t.length>0)console.log(`[ClientDetail] Found ${t.length} documents for client`),c(t);else{console.log("[ClientDetail] No documents found for client. Verificando tabla...");const t=(0,tt.X3)();try{const{data:n,error:r}=await t.from(qf.C.DOCUMENTS).select("count(*)").eq("client_id",e);console.log("[ClientDetail] Verificaci\xf3n directa de documentos:",JSON.stringify(n),r)}catch(r){console.error(`[ClientDetail] Error verificando tabla documents: ${r}`)}}}catch(a){console.error(`[ClientDetail] Error fetching documents: ${a}`),_(`Error al cargar los documentos: ${a}`)}finally{f(!1)}}else v(`No se encontr\xf3 el cliente con ID: ${e}`),setTimeout((()=>t("/clients")),3e3)}catch(g){console.error(`[ClientDetail] Error fetching client data: ${g.message||g}`),v(`Error al cargar los datos del cliente: ${g.message||"Error desconocido"}`)}finally{u(!1),p&&p(!1),f&&f(!1)}},$=e=>{let{label:t,value:n}=e;return(0,$e.jsxs)("div",{className:"mb-3",children:[(0,$e.jsx)("p",{className:"text-sm text-gray-500",children:t}),(0,$e.jsx)("p",{className:"font-medium",children:n||"-"})]})},F=e=>{let{id:t,label:n,isActive:r}=e;return(0,$e.jsx)("button",{onClick:()=>S(t),className:"px-4 py-2 font-medium text-sm rounded-t-lg "+(r?"bg-white text-primary border-b-2 border-primary":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:n})};return(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,$e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,$e.jsxs)("button",{onClick:()=>t("/clients"),className:"btn btn-sm btn-outline",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver a Clientes"]}),r&&(0,$e.jsxs)("h1",{className:"text-2xl font-bold",children:[r.first_name," ",r.paternal_surname," ",r.maternal_surname]})]}),r&&e&&n(He.EDIT_CLIENT)&&(0,$e.jsxs)(Te,{to:`/clients/${e}/edit`,className:"btn btn-primary",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})}),"Editar Cliente"]})]}),d?(0,$e.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})}):g?(0,$e.jsxs)("div",{className:"alert alert-error",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:g})]}):r?(0,$e.jsxs)("div",{className:"space-y-6",children:[(0,$e.jsxs)("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:[(0,$e.jsx)(F,{id:"info",label:"Informaci\xf3n Personal",isActive:"info"===E}),(0,$e.jsx)(F,{id:"contact",label:"Contacto y Direcci\xf3n",isActive:"contact"===E}),(0,$e.jsx)(F,{id:"employment",label:"Empleo",isActive:"employment"===E}),(0,$e.jsx)(F,{id:"financial",label:"Informaci\xf3n Financiera",isActive:"financial"===E}),(0,$e.jsx)(F,{id:"family",label:"Informaci\xf3n Familiar",isActive:"family"===E}),(0,$e.jsx)(F,{id:"banking",label:"Datos Bancarios",isActive:"banking"===E}),(0,$e.jsx)(F,{id:"references",label:"Referencias",isActive:"references"===E}),(0,$e.jsx)(F,{id:"applications",label:"Solicitudes",isActive:"applications"===E}),(0,$e.jsx)(F,{id:"documents",label:"Documentos",isActive:"documents"===E})]}),(0,$e.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:["info"===E&&(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Datos B\xe1sicos"}),(0,$e.jsx)($,{label:"Nombre Completo",value:`${r.first_name||""} ${r.paternal_surname||""} ${r.maternal_surname||""}`}),(0,$e.jsx)($,{label:"Nombre(s)",value:r.first_name}),(0,$e.jsx)($,{label:"Apellido Paterno",value:r.paternal_surname}),(0,$e.jsx)($,{label:"Apellido Materno",value:r.maternal_surname}),(0,$e.jsx)($,{label:"Fecha de Nacimiento",value:gv(r.birth_date)}),(0,$e.jsx)($,{label:"Estado de Nacimiento",value:r.birth_state}),(0,$e.jsx)($,{label:"Nacionalidad",value:r.nationality})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Identificaci\xf3n"}),(0,$e.jsx)($,{label:"RFC",value:r.rfc}),(0,$e.jsx)($,{label:"CURP",value:r.curp}),(0,$e.jsx)($,{label:"G\xe9nero",value:fv(iv,r.gender)}),(0,$e.jsx)($,{label:"Estado Civil",value:fv(lv,r.marital_status)}),(0,$e.jsx)($,{label:"Personas Dependientes",value:r.dependent_persons})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informaci\xf3n del Sistema"}),(0,$e.jsx)($,{label:"ID del Cliente",value:r.id}),(0,$e.jsx)($,{label:"Fecha de Registro",value:gv(r.created_at)}),(0,$e.jsx)($,{label:"\xdaltimo Acceso",value:gv(r.last_login)}),(0,$e.jsx)($,{label:"ID de Empresa",value:r.company_id}),(0,$e.jsx)($,{label:"ID de Asesor",value:r.advisor_id})]})]}),"contact"===E&&(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Contacto"}),(0,$e.jsx)($,{label:"Email",value:r.email}),(0,$e.jsx)($,{label:"Tel\xe9fono M\xf3vil",value:r.phone}),(0,$e.jsx)($,{label:"Tel\xe9fono Fijo",value:r.home_phone})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Direcci\xf3n"}),(0,$e.jsx)($,{label:"Direcci\xf3n",value:r.address}),(0,$e.jsx)($,{label:"N\xfamero Exterior",value:r.street_number_ext}),(0,$e.jsx)($,{label:"N\xfamero Interior",value:r.street_number_int}),(0,$e.jsx)($,{label:"Colonia",value:r.neighborhood}),(0,$e.jsx)($,{label:"Ciudad",value:r.city}),(0,$e.jsx)($,{label:"Estado",value:r.state}),(0,$e.jsx)($,{label:"C\xf3digo Postal",value:r.postal_code})]})]}),"employment"===E&&(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Datos Laborales"}),(0,$e.jsx)($,{label:"Tipo de Empleo",value:fv(cv,r.employment_type)}),(0,$e.jsx)($,{label:"A\xf1os de Empleo",value:r.employment_years}),(0,$e.jsx)($,{label:"Puesto/Cargo",value:r.job_position})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informaci\xf3n del Empleador"}),(0,$e.jsx)($,{label:"Nombre del Empleador",value:r.employer_name}),(0,$e.jsx)($,{label:"Tel\xe9fono del Empleador",value:r.employer_phone}),(0,$e.jsx)($,{label:"Direcci\xf3n del Empleador",value:r.employer_address}),(0,$e.jsx)($,{label:"Actividad del Empleador",value:r.employer_activity})]})]}),"financial"===E&&(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Ingresos"}),(0,$e.jsx)($,{label:"Ingreso Mensual",value:r.monthly_income?St(r.monthly_income):"-"}),(0,$e.jsx)($,{label:"Ingreso Adicional",value:r.additional_income?St(r.additional_income):"-"}),(0,$e.jsx)($,{label:"Frecuencia de Ingresos",value:fv(dv,r.income_frequency)})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Gastos"}),(0,$e.jsx)($,{label:"Gastos Mensuales",value:r.monthly_expenses?St(r.monthly_expenses):"-"}),(0,$e.jsx)($,{label:"Pago de Hipoteca",value:r.mortgage_payment?St(r.mortgage_payment):"-"}),(0,$e.jsx)($,{label:"Pago de Renta",value:r.rent_payment?St(r.rent_payment):"-"}),(0,$e.jsx)($,{label:"Saldo de Otros Pr\xe9stamos",value:r.other_loan_balances?St(r.other_loan_balances):"-"})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Preferencias Financieras"}),(0,$e.jsx)($,{label:"M\xe9todo de Pago Preferido",value:fv(uv,r.payment_method)}),(0,$e.jsx)($,{label:"Prop\xf3sito de Cr\xe9dito",value:fv(hv,r.credit_purpose)})]})]}),"family"===E&&(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informaci\xf3n del C\xf3nyuge"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,$e.jsx)($,{label:"Apellido Paterno del C\xf3nyuge",value:r.spouse_paternal_surname}),(0,$e.jsx)($,{label:"Apellido Materno del C\xf3nyuge",value:r.spouse_maternal_surname})]})]}),"banking"===E&&(0,$e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Datos Bancarios"}),(0,$e.jsx)($,{label:"Nombre del Banco",value:r.bank_name}),(0,$e.jsx)($,{label:"CLABE Interbancaria",value:r.bank_clabe}),(0,$e.jsx)($,{label:"N\xfamero de Cuenta",value:r.bank_account_number}),(0,$e.jsx)($,{label:"Tipo de Cuenta",value:fv(pv,r.bank_account_type)}),(0,$e.jsx)($,{label:"Origen de la Cuenta",value:r.bank_account_origin})]})}),"references"===E&&(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Primera Referencia"}),(0,$e.jsx)($,{label:"Nombre",value:r.reference1_name}),(0,$e.jsx)($,{label:"Relaci\xf3n",value:fv(mv,r.reference1_relationship)}),(0,$e.jsx)($,{label:"Direcci\xf3n",value:r.reference1_address}),(0,$e.jsx)($,{label:"Tel\xe9fono",value:r.reference1_phone})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Segunda Referencia"}),(0,$e.jsx)($,{label:"Nombre",value:r.reference2_name}),(0,$e.jsx)($,{label:"Relaci\xf3n",value:fv(mv,r.reference2_relationship)}),(0,$e.jsx)($,{label:"Direcci\xf3n",value:r.reference2_address}),(0,$e.jsx)($,{label:"Tel\xe9fono",value:r.reference2_phone})]})]}),"applications"===E&&(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold",children:"Solicitudes del Cliente"}),e&&n(He.CREATE_APPLICATION)&&(0,$e.jsxs)(Te,{to:`/applications/new?client=${e}`,className:"btn btn-sm btn-primary",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Nueva Solicitud"]})]}),s&&0!==s.length?(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{children:"ID"}),(0,$e.jsx)("th",{children:"Fecha"}),(0,$e.jsx)("th",{children:"Tipo"}),(0,$e.jsx)("th",{children:"Monto"}),(0,$e.jsx)("th",{children:"Estado"}),(0,$e.jsx)("th",{children:"Acciones"})]})}),(0,$e.jsx)("tbody",{children:s.filter((e=>"selected_plans"===e.application_type)).map(((e,t)=>(0,$e.jsxs)("tr",{className:"hover",children:[(0,$e.jsx)("td",{children:e.id?`${String(e.id).substring(0,8)}...`:"N/D"}),(0,$e.jsx)("td",{children:gv(e.created_at)}),(0,$e.jsx)("td",{children:_t[e.application_type]||e.application_type}),(0,$e.jsx)("td",{children:e.amount?St(Number(e.amount)):"-"}),(0,$e.jsx)("td",{children:(0,$e.jsx)("span",{className:`badge ${vv(e.status)}`,children:Nt[e.status]||e.status})}),(0,$e.jsx)("td",{children:e.id?(0,$e.jsx)(Te,{to:`/applications/${String(e.id)}`,className:"btn btn-xs btn-info",children:"Ver"}):(0,$e.jsx)("span",{className:"text-gray-400",children:"N/D"})})]},e.id||t)))})]})}):(0,$e.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 text-center",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-gray-300 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,$e.jsx)("p",{className:"text-gray-500 mb-4",children:"Este cliente no tiene solicitudes registradas."}),e&&n(He.CREATE_APPLICATION)&&(0,$e.jsxs)(Te,{to:`/applications/new?client=${e}`,className:"btn btn-primary",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Crear Solicitud"]})]})]}),"documents"===E&&(0,$e.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,$e.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,$e.jsx)("h3",{className:"text-lg font-semibold",children:"Documentos del Cliente"})}),l.length>0&&!m&&!x&&(0,$e.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full md:w-1/4",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Origen"})}),(0,$e.jsxs)("select",{className:"select select-bordered",value:j,onChange:e=>k(e.target.value),children:[(0,$e.jsx)("option",{value:"all",children:"Todos"}),(0,$e.jsx)("option",{value:"general",children:"Generales"}),(0,$e.jsx)("option",{value:"application",children:"Solicitudes"})]})]}),(0,$e.jsxs)("div",{className:"form-control w-full md:w-1/4",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Categor\xeda"})}),(0,$e.jsxs)("select",{className:"select select-bordered",value:C,onChange:e=>D(e.target.value),children:[(0,$e.jsx)("option",{value:"all",children:"Todas"}),O.map((e=>(0,$e.jsx)("option",{value:e,children:e},e)))]})]})]}),m?(0,$e.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-md"})}):x?(0,$e.jsxs)("div",{className:"alert alert-error",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:x})]}):0===l.length?(0,$e.jsx)("div",{className:"text-center py-8",children:(0,$e.jsx)("p",{className:"text-gray-500",children:"No hay documentos asociados a este cliente."})}):(0,$e.jsx)("div",{className:"overflow-x-auto",children:(0,$e.jsxs)("table",{className:"table w-full",children:[(0,$e.jsx)("thead",{children:(0,$e.jsxs)("tr",{children:[(0,$e.jsx)("th",{onClick:()=>{const e="file_name";T===e?I("asc"===P?"desc":"asc"):(A(e),I("asc"))},className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Nombre ","file_name"===T&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===P?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>{const e="category";T===e?I("asc"===P?"desc":"asc"):(A(e),I("asc"))},className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Categor\xeda ","category"===T&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===P?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>{"origin"===T?I("asc"===P?"desc":"asc"):(A("origin"),I("asc"))},className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Origen ","origin"===T&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===P?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>{const e="created_at";T===e?I("asc"===P?"desc":"asc"):(A(e),I("asc"))},className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Fecha ","created_at"===T&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===P?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{onClick:()=>{const e="file_size";T===e?I("asc"===P?"desc":"asc"):(A(e),I("asc"))},className:"cursor-pointer",children:(0,$e.jsxs)("div",{className:"flex items-center",children:["Tama\xf1o ","file_size"===T&&(0,$e.jsx)("span",{className:"ml-1",children:"asc"===P?"\u2191":"\u2193"})]})}),(0,$e.jsx)("th",{children:"Acciones"})]})}),(0,$e.jsx)("tbody",{children:(()=>{const e=[...l.filter((e=>("general"!==j||!e.application_id)&&!("application"===j&&!e.application_id)&&("all"===C||(e.category||"sin_categoria")===C)))];return e.sort(((e,t)=>{let n,r;return"origin"===T?(n=e.application_id?"Solicitud":"General",r=t.application_id?"Solicitud":"General"):(n=e[T],r=t[T]),null!==n&&void 0!==n||(n=""),null!==r&&void 0!==r||(r=""),"number"!==typeof n&&(n=String(n).toLowerCase()),"number"!==typeof r&&(r=String(r).toLowerCase()),"asc"===P?n>r?1:n<r?-1:0:n<r?1:n>r?-1:0})),e})().map((e=>(0,$e.jsxs)("tr",{children:[(0,$e.jsxs)("td",{className:"flex items-center gap-2",children:[(0,$e.jsx)(Og,{className:"text-primary"}),e.file_name||"Documento sin nombre"]}),(0,$e.jsx)("td",{children:e.category||"No especificada"}),(0,$e.jsx)("td",{children:e.application_id?"Solicitud":"General"}),(0,$e.jsx)("td",{children:gv(e.created_at)}),(0,$e.jsx)("td",{children:bv(e.file_size||0)}),(0,$e.jsx)("td",{className:"flex gap-2",children:e.file_path?(0,$e.jsx)($e.Fragment,{children:(0,$e.jsx)("button",{onClick:()=>M(e),className:"btn btn-sm btn-primary btn-outline",title:"Ver documento",children:"Ver"})}):(0,$e.jsx)("span",{className:"text-gray-400",title:"Documento sin ruta de archivo",children:(0,$e.jsx)(Mg,{})})})]},e.id||`doc-${Math.random()}`)))})]})}),R&&(0,$e.jsx)(yv,{document:R,onClose:()=>{M(null)}})]})]})]}):(0,$e.jsxs)("div",{className:"alert alert-warning",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,$e.jsx)("span",{children:"Cliente no encontrado."})]}),w&&(0,$e.jsx)("div",{className:"alert alert-warning shadow-lg mb-6",children:(0,$e.jsxs)("div",{children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,$e.jsx)("span",{children:w})]})})]})})},_v=async e=>{try{console.log("\ud83d\udd0d MCP Service: Ejecutando consulta:",e);const t=await eg(e);return console.log("\ud83d\udd0d MCP Service: Respuesta:",t),{data:t}}catch(t){return console.error("\ud83d\udd0d MCP Service: Error:",t),{error:t.message||"Error ejecutando consulta"}}},wv=[{value:"identificacion",label:"Identificaci\xf3n Oficial"},{value:"comprobante_domicilio",label:"Comprobante de Domicilio"},{value:"comprobante_ingresos",label:"Comprobante de Ingresos"},{value:"estados_cuenta",label:"Estados de Cuenta Bancarios"},{value:"rfc",label:"Constancia de Situaci\xf3n Fiscal (RFC)"},{value:"curp",label:"CURP"},{value:"otros",label:"Otros Documentos"}],Nv=[{value:"empleado",label:"Empleado"},{value:"autonomo",label:"Aut\xf3nomo / Freelance"},{value:"empresario",label:"Empresario"},{value:"jubilado",label:"Jubilado"},{value:"desempleado",label:"Desempleado"},{value:"estudiante",label:"Estudiante"},{value:"otro",label:"Otro"}],Ev=[{value:"soltero",label:"Soltero/a"},{value:"casado",label:"Casado/a"},{value:"divorciado",label:"Divorciado/a"},{value:"viudo",label:"Viudo/a"},{value:"union_libre",label:"Uni\xf3n Libre"}],Sv=[{value:"nomina",label:"N\xf3mina"},{value:"ahorro",label:"Ahorro"},{value:"cheques",label:"Cheques"},{value:"inversiones",label:"Inversiones"}],jv=[{value:"semanal",label:"Semanal"},{value:"quincenal",label:"Quincenal"},{value:"mensual",label:"Mensual"},{value:"bimestral",label:"Bimestral"},{value:"trimestral",label:"Trimestral"},{value:"semestral",label:"Semestral"},{value:"anual",label:"Anual"},{value:"irregular",label:"Irregular"}],kv=[{value:"efectivo",label:"Efectivo"},{value:"transferencia",label:"Transferencia"},{value:"tarjeta",label:"Tarjeta de Cr\xe9dito/D\xe9bito"},{value:"cheque",label:"Cheque"},{value:"domiciliacion",label:"Domiciliaci\xf3n Bancaria"}],Cv=[{value:"personal",label:"Gastos Personales"},{value:"negocio",label:"Negocio/Inversi\xf3n"},{value:"vivienda",label:"Vivienda"},{value:"auto",label:"Autom\xf3vil"},{value:"educacion",label:"Educaci\xf3n"},{value:"salud",label:"Salud"},{value:"deudas",label:"Consolidaci\xf3n de Deudas"},{value:"otro",label:"Otro"}],Dv=[{value:"familiar",label:"Familiar"},{value:"amigo",label:"Amigo"},{value:"companero_trabajo",label:"Compa\xf1ero de Trabajo"},{value:"vecino",label:"Vecino"},{value:"otro",label:"Otro"}],Tv=e=>{let{initialData:t={},onSubmit:n,onSavePartial:r,existingDocuments:o=[],isSubmitting:s}=e;const i=ne(),{user:l}=We(),[c,d]=(0,a.useState)({first_name:"",paternal_surname:"",maternal_surname:"",email:"",phone:"",address:"",city:"",state:"",postal_code:"",birth_date:"",gender:"",marital_status:"",employment_type:"",employment_years:void 0,rfc:"",curp:"",monthly_income:void 0,additional_income:void 0,monthly_expenses:void 0,other_loan_balances:void 0,bank_name:"",bank_clabe:"",bank_account_number:"",bank_account_type:"",bank_account_origin:"",company_id:"",street_number_ext:"",street_number_int:"",neighborhood:"",home_phone:"",birth_state:"",nationality:"",job_position:"",employer_name:"",employer_phone:"",employer_address:"",employer_activity:"",mortgage_payment:void 0,rent_payment:void 0,dependent_persons:void 0,income_frequency:"",payment_method:"",credit_purpose:"",spouse_paternal_surname:"",spouse_maternal_surname:"",reference1_name:"",reference1_relationship:"",reference1_address:"",reference1_phone:"",reference2_name:"",reference2_relationship:"",reference2_address:"",reference2_phone:"",...t}),[u,h]=(0,a.useState)({}),[p,m]=(0,a.useState)([]),[f,g]=(0,a.useState)(1),[v,y]=(0,a.useState)([]),[b,x]=(0,a.useState)(!0),[_,w]=(0,a.useState)(!1),[N,E]=(0,a.useState)(!1),S=(0,a.useMemo)((()=>(()=>{let e=0,t=0;const n=["first_name","paternal_surname","maternal_surname","email","phone","rfc","curp","birth_date","gender","marital_status","address","city","state","postal_code","company_id","street_number_ext","street_number_int","neighborhood","home_phone","birth_state","nationality","spouse_paternal_surname","spouse_maternal_surname","dependent_persons"];t+=n.length,e+=n.filter((e=>c[e])).length;const r=["employment_type","employment_years","job_position","employer_name","employer_phone","employer_address","employer_activity","monthly_income","additional_income","monthly_expenses","other_loan_balances","mortgage_payment","rent_payment","income_frequency","payment_method","credit_purpose"];t+=r.length,e+=r.filter((e=>void 0!==c[e]&&""!==c[e])).length;const a=["bank_name","bank_clabe","bank_account_number","bank_account_type","bank_account_origin","reference1_name","reference1_relationship","reference1_address","reference1_phone","reference2_name","reference2_relationship","reference2_address","reference2_phone"];return t+=a.length,e+=a.filter((e=>c[e])).length,Math.round(e/t*100)})()),[c.first_name,c.paternal_surname,c.maternal_surname]),j=e=>{const{name:t,value:n,type:r}=e.target;if("dependent_persons"===t){console.log(`Field ${t} changed: value=${n}, type=${r}`);const e=""===n?void 0:parseInt(n,10);console.log(`Converted to: ${e} (type: ${typeof e})`),d((n=>({...n,[t]:e})))}else if("birth_date"===t){const e=""===n?void 0:n;d((n=>({...n,[t]:e})))}else d((e=>({...e,[t]:"number"===r?""===n?void 0:parseFloat(n):n})))},k=e=>{m((t=>[...t,e]))},C=e=>{m((t=>t.filter(((t,n)=>n!==e))))},D=e=>{const{value:t}=e.target;d((e=>({...e,company_id:t})))};(0,a.useEffect)((()=>{(async()=>{try{x(!0);const e=await _v("SELECT id, name FROM companies ORDER BY name ASC");e&&e.data&&y(e.data)}catch(e){console.error("Error fetching companies:",e)}finally{x(!1)}})()}),[]);return(0,$e.jsx)("div",{className:"p-4",children:(0,$e.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await n(c,p)}catch(t){console.error("Error submitting form:",t)}},children:[(0,$e.jsxs)("div",{className:"mb-6",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,$e.jsx)("h2",{className:"text-xl font-bold",children:null!==t&&void 0!==t&&t.id?"Editar Cliente":"Nuevo Cliente"}),(0,$e.jsxs)("div",{className:"text-sm",children:["Paso ",f," de 4"]})]}),(0,$e.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-4",children:(0,$e.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${S}%`}})})]}),(()=>{switch(f){case 1:return(0,$e.jsxs)("div",{className:"space-y-4",children:[(0,$e.jsx)("h3",{className:"text-lg font-bold",children:"Datos Personales"}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsxs)("span",{className:"label-text",children:["Empresa ",(0,$e.jsx)("span",{className:"text-error",children:"*"})]})}),(0,$e.jsxs)("select",{name:"company_id",value:c.company_id||"",onChange:D,className:"select select-bordered w-full "+(u.company_id?"select-error":""),disabled:b,children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar empresa"}),v.map((e=>(0,$e.jsx)("option",{value:e.id,children:e.name},e.id)))]}),u.company_id&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.company_id}),b&&(0,$e.jsx)("span",{className:"text-sm mt-1",children:"Cargando empresas..."})]}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsxs)("span",{className:"label-text",children:["Nombre(s) ",(0,$e.jsx)("span",{className:"text-error",children:"*"})]})}),(0,$e.jsx)("input",{type:"text",name:"first_name",className:"input input-bordered w-full "+(u.first_name?"input-error":""),value:c.first_name||"",onChange:j,placeholder:"Nombre(s)"}),u.first_name&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.first_name})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsxs)("span",{className:"label-text",children:["Apellido Paterno ",(0,$e.jsx)("span",{className:"text-error",children:"*"})]})}),(0,$e.jsx)("input",{type:"text",name:"paternal_surname",className:"input input-bordered w-full "+(u.paternal_surname?"input-error":""),value:c.paternal_surname||"",onChange:j,placeholder:"Apellido paterno"}),u.paternal_surname&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.paternal_surname})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Apellido Materno"})}),(0,$e.jsx)("input",{type:"text",name:"maternal_surname",className:"input input-bordered w-full "+(u.maternal_surname?"input-error":""),value:c.maternal_surname||"",onChange:j,placeholder:"Apellido materno"}),u.maternal_surname&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.maternal_surname})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsxs)("span",{className:"label-text",children:["Email ",(0,$e.jsx)("span",{className:"text-error",children:"*"})]})}),(0,$e.jsx)("input",{type:"email",name:"email",className:"input input-bordered w-full "+(u.email?"input-error":""),value:c.email||"",onChange:j,placeholder:"email@ejemplo.com"}),u.email&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.email})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsxs)("span",{className:"label-text",children:["Tel\xe9fono M\xf3vil ",(0,$e.jsx)("span",{className:"text-error",children:"*"})]})}),(0,$e.jsx)("input",{type:"tel",name:"phone",className:"input input-bordered w-full "+(u.phone?"input-error":""),value:c.phone||"",onChange:j,placeholder:"55 1234 5678"}),u.phone&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.phone})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tel\xe9fono Fijo"})}),(0,$e.jsx)("input",{type:"tel",name:"home_phone",className:"input input-bordered w-full "+(u.home_phone?"input-error":""),value:c.home_phone||"",onChange:j,placeholder:"55 1234 5678"}),u.home_phone&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.home_phone})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"RFC"})}),(0,$e.jsx)("input",{type:"text",name:"rfc",className:"input input-bordered w-full "+(u.rfc?"input-error":""),value:c.rfc||"",onChange:j,placeholder:"XXXX000000XXX"}),u.rfc&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.rfc})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"CURP"})}),(0,$e.jsx)("input",{type:"text",name:"curp",className:"input input-bordered w-full "+(u.curp?"input-error":""),value:c.curp||"",onChange:j,placeholder:"XXXX000000XXXXXX00"}),u.curp&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.curp})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Fecha de Nacimiento"})}),(0,$e.jsx)("input",{type:"date",name:"birth_date",className:"input input-bordered w-full "+(u.birth_date?"input-error":""),value:c.birth_date||"",onChange:j,onBlur:e=>{""===e.target.value&&d((e=>({...e,birth_date:void 0})))}}),u.birth_date&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.birth_date})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"G\xe9nero"})}),(0,$e.jsxs)("select",{name:"gender",className:"select select-bordered w-full "+(u.gender?"select-error":""),value:c.gender||"",onChange:j,children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),(0,$e.jsx)("option",{value:"masculino",children:"Masculino"}),(0,$e.jsx)("option",{value:"femenino",children:"Femenino"}),(0,$e.jsx)("option",{value:"otro",children:"Otro"}),(0,$e.jsx)("option",{value:"no_especificado",children:"Prefiero no especificar"})]}),u.gender&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.gender})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Estado Civil"})}),(0,$e.jsxs)("select",{name:"marital_status",className:"select select-bordered w-full "+(u.marital_status?"select-error":""),value:c.marital_status||"",onChange:j,children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),Ev.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]}),u.marital_status&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.marital_status})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Personas Dependientes"})}),(0,$e.jsx)("input",{type:"number",name:"dependent_persons",className:"input input-bordered w-full "+(u.dependent_persons?"input-error":""),value:void 0===c.dependent_persons?"":c.dependent_persons,onChange:j,min:"0",placeholder:"0","data-field-type":"numeric",onBlur:()=>console.log(`Current dependent_persons value: ${c.dependent_persons} (type: ${typeof c.dependent_persons})`)}),u.dependent_persons&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.dependent_persons}),(0,$e.jsx)("small",{className:"text-gray-500 mt-1",children:"N\xfamero de personas que dependen econ\xf3micamente de usted"})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Estado de Nacimiento"})}),(0,$e.jsx)("input",{type:"text",name:"birth_state",className:"input input-bordered w-full "+(u.birth_state?"input-error":""),value:c.birth_state||"",onChange:j,placeholder:"Estado de nacimiento"}),u.birth_state&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.birth_state})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Nacionalidad"})}),(0,$e.jsx)("input",{type:"text",name:"nationality",className:"input input-bordered w-full "+(u.nationality?"input-error":""),value:c.nationality||"",onChange:j,placeholder:"Mexicana"}),u.nationality&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.nationality})]})]}),"casado"===c.marital_status&&(0,$e.jsxs)("div",{className:"mt-4",children:[(0,$e.jsx)("h4",{className:"text-md font-semibold mb-2",children:"Informaci\xf3n del C\xf3nyuge"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Apellido Paterno del C\xf3nyuge"})}),(0,$e.jsx)("input",{type:"text",name:"spouse_paternal_surname",className:"input input-bordered w-full",value:c.spouse_paternal_surname||"",onChange:j,placeholder:"Apellido paterno del c\xf3nyuge"})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Apellido Materno del C\xf3nyuge"})}),(0,$e.jsx)("input",{type:"text",name:"spouse_maternal_surname",className:"input input-bordered w-full",value:c.spouse_maternal_surname||"",onChange:j,placeholder:"Apellido materno del c\xf3nyuge"})]})]})]}),(0,$e.jsxs)("div",{className:"mt-4",children:[(0,$e.jsx)("h4",{className:"text-md font-semibold mb-2",children:"Direcci\xf3n"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Calle y N\xfamero"})}),(0,$e.jsx)("input",{type:"text",name:"address",className:"input input-bordered w-full "+(u.address?"input-error":""),value:c.address||"",onChange:j,placeholder:"Calle y n\xfamero"}),u.address&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.address})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"N\xfamero Exterior"})}),(0,$e.jsx)("input",{type:"text",name:"street_number_ext",className:"input input-bordered w-full",value:c.street_number_ext||"",onChange:j,placeholder:"123"})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"N\xfamero Interior"})}),(0,$e.jsx)("input",{type:"text",name:"street_number_int",className:"input input-bordered w-full",value:c.street_number_int||"",onChange:j,placeholder:"A"})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Colonia"})}),(0,$e.jsx)("input",{type:"text",name:"neighborhood",className:"input input-bordered w-full",value:c.neighborhood||"",onChange:j,placeholder:"Colonia o fraccionamiento"})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Ciudad"})}),(0,$e.jsx)("input",{type:"text",name:"city",className:"input input-bordered w-full "+(u.city?"input-error":""),value:c.city||"",onChange:j,placeholder:"Ciudad"}),u.city&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.city})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Estado"})}),(0,$e.jsx)("input",{type:"text",name:"state",className:"input input-bordered w-full "+(u.state?"input-error":""),value:c.state||"",onChange:j,placeholder:"Estado"}),u.state&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.state})]}),(0,$e.jsxs)("div",{className:"form-control",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"C\xf3digo Postal"})}),(0,$e.jsx)("input",{type:"text",name:"postal_code",className:"input input-bordered w-full "+(u.postal_code?"input-error":""),value:c.postal_code||"",onChange:j,placeholder:"00000"}),u.postal_code&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.postal_code})]})]})]})]});case 2:return(0,$e.jsxs)("div",{className:"space-y-6",children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold",children:"Informaci\xf3n Laboral"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tipo de Empleo"})}),(0,$e.jsxs)("select",{name:"employment_type",value:c.employment_type||"",onChange:j,className:"select select-bordered w-full "+(u.employment_type?"select-error":""),children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),Nv.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]}),u.employment_type&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.employment_type})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"A\xf1os en Empleo Actual"})}),(0,$e.jsx)("input",{type:"number",name:"employment_years",value:void 0===c.employment_years?"":c.employment_years,onChange:j,className:"input input-bordered w-full "+(u.employment_years?"input-error":""),placeholder:"0",min:"0",step:"1"}),u.employment_years&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.employment_years})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Puesto/Cargo"})}),(0,$e.jsx)("input",{type:"text",name:"job_position",value:c.job_position||"",onChange:j,className:"input input-bordered w-full "+(u.job_position?"input-error":""),placeholder:"Puesto o cargo"}),u.job_position&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.job_position})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Nombre del Empleador"})}),(0,$e.jsx)("input",{type:"text",name:"employer_name",value:c.employer_name||"",onChange:j,className:"input input-bordered w-full "+(u.employer_name?"input-error":""),placeholder:"Nombre de la empresa"}),u.employer_name&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.employer_name})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tel\xe9fono del Empleador"})}),(0,$e.jsx)("input",{type:"tel",name:"employer_phone",value:c.employer_phone||"",onChange:j,className:"input input-bordered w-full "+(u.employer_phone?"input-error":""),placeholder:"55 1234 5678"}),u.employer_phone&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.employer_phone})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Direcci\xf3n del Empleador"})}),(0,$e.jsx)("input",{type:"text",name:"employer_address",value:c.employer_address||"",onChange:j,className:"input input-bordered w-full "+(u.employer_address?"input-error":""),placeholder:"Direcci\xf3n de la empresa"}),u.employer_address&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.employer_address})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Giro o Actividad"})}),(0,$e.jsx)("input",{type:"text",name:"employer_activity",value:c.employer_activity||"",onChange:j,className:"input input-bordered w-full "+(u.employer_activity?"input-error":""),placeholder:"Giro o actividad"}),u.employer_activity&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.employer_activity})]})]}),(0,$e.jsx)("h3",{className:"text-lg font-semibold mt-6",children:"Informaci\xf3n Financiera"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Ingreso Mensual"})}),(0,$e.jsxs)("div",{className:"relative",children:[(0,$e.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,$e.jsx)("input",{type:"number",name:"monthly_income",value:void 0===c.monthly_income?"":c.monthly_income,onChange:j,className:"input input-bordered w-full pl-7 "+(u.monthly_income?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),u.monthly_income&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.monthly_income})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Ingresos Adicionales"})}),(0,$e.jsxs)("div",{className:"relative",children:[(0,$e.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,$e.jsx)("input",{type:"number",name:"additional_income",value:void 0===c.additional_income?"":c.additional_income,onChange:j,className:"input input-bordered w-full pl-7 "+(u.additional_income?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),u.additional_income&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.additional_income})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Frecuencia de Ingresos"})}),(0,$e.jsxs)("select",{name:"income_frequency",value:c.income_frequency||"",onChange:j,className:"select select-bordered w-full "+(u.income_frequency?"select-error":""),children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),jv.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]}),u.income_frequency&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.income_frequency})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"M\xe9todo de Pago Preferido"})}),(0,$e.jsxs)("select",{name:"payment_method",value:c.payment_method||"",onChange:j,className:"select select-bordered w-full "+(u.payment_method?"select-error":""),children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),kv.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]}),u.payment_method&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.payment_method})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Prop\xf3sito del Cr\xe9dito"})}),(0,$e.jsxs)("select",{name:"credit_purpose",value:c.credit_purpose||"",onChange:j,className:"select select-bordered w-full "+(u.credit_purpose?"select-error":""),children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),Cv.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]}),u.credit_purpose&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.credit_purpose})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Gastos Mensuales"})}),(0,$e.jsxs)("div",{className:"relative",children:[(0,$e.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,$e.jsx)("input",{type:"number",name:"monthly_expenses",value:void 0===c.monthly_expenses?"":c.monthly_expenses,onChange:j,className:"input input-bordered w-full pl-7 "+(u.monthly_expenses?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),u.monthly_expenses&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.monthly_expenses})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Pago de Hipoteca"})}),(0,$e.jsxs)("div",{className:"relative",children:[(0,$e.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,$e.jsx)("input",{type:"number",name:"mortgage_payment",value:void 0===c.mortgage_payment?"":c.mortgage_payment,onChange:j,className:"input input-bordered w-full pl-7 "+(u.mortgage_payment?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),u.mortgage_payment&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.mortgage_payment})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Pago de Renta"})}),(0,$e.jsxs)("div",{className:"relative",children:[(0,$e.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,$e.jsx)("input",{type:"number",name:"rent_payment",value:void 0===c.rent_payment?"":c.rent_payment,onChange:j,className:"input input-bordered w-full pl-7 "+(u.rent_payment?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),u.rent_payment&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.rent_payment})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Saldos de Otros Cr\xe9ditos"})}),(0,$e.jsxs)("div",{className:"relative",children:[(0,$e.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,$e.jsx)("input",{type:"number",name:"other_loan_balances",value:void 0===c.other_loan_balances?"":c.other_loan_balances,onChange:j,className:"input input-bordered w-full pl-7 "+(u.other_loan_balances?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),u.other_loan_balances&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.other_loan_balances})]})]})]});case 3:return(0,$e.jsxs)("div",{className:"space-y-6",children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold",children:"Datos de la Cuenta Bancaria"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Banco"})}),(0,$e.jsx)("input",{type:"text",name:"bank_name",value:c.bank_name||"",onChange:j,className:"input input-bordered w-full "+(u.bank_name?"input-error":""),placeholder:"Nombre del banco"}),u.bank_name&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.bank_name})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"CLABE Interbancaria"})}),(0,$e.jsx)("input",{type:"text",name:"bank_clabe",value:c.bank_clabe||"",onChange:j,className:"input input-bordered w-full "+(u.bank_clabe?"input-error":""),placeholder:"18 d\xedgitos",maxLength:18}),u.bank_clabe&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.bank_clabe})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"N\xfamero de Cuenta"})}),(0,$e.jsx)("input",{type:"text",name:"bank_account_number",value:c.bank_account_number||"",onChange:j,className:"input input-bordered w-full "+(u.bank_account_number?"input-error":""),placeholder:"N\xfamero de cuenta"}),u.bank_account_number&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.bank_account_number})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tipo de Cuenta"})}),(0,$e.jsxs)("select",{name:"bank_account_type",value:c.bank_account_type||"",onChange:j,className:"select select-bordered w-full "+(u.bank_account_type?"select-error":""),children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),Sv.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]}),u.bank_account_type&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.bank_account_type})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Origen de la Cuenta"})}),(0,$e.jsx)("input",{type:"text",name:"bank_account_origin",value:c.bank_account_origin||"",onChange:j,className:"input input-bordered w-full "+(u.bank_account_origin?"input-error":""),placeholder:"Ej: N\xf3mina, Personal"}),u.bank_account_origin&&(0,$e.jsx)("span",{className:"text-error text-sm mt-1",children:u.bank_account_origin})]})]}),(0,$e.jsx)("h3",{className:"text-lg font-semibold mt-6",children:"Referencias"}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h4",{className:"text-md font-medium mb-2",children:"Referencia #1"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Nombre Completo"})}),(0,$e.jsx)("input",{type:"text",name:"reference1_name",value:c.reference1_name||"",onChange:j,className:"input input-bordered w-full",placeholder:"Nombre de la referencia"})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Relaci\xf3n/Parentesco"})}),(0,$e.jsxs)("select",{name:"reference1_relationship",value:c.reference1_relationship||"",onChange:j,className:"select select-bordered w-full",children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),Dv.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tel\xe9fono"})}),(0,$e.jsx)("input",{type:"tel",name:"reference1_phone",value:c.reference1_phone||"",onChange:j,className:"input input-bordered w-full",placeholder:"55 1234 5678"})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Direcci\xf3n"})}),(0,$e.jsx)("input",{type:"text",name:"reference1_address",value:c.reference1_address||"",onChange:j,className:"input input-bordered w-full",placeholder:"Direcci\xf3n de la referencia"})]})]})]}),(0,$e.jsxs)("div",{children:[(0,$e.jsx)("h4",{className:"text-md font-medium mb-2",children:"Referencia #2"}),(0,$e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Nombre Completo"})}),(0,$e.jsx)("input",{type:"text",name:"reference2_name",value:c.reference2_name||"",onChange:j,className:"input input-bordered w-full",placeholder:"Nombre de la referencia"})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Relaci\xf3n/Parentesco"})}),(0,$e.jsxs)("select",{name:"reference2_relationship",value:c.reference2_relationship||"",onChange:j,className:"select select-bordered w-full",children:[(0,$e.jsx)("option",{value:"",children:"Seleccionar"}),Dv.map((e=>(0,$e.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Tel\xe9fono"})}),(0,$e.jsx)("input",{type:"tel",name:"reference2_phone",value:c.reference2_phone||"",onChange:j,className:"input input-bordered w-full",placeholder:"55 1234 5678"})]}),(0,$e.jsxs)("div",{className:"form-control w-full",children:[(0,$e.jsx)("label",{className:"label",children:(0,$e.jsx)("span",{className:"label-text",children:"Direcci\xf3n"})}),(0,$e.jsx)("input",{type:"text",name:"reference2_address",value:c.reference2_address||"",onChange:j,className:"input input-bordered w-full",placeholder:"Direcci\xf3n de la referencia"})]})]})]})]});case 4:return(0,$e.jsxs)("div",{className:"space-y-6",children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold",children:"Documentos"}),(0,$e.jsx)(zg,{onDocumentAdded:k,onDocumentRemoved:C,existingDocuments:p,categories:wv,existingServerDocuments:o})]});default:return null}})(),(0,$e.jsxs)("div",{className:"mt-8 flex justify-between",children:[f>1&&(0,$e.jsx)("button",{type:"button",onClick:()=>{f>1&&g((e=>e-1))},className:"btn btn-outline",disabled:_||s,children:"Anterior"}),(0,$e.jsxs)("div",{className:"flex space-x-2 ml-auto",children:[f>1&&f<4&&r&&(0,$e.jsx)("button",{type:"button",className:"btn btn-outline btn-secondary",onClick:async()=>{if(r)try{w(!0),console.log("\ud83d\udd0d [ClientForm] Guardando datos antes de salir:",c),await r(c,f),console.log("\ud83d\udd0d [ClientForm] Datos guardados exitosamente"),i("/clients")}catch(e){console.error("Error al guardar datos antes de salir:",e)}finally{w(!1)}},disabled:_||s,children:_?"Guardando...":"Guardar y Salir"}),f<4?(0,$e.jsx)("button",{type:"button",onClick:async()=>{if(f<4){if(r)try{w(!0),console.log("\ud83d\udd0d [ClientForm] Llamando a onSavePartial con datos:",c);const e=await r(c,f);console.log(`\ud83d\udd0d [ClientForm] Datos guardados para secci\xf3n ${f}, resultado:`,e),e&&d((t=>{const n={...t,...e};return console.log("\ud83d\udd0d [ClientForm] Datos de formulario actualizados con el resultado:",n),n}))}catch(e){return void console.error("Error al guardar datos parciales:",e)}finally{w(!1)}g((e=>e+1))}},className:"btn btn-primary",disabled:_||s,children:_?"Guardando...":"Siguiente"}):(0,$e.jsx)("button",{type:"submit",className:"btn btn-success",disabled:s||_,children:s?"Guardando...":"Guardar Cliente"})]})]})]})})},Av="70b2aa97-a5b6-4b5e-91db-be8acbd3701a",Pv=()=>{const e=ne(),{user:t}=We(),[n,r]=(0,a.useState)(!1),[o,s]=(0,a.useState)(!1),[i,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),[p,m]=(0,a.useState)(null),[f,g]=(0,a.useState)([]);ee();(0,a.useEffect)((()=>{try{const e=localStorage.getItem("draftClient"),t=localStorage.getItem("temporaryClientId"),n=localStorage.getItem("temporaryDocuments");e&&(console.log("Recuperando datos del cliente del localStorage:",e),h(JSON.parse(e))),t&&(console.log("Recuperando ID de cliente temporal:",t),m(t)),n&&console.log("Recuperando documentos temporales del localStorage")}catch(Yv){console.error("Error loading draft from localStorage:",Yv)}}),[]);const v=(e,t)=>{const n={};switch(e.id&&(n.id=e.id),e.company_id&&(n.company_id=e.company_id),e.advisor_id&&(n.advisor_id=e.advisor_id),t){case 1:["first_name","paternal_surname","maternal_surname","email","phone","rfc","curp","birth_date","gender","marital_status","address","city","state","postal_code","spouse_paternal_surname","spouse_maternal_surname","birth_state","nationality","street_number_ext","street_number_int","neighborhood","home_phone","dependent_persons"].forEach((t=>{t in e&&(n[t]=e[t])}));break;case 2:["employment_type","employment_years","monthly_income","additional_income","monthly_expenses","other_loan_balances","job_position","employer_name","employer_phone","employer_address","employer_activity","mortgage_payment","rent_payment","income_frequency","payment_method","credit_purpose"].forEach((t=>{t in e&&(n[t]=e[t])}));break;case 3:["bank_name","bank_clabe","bank_account_number","bank_account_type","bank_account_origin","reference1_name","reference1_relationship","reference1_address","reference1_phone","reference2_name","reference2_relationship","reference2_address","reference2_phone"].forEach((t=>{t in e&&(n[t]=e[t])}));break;default:console.warn(`\ud83d\udd0d Paso desconocido para guardado parcial: ${t}`)}return n};return(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex items-center mb-6",children:[(0,$e.jsxs)("button",{onClick:()=>e("/clients"),className:"btn btn-sm btn-outline mr-4",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver"]}),(0,$e.jsx)("h1",{className:"text-2xl font-bold",children:"Nuevo Cliente"})]}),i&&(0,$e.jsx)("div",{className:"mb-4",children:(0,$e.jsxs)("div",{className:"alert alert-error",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:i}),(0,$e.jsx)("button",{onClick:()=>l(null),className:"ml-auto",children:"\xd7"})]})}),c&&(0,$e.jsx)("div",{className:"mb-4",children:(0,$e.jsxs)("div",{className:"alert alert-success",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:c}),(0,$e.jsx)("button",{onClick:()=>d(null),className:"ml-auto",children:"\xd7"})]})}),p&&(0,$e.jsx)("div",{className:"mb-4",children:(0,$e.jsxs)("div",{className:"alert alert-info",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:"Cliente guardado como borrador. Complete y env\xede el formulario para finalizar."})]})}),(0,$e.jsx)(Tv,{initialData:u||void 0,onSubmit:async(n,a)=>{r(!0),l(null),console.log("Submitting client data:",n);try{const o={...n};let s;if(t&&"ADVISOR"===t.role&&(o.advisor_id=t.id),o.company_id?console.log("Using company_id selected in form:",o.company_id):(console.log("No company selected in form, applying default/user company logic"),t?"COMPANY_ADMIN"===t.role?(o.company_id=t.entityId,console.log("Using company_id from COMPANY_ADMIN user:",o.company_id)):(o.company_id=Av,console.log("Using default company_id for user with role:",t.role)):(o.company_id=Av,console.log("No user context, using default company_id"))),p?(console.log(`Updating temporary client with ID ${p}`),s=await(0,Eg.updateClient)(p,o,a,null===t||void 0===t?void 0:t.id),console.log("Client updated successfully:",s)):(console.log("Creando nuevo cliente sin ID temporal"),s=await(0,Eg.createClient)(o,a,null===t||void 0===t?void 0:t.id),console.log("Client created successfully:",s)),s&&"warningMessage"in s&&s.warningMessage)return d(s.warningMessage),void r(!1);console.log("Client created/updated successfully:",s),localStorage.removeItem("draftClient"),localStorage.removeItem("clientFormStep"),localStorage.removeItem("temporaryClientId"),localStorage.removeItem("temporaryDocuments"),e("/clients")}catch(i){console.error("Error al crear cliente:",i),l(i.message||"Error al crear el cliente. Por favor, intente de nuevo.")}finally{r(!1)}},onSavePartial:async(e,n)=>{try{s(!0),l(null),console.log(`Saving partial data for step ${n}:`,e);const a=v(e,n);t&&"ADVISOR"===t.role&&!a.advisor_id&&(a.advisor_id=t.id),a.company_id||(t&&"COMPANY_ADMIN"===t.role?a.company_id=t.entityId:a.company_id=Av);const o={...u,...a};h(o);try{if(p){console.log(`Updating temporary client with ID ${p}`);const e=await(0,Eg.updateClient)(p,a);if(console.log("Client updated successfully:",e),!e)throw new Error("No se recibi\xf3 respuesta despu\xe9s de la actualizaci\xf3n");e&&"warningMessage"in e&&e.warningMessage?d(e.warningMessage):d(`Los datos de la secci\xf3n ${n} se han guardado correctamente.`),setTimeout((()=>{d(null)}),3e3)}else if(1===n){if(console.log("Creating temporary client"),!a.first_name||!a.paternal_surname)return l("Debe proporcionar al menos nombre y apellido paterno para guardar."),s(!1),null;const e=await(0,Eg.createClient)(a,[],null===t||void 0===t?void 0:t.id);if(console.log("Temporary client created successfully:",e),!e||!e.id)throw new Error("No se recibi\xf3 un ID de cliente despu\xe9s de la creaci\xf3n");m(e.id),localStorage.setItem("temporaryClientId",e.id)}else console.log("No se puede guardar en Supabase sin haber completado el paso 1 primero");return localStorage.setItem("draftClient",JSON.stringify(o)),o}catch(Yv){console.error("Error saving to Supabase:",Yv),Yv.message&&console.error("Error message:",Yv.message),Yv.cause&&console.error("Error cause:",Yv.cause),Yv.stack&&console.error("Error stack:",Yv.stack),(Yv.code||Yv.details||Yv.hint)&&console.error("Supabase error details:",{code:Yv.code,details:Yv.details,hint:Yv.hint}),l(`Error al guardar los datos en el servidor: ${Yv.message||"Error desconocido"}`);try{localStorage.setItem("draftClient",JSON.stringify(o))}catch(r){console.error("Error saving to localStorage:",r)}return null}}catch(i){return console.error("Error saving partial data:",i),l("Error al guardar los datos parciales."),null}finally{s(!1)}},isSubmitting:n})]})})},Iv=()=>{const{id:e}=re(),t=ne(),{user:n}=We(),[r,o]=(0,a.useState)(null),[s,i]=(0,a.useState)([]),[l,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(!0),[h,p]=(0,a.useState)(!1),[m,f]=(0,a.useState)(null),[g,v]=(0,a.useState)(null);(0,a.useEffect)((()=>{e&&(y(e),b(e))}),[e]);const y=async e=>{try{c(!0),console.log(`Fetching client data for ID ${e}`);const t=await(0,Eg.getClientById)(e);t?(console.log("Client data retrieved successfully:",t),o(t)):f("No se encontr\xf3 el cliente especificado.")}catch(t){console.error("Error al obtener datos del cliente:",t),f("Error al cargar los datos del cliente. Por favor, intente de nuevo.")}finally{c(!1)}},b=async e=>{try{u(!0),console.log(`Fetching documents for client ${e}`);const t=await(0,jg.AS)(e);console.log("Documents retrieved:",t);const n=t.map((e=>({id:e.id,name:e.file_name||"",category:e.category||"",url:e.file_path})));i(n)}catch(t){console.error("Error fetching client documents:",t)}finally{u(!1)}},x=(e,t)=>{const n={};switch(e.id&&(n.id=e.id),e.company_id&&(n.company_id=e.company_id),e.advisor_id&&(n.advisor_id=e.advisor_id),t){case 1:["first_name","paternal_surname","maternal_surname","email","phone","rfc","curp","birth_date","gender","marital_status","address","city","state","postal_code","spouse_paternal_surname","spouse_maternal_surname","birth_state","nationality","street_number_ext","street_number_int","neighborhood","home_phone","dependent_persons"].forEach((t=>{t in e&&(n[t]=e[t])}));break;case 2:["employment_type","employment_years","monthly_income","additional_income","monthly_expenses","other_loan_balances","job_position","employer_name","employer_phone","employer_address","employer_activity","mortgage_payment","rent_payment","income_frequency","payment_method","credit_purpose"].forEach((t=>{t in e&&(n[t]=e[t])}));break;case 3:["bank_name","bank_clabe","bank_account_number","bank_account_type","bank_account_origin","reference1_name","reference1_relationship","reference1_address","reference1_phone","reference2_name","reference2_relationship","reference2_address","reference2_phone"].forEach((t=>{t in e&&(n[t]=e[t])}));break;default:console.warn(`\ud83d\udd0d Paso desconocido para guardado parcial: ${t}`)}return n};return l?(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"p-6 flex justify-center",children:(0,$e.jsx)("span",{className:"loading loading-spinner loading-lg"})})}):m||!r?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"alert alert-error",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:m||"No se encontr\xf3 el cliente solicitado."})]}),(0,$e.jsx)("div",{className:"mt-4",children:(0,$e.jsx)("button",{onClick:()=>t("/clients"),className:"btn btn-primary",children:"Volver a Clientes"})})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex items-center mb-6",children:[(0,$e.jsxs)("button",{onClick:()=>t("/clients"),className:"btn btn-sm btn-outline mr-4",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver"]}),(0,$e.jsx)("h1",{className:"text-2xl font-bold",children:"Editar Cliente"})]}),m&&(0,$e.jsx)("div",{className:"mb-4",children:(0,$e.jsxs)("div",{className:"alert alert-error",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:m}),(0,$e.jsx)("button",{onClick:()=>f(null),className:"ml-auto",children:"\xd7"})]})}),g&&(0,$e.jsx)("div",{className:"mb-4",children:(0,$e.jsxs)("div",{className:"alert alert-success",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:g}),(0,$e.jsx)("button",{onClick:()=>v(null),className:"ml-auto",children:"\xd7"})]})}),l?(0,$e.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,$e.jsx)("div",{className:"loading loading-spinner loading-lg"})}):r?(0,$e.jsx)(Tv,{initialData:r,onSubmit:async(r,a)=>{if(e)try{p(!0),f(null),v(null),console.log("Updating client data with documents...",r),console.log("Documents to upload:",a.length);const o=await(0,Eg.updateClient)(e,r,a,null===n||void 0===n?void 0:n.id);if(console.log("Client data successfully updated",o),o.warningMessage)return void v(o.warningMessage);console.log("Client update complete"),t("/clients")}catch(m){console.error("Error al actualizar cliente:",m),m.message&&(m.message.includes("pol\xedticas de seguridad RLS")||m.message.includes("permisos")||m.message.includes("Unauthorized")||m.message.includes("No tienes permisos"))?f(`Error de permisos: ${m.message}. Contacte al administrador para verificar las pol\xedticas de seguridad de la base de datos.`):m.message&&m.message.includes("actualizaci\xf3n no tuvo efecto")?f(`${m.message} Contacte al administrador para verificar si tiene los permisos necesarios.`):f(m.message||"Error al guardar los cambios. Por favor, intente de nuevo."),window.scrollTo(0,0)}finally{p(!1)}},onSavePartial:async(e,t)=>{try{if(console.log(`\ud83d\udd0d Guardando datos parciales del cliente en paso ${t}...`),console.log("\ud83d\udd0d Datos a guardar:",e),p(!0),f(null),!r||!r.id)throw new Error("No se encontr\xf3 el ID del cliente para actualizaci\xf3n parcial");const a={id:r.id,...x(e,t)};!a.company_id&&r.company_id&&(a.company_id=r.company_id),!a.advisor_id&&r.advisor_id&&(a.advisor_id=r.advisor_id),console.log("\ud83d\udd0d Datos finales a enviar a Supabase:",a);try{const e=await(0,Eg.updateClient)(r.id,a);if(console.log(`\ud83d\udd0d Actualizaci\xf3n exitosa para secci\xf3n ${t}:`,e),!e)throw new Error("No se recibi\xf3 respuesta despu\xe9s de la actualizaci\xf3n");const n={...r,...a,...e};return o(n),console.log("\ud83d\udd0d Cliente actualizado en estado local:",n),e.warningMessage?v(e.warningMessage):v(`Se guardaron los datos de la secci\xf3n ${t} correctamente`),setTimeout((()=>{v(null)}),3e3),console.log("\ud83d\udd0d Datos completos a devolver al formulario:",n),1===t&&n?(console.log("\ud83d\udd0d Verificando campos financieros para el paso 2:"),console.log("employment_type:",n.employment_type),console.log("employment_years:",n.employment_years),console.log("monthly_income:",n.monthly_income),console.log("additional_income:",n.additional_income),console.log("monthly_expenses:",n.monthly_expenses),console.log("other_loan_balances:",n.other_loan_balances)):2===t&&n&&(console.log("\ud83d\udd0d Verificando campos bancarios para el paso 3:"),console.log("bank_name:",n.bank_name),console.log("bank_clabe:",n.bank_clabe),console.log("bank_account_number:",n.bank_account_number),console.log("bank_account_type:",n.bank_account_type),console.log("bank_account_origin:",n.bank_account_origin)),n}catch(n){throw console.error(`\ud83d\udd0d Error al actualizar cliente en paso ${t}:`,n),n.message&&console.error("Error message:",n.message),n.cause&&console.error("Error cause:",n.cause),n.stack&&console.error("Error stack:",n.stack),(n.code||n.details||n.hint)&&console.error("Supabase error details:",{code:n.code,details:n.details,hint:n.hint}),n.message&&(n.message.includes("pol\xedticas de seguridad RLS")||n.message.includes("permisos")||n.message.includes("Unauthorized")||n.message.includes("No tienes permisos"))?f(`Error de permisos al guardar la secci\xf3n ${t}: ${n.message}. \n            Contacte al administrador para verificar las pol\xedticas de seguridad de la base de datos.`):n.message&&n.message.includes("actualizaci\xf3n no tuvo efecto")?f(`${n.message} Contacte al administrador para verificar si tiene los permisos necesarios.`):f(`Error al guardar la secci\xf3n ${t}: ${n.message||"Error desconocido"}`),n}}catch(m){return console.error(`\ud83d\udd0d Error en handleSavePartial en paso ${t}:`,m),document.getElementById("error-message")||f(m.message||`Error al guardar la secci\xf3n ${t}. Por favor, intente nuevamente.`),setTimeout((()=>{m.message===f&&f(null)}),6e3),null}finally{p(!1)}},existingDocuments:s,isSubmitting:h}):(0,$e.jsxs)("div",{className:"alert alert-error",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,$e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,$e.jsx)("span",{children:"Cliente no encontrado"})]})]})})},Rv=()=>{const{userCan:e}=Qe();return e(He.VIEW_REPORTS)?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Reportes"}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsx)("div",{className:"card-body",children:(0,$e.jsx)("p",{className:"text-center py-12 text-gray-500",children:"Esta p\xe1gina est\xe1 en desarrollo."})})})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,$e.jsxs)("div",{className:"text-center",children:[(0,$e.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,$e.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},Mv=()=>{const{userCan:e}=Qe();return e(He.VIEW_ADVISORS)?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold mb-4 md:mb-0",children:"Usuarios"}),e(He.CREATE_ADVISOR)&&(0,$e.jsxs)(Te,{to:"/users/new",className:"btn btn-primary",children:[(0,$e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,$e.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Nuevo Usuario"]})]}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsx)("div",{className:"card-body",children:(0,$e.jsx)("p",{className:"text-center py-12 text-gray-500",children:"Esta p\xe1gina est\xe1 en desarrollo."})})})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,$e.jsxs)("div",{className:"text-center",children:[(0,$e.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,$e.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},Ov=()=>{const{id:e}=re(),t=!!e;return(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:t?"Editar Usuario":"Nuevo Usuario"}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsxs)("div",{className:"card-body",children:[t?(0,$e.jsxs)("p",{children:["Formulario de edici\xf3n para usuario ID: ",e]}):(0,$e.jsx)("p",{children:"Formulario para nuevo usuario"}),(0,$e.jsx)("p",{className:"text-gray-500",children:"Esta p\xe1gina est\xe1 en desarrollo."})]})})]})})},Lv=()=>{const{userCan:e}=Qe();return e(He.VIEW_DASHBOARD)?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Configuraci\xf3n"}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsx)("div",{className:"card-body",children:(0,$e.jsx)("p",{className:"text-center py-12 text-gray-500",children:"Esta p\xe1gina est\xe1 en desarrollo."})})})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,$e.jsxs)("div",{className:"text-center",children:[(0,$e.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,$e.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},$v=()=>(0,$e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-base-200",children:(0,$e.jsxs)("div",{className:"text-center p-8",children:[(0,$e.jsx)("h1",{className:"text-8xl font-bold text-primary",children:"404"}),(0,$e.jsx)("h2",{className:"text-2xl font-bold my-4",children:"P\xe1gina No Encontrada"}),(0,$e.jsx)("p",{className:"mb-6 text-gray-600",children:"Lo sentimos, la p\xe1gina que buscas no existe o ha sido movida."}),(0,$e.jsx)(Te,{to:"/",className:"btn btn-primary",children:"Volver al Inicio"})]})}),Fv=()=>(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Empresas"}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsx)("div",{className:"card-body",children:(0,$e.jsx)("p",{className:"text-lg text-center py-10",children:"La secci\xf3n de Empresas est\xe1 en desarrollo. Estar\xe1 disponible pr\xf3ximamente."})})})]})}),zv=()=>{const{notifications:e,markAsRead:t,markAllAsRead:n,clearNotifications:r}=at();return(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold",children:"Notificaciones"}),(0,$e.jsxs)("div",{className:"flex gap-2",children:[(0,$e.jsx)("button",{onClick:n,className:"btn btn-sm btn-outline",children:"Marcar todas como le\xeddas"}),(0,$e.jsx)("button",{onClick:r,className:"btn btn-sm btn-outline btn-error",children:"Limpiar notificaciones"})]})]}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsx)("div",{className:"card-body",children:0===e.length?(0,$e.jsx)("p",{className:"text-center py-10 text-gray-500",children:"No tienes notificaciones."}):(0,$e.jsx)("div",{className:"space-y-4",children:e.map((e=>(0,$e.jsxs)("div",{className:"border-b border-base-200 p-4 "+(e.read?"":"bg-base-200"),children:[(0,$e.jsxs)("div",{className:"flex justify-between items-start",children:[(0,$e.jsx)("h3",{className:"font-semibold",children:e.title}),(0,$e.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),(0,$e.jsx)("p",{className:"mt-2",children:e.message}),!e.read&&(0,$e.jsx)("button",{onClick:()=>t(e.id),className:"btn btn-xs btn-ghost mt-2",children:"Marcar como le\xedda"})]},e.id)))})})})]})})},Bv=()=>{const{userId:e}=re(),{user:t}=(ne(),We()),[n,r]=(0,a.useState)(e||null),[o,s]=(0,a.useState)(!0),[i,l]=(0,a.useState)(null);return(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-6",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Mensajes"}),(0,$e.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,$e.jsx)("div",{className:"card-body",children:(0,$e.jsx)("p",{className:"text-lg text-center py-10",children:"El sistema de mensajer\xeda est\xe1 en mantenimiento. Estar\xe1 disponible pr\xf3ximamente."})})})]})})},Uv=async()=>{try{const e=(0,tt.X3)();console.log("Running auto_assign_advisor_id migration...");const t="\n    -- Script to assign advisor_id to clients/users based on their company_id\n    -- This ensures clients created by company admins also have advisor_id set\n    \n    -- 1. Create the function to automatically set advisor_id for new users/clients\n    CREATE OR REPLACE FUNCTION auto_assign_advisor_id_on_insert()\n    RETURNS TRIGGER AS $$\n    BEGIN\n      -- Only process when advisor_id is NULL but company_id is set\n      IF NEW.advisor_id IS NULL AND NEW.company_id IS NOT NULL THEN\n        -- Get the advisor_id from the company and assign it to the new user\n        SELECT advisor_id INTO NEW.advisor_id \n        FROM companies \n        WHERE id = NEW.company_id \n        AND advisor_id IS NOT NULL;\n      END IF;\n      \n      RETURN NEW;\n    END;\n    $$ LANGUAGE plpgsql;\n    \n    -- 2. Create the trigger if it doesn't exist\n    DO $$\n    BEGIN\n      IF NOT EXISTS (\n        SELECT 1 FROM pg_trigger \n        WHERE tgname = 'users_auto_assign_advisor_id_trigger'\n      ) THEN\n        CREATE TRIGGER users_auto_assign_advisor_id_trigger\n        BEFORE INSERT ON users\n        FOR EACH ROW\n        EXECUTE FUNCTION auto_assign_advisor_id_on_insert();\n      END IF;\n    END;\n    $$;\n    \n    -- 3. Create a function to sync existing users/clients\n    CREATE OR REPLACE FUNCTION sync_client_advisor_ids()\n    RETURNS INTEGER AS $$\n    DECLARE\n      updated_count INTEGER := 0;\n    BEGIN\n      -- Update existing users/clients where advisor_id is NULL but company_id is set\n      UPDATE users\n      SET advisor_id = c.advisor_id\n      FROM companies c\n      WHERE \n        users.company_id = c.id AND\n        users.advisor_id IS NULL AND\n        c.advisor_id IS NOT NULL;\n        \n      GET DIAGNOSTICS updated_count = ROW_COUNT;\n      RETURN updated_count;\n    END;\n    $$ LANGUAGE plpgsql;\n    \n    -- 4. Run the sync function to update existing records\n    SELECT sync_client_advisor_ids();\n    ",{error:n}=await e.rpc("execute_sql",{sql:t});return n?(console.error("Failed to execute migration:",n),!1):(console.log("Auto assign advisor_id migration completed successfully"),!0)}catch(e){return console.error("Failed to run migration:",e),!1}},Wv=()=>{const{user:e}=We(),{userCan:t,isAdmin:n}=Qe(),[r,o]=(0,a.useState)(!1),[s,i]=(0,a.useState)(null),[l,c]=(0,a.useState)(null);return a.useEffect((()=>{if(s){const e=setTimeout((()=>i(null)),5e3);return()=>clearTimeout(e)}}),[s]),a.useEffect((()=>{if(l){const e=setTimeout((()=>c(null)),5e3);return()=>clearTimeout(e)}}),[l]),n()?(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-4",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Panel de Administraci\xf3n"}),s&&(0,$e.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 relative",children:[s,(0,$e.jsx)("button",{className:"absolute top-0 right-0 mt-2 mr-2",onClick:()=>i(null),children:"\u2715"})]}),l&&(0,$e.jsxs)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4 relative",children:[l,(0,$e.jsx)("button",{className:"absolute top-0 right-0 mt-2 mr-2",onClick:()=>c(null),children:"\u2715"})]}),(0,$e.jsxs)("div",{className:"mt-8",children:[(0,$e.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Mantenimiento de Base de Datos"}),(0,$e.jsx)("div",{className:"space-y-4",children:(0,$e.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow",children:[(0,$e.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Sincronizar Asignaci\xf3n de Asesores"}),(0,$e.jsx)("p",{className:"text-gray-600 mb-4",children:"Esta operaci\xf3n asigna autom\xe1ticamente asesores a los clientes que fueron creados por administradores de empresa y que no tienen asesor asignado. Se usa el asesor asociado a la empresa."}),(0,$e.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",onClick:async()=>{try{o(!0);await Uv()?c("Migraci\xf3n de asignaci\xf3n de asesores completada con \xe9xito"):i("Error al ejecutar la migraci\xf3n de asesores")}catch(e){console.error("Error running advisor migration:",e),i("Error al ejecutar la migraci\xf3n: "+(e instanceof Error?e.message:String(e)))}finally{o(!1)}},disabled:r,children:r?"Ejecutando...":"Ejecutar Sincronizaci\xf3n"})]})})]})]})}):(0,$e.jsx)(Tt,{children:(0,$e.jsxs)("div",{className:"p-4",children:[(0,$e.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Administraci\xf3n"}),(0,$e.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:"No tienes permiso para acceder a esta p\xe1gina."})]})})};var Vv=n(599);const Hv=()=>(a.useEffect((()=>{(async()=>{try{await(0,Vv.og)(),console.log("Database structure check completed successfully"),Uv().then((e=>{e?console.log("Advisor ID migration completed successfully"):console.warn("Advisor ID migration failed or was skipped")})).catch((e=>{console.error("Error running advisor ID migration:",e)}))}catch(e){console.error("Error checking database structure:",e)}})()}),[]),a.useEffect((()=>{const e=()=>{document.documentElement.setAttribute("data-user-interacted","true")},t=["click","keydown","mousedown","touchstart"];return t.forEach((t=>{document.addEventListener(t,e,{once:!0})})),()=>{t.forEach((t=>{document.removeEventListener(t,e)}))}}),[]),(0,$e.jsx)(ke,{children:(0,$e.jsx)(Ve,{children:(0,$e.jsx)(Ke,{children:(0,$e.jsxs)(ot,{children:[(0,$e.jsx)(it,{}),(0,$e.jsxs)(_e,{children:[(0,$e.jsx)(be,{path:"/login",element:(0,$e.jsx)(ct,{})}),(0,$e.jsx)(be,{path:"/",element:(0,$e.jsx)(ye,{to:"/dashboard",replace:!0})}),(0,$e.jsx)(be,{path:"/dashboard",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Hf,{})})}),(0,$e.jsx)(be,{path:"/applications",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(xg,{})})}),(0,$e.jsx)(be,{path:"/applications/kanban",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Ng,{})})}),(0,$e.jsx)(be,{path:"/applications/new",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(ov,{})})}),(0,$e.jsx)(be,{path:"/applications/:id",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(tv,{})})}),(0,$e.jsx)(be,{path:"/applications/:id/edit",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(ov,{})})}),(0,$e.jsx)(be,{path:"/clients",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(sv,{})})}),(0,$e.jsx)(be,{path:"/clients/new",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Pv,{})})}),(0,$e.jsx)(be,{path:"/clients/:id",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(xv,{})})}),(0,$e.jsx)(be,{path:"/clients/:id/edit",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Iv,{})})}),(0,$e.jsx)(be,{path:"/reports",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Rv,{})})}),(0,$e.jsx)(be,{path:"/users",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Mv,{})})}),(0,$e.jsx)(be,{path:"/users/new",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Ov,{})})}),(0,$e.jsx)(be,{path:"/users/:id/edit",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Ov,{})})}),(0,$e.jsx)(be,{path:"/settings",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Lv,{})})}),(0,$e.jsx)(be,{path:"/companies",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Fv,{})})}),(0,$e.jsx)(be,{path:"/notifications",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(zv,{})})}),(0,$e.jsx)(be,{path:"/messages",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Bv,{})})}),(0,$e.jsx)(be,{path:"/messages/:userId",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Bv,{})})}),(0,$e.jsx)(be,{path:"/admin",element:(0,$e.jsx)(st,{children:(0,$e.jsx)(Wv,{})})}),(0,$e.jsx)(be,{path:"*",element:(0,$e.jsx)($v,{})})]})]})})})})),qv=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:o,getTTFB:s}=t;n(e),r(e),a(e),o(e),s(e)}))};(async()=>{console.log("Iniciando configuraci\xf3n de base de datos...");try{if(await(0,Vv.$n)(qf.C.DOCUMENTS,"\n      id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n      created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),\n      updated_at TIMESTAMP WITH TIME ZONE DEFAULT now(),\n      application_id UUID,\n      client_id UUID,\n      file_name TEXT NOT NULL,\n      file_path TEXT,\n      file_type TEXT,\n      file_size INTEGER DEFAULT 0,\n      category TEXT,\n      uploaded_by_user_id UUID,\n      is_verified BOOLEAN DEFAULT FALSE,\n      verified_by UUID,\n      verified_at TIMESTAMP WITH TIME ZONE\n    "),!await(0,Vv.dg)("users","user_id")){console.log("La columna user_id no existe en la tabla users, intentando crearla...");try{const e="\n          ALTER TABLE public.users \n          ADD COLUMN IF NOT EXISTS user_id UUID DEFAULT gen_random_uuid();\n        ",t=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),n=await t.json();n.error?console.error("Error al crear columna user_id en users:",n.error):console.log("Columna user_id creada con \xe9xito en tabla users")}catch(e){console.error("Error al intentar crear columna user_id:",e)}}try{const e="\n        CREATE OR REPLACE FUNCTION public.check_column_exists(_table_name text, _column_name text)\n        RETURNS boolean\n        LANGUAGE plpgsql\n        SECURITY DEFINER\n        AS $$\n        BEGIN\n          RETURN EXISTS (\n            SELECT FROM information_schema.columns \n            WHERE table_name = _table_name\n            AND column_name = _column_name\n            AND table_schema = 'public'\n          );\n        END;\n        $$;\n\n        -- Aseguramos que todos los usuarios puedan ejecutar esta funci\xf3n\n        GRANT EXECUTE ON FUNCTION public.check_column_exists(text, text) TO authenticated;\n        GRANT EXECUTE ON FUNCTION public.check_column_exists(text, text) TO anon;\n        GRANT EXECUTE ON FUNCTION public.check_column_exists(text, text) TO service_role;\n      ",t=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),n=await t.json();n.error?console.error("Error al crear funci\xf3n RPC check_column_exists:",n.error):console.log("Funci\xf3n RPC check_column_exists creada con \xe9xito")}catch(e){console.error("Error al intentar crear funci\xf3n RPC:",e)}try{const{data:e,error:t}=await tt.ND.storage.listBuckets();if(t)console.error("Error al listar buckets:",t);else{if(null===e||void 0===e?void 0:e.some((e=>"client-documents"===e.name)))console.log("El bucket client-documents ya existe");else{console.log("El bucket client-documents no existe, intentando crearlo...");const{data:e,error:t}=await tt.ND.storage.createBucket("client-documents",{public:!0});t?console.error("Error al crear bucket client-documents:",t):console.log("Bucket client-documents creado con \xe9xito")}}}catch(e){console.error("Error al intentar verificar/crear bucket de storage:",e)}console.log("Configuraci\xf3n de base de datos completada.")}catch(e){console.error("Error durante la configuraci\xf3n de la base de datos:",e)}})().catch((e=>{console.error("Error en la configuraci\xf3n inicial de la base de datos:",e)}));s.createRoot(document.getElementById("root")).render((0,$e.jsx)(a.StrictMode,{children:(0,$e.jsx)(Hv,{})})),qv()})();
//# sourceMappingURL=main.8acf75ea.js.map